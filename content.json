{"meta":{"title":"PuFanyi's Blog","subtitle":"A burnt child loves the fire","description":"","author":"pufanyi","url":"https://pufanyi.github.io/oi-blog","root":"/oi-blog/"},"pages":[{"title":"å…³äºæˆ‘","date":"2023-12-25T16:08:28.161Z","updated":"2023-12-25T16:08:28.161Z","comments":true,"path":"about/index.html","permalink":"https://pufanyi.github.io/oi-blog/about/index.html","excerpt":"","text":"ä¸€åªæ¥è‡ªæµ™æ±Ÿç»å…´çš„å°è’Ÿè’»ã€‚ è€å¹´é€€å½¹é€‰æ‰‹ã€‚"},{"title":"å½’æ¡£","date":"2023-12-25T16:08:28.161Z","updated":"2023-12-25T16:08:28.161Z","comments":true,"path":"archives/index.html","permalink":"https://pufanyi.github.io/oi-blog/archives/index.html","excerpt":"","text":""},{"title":"","date":"2023-12-25T16:08:27.855Z","updated":"2023-12-25T16:08:27.855Z","comments":true,"path":"README.html","permalink":"https://pufanyi.github.io/oi-blog/README.html","excerpt":"","text":"My Blog"},{"title":"æœ‹å‹ä»¬","date":"2023-12-25T16:08:28.166Z","updated":"2023-12-25T16:08:28.166Z","comments":true,"path":"friends/index.html","permalink":"https://pufanyi.github.io/oi-blog/friends/index.html","excerpt":"æƒ³åŠ å‹é“¾çš„å¯ä»¥ç›´æ¥åœ¨ä¸‹é¢è¯„è®ºå»ç•™è¨€ã€‚ä½†å› ä¸ºé‚®ä»¶æé†’æ—¥å¸¸å‡ºæ•…éšœï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥ç›´æ¥å‘æˆ‘é‚®ä»¶ï¼ˆFPU001@e.ntu.edu.sgï¼‰ã€‚","text":"æƒ³åŠ å‹é“¾çš„å¯ä»¥ç›´æ¥åœ¨ä¸‹é¢è¯„è®ºå»ç•™è¨€ã€‚ä½†å› ä¸ºé‚®ä»¶æé†’æ—¥å¸¸å‡ºæ•…éšœï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥ç›´æ¥å‘æˆ‘é‚®ä»¶ï¼ˆFPU001@e.ntu.edu.sgï¼‰ã€‚"},{"title":"schedule","date":"2023-12-25T16:08:28.171Z","updated":"2023-12-25T16:08:28.171Z","comments":true,"path":"schedule/index.html","permalink":"https://pufanyi.github.io/oi-blog/schedule/index.html","excerpt":"","text":""},{"title":"æ‰€æœ‰åˆ†ç±»","date":"2023-12-25T16:08:28.161Z","updated":"2023-12-25T16:08:28.161Z","comments":true,"path":"categories/index.html","permalink":"https://pufanyi.github.io/oi-blog/categories/index.html","excerpt":"","text":""},{"title":"sitemap","date":"2023-12-25T16:08:28.171Z","updated":"2023-12-25T16:08:28.171Z","comments":true,"path":"sitemap/index.html","permalink":"https://pufanyi.github.io/oi-blog/sitemap/index.html","excerpt":"","text":""},{"title":"æ‰€æœ‰æ ‡ç­¾","date":"2023-12-25T16:08:28.171Z","updated":"2023-12-25T16:08:28.171Z","comments":true,"path":"tags/index.html","permalink":"https://pufanyi.github.io/oi-blog/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"Linear Algebra é¢˜ç›®é€‰åš","slug":"LinearAlgebraDoneRight","date":"2023-12-25T16:08:27.899Z","updated":"2023-12-25T16:08:27.899Z","comments":true,"path":"LinearAlgebraDoneRight/","link":"","permalink":"https://pufanyi.github.io/oi-blog/LinearAlgebraDoneRight/","excerpt":"åšä¸€äº› Linear Algebra çš„é¢˜ã€‚ ä¸»è¦æ¥æºæ˜¯ Linear Algebra Done Right (Third Edition) çš„ä¹ é¢˜ï¼Œä»¥åŠ MIT 18.700 Linear Algebra çš„ä¸€äº›ä½œä¸šé¢˜ã€‚ è™½ç„¶ä½†æ˜¯ï¼Œæ€ä¹ˆéƒ½æ²¡ç­”æ¡ˆå‘€ã€‚ğŸ˜¢","text":"åšä¸€äº› Linear Algebra çš„é¢˜ã€‚ ä¸»è¦æ¥æºæ˜¯ Linear Algebra Done Right (Third Edition) çš„ä¹ é¢˜ï¼Œä»¥åŠ MIT 18.700 Linear Algebra çš„ä¸€äº›ä½œä¸šé¢˜ã€‚ è™½ç„¶ä½†æ˜¯ï¼Œæ€ä¹ˆéƒ½æ²¡ç­”æ¡ˆå‘€ã€‚ğŸ˜¢ Q1 Consider the set of complex numbers G={a+biâˆ£a,bâˆˆQ}.G = \\{a + bi \\mid a, b \\in \\mathbb{Q}\\}. G={a+biâˆ£a,bâˆˆQ}. (The GGG stands for Gauss; these numbers might be called Gaussian rational numbers, although I donâ€™t know if they actually are.) Is GGG a field (with the same addition and multiplication operations as in C\\mathbb{C}C)? For a question like this, you should either explain why all the axioms for a field are satisfied (you can assume that they hold for C\\mathbb{C}C), or else explain why one of the axioms fails. A few sentences could be enough to write. Answer GGG is a field. Closure under addition and multiplication: Assume x=a+bi,y=c+diâˆˆGx = a+bi, y=c+di\\in Gx=a+bi,y=c+diâˆˆG So a,b,c,dâˆˆQa, b, c, d \\in \\mathbb{Q}a,b,c,dâˆˆQ So a+c,b+d,(acâˆ’bd,ad+bc)âˆˆQa + c, b + d, (ac - bd, ad + bc)\\in \\mathbb{Q}a+c,b+d,(acâˆ’bd,ad+bc)âˆˆQ x+y=(a+c)+(b+d)iâˆˆQx + y=(a + c) + (b + d) i\\in \\mathbb{Q}x+y=(a+c)+(b+d)iâˆˆQ xy=(acâˆ’bd)+(ad+bc)iâˆˆQxy = (ac - bd) + (ad + bc)i\\in \\mathbb{Q}xy=(acâˆ’bd)+(ad+bc)iâˆˆQ Community of addition and multiplication: x+y=(a+c)+(b+d)i=(c+a)+(d+b)i=y+xx + y = (a + c) + (b + d)i = (c + a) + (d + b)i = y + xx+y=(a+c)+(b+d)i=(c+a)+(d+b)i=y+x xy=(acâˆ’bd)+(ad+bc)i=(caâˆ’db)+(cb+da)i=yxxy = (ac - bd) + (ad + bc)i = (ca - db) + (cb + da)i = yxxy=(acâˆ’bd)+(ad+bc)i=(caâˆ’db)+(cb+da)i=yx Existence of additive and multiplicative identity: 0=0+0iâˆˆG0 = 0 + 0i\\in G0=0+0iâˆˆG 1=1+0iâˆˆG1 = 1 + 0i\\in G1=1+0iâˆˆG Existence of additive inverse: âˆ’x=âˆ’aâˆ’biâˆˆG-x = -a - bi\\in Gâˆ’x=âˆ’aâˆ’biâˆˆG Existence of multiplicative inverse: Assume x=a+biâˆˆGâˆ–{0}x = a + bi\\in G\\setminus\\{0\\}x=a+biâˆˆGâˆ–{0} and xâˆ’1=c+dix^{-1}=c+dixâˆ’1=c+di We have (a+bi)â‹…(d+di)=1(a + bi)\\cdot (d + di)=1(a+bi)â‹…(d+di)=1 So {acâˆ’bd=1ad+bc=0\\begin{cases} ac - bd = 1 \\\\ ad + bc = 0 \\end{cases}{acâˆ’bd=1ad+bc=0â€‹ Which is [aâˆ’bba][cd]=[10]\\begin{bmatrix} a &amp; -b \\\\ b &amp; a \\end{bmatrix}\\begin{bmatrix} c \\\\ d \\end{bmatrix}=\\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}[abâ€‹âˆ’baâ€‹][cdâ€‹]=[10â€‹] We get the inverse matrix [aâˆ’bba]âˆ’1=1a2+b2[abâˆ’ba]\\begin{bmatrix} a &amp; -b \\\\ b &amp; a \\end{bmatrix}^{-1}=\\frac{1}{a^2+b^2}\\begin{bmatrix} a &amp; b \\\\ -b &amp; a \\end{bmatrix}[abâ€‹âˆ’baâ€‹]âˆ’1=a2+b21â€‹[aâˆ’bâ€‹baâ€‹] So [cd]=1a2+b2[abâˆ’ba][10]=1a2+b2[aâˆ’b]\\begin{bmatrix} c \\\\ d \\end{bmatrix}=\\frac{1}{a^2+b^2}\\begin{bmatrix} a &amp; b \\\\ -b &amp; a \\end{bmatrix}\\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}=\\frac{1}{a^2+b^2}\\begin{bmatrix} a \\\\ -b \\end{bmatrix}[cdâ€‹]=a2+b21â€‹[aâˆ’bâ€‹baâ€‹][10â€‹]=a2+b21â€‹[aâˆ’bâ€‹] So c,dâˆˆQc, d\\in \\mathbb{Q}c,dâˆˆQ, and xâˆ’1=c+diâˆˆGx^{-1}=c+di\\in Gxâˆ’1=c+diâˆˆG Distributivity of multiplication over addition: Follows from the distributivity of multiplication over addition in C\\mathbb{C}C Q2 Consider the set of complex numbers M={r0+r1eÏ€i2âˆ£r0,r1âˆˆQ}M = \\left\\{r_0 + r_1 e^{\\frac{\\pi i}{2}} \\mid r_0, r_1 \\in \\mathbb{Q}\\right\\} M={r0â€‹+r1â€‹e2Ï€iâ€‹âˆ£r0â€‹,r1â€‹âˆˆQ} Is MMM a field? Answer MMM is a field. Consider that eÏ€i2=ie^{\\frac{\\pi i}{2}} = ie2Ï€iâ€‹=i, we have M={r0+r1iâˆ£r0,r1âˆˆQ}=GM = \\{r_0 + r_1 i \\mid r_0, r_1 \\in \\mathbb{Q}\\}=GM={r0â€‹+r1â€‹iâˆ£r0â€‹,r1â€‹âˆˆQ}=G. Since GGG is a field, MMM is also a field. Q3 Consider the set of complex numbers P={re2Ï€iÎ¸âˆ£r,Î¸âˆˆQ}P = \\left\\{re^{2\\pi i\\theta} \\mid r, \\theta \\in \\mathbb{Q}\\right\\} P={re2Ï€iÎ¸âˆ£r,Î¸âˆˆQ} Is PPP a field? Answer PPP is not a field. Consider x=eÏ€i4,y=eâˆ’Ï€i4âˆˆPx = e^{\\frac{\\pi i}{4}}, y=e^{-\\frac{\\pi i}{4}}\\in Px=e4Ï€iâ€‹,y=eâˆ’4Ï€iâ€‹âˆˆP, we have: x+y=2âˆ‰Px + y = \\sqrt{2}\\notin P x+y=2â€‹âˆˆ/P So PPP is not closed under addition. Q4 The set W={(x,y,z,w)âˆˆR4âˆ£x+y+z+w=0}W = \\left\\{(x, y, z, w) \\in \\mathbb{R}^4 \\mid x + y + z + w = 0\\right\\}W={(x,y,z,w)âˆˆR4âˆ£x+y+z+w=0} is a subspace of R4\\mathbb{R}^4R4. Find a basis of WWW. Answer We firstly add (1,âˆ’1,0,0),(1,0,âˆ’1,0),(1,0,0,âˆ’1)(1, -1, 0, 0), (1, 0, -1, 0), (1, 0, 0, -1)(1,âˆ’1,0,0),(1,0,âˆ’1,0),(1,0,0,âˆ’1) into the basis of WWW, they are linearly independent. Then we could find that if we add (0,1,0,2)(0, 1, 0, 2)(0,1,0,2) in to the set, it will still be linearly independent, and","categories":[{"name":"notes","slug":"notes","permalink":"https://pufanyi.github.io/oi-blog/categories/notes/"}],"tags":[{"name":"æ•°å­¦","slug":"æ•°å­¦","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%95%B0%E5%AD%A6/"},{"name":"Linear Algebra","slug":"Linear-Algebra","permalink":"https://pufanyi.github.io/oi-blog/tags/Linear-Algebra/"}]},{"title":"æ–°åšå®¢ï¼","slug":"æ–°åšå®¢ï¼","date":"2023-05-31T16:00:00.000Z","updated":"2024-06-22T19:16:41.067Z","comments":true,"path":"æ–°åšå®¢ï¼/","link":"","permalink":"https://pufanyi.github.io/oi-blog/%E6%96%B0%E5%8D%9A%E5%AE%A2%EF%BC%81/","excerpt":"æœ€è¿‘å¤§å¹…åº¦çš„ä¿®æ”¹äº†ä¸€ä¸‹ç½‘å€ï¼ŒæŠŠåŸæ¥çš„ç½‘å€ pufanyi.github.io è®©å‡ºæ¥ç»™äº†æˆ‘çš„ä¸ªäººä¸»é¡µï¼Œç„¶åæŠŠè¿™ä¸ª blog æ¬åˆ°äº† pufanyi.github.io/oi-blog ä¸‹ï¼Œå¹¶ä¸”å¼€äº†ä¸ªæ–°çš„è‹±æ–‡ blogã€‚","text":"æœ€è¿‘å¤§å¹…åº¦çš„ä¿®æ”¹äº†ä¸€ä¸‹ç½‘å€ï¼ŒæŠŠåŸæ¥çš„ç½‘å€ pufanyi.github.io è®©å‡ºæ¥ç»™äº†æˆ‘çš„ä¸ªäººä¸»é¡µï¼Œç„¶åæŠŠè¿™ä¸ª blog æ¬åˆ°äº† pufanyi.github.io/oi-blog ä¸‹ï¼Œå¹¶ä¸”å¼€äº†ä¸ª æ–°çš„è‹±æ–‡ blogã€‚ å½“ç„¶ï¼Œè¿™ä¸ª blog ä»ç„¶ä¼šæŒç»­æ›´æ–°ï¼Œåªæ˜¯éƒ¨åˆ†è‹±æ–‡å†…å®¹æˆ‘ä¼šæ”¾åˆ°æ–°çš„ blog é‡Œé¢å»ã€‚","categories":[{"name":"å…¬å‘Š","slug":"å…¬å‘Š","permalink":"https://pufanyi.github.io/oi-blog/categories/%E5%85%AC%E5%91%8A/"}],"tags":[]},{"title":"SC2006 Software Engineering Notes","slug":"SC2006Notes","date":"2023-04-24T16:00:00.000Z","updated":"2023-12-25T16:08:27.900Z","comments":true,"path":"SC2006Notes/","link":"","permalink":"https://pufanyi.github.io/oi-blog/SC2006Notes/","excerpt":"Software Engineering è€ƒå®Œäº†ï¼ˆå¼€å·è€ƒï¼‰ï¼Œåˆ†äº«ä¸€ä¸‹ notesã€‚ è™½ç„¶ä½†æ˜¯ï¼Œåªè®°äº†ä¸ŠåŠå­¦æœŸï¼Œä¸‹åŠå­¦æœŸæ‰“äº†è¯¾ä»¶ä¸Šè€ƒåœºçš„ã€‚","text":"Software Engineering è€ƒå®Œäº†ï¼ˆå¼€å·è€ƒï¼‰ï¼Œåˆ†äº«ä¸€ä¸‹ notesã€‚ è™½ç„¶ä½†æ˜¯ï¼Œåªè®°äº†ä¸ŠåŠå­¦æœŸï¼Œä¸‹åŠå­¦æœŸæ‰“äº†è¯¾ä»¶ä¸Šè€ƒåœºçš„ã€‚","categories":[{"name":"notes","slug":"notes","permalink":"https://pufanyi.github.io/oi-blog/categories/notes/"}],"tags":[{"name":"NTU","slug":"NTU","permalink":"https://pufanyi.github.io/oi-blog/tags/NTU/"},{"name":"OOP","slug":"OOP","permalink":"https://pufanyi.github.io/oi-blog/tags/OOP/"},{"name":"notes","slug":"notes","permalink":"https://pufanyi.github.io/oi-blog/tags/notes/"},{"name":"Software Engineering","slug":"Software-Engineering","permalink":"https://pufanyi.github.io/oi-blog/tags/Software-Engineering/"}]},{"title":"SC1015 Introduction to Data Science and Artificial Intelligence Project (Gender Recognition by Voice)","slug":"SC1015Project","date":"2023-04-23T16:00:00.000Z","updated":"2023-12-25T16:08:27.900Z","comments":true,"path":"SC1015Project/","link":"","permalink":"https://pufanyi.github.io/oi-blog/SC1015Project/","excerpt":"åˆæ˜¯ä¸€ä¸ª ddl ä¹‹å‰è‚å‡ºæ¥çš„ projectã€‚","text":"åˆæ˜¯ä¸€ä¸ª ddl ä¹‹å‰è‚å‡ºæ¥çš„ projectã€‚ ç»§ç»­æ°´ã€‚ website å°„æ­»å°è§†é¢‘","categories":[{"name":"Project","slug":"Project","permalink":"https://pufanyi.github.io/oi-blog/categories/Project/"}],"tags":[{"name":"NTU","slug":"NTU","permalink":"https://pufanyi.github.io/oi-blog/tags/NTU/"},{"name":"Project","slug":"Project","permalink":"https://pufanyi.github.io/oi-blog/tags/Project/"},{"name":"Data Science","slug":"Data-Science","permalink":"https://pufanyi.github.io/oi-blog/tags/Data-Science/"},{"name":"Artificial Intelligence","slug":"Artificial-Intelligence","permalink":"https://pufanyi.github.io/oi-blog/tags/Artificial-Intelligence/"}]},{"title":"SC2002 Object-Oriented Design & Programming Project (FYPMS)","slug":"SC2002Project","date":"2023-04-20T16:00:00.000Z","updated":"2023-12-25T16:08:27.900Z","comments":true,"path":"SC2002Project/","link":"","permalink":"https://pufanyi.github.io/oi-blog/SC2002Project/","excerpt":"æ€»ç®—æ˜¯åœ¨ ddl ä¹‹å‰è‚å‡ºæ¥äº†ã€‚","text":"æ€»ç®—æ˜¯åœ¨ ddl ä¹‹å‰è‚å‡ºæ¥äº†ã€‚ å¥½ä¹…æ²¡å†™ blog äº†ï¼Œè¦ä¸æ‹¿è¿™ç©æ„å„¿æ°´ä¸€ä¸‹å§ã€‚ website å°„æ­»å°è§†é¢‘","categories":[{"name":"Project","slug":"Project","permalink":"https://pufanyi.github.io/oi-blog/categories/Project/"}],"tags":[{"name":"NTU","slug":"NTU","permalink":"https://pufanyi.github.io/oi-blog/tags/NTU/"},{"name":"Project","slug":"Project","permalink":"https://pufanyi.github.io/oi-blog/tags/Project/"},{"name":"OOP","slug":"OOP","permalink":"https://pufanyi.github.io/oi-blog/tags/OOP/"}]},{"title":"çº¿æ€§æ—¶é—´æ±‚å‡ºåºåˆ—ç¬¬ k å°","slug":"çº¿æ€§æ—¶é—´æ±‚å‡ºåºåˆ—ç¬¬kå°","date":"2023-01-21T16:00:00.000Z","updated":"2023-12-25T16:08:28.152Z","comments":true,"path":"çº¿æ€§æ—¶é—´æ±‚å‡ºåºåˆ—ç¬¬kå°/","link":"","permalink":"https://pufanyi.github.io/oi-blog/%E7%BA%BF%E6%80%A7%E6%97%B6%E9%97%B4%E6%B1%82%E5%87%BA%E5%BA%8F%E5%88%97%E7%AC%ACk%E5%B0%8F/","excerpt":"çœ‹åˆ°ä¸€ä¸ªæœ‰è¶£çš„ç®—æ³•ï¼Œèƒ½åœ¨æœ€åæ—¶é—´å¤æ‚åº¦ O(n)\\mathcal{O}(n)O(n) å†…æ±‚å‡ºåºåˆ—ç¬¬ kkk å°ã€‚","text":"çœ‹åˆ°ä¸€ä¸ªæœ‰è¶£çš„ç®—æ³•ï¼Œèƒ½åœ¨æœ€åæ—¶é—´å¤æ‚åº¦ O(n)\\mathcal{O}(n)O(n) å†…æ±‚å‡ºåºåˆ—ç¬¬ kkk å°ã€‚ é¦–å…ˆå¦‚æœæ˜¯æœŸæœ›çº¿æ€§çš„è¯ï¼Œåº”è¯¥æ˜¯éå¸¸ç®€å•çš„ï¼Œå°±æ˜¯æˆ‘ä»¬ç›´æ¥ä½¿ç”¨å¿«é€Ÿæ’åºçš„åˆ†æ²»æ€æƒ³ï¼Œéšæœºé€‰ä¸€ä¸ªæ•°ä½œä¸º pivotï¼ŒæŠŠæ¯”å¥¹å°çš„æ”¾å‰é¢ï¼Œæ¯”å¥¹å¤§çš„æ”¾åé¢ï¼Œäºæ˜¯å°±å½¢æˆäº†å·¦å³ä¸¤è¾¹ï¼Œç´§æ¥ç€è€ƒè™‘å·¦è¾¹çš„ size æ˜¯å¦å°äº kkk è¿›è¡Œåˆ†æ²»ã€‚ ä½†æˆ‘ä»¬éœ€è¦çš„æ˜¯ç¡®å®šæ€§ç®—æ³•ã€‚ é¦–å…ˆæˆ‘ä»¬ä¿è¯æ¯ä¸ªæ•°æ˜¯ä¸ç›¸åŒçš„ï¼Œè¿™å¾ˆå¥½ä¿è¯ï¼Œåªè¦å¼€ä¸ª pairï¼Œåœ¨æ¯ä¸ªæ•°åé¢é™„ä¸Šä¸€ä¸ª index ä»¥åŒå…³é”®å­—æ¯”è¾ƒå³å¯ã€‚ ç°åœ¨æœ‰ä¸€ä¸ªéå¸¸æœ‰è¶£çš„æƒ³æ³•ï¼Œå°±æ˜¯æˆ‘ä»¬ç”¨ä¸€ç§æ–¹æ³•æ¥æ‰¾åˆ°ä¸€ä¸ª pivotï¼Œè®©è¿™ä¸ª pivot æ¯”è¾ƒå±…ä¸­ã€‚æˆ‘ä»¬è€ƒè™‘å°†åºåˆ—æŒ‰ç…§æ¯äº”ä¸ªåˆ‡æˆç‰‡ï¼Œè¿™æ ·çš„è¯å¦‚æœæ˜¯ä¸€ä¸ªé•¿åº¦ä¸º nnn çš„åºåˆ—ï¼Œå°±ä¼šè¢«åˆ‡æˆ âŒˆn5âŒ‰\\left\\lceil \\frac{n}{5}\\right\\rceilâŒˆ5nâ€‹âŒ‰ ç‰‡ï¼Œæ¯ç‰‡è‡³å¤š 555 ä¸ªæ•°ï¼Œç„¶åæˆ‘ä»¬å¯¹è¿™ 555 ä¸ªæ•°å–ä¸­ä½æ•°ï¼Œå¹¶å°†å…¶æå–å‡ºæ¥ï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„åºåˆ—ã€‚è¿™æ ·è¿™ä¸ªæ–°çš„åºåˆ—çš„é•¿åº¦ä¸º âŒˆn5âŒ‰\\left\\lceil\\frac{n}{5}\\right\\rceilâŒˆ5nâ€‹âŒ‰ã€‚ç„¶åæˆ‘ä»¬é€’å½’åœ°æ±‚å‡ºè¿™ä¸ªåºåˆ—çš„ä¸­ä½æ•°ï¼ˆä¹Ÿå°±æ˜¯è¯¥åºåˆ—çš„ç¬¬ âŒŠâŒˆn5âŒ‰2âŒ‹\\left\\lfloor\\frac{\\left\\lceil\\frac{n}{5}\\right\\rceil}{2}\\right\\rfloorâŒŠ2âŒˆ5nâ€‹âŒ‰â€‹âŒ‹ å°å€¼ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä¸ª k å°å€¼é—®é¢˜ï¼‰ã€‚ç„¶åå°†è¯¥æ•°ä½œä¸º pivot è¿›è¡Œåˆ†æ²»ã€‚ æˆ‘ä»¬è€ƒè™‘è¿™ä¸ª pivot çš„æ€§è´¨ã€‚è€ƒè™‘åˆ°æ­¤æ—¶è®¡ç®—èµ·æ¥æ¯”è¾ƒéº»çƒ¦ï¼Œåˆè€ƒè™‘åˆ°è¿™æ˜¯ä¸€ä¸ªåˆ†æ²»ç®—æ³•ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ nâ‰¤100n\\le 100nâ‰¤100 çš„æ—¶å€™ç›´æ¥é‡‡ç”¨æ’åºï¼Œä¸å½±å“å¤æ‚åº¦ã€‚è€Œåœ¨ nnn æ¯”è¾ƒå¤§çš„æ—¶å€™ï¼Œä¸ºäº†æ–¹ä¾¿è®¡ç®—ï¼Œæˆ‘ä»¬åœ¨è®¡ç®—ä¸­å¿½ç•¥åº•å’Œé¡¶ã€å°‘æ•°åŠ å‡å¸¸æ•°ä»¥åŠè„šå—å¯¹å¤æ‚åº¦çš„å½±å“ã€‚å‡è®¾è¿™ä¸ª pivot çš„å€¼æ˜¯ pppï¼Œé‚£ä¹ˆç”±äºå¥¹æ˜¯æ¯ä¸ªåˆ‡ç‰‡çš„ä¸­ä½æ•°çš„ä¸­ä½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè‡³å°‘æœ‰ n52=n10\\frac{\\frac{n}{5}}{2}=\\frac{n}{10}25nâ€‹â€‹=10nâ€‹ ä¸ªåˆ‡ç‰‡çš„ä¸­ä½æ•°æ¯”å¥¹å°ï¼Œn10\\frac{n}{10}10nâ€‹ ä¸ªåˆ‡ç‰‡çš„ä¸­ä½æ•°æ¯”å¥¹å¤§ã€‚è€Œåœ¨è¿™äº›åˆ‡ç‰‡ä¸­ï¼Œè€ƒè™‘åˆ°æ¯ä¸ªåˆ‡ç‰‡éƒ½æœ‰ä¸¤ä¸ªæ•°å¤§äºä¸­ä½æ•°ï¼Œä¸¤ä¸ªæ•°å°äºä¸­ä½æ•°ï¼Œå› æ­¤è‡³å°‘æœ‰ n5\\frac{n}{5}5nâ€‹ ä¸ªéåˆ‡ç‰‡ä¸­ä½æ•°çš„æ•°å¤§äºå’Œå°äº pivotã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæœ‰ n10+n5=310n\\frac{n}{10} + \\frac{n}{5}=\\frac{3}{10}n10nâ€‹+5nâ€‹=103â€‹n ä¸ªæ•°å¤§äºå’Œå°äº pivotã€‚é‚£ä¹ˆåˆ†æ²»æ—¶ï¼Œä¸ç®¡æ˜¯å¤§äºè¿˜æ˜¯å°äº kkkï¼Œä¸€å®šæ˜¯æœ‰ 310n\\frac{3}{10}n103â€‹n ä¸ªæ•°æ˜¯ä¼šè¢«åˆ æ‰çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯æ¬¡é€’å½’åªä¼šç•™ä¸‹ 710n\\frac{7}{10}n107â€‹n ä¸ªæ•°ã€‚ è¿™æ ·å¤æ‚åº¦å°±æ˜¯ï¼š T(n)=T(n5)+T(710n)+O(n)T(n)=T\\left(\\frac{n}{5}\\right) + T\\left(\\frac{7}{10}n\\right) + \\mathcal{O}(n) T(n)=T(5nâ€‹)+T(107â€‹n)+O(n) æˆ‘ä»¬ç”¨ç¬¬äºŒæ•°å­¦å½’çº³æ³•è¯æ˜ T(n)=O(n)T(n)=\\mathcal{O}(n)T(n)=O(n)ã€‚æˆ‘ä»¬å‡è®¾ âˆƒcâˆˆN,âˆ€k&lt;n,T(k)â‰¤câ‹…k\\exist c\\in\\N, \\forall k&lt;n, T(k)\\le c\\cdot kâˆƒcâˆˆN,âˆ€k&lt;n,T(k)â‰¤câ‹…kã€‚å½’çº³åŸºç¡€æ˜¾ç„¶ã€‚ T(n)=T(n5)+T(710n)+O(n)â‰¤câ‹…n5+câ‹…710n+O(n)â‰¤câ‹…910n+O(n)\\begin{aligned} T(n)&amp;=T\\left(\\frac{n}{5}\\right) + T\\left(\\frac{7}{10}n\\right) + \\mathcal{O}(n)\\\\ &amp;\\le c\\cdot\\frac{n}{5} + c\\cdot \\frac{7}{10}n+\\mathcal{O}(n)\\\\ &amp;\\le c\\cdot\\frac{9}{10}n + \\mathcal{O}(n) \\end{aligned} T(n)â€‹=T(5nâ€‹)+T(107â€‹n)+O(n)â‰¤câ‹…5nâ€‹+câ‹…107â€‹n+O(n)â‰¤câ‹…109â€‹n+O(n)â€‹ å½“ ccc è¶³å¤Ÿå¤§åˆ° c10\\frac{c}{10}10câ€‹ å¤§äºç­‰å¼ä¸­ O(n)\\mathcal{O}(n)O(n) çš„ç³»æ•°æ—¶ï¼ŒT(n)â‰¤câ‹…nT(n)\\le c\\cdot nT(n)â‰¤câ‹…nã€‚ å› æ­¤ï¼Œè¯¥ç®—æ³•å¤æ‚åº¦ä¸ºçº¿æ€§ã€‚ å‰å‡ å¤©åˆšå¼€å§‹å­¦ javaï¼Œé‚£å°±æ‹¿ java æ¥ç»ƒç»ƒæ‰‹ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257import java.util.Arrays;import java.util.LinkedList;import java.util.List;public class Nth &#123; /** * Integers with a subscript, to make sure all numbers * in the array are different. */ public static class DistinctNumber implements Comparable&lt;DistinctNumber&gt; &#123; private final int number, index; /** * @param _number the value of the number. * @param _index the index of the number in the array. */ public DistinctNumber(int _number, int _index) &#123; this.number = _number; this.index = _index; &#125; /** * @return the value of the number. */ public int valueOf() &#123; return number; &#125; /** * Compare &#123;@code this&#125; and &#123;@code b&#125;. If the value of the two are the * same, compare the index. * * @param b the object to be compared. * @return an integer, if &#123;@code x &lt; y&#125; then &#123;@code x.compareTo(y) * &lt; 0&#125;, if &#123;@code x &gt; y&#125; then &#123;@code x.compare(y) &gt; 0&#125;, if &#123;@code * x = y&#125; then &#123;@code x.compare(y) = 0&#125;. */ @Override public int compareTo(DistinctNumber b) &#123; if (this.number != b.number) &#123; return this.number - b.number; &#125; else &#123; return this.index - b.index; &#125; &#125; /** * Convert a &#123;@code int[]&#125; to &#123;@code DistinctNumber[]&#125;. * * @param intArray the &#123;@code int&#125; array want to be converted. * @param distinctArray the &#123;@code DistinctNumber&#125; array want * to be saved into. * @return the array after converting. */ public static DistinctNumber[] intArrayToDistinctArray(int[] intArray, DistinctNumber[] distinctArray) &#123; for (int i = 0; i &lt; intArray.length; ++i) &#123; distinctArray[i] = new DistinctNumber(intArray[i], i); &#125; return distinctArray; &#125; /** * Convert a &#123;@code int[]&#125; to &#123;@code DistinctNumber[]&#125;. * * @param intArray the &#123;@code int&#125; array want to be converted. * @return the array after converting. */ public static DistinctNumber[] intArrayToDistinctArray(int[] intArray) &#123; DistinctNumber[] distinctArray = new DistinctNumber[intArray.length]; return intArrayToDistinctArray(intArray, distinctArray); &#125; /** * Convert a &#123;@code DistinctNumber[]&#125; to &#123;@code int[]&#125; . * * @param distinctArray the &#123;@code DistinctNumber&#125; array want * to be converted. * @param intArray the &#123;@code int&#125; array want to be saved into. * @return the array after converting. */ public static int[] distinctArrayToIntArray(DistinctNumber[] distinctArray, int[] intArray) &#123; for (int i = 0; i &lt; distinctArray.length; ++i) &#123; intArray[i] = distinctArray[i].valueOf(); &#125; return intArray; &#125; /** * Convert a &#123;@code DistinctNumber[]&#125; to &#123;@code int[]&#125; . * * @param distinctArray the &#123;@code DistinctNumber&#125; array want * to be converted. * @return the array after converting. */ public static int[] distinctArrayToIntArray(DistinctNumber[] distinctArray) &#123; int[] intArray = new int[distinctArray.length]; return distinctArrayToIntArray(distinctArray, intArray); &#125; &#125; /** * Use Hoare partition method to move all the numbers * in the array smaller than &#123;@code array[pivot]&#125; to its front, * move all the numbers larger than it to its back, and * return the final position of the number. * * @param array a non-empty array wants to be rearranged. * @param pivot an integer from &#123;@code 0&#125; to * &#123;@code array.length - 1&#125;, which represents * the position of the pivot. * @return an integer from &#123;@code 0&#125; to &#123;@code array.length - 1&#125;, * which represents the position of the pivot after rearranged. */ public static int hoarePartition(DistinctNumber[] array, int pivot) &#123; int left = 0, right = array.length - 1; while (left &lt; right) &#123; /* Find two positions left and right which satisfies that array[left] &gt; array[pivot] &gt; array[right] and left &lt;= pivot &lt;= right. */ while (left &lt; pivot &amp;&amp; array[left].compareTo(array[pivot]) &lt;= 0) &#123; left++; &#125; while (right &gt; pivot &amp;&amp; array[right].compareTo(array[pivot]) &gt;= 0) &#123; right--; &#125; /* If pivot equals to left or right, which means the position of the pivot changes. So we have to change the position of the pivot before swapping left and right. */ if (pivot == left) &#123; pivot = right; &#125; else if (pivot == right) &#123; pivot = left; &#125; /* Swap array[left] and array[right]. */ DistinctNumber temp = array[left]; array[left] = array[right]; array[right] = temp; &#125; return pivot; &#125; /** * Divide an array into every five integer a piece, extract * the median of each copy to the front end of the entire * array, copy the front and return it. * * @param array a non-empty &#123;@code DistinctNumber&#125; array want * to be rearranged. * @return a non-empty array, contains the median of each * slice. */ public static DistinctNumber[] divideIntoFive(DistinctNumber[] array) &#123; List&lt;DistinctNumber&gt; mediumList = new LinkedList&lt;&gt;(); // Median of each slice List&lt;DistinctNumber&gt; remainList = new LinkedList&lt;&gt;(); // Numbers other than the median for (int beginSlice = 0; beginSlice &lt; array.length; beginSlice += 5) &#123; // Extract a slice. int endSlice = Integer.min(beginSlice + 5, array.length); DistinctNumber[] slice = Arrays.copyOfRange(array, beginSlice, endSlice); // Sort the slice and assign each number to each linked list Arrays.sort(slice); for (int i = 0; i &lt; slice.length; ++i) &#123; if (i == slice.length / 2) &#123; mediumList.add(slice[i]); &#125; else &#123; remainList.add(slice[i]); &#125; &#125; &#125; // Copy mediumList and remainList to the array. int indexOfChangedArray = 0; for (DistinctNumber medium : mediumList) &#123; array[indexOfChangedArray] = medium; indexOfChangedArray++; &#125; for (DistinctNumber remain : remainList) &#123; array[indexOfChangedArray] = remain; indexOfChangedArray++; &#125; // Convert mediumList to array and return. DistinctNumber[] mediumArray = new DistinctNumber[mediumList.size()]; mediumList.toArray(mediumArray); return mediumArray; &#125; /** * Give an &#123;@code DistinctNumber&#125; array and a number n, * rearrange the array to make that for all &#123;@code i &lt; n&#125;, * &#123;@code array[i] &lt;= array[n]&#125;; for all &#123;@code i &gt; n&#125;, * &#123;@code array[i] &gt;= array[n]&#125;. * * @param array a non-empty &#123;@code DistinctNumber&#125; array want * to be rearranged. * @param n an integer from &#123;@code 0&#125; to &#123;@code n - 1&#125;. */ public static void nthElement(DistinctNumber[] array, int n) &#123; if (n &gt;= array.length) &#123; throw new ArrayIndexOutOfBoundsException(&quot;n cannot &quot; + &quot;greater than the size of array&quot;); &#125; // Recursion bounds if (array.length &lt;= 10) &#123; Arrays.sort(array); return; &#125; // Get the pivot DistinctNumber[] mediumOfSlice = divideIntoFive(array); nthElement(mediumOfSlice, mediumOfSlice.length / 2); int pivot = mediumOfSlice.length / 2; System.arraycopy(mediumOfSlice, 0, array, 0, mediumOfSlice.length); pivot = hoarePartition(array, pivot); // Divide and conquer by pivot if (n &lt; pivot) &#123; DistinctNumber[] leftSide = Arrays.copyOfRange(array, 0, pivot); nthElement(leftSide, n); System.arraycopy(array, 0, leftSide, 0, leftSide.length); &#125; else if (n &gt; pivot) &#123; DistinctNumber[] rightSide = Arrays.copyOfRange(array, pivot + 1, array.length); nthElement(rightSide, n - pivot - 1); System.arraycopy(array, pivot + 1, rightSide, 0, rightSide.length); &#125; &#125; /** * Give an array and a number n, rearrange the array to make * that for all &#123;@code i &lt; n&#125;, &#123;@code array[i] &lt;= array[n]&#125;; * for all &#123;@code i &gt; n&#125;, &#123;@code array[i] &gt;= array[n]&#125;. * * @param array a non-empty array want to be rearranged. * @param n an integer from &#123;@code 0&#125; to &#123;@code n - 1&#125;. */ public static void nthElement(int[] array, int n) &#123; DistinctNumber[] distinctArray = DistinctNumber.intArrayToDistinctArray(array); nthElement(distinctArray, n); &#125;&#125;","categories":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%9A%8F%E7%AC%94/"}],"tags":[{"name":"åˆ†æ²»","slug":"åˆ†æ²»","permalink":"https://pufanyi.github.io/oi-blog/tags/%E5%88%86%E6%B2%BB/"}]},{"title":"UCB EECS 70 Discrete Mathematics and Probability Theory","slug":"DiscreteMathRemake","date":"2022-12-27T16:00:00.000Z","updated":"2023-12-25T16:08:27.891Z","comments":true,"path":"DiscreteMathRemake/","link":"","permalink":"https://pufanyi.github.io/oi-blog/DiscreteMathRemake/","excerpt":"å¯’å‡æ‰¾ç‚¹äº‹å¹²ã€‚ æ²¡ç­”æ¡ˆåªèƒ½çåšï¼Œä¸ä¿è¯æ­£ç¡®æ€§ï¼ˆï¼‰","text":"å¯’å‡æ‰¾ç‚¹äº‹å¹² ã€‚ æ²¡ç­”æ¡ˆåªèƒ½çåšï¼Œä¸ä¿è¯æ­£ç¡®æ€§ï¼ˆï¼‰ Discussion 0A 1 Truth Tables (a) PPP QQQ Qâˆ¨PQ\\lor PQâˆ¨P Pâˆ§(Qâˆ¨P)P\\land(Q\\lor P)Pâˆ§(Qâˆ¨P) Pâˆ§QP\\land QPâˆ§Q T T T T T T F T T F F T T F F F F F F F When P=T,Q=FP=\\mathtt{T},Q=\\mathtt{F}P=T,Q=F, LHS=T\\mathrm{LHS}=\\mathtt{T}LHS=T but RHS=F\\mathrm{RHS}=\\mathtt{F}RHS=F. So LHSâ‰¡Ì¸RHS\\mathrm{LHS}\\not\\equiv \\mathrm{RHS}LHSî€ â‰¡RHS. (b) PPP QQQ RRR Pâˆ¨QP\\lor QPâˆ¨Q (Pâˆ¨Q)âˆ§R(P\\lor Q)\\land R(Pâˆ¨Q)âˆ§R Pâˆ§RP\\land RPâˆ§R Qâˆ§RQ\\land RQâˆ§R (Pâˆ§R)âˆ¨(Qâˆ§R)(P\\land R)\\lor(Q\\land R)(Pâˆ§R)âˆ¨(Qâˆ§R) False False False False False False False False False False True False False False False False False True False True False False False False False True True True True False True True True False False True False False False False True False True True True True False True True True False True False False False False True True True True True True True True So LHSâ‰¡RHS\\mathrm{LHS}\\equiv \\mathrm{RHS}LHSâ‰¡RHS. 12345678from itertools import productif __name__ == &quot;__main__&quot;: tb = (False, True) for P, Q, R in product(tb, tb, tb): print(&#x27;&#x27;, P, Q, R, P or Q, (P or Q) and R, P and R, Q and R, (P and R) or (Q and R), &#x27;&#x27;, sep=&#x27;|&#x27;) (c) PPP QQQ RRR Pâˆ§QP\\land QPâˆ§Q (Pâˆ§Q)âˆ¨R(P\\land Q)\\lor R(Pâˆ§Q)âˆ¨R Pâˆ¨RP\\lor RPâˆ¨R Qâˆ¨RQ\\lor RQâˆ¨R (Pâˆ¨R)âˆ§(Qâˆ¨R)(P\\lor R)\\land(Q\\lor R)(Pâˆ¨R)âˆ§(Qâˆ¨R) False False False False False False False False False False True False True True True True False True False False False False True False False True True False True True True True True False False False False True False False True False True False True True True True True True False True True True True True True True True True True True True True So LHSâ‰¡RHS\\mathrm{LHS}\\equiv \\mathrm{RHS}LHSâ‰¡RHS. 12345678from itertools import productif __name__ == &quot;__main__&quot;: tb = (False, True) for P, Q, R in product(tb, tb, tb): print(&#x27;&#x27;, P, Q, R, P and Q, (P and Q) or R, P or R, Q or R, (P or R) and (Q or R), &#x27;&#x27;, sep=&#x27;|&#x27;) 2 Propositional Practice (a) âˆƒxâˆˆR,xâˆˆÌ¸Q.\\exist x\\in\\R, x\\not\\in\\mathbb{Q}. âˆƒxâˆˆR,xî€ âˆˆQ. (b) âˆ€nâˆˆZ,((nâˆˆN)âˆ¨(n&lt;0))âˆ§Â¬((nâˆˆN)âˆ§(n&lt;0)).\\forall n\\in \\mathbb{Z},\\left((n\\in\\mathbb{N})\\lor(n&lt;0)\\right)\\land\\lnot\\left((n\\in\\mathbb{N})\\land(n&lt;0)\\right). âˆ€nâˆˆZ,((nâˆˆN)âˆ¨(n&lt;0))âˆ§Â¬((nâˆˆN)âˆ§(n&lt;0)). (c) âˆ€nâˆˆN,(6âˆ£n âŸ¹ (2âˆ£n)âˆ¨(3âˆ£n)).\\forall n\\in \\N,\\left(6\\mid n\\implies(2\\mid n)\\lor (3\\mid n)\\right). âˆ€nâˆˆN,(6âˆ£nâŸ¹(2âˆ£n)âˆ¨(3âˆ£n)). (d) All integers are rational numbers. (e) All integers divisible by 222 or 333 are divisible by 666. (f) Any natural number greater than 7 can be decomposed into the sum of two natural numbers. 3 Converse and Contrapositive (a) âˆ€nâˆˆN,(4âˆ£n âŸ¹ 2âˆ£n).\\forall n\\in\\N, (4\\mid n\\implies 2\\mid n). âˆ€nâˆˆN,(4âˆ£nâŸ¹2âˆ£n). It is true. We let n=4k,kâˆˆNn=4k, k\\in \\Nn=4k,kâˆˆN. We have n=2â‹…(2k)n=2\\cdot (2k)n=2â‹…(2k), so 2âˆ£n2\\mid n2âˆ£n. (b) If a natural number is not divisible by 444, it is not divisible by 222. âˆ€nâˆˆN,(4âˆ¤n âŸ¹ 2âˆ¤n).\\forall n\\in\\N, (4\\nmid n\\implies 2\\nmid n). âˆ€nâˆˆN,(4âˆ¤nâŸ¹2âˆ¤n). It is false. A possible counterexample is when n=2n=2n=2, 4âˆ¤24\\nmid 24âˆ¤2, but 2âˆ£22\\mid 22âˆ£2. (c) If a natural number is divisible by 222, it is divisible by 444. âˆ€nâˆˆN,(2âˆ£n âŸ¹ 4âˆ£n).\\forall n\\in\\N, (2\\mid n\\implies 4\\mid n). âˆ€nâˆˆN,(2âˆ£nâŸ¹4âˆ£n). It is false. A possible counterexample is when n=2n=2n=2, 2âˆ£22\\mid 22âˆ£2, but 4âˆ¤24\\nmid 24âˆ¤2. (d) If a natural number is divisible by 222, it is divisible by 444. 4 Equivalences with Quantifiers (a) LHSâ‰¡âˆ€x ((âˆƒy Q(x,y)) âŸ¹ P(x))â‰¡âˆ€x (Â¬(âˆƒy Q(x,y))âˆ¨P(x))â‰¡âˆ€x ((âˆ€y Â¬Q(x,y))âˆ¨P(x))â‰¡âˆ€xâˆ€y (Â¬Q(x,y)âˆ¨P(x))â‰¡âˆ€xâˆ€y (Q(x,y) âŸ¹ P(x))â‰¡Ì¸âˆ€xâˆƒy (Q(x,y) âŸ¹ P(x))â‰¡RHS\\begin{aligned} \\mathrm{LHS}&amp;\\equiv\\forall x\\ ((\\exist y\\ Q(x, y))\\implies P(x))\\\\ &amp;\\equiv \\forall x\\ (\\lnot(\\exist y\\ Q(x, y))\\lor P(x))\\\\ &amp;\\equiv \\forall x\\ ((\\forall y\\ \\lnot Q(x, y))\\lor P(x))\\\\ &amp;\\equiv \\forall x\\forall y\\ (\\lnot Q(x, y)\\lor P(x))\\\\ &amp;\\equiv \\forall x\\forall y\\ (Q(x, y)\\implies P(x))\\\\ &amp;\\not \\equiv \\forall x\\exist y\\ (Q(x, y)\\implies P(x))\\\\ &amp;\\equiv \\mathrm{RHS} \\end{aligned} LHSâ€‹â‰¡âˆ€x ((âˆƒy Q(x,y))âŸ¹P(x))â‰¡âˆ€x (Â¬(âˆƒy Q(x,y))âˆ¨P(x))â‰¡âˆ€x ((âˆ€y Â¬Q(x,y))âˆ¨P(x))â‰¡âˆ€xâˆ€y (Â¬Q(x,y)âˆ¨P(x))â‰¡âˆ€xâˆ€y (Q(x,y)âŸ¹P(x))î€ â‰¡âˆ€xâˆƒy (Q(x,y)âŸ¹P(x))â‰¡RHSâ€‹ To find one counterexample, we could let P(x)P(x)P(x) to be contradictions, like â€œxxx is an elephantâ€, and Q(x,y)Q(x, y)Q(x,y) be â€œx=yx=yx=yâ€. On the one hand, for all xxx, âˆƒy Q(x,y)\\exist y\\ Q(x, y)âˆƒy Q(x,y) is true because we could just let y=xy=xy=x, and P(x)P(x)P(x) is false, so LHS\\mathrm{LHS}LHS is false. However, for all xxx, we just let y=x+1y=x+1y=x+1, then since Q(x,y)Q(x, y)Q(x,y) is false, Q(x,y) âŸ¹ P(x)Q(x, y)\\implies P(x)Q(x,y)âŸ¹P(x) is true, so RHS\\mathrm{RHS}RHS is true. (b) LHSâ‰¡âˆ€xâˆƒy (Â¬(P(x,y) âŸ¹ Â¬Q(x,y)))â‰¡âˆ€xâˆƒy (Â¬(Â¬P(x,y)âˆ¨Â¬Q(x,y)))â‰¡âˆ€xâˆƒy (P(x,y)âˆ§Q(x,y))â‰¡Ì¸âˆ€x((âˆƒy P(x,y))âˆ§(âˆƒy Q(x,y)))â‰¡RHS\\begin{aligned} \\mathrm{LHS}&amp;\\equiv\\forall x\\exist y\\ \\left(\\lnot\\left(P(x, y)\\implies \\lnot Q(x, y)\\right)\\right)\\\\ &amp;\\equiv\\forall x\\exist y\\ \\left(\\lnot\\left(\\lnot P(x, y)\\lor \\lnot Q(x, y)\\right)\\right)\\\\ &amp;\\equiv\\forall x\\exist y\\ \\left(P(x, y)\\land Q(x, y)\\right)\\\\ &amp;\\not\\equiv\\forall x\\left((\\exist y\\ P(x, y))\\land (\\exist y\\ Q(x, y))\\right)\\\\ &amp;\\equiv \\mathrm{RHS} \\end{aligned} LHSâ€‹â‰¡âˆ€xâˆƒy (Â¬(P(x,y)âŸ¹Â¬Q(x,y)))â‰¡âˆ€xâˆƒy (Â¬(Â¬P(x,y)âˆ¨Â¬Q(x,y)))â‰¡âˆ€xâˆƒy (P(x,y)âˆ§Q(x,y))î€ â‰¡âˆ€x((âˆƒy P(x,y))âˆ§(âˆƒy Q(x,y)))â‰¡RHSâ€‹ To find one counterexample, we could let P(x,y)P(x, y)P(x,y) to be x=yx=yx=y, and Q(x,y)Q(x, y)Q(x,y) be â€œx=y+1x=y+1x=y+1â€. On the one hand, when x=yx=yx=y, xâ‰ y+1x\\neq y+1xî€ =y+1, so P(x,y) âŸ¹ Â¬Q(x,y)P(x, y)\\implies \\lnot Q(x, y)P(x,y)âŸ¹Â¬Q(x,y) is true. So LHS\\mathrm{LHS}LHS is false. But for all xxx. For âˆƒy P(x,y)\\exist y\\ P(x, y)âˆƒy P(x,y), we just let y=xy=xy=x, so it is true. And for âˆƒy Q(x,y)\\exist y\\ Q(x, y)âˆƒy Q(x,y), we just let y=xâˆ’1y = x - 1y=xâˆ’1, so it is also true. In all RHS\\mathrm{RHS}RHS is true. So LHSâ‰¡Ì¸RHS\\mathrm{LHS}\\not\\equiv\\mathrm{RHS}LHSî€ â‰¡RHS. (c) LHSâ‰¡âˆ€xâˆƒy (Â¬P(x)âˆ¨Q(x,y))RHSâ‰¡âˆ€x (Â¬P(x)âˆ¨(âˆƒy Q(x,y)))\\begin{aligned} \\mathrm{LHS}&amp;\\equiv \\forall x\\exist y\\ (\\lnot P(x)\\lor Q(x,y))\\\\ \\mathrm{RHS}&amp;\\equiv\\forall x\\ (\\lnot P(x)\\lor(\\exist y\\ Q(x, y))) \\end{aligned} LHSRHSâ€‹â‰¡âˆ€xâˆƒy (Â¬P(x)âˆ¨Q(x,y))â‰¡âˆ€x (Â¬P(x)âˆ¨(âˆƒy Q(x,y)))â€‹ If P(x)P(x)P(x) is true, LHSâ‰¡âˆ€xâˆƒy (Fâˆ¨Q(x,y))â‰¡âˆ€xâˆƒy Q(x,y)\\mathrm{LHS}\\equiv \\forall x\\exist y\\ (\\mathtt{F}\\lor Q(x, y))\\equiv \\forall x\\exist y\\ Q(x, y)LHSâ‰¡âˆ€xâˆƒy (Fâˆ¨Q(x,y))â‰¡âˆ€xâˆƒy Q(x,y), RHSâ‰¡âˆ€x (Fâˆ¨(âˆƒy Q(x,y)))â‰¡âˆ€xâˆƒy Q(x,y)\\mathrm{RHS}\\equiv\\forall x\\ (\\mathtt{F}\\lor (\\exist y\\ Q(x, y)))\\equiv \\forall x\\exist y\\ Q(x, y)RHSâ‰¡âˆ€x (Fâˆ¨(âˆƒy Q(x,y)))â‰¡âˆ€xâˆƒy Q(x,y). So LHSâ‰¡RHS\\mathrm{LHS}\\equiv \\mathrm{RHS}LHSâ‰¡RHS. If P(x)P(x)P(x) is true, then LHSâ‰¡RHSâ‰¡T\\mathrm{LHS}\\equiv \\mathrm{RHS}\\equiv \\mathtt{T}LHSâ‰¡RHSâ‰¡T. In all LHSâ‰¡RHS\\mathrm{LHS}\\equiv\\mathrm{RHS}LHSâ‰¡RHS. Homework 0 5 Propositional Practice (a) âˆƒxâˆˆR ((x2=0)âˆ§(âˆ€yâˆˆR ((y2=0) âŸ¹ (x=y)))).\\exist x\\in\\R\\ ((x^2=0)\\land(\\forall y\\in\\R\\ ((y^2=0)\\implies (x=y)))). âˆƒxâˆˆR ((x2=0)âˆ§(âˆ€yâˆˆR ((y2=0)âŸ¹(x=y)))). (b) âˆ€xâˆˆQ âˆ€yâˆˆQ âˆƒzâˆˆQ ((x=y)âˆ¨(x&lt;y&lt;z)âˆ¨(x&gt;y&gt;z)).\\forall x\\in\\mathbb{Q}\\ \\forall y\\in\\mathbb{Q}\\ \\exist z\\in \\mathbb{Q}\\ ((x=y)\\lor (x&lt;y&lt;z)\\lor(x&gt;y&gt;z)). âˆ€xâˆˆQ âˆ€yâˆˆQ âˆƒzâˆˆQ ((x=y)âˆ¨(x&lt;y&lt;z)âˆ¨(x&gt;y&gt;z)). (c) âˆ€xâˆˆZ ((x2&gt;4) âŸ¹ ((x&lt;âˆ’2)âˆ¨(x&gt;2))).\\forall x\\in\\Z\\ ((x^2&gt;4)\\implies((x&lt;-2)\\lor(x&gt;2))). âˆ€xâˆˆZ ((x2&gt;4)âŸ¹((x&lt;âˆ’2)âˆ¨(x&gt;2))). (d) All real numbers are complex numbers. (e) There is no integer solution of x2âˆ’y2=10x^2-y^2=10x2âˆ’y2=10. (f) All greater than 222 natural numbers can be decomposed into the sum of two prime numbers. Note 2 9 Exercises 1. nâ‰¡âˆ‘i=0kâˆ’1(aiâ‹…10i)(mod9)â‰¡âˆ‘i=0kâˆ’1(aiâ‹…10imod 9)(mod9)â‰¡âˆ‘i=0kâˆ’1(aiâ‹…(10imod 9))(mod9)â‰¡âˆ‘i=0kâˆ’1(aiâ‹…(10mod 9)i)(mod9)â‰¡âˆ‘i=0kâˆ’1ai(mod9)\\begin{aligned} n&amp;\\equiv\\sum_{i=0}^{k-1}\\left(a_i\\cdot 10^i\\right)\\pmod 9\\\\ &amp;\\equiv \\sum_{i=0}^{k-1}\\left(a_i\\cdot 10^i\\mod 9\\right)\\pmod 9\\\\ &amp;\\equiv \\sum_{i=0}^{k-1}\\left(a_i\\cdot\\left(10^i\\mod 9\\right)\\right)\\pmod 9\\\\ &amp;\\equiv \\sum_{i=0}^{k-1}\\left(a_i\\cdot\\left(10\\mod 9\\right)^i\\right)\\pmod 9\\\\ &amp;\\equiv \\sum_{i=0}^{k-1}a_i\\pmod 9 \\end{aligned} nâ€‹â‰¡i=0âˆ‘kâˆ’1â€‹(aiâ€‹â‹…10i)(mod9)â‰¡i=0âˆ‘kâˆ’1â€‹(aiâ€‹â‹…10imod9)(mod9)â‰¡i=0âˆ‘kâˆ’1â€‹(aiâ€‹â‹…(10imod9))(mod9)â‰¡i=0âˆ‘kâˆ’1â€‹(aiâ€‹â‹…(10mod9)i)(mod9)â‰¡i=0âˆ‘kâˆ’1â€‹aiâ€‹(mod9)â€‹ 2. a2 is even âŸ¹ a is evenâ‰¡Â¬(a is even) âŸ¹ Â¬(a2 is even)â‰¡a is odd âŸ¹ a2 is odd\\begin{aligned} &amp;\\text{$a^2$ is even}\\implies \\text{$a$ is even}\\\\ \\equiv&amp;\\lnot(\\text{$a$ is even})\\implies \\lnot(\\text{$a^2$ is even})\\\\ \\equiv&amp; \\text{$a$ is odd}\\implies \\text{$a^2$ is odd} \\end{aligned} â‰¡â‰¡â€‹a2 is evenâŸ¹a is evenÂ¬(a is even)âŸ¹Â¬(a2 is even)a is oddâŸ¹a2 is oddâ€‹ Let a=2k+1,kâˆˆZa=2k+1, k\\in \\Za=2k+1,kâˆˆZ, we have a2=4k2+4k+1=2(2k2+1)+1a^2=4k^2+4k+1=2(2k^2+1)+1a2=4k2+4k+1=2(2k2+1)+1, so a2a^2a2 is odd. So a is odd âŸ¹ a2 is odda\\text{is odd}\\implies a^2\\text{is odd}a is oddâŸ¹a2 is odd holds, so Lemma 2.2 holds. Note 3 1. We proceed by induction on nnn. Base Case: When n=1n=1n=1, LHS=RHS=1\\mathrm{LHS}=\\mathrm{RHS}=1LHS=RHS=1. So base case Holds. Induction Hypothesis: Assume that âˆ‘i=1ki=16k(k+1)(2k+1)\\sum_{i=1}^{k} i = \\frac{1}{6}k(k+1)(2k+1)âˆ‘i=1kâ€‹i=61â€‹k(k+1)(2k+1). Induction Step: When n=k+1n=k+1n=k+1, âˆ‘i=1k+1i=(k+1)+âˆ‘i=1ki=16k(k+1)(2k+1)+k+1=16(k+1)(2k2+k+6k+6)=16(k+1)(2k2+7k+6)=16(k+1)(k+2)(2k+3)\\begin{aligned} \\sum_{i=1}^{k+1}i&amp;=(k+1)+\\sum_{i=1}^{k} i\\\\ &amp;=\\frac{1}{6}k(k+1)(2k+1)+k+1\\\\ &amp;=\\frac{1}{6}(k+1)(2k^2+k+6k+6)\\\\ &amp;=\\frac{1}{6}(k+1)(2k^2+7k+6)\\\\ &amp;=\\frac{1}{6}(k+1)(k+2)(2k+3) \\end{aligned} i=1âˆ‘k+1â€‹iâ€‹=(k+1)+i=1âˆ‘kâ€‹i=61â€‹k(k+1)(2k+1)+k+1=61â€‹(k+1)(2k2+k+6k+6)=61â€‹(k+1)(2k2+7k+6)=61â€‹(k+1)(k+2)(2k+3)â€‹ Thus, âˆ€nâˆˆN\\forall n\\in\\Nâˆ€nâˆˆN, âˆ‘i=1ni=16n(n+1)(2n+1)\\sum_{i=1}^{n} i = \\frac{1}{6}n(n+1)(2n+1)âˆ‘i=1nâ€‹i=61â€‹n(n+1)(2n+1) holds. 2. We proceed by induction on nnn. Base Case: When n=1n=1n=1, LHS=RHS=1+x\\mathrm{LHS}=\\mathrm{RHS}=1+xLHS=RHS=1+x. So base case Holds. Induction Hypothesis: Assume that (1+x)kâ‰¥1+kx(1+x)^k\\ge 1+kx(1+x)kâ‰¥1+kx, for kâˆˆNk\\in \\NkâˆˆN. Induction Step: When n=k+1n=k+1n=k+1, (1+x)k+1=(1+x)â‹…(1+x)kâ‰¥(1+x)â‹…(1+kx)=1+(k+1)â‹…x+kx2â‰¥1+(k+1)â‹…x\\begin{aligned} (1+x)^{k+1}&amp;=(1+x)\\cdot(1+x)^k\\\\ &amp;\\ge(1+x)\\cdot(1+kx)\\\\ &amp;=1+(k+1)\\cdot x+kx^2\\\\ &amp;\\ge 1+(k+1)\\cdot x \\end{aligned} (1+x)k+1â€‹=(1+x)â‹…(1+x)kâ‰¥(1+x)â‹…(1+kx)=1+(k+1)â‹…x+kx2â‰¥1+(k+1)â‹…xâ€‹ Thus, âˆ€nâˆˆN,x&gt;âˆ’1, (1+x)nâ‰¥1+nx\\forall n\\in\\N, x&gt;-1, \\ (1+x)^n\\ge 1+nxâˆ€nâˆˆN,x&gt;âˆ’1, (1+x)nâ‰¥1+nx holds. 3. We proceed by induction on nnn. Base Case: When n=2n=2n=2, LHS=2&lt;4=RHS\\mathrm{LHS}=2&lt;4=\\mathrm{RHS}LHS=2&lt;4=RHS. So base case Holds. Induction Hypothesis: Assume that k!&lt;kkk!&lt;k^kk!&lt;kk, for kâˆˆN,k&gt;1k\\in \\N, k&gt;1kâˆˆN,k&gt;1. Induction Step: When n=k+1n=k+1n=k+1, (k+1)!=(k+1)â‹…k!&lt;(k+1)â‹…kk&lt;(k+1)â‹…(k+1)k=(k+1)k+1\\begin{aligned} (k+1)!&amp;=(k+1)\\cdot k!\\\\ &amp;&lt;(k+1)\\cdot k^k\\\\ &amp;&lt;(k+1)\\cdot (k+1)^k\\\\ &amp;=(k+1)^{k+1} \\end{aligned} (k+1)!â€‹=(k+1)â‹…k!&lt;(k+1)â‹…kk&lt;(k+1)â‹…(k+1)k=(k+1)k+1â€‹ Thus, âˆ€nâˆˆN,n&gt;1, n!&lt;nn\\forall n\\in\\N, n&gt;1, \\ n!&lt;n^nâˆ€nâˆˆN,n&gt;1, n!&lt;nn holds. 4. We define an ask Aâ†’BA\\to BAâ†’B means asking A if he know B. And we define f(n)f(n)f(n) be the times of asking. Base Case: When n=2n=2n=2, there are just two people A and B. We could ask Aâ†’BA\\to BAâ†’B and Bâ†’AB\\to ABâ†’A. And now we know everything and it is easy for us to find the answer. We asked 3nâˆ’4=23n-4=23nâˆ’4=2 times. So f(n)â‰¤3nâˆ’4f(n)\\le 3n-4f(n)â‰¤3nâˆ’4 holds for n=1n=1n=1. Induction Hypothesis: Assume that if there are kkk people, we could use 3kâˆ’43k-43kâˆ’4 asks to find the answer. Induction Step: When n=k+1n=k+1n=k+1, we could randomly choose two people A and B, asking Aâ†’BA\\to BAâ†’B. Now there are two cases: If A donâ€™t know B. Then we could know that B is not celebrity. So we could just firstly remove B and solve the remaining kkk people to find the â€œcelebrityâ€ for these kkk people, which is C. (If now found, just return â€œnot foundâ€.) And after that, we should check if B knows C and C doesnâ€™t know B. It cost f(k+1)=3+f(k)â‰¤3+(3kâˆ’4)=3(k+1)âˆ’4f(k + 1)=3+f(k)\\le 3+(3k-4)=3(k+1)-4f(k+1)=3+f(k)â‰¤3+(3kâˆ’4)=3(k+1)âˆ’4. If A knows B. Then we could know that A is not celebrity. Then we can prove as in the first case, changing B to A. So f(k+1)â‰¤3(k+1)âˆ’4f(k+1)\\le 3(k+1)-4f(k+1)â‰¤3(k+1)âˆ’4. And as a conclusion, f(n)â‰¤3nâˆ’4f(n)\\le 3n-4f(n)â‰¤3nâˆ’4 holds for all nâˆˆN,nâ‰¥2n\\in\\N, n\\ge 2nâˆˆN,nâ‰¥2. 5. The python code shows below: 123def solve(n): base_case = [(3, 0), (2, 1), (1, 2), (0, 3)] return base_case[n % 4][0] + (n - 12) // 4, base_case[n % 4][1] The largest number of 5c stamps my algorithm will ever use is 333. Discussion 1A 1 Contraposition (a+b&lt;c+d) âŸ¹ (a&lt;c)âˆ¨(b&lt;d)â‰¡Â¬((a&lt;c)âˆ¨(b&lt;d)) âŸ¹ Â¬(a+b&lt;c+d)â‰¡(aâ‰¥c)âˆ§(bâ‰¥d) âŸ¹ (a+bâ‰¥c+d)\\begin{aligned} &amp;(a+b&lt;c+d)\\implies (a&lt;c)\\lor(b&lt;d)\\\\ \\equiv&amp; \\lnot((a&lt;c)\\lor(b&lt;d))\\implies \\lnot(a+b&lt;c+d)\\\\ \\equiv &amp; (a\\ge c)\\land(b\\ge d) \\implies (a+b\\ge c+d) \\end{aligned} â‰¡â‰¡â€‹(a+b&lt;c+d)âŸ¹(a&lt;c)âˆ¨(b&lt;d)Â¬((a&lt;c)âˆ¨(b&lt;d))âŸ¹Â¬(a+b&lt;c+d)(aâ‰¥c)âˆ§(bâ‰¥d)âŸ¹(a+bâ‰¥c+d)â€‹ 2 Numbers of Friends We let the iii-th person have aia_iaiâ€‹ friends. We have aiâˆˆ[0,nâˆ’1]âˆ©Za_i\\in[0, n-1]\\cap \\Zaiâ€‹âˆˆ[0,nâˆ’1]âˆ©Z. Then we check if there exist kâˆˆ[0,nâˆ’1]âˆ©Zk\\in [0, n-1]\\cap\\Zkâˆˆ[0,nâˆ’1]âˆ©Z, âˆ€i,aiâ‰ k\\forall i, a_i\\neq kâˆ€i,aiâ€‹î€ =k. âˆƒkâˆˆ[0,nâˆ’1]âˆ©Z,âˆ€i,aiâ‰ k\\exist k\\in [0, n-1]\\cap\\Z, \\forall i, a_i\\neq kâˆƒkâˆˆ[0,nâˆ’1]âˆ©Z,âˆ€i,aiâ€‹î€ =k. Which means, âˆ€i,aiâˆˆ[0,nâˆ’1]âˆ©Z\\{k}\\forall i, a_i\\in [0, n-1]\\cap\\Z\\backslash\\{k\\}âˆ€i,aiâ€‹âˆˆ[0,nâˆ’1]âˆ©Z\\{k}. And since âˆ£[0,nâˆ’1]âˆ©Z\\{k}âˆ£=nâˆ’1\\left|[0, n-1]\\cap\\Z\\backslash\\{k\\}\\right|=n-1âˆ£[0,nâˆ’1]âˆ©Z\\{k}âˆ£=nâˆ’1, and there are nnn numbers. Due to the Pigeonhole Principle, there must be 222 of them have the same number. If âˆ€kâˆˆ[0,nâˆ’1]âˆ©Z,âˆƒi,ai=k\\forall k\\in [0, n-1]\\cap\\Z, \\exist i, a_i=kâˆ€kâˆˆ[0,nâˆ’1]âˆ©Z,âˆƒi,aiâ€‹=k, there must be some one with 000 friends (name A) and some one with nâˆ’1n-1nâˆ’1 friends (name B). A have 000 friends shows that A and B are not friends, but B have nâˆ’1n-1nâˆ’1 friends shows that A and B are friends. This forms a contradiction, so this case is impossible. In all, there must be at least 222 of them have the same number of friends at the party. 3 Pebbles If there is no all-red column exist, which means all column has a blue pebble, for every column, we could just choose that blue pebble, then there exist a way choosing makes no red pebble. So there must exist all-red column. 4 Preserving Set Operations (a) We want to prove fâˆ’1(AâˆªB)âŠ†fâˆ’1(A)âˆªfâˆ’1(B)f^{-1}(A\\cup B)\\subseteq f^{-1}(A)\\cup f^{-1}(B)fâˆ’1(AâˆªB)âŠ†fâˆ’1(A)âˆªfâˆ’1(B) and fâˆ’1(AâˆªB)âŠ‡fâˆ’1(A)âˆªfâˆ’1(B)f^{-1}(A\\cup B)\\supseteq f^{-1}(A)\\cup f^{-1}(B)fâˆ’1(AâˆªB)âŠ‡fâˆ’1(A)âˆªfâˆ’1(B). We first show fâˆ’1(AâˆªB)âŠ†fâˆ’1(A)âˆªfâˆ’1(B)f^{-1}(A\\cup B)\\subseteq f^{-1}(A)\\cup f^{-1}(B)fâˆ’1(AâˆªB)âŠ†fâˆ’1(A)âˆªfâˆ’1(B). Let xâˆˆfâˆ’1(AâˆªB)x\\in f^{-1}(A\\cup B)xâˆˆfâˆ’1(AâˆªB), which means f(x)âˆˆAâˆªBf(x)\\in A\\cup Bf(x)âˆˆAâˆªB. So (f(x)âˆˆA)âˆ¨(f(x)âˆˆB)(f(x)\\in A)\\lor (f(x)\\in B)(f(x)âˆˆA)âˆ¨(f(x)âˆˆB). So (xâˆˆfâˆ’1(A))âˆ¨(xâˆˆfâˆ’1(B))\\left(x\\in f^{-1}(A)\\right)\\lor \\left(x\\in f^{-1}(B)\\right)(xâˆˆfâˆ’1(A))âˆ¨(xâˆˆfâˆ’1(B)), which means xâˆˆfâˆ’1(A)âˆªfâˆ’1(B)x\\in f^{-1}(A)\\cup f^{-1}(B)xâˆˆfâˆ’1(A)âˆªfâˆ’1(B). So fâˆ’1(AâˆªB)âŠ†fâˆ’1(A)âˆªfâˆ’1(B)f^{-1}(A\\cup B)\\subseteq f^{-1}(A)\\cup f^{-1}(B)fâˆ’1(AâˆªB)âŠ†fâˆ’1(A)âˆªfâˆ’1(B). Then letâ€™s prove fâˆ’1(AâˆªB)âŠ‡fâˆ’1(A)âˆªfâˆ’1(B)f^{-1}(A\\cup B)\\supseteq f^{-1}(A)\\cup f^{-1}(B)fâˆ’1(AâˆªB)âŠ‡fâˆ’1(A)âˆªfâˆ’1(B). We let xâˆˆfâˆ’1(A)âˆªfâˆ’1(B)x\\in f^{-1}(A)\\cup f^{-1}(B)xâˆˆfâˆ’1(A)âˆªfâˆ’1(B), which means xâˆˆfâˆ’1(A)x\\in f^{-1}(A)xâˆˆfâˆ’1(A) or xâˆˆfâˆ’1(B)x\\in f^{-1}(B)xâˆˆfâˆ’1(B). So f(x)âˆˆAf(x)\\in Af(x)âˆˆA or f(x)âˆˆBf(x)\\in Bf(x)âˆˆB, which is f(x)âˆˆAâˆªBf(x)\\in A\\cup Bf(x)âˆˆAâˆªB. So xâˆˆfâˆ’1(AâˆªB)x\\in f^{-1}(A\\cup B)xâˆˆfâˆ’1(AâˆªB). So fâˆ’1(A)âˆªfâˆ’1(B)âŠ†fâˆ’1(AâˆªB)f^{-1}(A)\\cup f^{-1}(B)\\subseteq f^{-1}(A\\cup B)fâˆ’1(A)âˆªfâˆ’1(B)âŠ†fâˆ’1(AâˆªB). In all, fâˆ’1(AâˆªB)=fâˆ’1(A)âˆªfâˆ’1(B)f^{-1}(A\\cup B)=f^{-1}(A)\\cup f^{-1}(B)fâˆ’1(AâˆªB)=fâˆ’1(A)âˆªfâˆ’1(B). (b) We want to prove f(AâˆªB)âŠ†f(A)âˆªf(B)f(A\\cup B)\\subseteq f(A)\\cup f(B)f(AâˆªB)âŠ†f(A)âˆªf(B) and f(AâˆªB)âŠ‡f(A)âˆªf(B)f(A\\cup B)\\supseteq f(A)\\cup f(B)f(AâˆªB)âŠ‡f(A)âˆªf(B). We firstly prove f(AâˆªB)âŠ†f(A)âˆªf(B)f(A\\cup B)\\subseteq f(A)\\cup f(B)f(AâˆªB)âŠ†f(A)âˆªf(B). Let xâˆˆf(AâˆªB)x\\in f(A\\cup B)xâˆˆf(AâˆªB), which is âˆƒyâˆˆAâˆªB,f(y)=x\\exist y\\in A\\cup B, f(y)=xâˆƒyâˆˆAâˆªB,f(y)=x. So âˆƒyâˆˆA,f(y)=x\\exist y\\in A, f(y)=xâˆƒyâˆˆA,f(y)=x or âˆƒyâˆˆB,f(y)=x\\exist y\\in B, f(y)=xâˆƒyâˆˆB,f(y)=x. So xâˆˆf(A)x\\in f(A)xâˆˆf(A) or xâˆˆf(B)x\\in f(B)xâˆˆf(B). So xâˆˆf(A)âˆªf(B)x\\in f(A)\\cup f(B)xâˆˆf(A)âˆªf(B). So f(AâˆªB)âŠ†f(A)âˆªf(B)f(A\\cup B)\\subseteq f(A)\\cup f(B)f(AâˆªB)âŠ†f(A)âˆªf(B). Then we want to prove f(AâˆªB)âŠ‡f(A)âˆªf(B)f(A\\cup B)\\supseteq f(A)\\cup f(B)f(AâˆªB)âŠ‡f(A)âˆªf(B). Let xâˆˆf(A)âˆªf(B)x\\in f(A)\\cup f(B)xâˆˆf(A)âˆªf(B), which is xâˆˆf(A)x\\in f(A)xâˆˆf(A) or xâˆˆf(B)x\\in f(B)xâˆˆf(B). So âˆƒyâˆˆA,x=f(y)\\exist y\\in A, x=f(y)âˆƒyâˆˆA,x=f(y) or âˆƒyâˆˆB,x=f(y)\\exist y\\in B, x = f(y)âˆƒyâˆˆB,x=f(y). So âˆƒyâˆˆAâˆªB,x=f(y)\\exist y\\in A\\cup B, x = f(y)âˆƒyâˆˆAâˆªB,x=f(y). So xâˆˆf(AâˆªB)x\\in f(A\\cup B)xâˆˆf(AâˆªB). So f(A)âˆªf(B)âŠ†f(AâˆªB)f(A)\\cup f(B)\\subseteq f(A\\cup B)f(A)âˆªf(B)âŠ†f(AâˆªB). In all f(AâˆªB)=f(A)âˆªf(B)f(A\\cup B)=f(A)\\cup f(B)f(AâˆªB)=f(A)âˆªf(B). Discussion 1B 1 Natural Induction on Inequality The same as Note 3 Question 2. We proceed by induction on nnn. Base Case: When n=1n=1n=1, LHS=RHS=1+x\\mathrm{LHS}=\\mathrm{RHS}=1+xLHS=RHS=1+x. So base case Holds. Induction Hypothesis: Assume that (1+x)kâ‰¥1+kx(1+x)^k\\ge 1+kx(1+x)kâ‰¥1+kx, for kâˆˆNk\\in \\NkâˆˆN. Induction Step: When n=k+1n=k+1n=k+1, (1+x)k+1=(1+x)â‹…(1+x)kâ‰¥(1+x)â‹…(1+kx)=1+(k+1)â‹…x+kx2â‰¥1+(k+1)â‹…x\\begin{aligned} (1+x)^{k+1}&amp;=(1+x)\\cdot(1+x)^k\\\\ &amp;\\ge(1+x)\\cdot(1+kx)\\\\ &amp;=1+(k+1)\\cdot x+kx^2\\\\ &amp;\\ge 1+(k+1)\\cdot x \\end{aligned} (1+x)k+1â€‹=(1+x)â‹…(1+x)kâ‰¥(1+x)â‹…(1+kx)=1+(k+1)â‹…x+kx2â‰¥1+(k+1)â‹…xâ€‹ Thus, âˆ€nâˆˆN,x&gt;0, (1+x)nâ‰¥1+nx\\forall n\\in\\N, x&gt;0, \\ (1+x)^n\\ge 1+nxâˆ€nâˆˆN,x&gt;0, (1+x)nâ‰¥1+nx holds. 2 Make It Stronger (a) No. If we let anâ‰¤32na_n\\le 3^{2^n}anâ€‹â‰¤32n, an+1=3an2â‰¤3â‹…(32n)2=32n+1+1a_{n+1}=3a_n^2\\le 3\\cdot\\left(3^{2^n}\\right)^2=3^{2^{n+1}+1}an+1â€‹=3an2â€‹â‰¤3â‹…(32n)2=32n+1+1. But 32n+1+1â‰¥32n+13^{2^{n+1}+1}\\ge 3^{2^{n+1}}32n+1+1â‰¥32n+1, so it doesnâ€™t work. (b) Letâ€™s prove by induction. Base Case: When n=1n=1n=1, a1=1a_1=1a1â€‹=1, 32nâˆ’1=33^{2^n-1}=332nâˆ’1=3. So anâ‰¤32nâˆ’1a_n\\le 3^{2^n-1}anâ€‹â‰¤32nâˆ’1 holds for n=1n=1n=1. Induction Hypothesis: Assume that akâ‰¤32kâˆ’1a_k\\le 3^{2^k-1}akâ€‹â‰¤32kâˆ’1, for kâˆˆNk\\in \\NkâˆˆN. Induction Step: When n=k+1n=k+1n=k+1: ak+1=3ak2â‰¤3â‹…(32kâˆ’1)2=32k+1âˆ’1.a_{k+1}=3a_{k}^2\\le 3\\cdot \\left(3^{2^k-1}\\right)^2=3^{2^{k+1}-1}. ak+1â€‹=3ak2â€‹â‰¤3â‹…(32kâˆ’1)2=32k+1âˆ’1. So for all nâˆˆN+n\\in\\N^+nâˆˆN+, anâ‰¤32nâˆ’1a_n\\le 3^{2^n-1}anâ€‹â‰¤32nâˆ’1. (c) For nâˆˆNn\\in\\NnâˆˆN, anâ‰¤32nâˆ’1=13â‹…32nâ‰¤32na_n\\le 3^{2^n-1}=\\frac{1}{3}\\cdot 3^{2^n}\\le 3^{2^n}anâ€‹â‰¤32nâˆ’1=31â€‹â‹…32nâ‰¤32n. 3 Binary Numbers We proceed by induction on nnn. Base Case: When n=1n=1n=1, let c0=1c_0=1c0â€‹=1, n=1â‹…20n=1\\cdot 2^0n=1â‹…20. So the assumption holds when n=1n=1n=1. Induction Hypothesis: We assume that the proposition holds for nâ‰¤tn\\le tnâ‰¤t. Induction Step: We use the parity of t+1 for discussion. If t+1t + 1t+1 is an odd number. Let t2=âˆ‘i=0kckâ‹…2k\\frac{t}{2}=\\sum_{i=0}^k c_k\\cdot 2^k2tâ€‹=âˆ‘i=0kâ€‹ckâ€‹â‹…2k, then t+1=2â‹…t2+1=2âˆ‘i=0kciâ‹…2i+1=âˆ‘i=1k+1ciâˆ’1â‹…2i+1â‹…20t + 1=2\\cdot \\frac{t}{2}+1=2\\sum_{i=0}^k c_i\\cdot 2^i+1=\\sum_{i=1}^{k+1}c_{i-1}\\cdot 2^i+1\\cdot 2^0t+1=2â‹…2tâ€‹+1=2âˆ‘i=0kâ€‹ciâ€‹â‹…2i+1=âˆ‘i=1k+1â€‹ciâˆ’1â€‹â‹…2i+1â‹…20. If t+1t+1t+1 is an even number. Let t+12=âˆ‘i=0kciâ‹…2i\\frac{t + 1}{2}=\\sum_{i=0}^k c_i\\cdot 2^i2t+1â€‹=âˆ‘i=0kâ€‹ciâ€‹â‹…2i, then t+1=2â‹…t+12=2âˆ‘i=0kciâ‹…2i=âˆ‘i=1k+1ciâ‹…2i+0â‹…20t+1=2\\cdot\\frac{t+1}{2}=2\\sum_{i=0}^k c_i\\cdot 2^i=\\sum_{i=1}^{k+1} c_i\\cdot 2^i+0\\cdot 2^0t+1=2â‹…2t+1â€‹=2âˆ‘i=0kâ€‹ciâ€‹â‹…2i=âˆ‘i=1k+1â€‹ciâ€‹â‹…2i+0â‹…20. In all, the proposition holds. 4 Fibonacci for Home Let P(n)P(n)P(n) be the proposition that 2âˆ£F3n2\\mid F_{3n}2âˆ£F3nâ€‹. Letâ€™s prove it by induction. Base Case: When n=1n=1n=1, F3n=2F_{3n}=2F3nâ€‹=2 so 2âˆ£F3n2\\mid F_{3n}2âˆ£F3nâ€‹. Induction Hypothesis: We assume that 2âˆ£F3k2\\mid F_{3k}2âˆ£F3kâ€‹ when kâˆˆNk\\in\\NkâˆˆN. Induction Step: F3(k+1)â‰¡F3k+3(mod2)â‰¡F3k+2+F3k+1(mod2)â‰¡F3k+1+F3k+F3k+1(mod2)â‰¡2F3k+1+F3k(mod2)â‰¡0(mod2)\\begin{aligned} F_{3(k+1)}&amp;\\equiv F_{3k+3}\\pmod 2\\\\ &amp;\\equiv F_{3k+2}+F_{3k+1}\\pmod 2\\\\ &amp;\\equiv F_{3k+1}+F_{3k}+F_{3k+1}\\pmod 2\\\\ &amp;\\equiv 2F_{3k+1}+F_{3k}\\pmod 2\\\\ &amp;\\equiv 0\\pmod 2 \\end{aligned} F3(k+1)â€‹â€‹â‰¡F3k+3â€‹(mod2)â‰¡F3k+2â€‹+F3k+1â€‹(mod2)â‰¡F3k+1â€‹+F3kâ€‹+F3k+1â€‹(mod2)â‰¡2F3k+1â€‹+F3kâ€‹(mod2)â‰¡0(mod2)â€‹ So 2âˆ£F3(k+1)2\\mid F_{3(k+1)}2âˆ£F3(k+1)â€‹. In all, âˆ€nâˆˆN,2âˆ£F3n\\forall n\\in \\N, 2\\mid F_{3n}âˆ€nâˆˆN,2âˆ£F3nâ€‹. Homework 1 1 Solving a System of Equations Let the prices for an apple, for a beet, and for a carrot be a,b,ca, b, ca,b,c separately. Then we have: [111230123]â‹…[abc]=[162335]\\begin{bmatrix} 1 &amp; 1 &amp; 1 \\\\ 2 &amp; 3 &amp; 0 \\\\ 1 &amp; 2 &amp; 3 \\end{bmatrix} \\cdot \\begin{bmatrix} a\\\\ b\\\\ c \\end{bmatrix} = \\begin{bmatrix} 16\\\\ 23\\\\ 35 \\end{bmatrix} â£â¢â¡â€‹121â€‹132â€‹103â€‹â¦â¥â¤â€‹â‹…â£â¢â¡â€‹abcâ€‹â¦â¥â¤â€‹=â£â¢â¡â€‹162335â€‹â¦â¥â¤â€‹ 1234A = [1 1 1; 2 3 0; 1 2 3];b = [16; 23; 35];x = inv(A) * b;disp(x); Solving this equation, we get x=[457]Tx=\\begin{bmatrix}4&amp;5&amp;7\\end{bmatrix}^{\\mathrm{T}}x=[4â€‹5â€‹7â€‹]T. So a=4,b=5,c=7a=4, b=5, c=7a=4,b=5,c=7. 2 Calculus Review (a) âˆ«0âˆeâˆ’tsinâ¡t dt=âˆ’âˆ«0âˆsinâ¡t d(eâˆ’t)=âˆ’((sinâ¡(t)â‹…eâˆ’t)0âˆâˆ’âˆ«0âˆeâˆ’t d(sinâ¡t))=âˆ«0âˆeâˆ’tcosâ¡t dt=âˆ’âˆ«0âˆcosâ¡t d(eâˆ’t)=âˆ’((eâˆ’tcosâ¡t)0âˆâˆ’âˆ«0âˆeâˆ’t d(cosâ¡t))=âˆ«0âˆeâˆ’t d(cosâ¡t)âˆ’(eâˆ’tcosâ¡t)0âˆ=âˆ’âˆ«0âˆeâˆ’tsinâ¡t dt+1\\begin{aligned} \\int_{0}^{\\infty}e^{-t}\\sin t\\ \\mathrm{d}t&amp;=-\\int_{0}^{\\infty}\\sin t\\ \\mathrm{d}\\left(e^{-t}\\right)\\\\ &amp;=-\\left(\\left(\\sin(t)\\cdot e^{-t}\\right)_0^{\\infty}-\\int_{0}^\\infty e^{-t}\\ \\mathrm{d}(\\sin t)\\right)\\\\ &amp;=\\int_{0}^{\\infty}e^{-t}\\cos t\\ \\mathrm{d}t\\\\ &amp;=-\\int_{0}^{\\infty}\\cos t\\ \\mathrm{d}\\left(e^{-t}\\right)\\\\ &amp;=-\\left(\\left(e^{-t}\\cos t\\right)_{0}^{\\infty}-\\int_{0}^{\\infty}e^{-t}\\ \\mathrm{d}(\\cos t)\\right)\\\\ &amp;=\\int_{0}^{\\infty}e^{-t}\\ \\mathrm{d}(\\cos t)-\\left(e^{-t}\\cos t\\right)_{0}^{\\infty}\\\\ &amp;=-\\int^\\infty_0e^{-t}\\sin t\\ \\mathrm{d}t+1 \\end{aligned} âˆ«0âˆâ€‹eâˆ’tsint dtâ€‹=âˆ’âˆ«0âˆâ€‹sint d(eâˆ’t)=âˆ’((sin(t)â‹…eâˆ’t)0âˆâ€‹âˆ’âˆ«0âˆâ€‹eâˆ’t d(sint))=âˆ«0âˆâ€‹eâˆ’tcost dt=âˆ’âˆ«0âˆâ€‹cost d(eâˆ’t)=âˆ’((eâˆ’tcost)0âˆâ€‹âˆ’âˆ«0âˆâ€‹eâˆ’t d(cost))=âˆ«0âˆâ€‹eâˆ’t d(cost)âˆ’(eâˆ’tcost)0âˆâ€‹=âˆ’âˆ«0âˆâ€‹eâˆ’tsint dt+1â€‹ So, âˆ«0âˆeâˆ’tsinâ¡t dt=âˆ’âˆ«0âˆeâˆ’tsinâ¡t dt+1.\\int_{0}^{\\infty}e^{-t}\\sin t\\ \\mathrm{d}t=-\\int_{0}^{\\infty}e^{-t}\\sin t\\ \\mathrm{d}t+1. âˆ«0âˆâ€‹eâˆ’tsint dt=âˆ’âˆ«0âˆâ€‹eâˆ’tsint dt+1. Which is âˆ«0âˆeâˆ’tsinâ¡t dt=12.\\int_{0}^{\\infty}e^{-t}\\sin t\\ \\mathrm{d}t=\\frac{1}{2}. âˆ«0âˆâ€‹eâˆ’tsint dt=21â€‹. 12syms x;disp(int(sin(x) * exp(-x), 0, inf)); (b) fâ€²(x)=2xâ‹…eâˆ’x4f&#x27;(x)=2x\\cdot e^{-x^4} fâ€²(x)=2xâ‹…eâˆ’x4 Since eâˆ’x4&gt;0e^{-x^4}&gt;0eâˆ’x4&gt;0, fâ€²(x)&lt;0f&#x27;(x)&lt;0fâ€²(x)&lt;0 when x&lt;0x&lt;0x&lt;0 and fâ€²(x)&gt;0f&#x27;(x)&gt;0fâ€²(x)&gt;0 when x&gt;0x&gt;0x&gt;0. So when x=0x=0x=0, the minimum value of f(x)f(x)f(x) is 000. (c) âˆ¬R2x+y dA=âˆ«01dxâˆ«0x2x+y dy=âˆ«01(2xy+12y2)y=0y=xdx=âˆ«0152x2 dx=56\\begin{aligned} \\iint_R 2x+y\\ \\mathrm{d}A&amp;=\\int_0^1\\mathrm{d}x\\int_{0}^{x}2x+y\\ \\mathrm{d}y\\\\ &amp;=\\int_{0}^{1}\\left(2xy+\\frac{1}{2}y^2\\right)_{y=0}^{y=x}\\mathrm{d}x\\\\ &amp;=\\int_{0}^{1}\\frac{5}{2}x^2\\ \\mathrm{d}x\\\\ &amp;=\\frac{5}{6} \\end{aligned} âˆ¬Râ€‹2x+y dAâ€‹=âˆ«01â€‹dxâˆ«0xâ€‹2x+y dy=âˆ«01â€‹(2xy+21â€‹y2)y=0y=xâ€‹dx=âˆ«01â€‹25â€‹x2 dx=65â€‹â€‹ 3 Implication (a) True. (b) False. Let Q(x,y)Q(x, y)Q(x,y) be x=yx=yx=y. (c) True. For all yyy, we just choose the xxx previously selected. (d) True. 4 Logical Equivalence? (a) True. âˆ€x (P(x)âˆ§Q(x))â‰¡â‹€x(P(x)âˆ§Q(x))â‰¡(â‹€xP(x))âˆ§(â‹€xQ(x))â‰¡(âˆ€x P(x))âˆ§(âˆ€x Q(x))\\begin{aligned} \\forall x\\ (P(x)\\land Q(x))&amp;\\equiv\\bigwedge_{x}(P(x)\\land Q(x))\\\\&amp;\\equiv\\left(\\bigwedge_x P(x)\\right)\\land\\left(\\bigwedge_x Q(x)\\right)\\\\ &amp;\\equiv \\left(\\forall x\\ P(x)\\right)\\land\\left(\\forall x\\ Q(x)\\right) \\end{aligned} âˆ€x (P(x)âˆ§Q(x))â€‹â‰¡xâ‹€â€‹(P(x)âˆ§Q(x))â‰¡(xâ‹€â€‹P(x))âˆ§(xâ‹€â€‹Q(x))â‰¡(âˆ€x P(x))âˆ§(âˆ€x Q(x))â€‹ (b) False. Let P(x)=(x&gt;0),Q(x)=(xâ‰¤0)P(x)=(x&gt;0), Q(x)=(x\\le 0)P(x)=(x&gt;0),Q(x)=(xâ‰¤0). âˆ€x (P(x)âˆ§Q(x))\\forall x\\ (P(x)\\land Q(x))âˆ€x (P(x)âˆ§Q(x)) is true but (âˆ€x P(x))âˆ¨(âˆ€x Q(x))\\left(\\forall x\\ P(x)\\right)\\lor\\left(\\forall x\\ Q(x)\\right)(âˆ€x P(x))âˆ¨(âˆ€x Q(x)) is false. (c) True. âˆƒx (P(x)âˆ¨Q(x))â‰¡â‹x(P(x)âˆ¨Q(x))â‰¡(â‹xP(x))âˆ¨(â‹xQ(x))â‰¡(âˆƒx P(x))âˆ¨(âˆƒx Q(x))\\begin{aligned} \\exist x\\ (P(x)\\lor Q(x))&amp;\\equiv\\bigvee_{x}(P(x)\\lor Q(x))\\\\&amp;\\equiv\\left(\\bigvee_x P(x)\\right)\\lor\\left(\\bigvee_x Q(x)\\right)\\\\ &amp;\\equiv \\left(\\exist x\\ P(x)\\right)\\lor\\left(\\exist x\\ Q(x)\\right) \\end{aligned} âˆƒx (P(x)âˆ¨Q(x))â€‹â‰¡xâ‹â€‹(P(x)âˆ¨Q(x))â‰¡(xâ‹â€‹P(x))âˆ¨(xâ‹â€‹Q(x))â‰¡(âˆƒx P(x))âˆ¨(âˆƒx Q(x))â€‹ (d) False. Let P(x)=(x=2)P(x)=(x=2)P(x)=(x=2) and Q(x)=(x=3)Q(x)=(x=3)Q(x)=(x=3). LHS\\mathrm{LHS}LHS is false but RHS\\mathrm{RHS}RHS is true. 5 Preserving Set Operations (a) xâˆˆfâˆ’1(Aâˆ©B)âŸº f(x)âˆˆAâˆ©BâŸº (f(x)âˆˆA)âˆ§(f(x)âˆˆB)âŸº (xâˆˆfâˆ’1(A))âˆ§(xâˆˆfâˆ’1(B))âŸº xâˆˆfâˆ’1(A)âˆ©fâˆ’1(B)\\begin{aligned} &amp;x\\in f^{-1}(A\\cap B)\\\\ \\Longleftrightarrow\\ &amp;f(x)\\in A\\cap B\\\\ \\Longleftrightarrow\\ &amp;\\left(f(x)\\in A\\right)\\land \\left(f(x)\\in B\\right)\\\\ \\Longleftrightarrow\\ &amp;\\left(x\\in f^{-1}(A)\\right)\\land \\left(x\\in f^{-1}(B)\\right)\\\\ \\Longleftrightarrow\\ &amp;x\\in f^{-1}(A)\\cap f^{-1}(B) \\end{aligned} âŸº âŸº âŸº âŸº â€‹xâˆˆfâˆ’1(Aâˆ©B)f(x)âˆˆAâˆ©B(f(x)âˆˆA)âˆ§(f(x)âˆˆB)(xâˆˆfâˆ’1(A))âˆ§(xâˆˆfâˆ’1(B))xâˆˆfâˆ’1(A)âˆ©fâˆ’1(B)â€‹ So fâˆ’1(Aâˆ©B)=fâˆ’1(A)âˆ©fâˆ’1(B)f^{-1}(A\\cap B)=f^{-1}(A)\\cap f^{-1}(B)fâˆ’1(Aâˆ©B)=fâˆ’1(A)âˆ©fâˆ’1(B). (b) xâˆˆfâˆ’1(Aâˆ–B)âŸº f(x)âˆˆAâˆ–BâŸº (f(x)âˆˆA)âˆ§(f(x)âˆˆÌ¸B)âŸº (xâˆˆfâˆ’1(A))âˆ§(xâˆˆÌ¸fâˆ’1(B))âŸº xâˆˆfâˆ’1(A)âˆ–fâˆ’1(B)\\begin{aligned} &amp;x\\in f^{-1}(A\\setminus B)\\\\ \\Longleftrightarrow\\ &amp;f(x)\\in A\\setminus B\\\\ \\Longleftrightarrow\\ &amp;(f(x)\\in A)\\land (f(x)\\not\\in B)\\\\ \\Longleftrightarrow\\ &amp;(x\\in f^{-1}(A))\\land (x\\not\\in f^{-1}(B))\\\\ \\Longleftrightarrow\\ &amp;x\\in f^{-1}(A)\\setminus f^{-1}(B) \\end{aligned} âŸº âŸº âŸº âŸº â€‹xâˆˆfâˆ’1(Aâˆ–B)f(x)âˆˆAâˆ–B(f(x)âˆˆA)âˆ§(f(x)î€ âˆˆB)(xâˆˆfâˆ’1(A))âˆ§(xî€ âˆˆfâˆ’1(B))xâˆˆfâˆ’1(A)âˆ–fâˆ’1(B)â€‹ So fâˆ’1(Aâˆ–B)=fâˆ’1(A)âˆ–fâˆ’1(B)f^{-1}(A\\setminus B)=f^{-1}(A)\\setminus f^{-1}(B)fâˆ’1(Aâˆ–B)=fâˆ’1(A)âˆ–fâˆ’1(B). (c) yâˆˆf(Aâˆ©B)âŸº âˆƒxâˆˆAâˆ©B,f(x)=y âŸ¹ (âˆƒxâˆˆA,f(x)=y)âˆ§(âˆƒxâˆˆB,f(x)=y)âŸº (yâˆˆf(A))âˆ§(yâˆˆf(B))âŸº yâˆˆf(A)âˆ©f(B)\\begin{aligned} &amp;y\\in f(A\\cap B)\\\\ \\Longleftrightarrow\\ &amp;\\exist x\\in A\\cap B, f(x)=y\\\\ \\implies&amp;(\\exist x \\in A, f(x)=y)\\land (\\exist x\\in B, f(x)=y)\\\\ \\Longleftrightarrow\\ &amp;(y\\in f(A))\\land (y\\in f(B))\\\\ \\Longleftrightarrow\\ &amp;y\\in f(A)\\cap f(B) \\end{aligned} âŸº âŸ¹âŸº âŸº â€‹yâˆˆf(Aâˆ©B)âˆƒxâˆˆAâˆ©B,f(x)=y(âˆƒxâˆˆA,f(x)=y)âˆ§(âˆƒxâˆˆB,f(x)=y)(yâˆˆf(A))âˆ§(yâˆˆf(B))yâˆˆf(A)âˆ©f(B)â€‹ So f(Aâˆ©B)âŠ†f(A)âˆ©f(B)f(A\\cap B)\\subseteq f(A)\\cap f(B)f(Aâˆ©B)âŠ†f(A)âˆ©f(B). The counterexample for f(Aâˆ©B)=f(A)âˆ©f(B)f(A\\cap B)= f(A)\\cap f(B)f(Aâˆ©B)=f(A)âˆ©f(B) is when A={2}A=\\{2\\}A={2} and B={âˆ’2}B = \\{-2\\}B={âˆ’2}, and we let f(x)=x2f(x)=x^2f(x)=x2. f(Aâˆ©B)=âˆ…f(A\\cap B)=\\emptysetf(Aâˆ©B)=âˆ… but f(A)âˆ©f(B)={4}f(A)\\cap f(B)=\\{4\\}f(A)âˆ©f(B)={4}. (d) yâˆˆf(Aâˆ–B)âŸº âˆƒxâˆˆAâˆ–B,f(x)=y âŸ¸ (âˆƒxâˆˆA,f(x)=y)âˆ§(âˆ€xâˆˆB,f(x)â‰ y)âŸº (yâˆˆf(A))âˆ§(yâˆˆÌ¸f(B))âŸº yâˆˆf(A)âˆ–f(B)\\begin{aligned} &amp;y\\in f(A\\setminus B)\\\\ \\Longleftrightarrow\\ &amp;\\exist x\\in A\\setminus B, f(x)=y\\\\ \\impliedby\\ &amp;(\\exist x \\in A, f(x)=y)\\land (\\forall x\\in B, f(x)\\neq y)\\\\ \\Longleftrightarrow\\ &amp;(y\\in f(A))\\land (y\\not\\in f(B))\\\\ \\Longleftrightarrow\\ &amp;y\\in f(A)\\setminus f(B) \\end{aligned} âŸº âŸ¸ âŸº âŸº â€‹yâˆˆf(Aâˆ–B)âˆƒxâˆˆAâˆ–B,f(x)=y(âˆƒxâˆˆA,f(x)=y)âˆ§(âˆ€xâˆˆB,f(x)î€ =y)(yâˆˆf(A))âˆ§(yî€ âˆˆf(B))yâˆˆf(A)âˆ–f(B)â€‹ So f(Aâˆ–B)âŠ‡f(A)âˆ–f(B)f(A\\setminus B)\\supseteq f(A)\\setminus f(B)f(Aâˆ–B)âŠ‡f(A)âˆ–f(B). The counterexample for f(Aâˆ–B)=f(A)âˆ–f(B)f(A\\setminus B)= f(A)\\setminus f(B)f(Aâˆ–B)=f(A)âˆ–f(B) is when A={âˆ’2,2}A=\\{-2, 2\\}A={âˆ’2,2} and B={âˆ’2}B = \\{-2\\}B={âˆ’2}, and we let f(x)=x2f(x)=x^2f(x)=x2. f(Aâˆ–B)={4}f(A\\setminus B)=\\{4\\}f(Aâˆ–B)={4} but f(A)âˆ©f(B)=âˆ…f(A)\\cap f(B)=\\emptysetf(A)âˆ©f(B)=âˆ…. 6 Prove or Disprove (a) True. Let n=2k+1n=2k+1n=2k+1, kâˆˆZk\\in \\ZkâˆˆZ. n2+4n=4k2+12k+5n^2+4n=4k^2+12k+5n2+4n=4k2+12k+5 is an odd number. (b) True. a+bâ‰¤15 âŸ¹ (aâ‰¤11)âˆ¨(bâ‰¤4)â‰¡ Â¬((aâ‰¤11)âˆ¨(bâ‰¤4)) âŸ¹ Â¬(a+bâ‰¤15)â‰¡ (a&gt;15)âˆ§(b&gt;4) âŸ¹ a+b&gt;15\\begin{aligned} &amp;a + b\\le 15\\implies (a\\le 11) \\lor (b\\le 4)\\\\ \\equiv\\ &amp;\\lnot((a\\le 11) \\lor (b\\le 4))\\implies \\lnot(a + b\\le 15)\\\\ \\equiv\\ &amp;(a &gt; 15)\\land (b&gt;4)\\implies a + b &gt; 15 \\end{aligned} â‰¡ â‰¡ â€‹a+bâ‰¤15âŸ¹(aâ‰¤11)âˆ¨(bâ‰¤4)Â¬((aâ‰¤11)âˆ¨(bâ‰¤4))âŸ¹Â¬(a+bâ‰¤15)(a&gt;15)âˆ§(b&gt;4)âŸ¹a+b&gt;15â€‹ (c) True. r2âˆˆÌ¸Q âŸ¹ râˆˆÌ¸Qâ‰¡ Â¬(râˆˆÌ¸Q) âŸ¹ Â¬(r2âˆˆÌ¸Q)â‰¡ râˆˆQ âŸ¹ r2âˆˆQ\\begin{aligned} &amp;r^2\\not\\in \\mathbb{Q}\\implies r \\not\\in \\mathbb{Q}\\\\ \\equiv\\ &amp;\\lnot(r \\not\\in \\mathbb{Q})\\implies \\lnot(r^2\\not\\in \\mathbb{Q})\\\\ \\equiv\\ &amp;r \\in \\mathbb{Q}\\implies r^2\\in \\mathbb{Q} \\end{aligned} â‰¡ â‰¡ â€‹r2î€ âˆˆQâŸ¹rî€ âˆˆQÂ¬(rî€ âˆˆQ)âŸ¹Â¬(r2î€ âˆˆQ)râˆˆQâŸ¹r2âˆˆQâ€‹ Let r=pqr=\\frac{p}{q}r=qpâ€‹, where p,qâˆˆZp, q\\in \\Zp,qâˆˆZ and gcdâ¡(p,q)=1\\gcd(p, q) = 1gcd(p,q)=1. r2=p2q2âˆˆQr^2=\\frac{p^2}{q^2}\\in\\mathbb{Q}r2=q2p2â€‹âˆˆQ. (d) False. 1234from math import factorialn = 10print(5 * n ** 3 &gt; factorial(n)) 7 Rationals and Irrationals We use proof by contradiction. Let xâˆˆQ,yâˆˆRâˆ–Q,zâˆˆQx\\in \\mathbb{Q}, y\\in\\mathbb{R}\\setminus\\mathbb{Q}, z\\in\\mathbb{Q}xâˆˆQ,yâˆˆRâˆ–Q,zâˆˆQ and z=xyz=xyz=xy. But y=zxâˆˆQy = \\frac{z}{x}\\in \\mathbb{Q}y=xzâ€‹âˆˆQ, which conflicts with yâˆˆRâˆ–Qy\\in \\R\\setminus\\mathbb{Q}yâˆˆRâˆ–Q, so zzz must be irrational. 8 Twin Primes (a) If 3âˆ£p3\\mid p3âˆ£p, ppp is not a prime number. So 3âˆ¤p3\\nmid p3âˆ¤p. So pâ‰¡1(mod3)p\\equiv 1\\pmod 3pâ‰¡1(mod3) or pâ‰¡2â‰¡âˆ’1(mod3)p\\equiv 2\\equiv -1\\pmod 3pâ‰¡2â‰¡âˆ’1(mod3). So ppp is of the form 3k+13k + 13k+1 or 3kâˆ’13k - 13kâˆ’1 for some integer kkk. (b) If the three prime numbers are p,p+2,p+4 (p&gt;3)p, p + 2, p + 4\\ (p&gt;3)p,p+2,p+4 (p&gt;3), we could let p=3kÂ±1p=3k\\pm 1p=3kÂ±1. If p=3k+1p=3k + 1p=3k+1, we have p+2=3k+3=3(k+1)p + 2=3k + 3 = 3(k + 1)p+2=3k+3=3(k+1) is not a prime number. If p=3kâˆ’1p=3k - 1p=3kâˆ’1, we have p+4=3k+3=3(k+1)p + 4 = 3k + 3 = 3(k + 1)p+4=3k+3=3(k+1). So 555 is the only prime number that takes part in two different twin prime pairs.","categories":[{"name":"æ–‡åŒ–è¯¾","slug":"æ–‡åŒ–è¯¾","permalink":"https://pufanyi.github.io/oi-blog/categories/%E6%96%87%E5%8C%96%E8%AF%BE/"}],"tags":[{"name":"æ•°å­¦","slug":"æ•°å­¦","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%95%B0%E5%AD%A6/"},{"name":"Discrete Mathematics","slug":"Discrete-Mathematics","permalink":"https://pufanyi.github.io/oi-blog/tags/Discrete-Mathematics/"},{"name":"æ¦‚ç‡","slug":"æ¦‚ç‡","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%A6%82%E7%8E%87/"}]},{"title":"RESTART","slug":"restart","date":"2022-08-07T16:00:00.000Z","updated":"2023-12-25T16:08:27.954Z","comments":true,"path":"restart/","link":"","permalink":"https://pufanyi.github.io/oi-blog/restart/","excerpt":"","text":"è·‘åˆ°äº†å—æ´‹ç†å·¥å¤§å­¦ï¼Œè¿™ä¸ªå·²ç»é•¿è‰çš„ blog æˆ–è®¸æœ‰æ—¶é—´æ›´æ–°äº†ï¼ ï¼ˆå½“ç„¶å…·ä½“æœ‰æ²¡æœ‰è¿˜å¾—çœ‹å¿ƒæƒ…ï¼‰","categories":[{"name":"å…¬å‘Š","slug":"å…¬å‘Š","permalink":"https://pufanyi.github.io/oi-blog/categories/%E5%85%AC%E5%91%8A/"}],"tags":[]},{"title":"CodeForces 1594F Ideal Farm","slug":"CF1594F","date":"2021-10-08T16:00:00.000Z","updated":"2023-12-25T16:08:27.873Z","comments":true,"path":"CF1594F/","link":"","permalink":"https://pufanyi.github.io/oi-blog/CF1594F/","excerpt":"Farmer John æœ‰ sss åªå¥¶ç‰›ï¼Œå’Œ nnn ä¸ªç‹¬ç«‹çš„ç¯±ç¬†ï¼Œæ¯ä¸ªç¯±ç¬†é‡Œå¯ä»¥åœˆå…»ä¸€äº›å¥¶ç‰›ã€‚å‡ºäºä¸€ç§å¥‡â™‚ï¸æ€ªçš„åå¥½ï¼ŒFarmer John æŠŠç¯±ç¬†æ’æˆäº†ä¸€æ’ã€‚ç¬¬ iii ä¸ªç¯±ç¬†åœˆå…»çš„å¥¶ç‰›æ•°é‡ä¸º aia_iaiâ€‹ï¼Œæ˜¾ç„¶æˆ‘ä»¬æœ‰ âˆ‘i=1nai=s\\sum_{i=1}^n a_i=sâˆ‘i=1nâ€‹aiâ€‹=sã€‚è€Œä¸”ï¼Œå¤„äº Farmer John çš„ç™–å¥½ï¼Œä»–è¦æ±‚å¯¹äºæ¯ä¸ª iii éƒ½æœ‰ ai&gt;0a_i&gt;0aiâ€‹&gt;0ã€‚ Bessie è®¤ä¸ºä¸€ä¸ªå†œåœºæ˜¯â€œå¹¸è¿çš„â€å½“ä¸”ä»…å½“ä½ å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªåŒºé—´ [l,r][l,r][l,r]ï¼Œä½¿å¾— âˆ‘i=lrai=k\\sum_{i=l}^ra_i=kâˆ‘i=lrâ€‹aiâ€‹=kã€‚ è€Œå¾—å¯¸è¿›å°ºçš„ Bessie è®¤ä¸ºä¸€ä¸ªå†œåœºæ˜¯â€œç‰›é€¼çš„â€å½“ä¸”ä»…å½“ä¸ç®¡ Farmer John æ€ä¹ˆå®‰ç½®ä»–çš„å¥¶ç‰›ï¼Œè¯¥å†œåœºéƒ½æ˜¯â€œå¹¸è¿çš„â€ã€‚ ç°åœ¨æœ‰ t (1â‰¤tâ‰¤105)t\\,(1\\le t\\le 10^5)t(1â‰¤tâ‰¤105) ç»„è¯¢é—®ï¼Œæ¯ç»„è¯¢é—®ç»™å‡º s,ns, ns,n å’Œ k (1â‰¤s,n,kâ‰¤1018, nâ‰¤s)k\\,(1\\le s,n,k\\le {10}^{18},\\,n\\le s)k(1â‰¤s,n,kâ‰¤1018,nâ‰¤s)ï¼Œè¯¢é—®è¿™ä¸ªå†œåœºæ˜¯ä¸æ˜¯â€œç‰›é€¼çš„â€ã€‚","text":"Farmer John æœ‰ sss åªå¥¶ç‰›ï¼Œå’Œ nnn ä¸ªç‹¬ç«‹çš„ç¯±ç¬†ï¼Œæ¯ä¸ªç¯±ç¬†é‡Œå¯ä»¥åœˆå…»ä¸€äº›å¥¶ç‰›ã€‚å‡ºäºä¸€ç§å¥‡â™‚ï¸æ€ªçš„åå¥½ï¼ŒFarmer John æŠŠç¯±ç¬†æ’æˆäº†ä¸€æ’ã€‚ç¬¬ iii ä¸ªç¯±ç¬†åœˆå…»çš„å¥¶ç‰›æ•°é‡ä¸º aia_iaiâ€‹ï¼Œæ˜¾ç„¶æˆ‘ä»¬æœ‰ âˆ‘i=1nai=s\\sum_{i=1}^n a_i=sâˆ‘i=1nâ€‹aiâ€‹=sã€‚è€Œä¸”ï¼Œå¤„äº Farmer John çš„ç™–å¥½ï¼Œä»–è¦æ±‚å¯¹äºæ¯ä¸ª iii éƒ½æœ‰ ai&gt;0a_i&gt;0aiâ€‹&gt;0ã€‚ Bessie è®¤ä¸ºä¸€ä¸ªå†œåœºæ˜¯â€œå¹¸è¿çš„â€å½“ä¸”ä»…å½“ä½ å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªåŒºé—´ [l,r][l,r][l,r]ï¼Œä½¿å¾— âˆ‘i=lrai=k\\sum_{i=l}^ra_i=kâˆ‘i=lrâ€‹aiâ€‹=kã€‚ è€Œå¾—å¯¸è¿›å°ºçš„ Bessie è®¤ä¸ºä¸€ä¸ªå†œåœºæ˜¯â€œç‰›é€¼çš„â€å½“ä¸”ä»…å½“ä¸ç®¡ Farmer John æ€ä¹ˆå®‰ç½®ä»–çš„å¥¶ç‰›ï¼Œè¯¥å†œåœºéƒ½æ˜¯â€œå¹¸è¿çš„â€ã€‚ ç°åœ¨æœ‰ t (1â‰¤tâ‰¤105)t\\,(1\\le t\\le 10^5)t(1â‰¤tâ‰¤105) ç»„è¯¢é—®ï¼Œæ¯ç»„è¯¢é—®ç»™å‡º s,ns, ns,n å’Œ k (1â‰¤s,n,kâ‰¤1018, nâ‰¤s)k\\,(1\\le s,n,k\\le {10}^{18},\\,n\\le s)k(1â‰¤s,n,kâ‰¤1018,nâ‰¤s)ï¼Œè¯¢é—®è¿™ä¸ªå†œåœºæ˜¯ä¸æ˜¯â€œç‰›é€¼çš„â€ã€‚ ç”±äºæ˜¯åŒºé—´é—®é¢˜ï¼Œæˆ‘ä»¬è€ƒè™‘å…ˆå°†å…¶è½¬æ¢ä¸ºä¸¤ç‚¹é—®é¢˜ã€‚è€ƒè™‘ bi=âˆ‘j=1iaib_i=\\sum_{j=1}^i a_ibiâ€‹=âˆ‘j=1iâ€‹aiâ€‹ï¼Œäºæ˜¯æˆ‘ä»¬æœ‰ {b0=0bn=s\\begin{cases}b_0=0\\\\b_n=s\\end{cases}{b0â€‹=0bnâ€‹=sâ€‹ã€‚å¦‚æœå­˜åœ¨ä¸€å¯¹ &lt;i,j&gt;\\left&lt;i,j\\right&gt;âŸ¨i,jâŸ© æ»¡è¶³ bjâˆ’bi=kb_j-b_i=kbjâ€‹âˆ’biâ€‹=kï¼Œé‚£æ˜¾ç„¶è¿™ä¸ªå†œåœºæ˜¯å¹¸è¿çš„ã€‚ç”±äº ai&gt;0a_i&gt;0aiâ€‹&gt;0ï¼Œæ¯ä¸€ä¸ª bib_ibiâ€‹ éƒ½æ˜¯ä¸¤ä¸¤ä¸åŒçš„ã€‚äºæ˜¯é—®é¢˜å°±è½¬åŒ–æˆäº†ï¼Œåœ¨ 1âˆ¼s1\\sim s1âˆ¼s ä¸­é€‰å‡º nnn ä¸ªæ•°ï¼Œä½¿å¾—è¿™äº›æ•°ä¸­ä¸å­˜åœ¨ kkkï¼Œä¸”ä¸å­˜åœ¨ä¸€å¯¹ &lt;i,j&gt;\\left&lt;i,j\\right&gt;âŸ¨i,jâŸ© æ»¡è¶³ jâˆ’i=kj-i=kjâˆ’i=kã€‚ ä¸‹é¢æˆ‘ä»¬è´ªå¿ƒåœ°è€ƒè™‘æœ€å¤šèƒ½é€‰å‡ºå¤šå°‘ä¸ªæ»¡è¶³æ¡ä»¶çš„æ•°ã€‚ è€ƒè™‘åˆ°ä¸èƒ½æœ‰ kkk è¿™ä¸ªæ¡ä»¶ï¼Œæˆ‘ä»¬æŠŠ kkk çš„å€æ•°å’Œä¸æ˜¯ kkk çš„å€æ•°çš„æ•°åˆ†å¼€è®¨è®ºï¼Œå¯¹äºä¸æ˜¯ kkk å€æ•°çš„æ•°ï¼Œå¦‚æœæˆ‘ä»¬é€‰äº† xxxï¼Œé‚£æˆ‘ä»¬å°±ä¸èƒ½é€‰ x+kx+kx+k äº†ï¼ˆå¦‚æœ x+kâ‰¤sx+k\\le sx+kâ‰¤s çš„è¯ï¼‰ã€‚äºæ˜¯æˆ‘ä»¬è€ƒè™‘å¯¹æ¯ 2k2k2k ä¸ªåˆ’åˆ†ä¸ºä¸€æ®µï¼Œè¿™æ ·é™¤äº†æœ€åä¸€æ®µä¸æ»¡çš„ï¼Œå°±æœ‰ âŒŠs2kâŒ‹\\left\\lfloor\\frac{s}{2k}\\right\\rfloorâŒŠ2ksâ€‹âŒ‹ æ®µï¼Œè€Œæ¯ä¸€æ®µæˆ‘ä»¬å¯ä»¥è´ªå¿ƒåœ°é€‰æ‹© 1âˆ¼kâˆ’11\\sim k-11âˆ¼kâˆ’1ï¼Œè¿™æ ·ä¿è¯äº†æœ€åç•™ä¸‹çš„ s mod 2ks\\ \\mathrm{mod}\\ 2ks mod 2k ä¸ªæ•°èƒ½å°½é‡å¤šå–ï¼Œäºæ˜¯è¿™å¯¹äºä¸æ˜¯ kkk å€æ•°çš„æ•°ï¼Œè¿™ âŒŠs2kâŒ‹\\left\\lfloor\\frac{s}{2k}\\right\\rfloorâŒŠ2ksâ€‹âŒ‹ æ®µå¯ä»¥é€‰æ‹© âŒŠs2kâŒ‹â‹…(kâˆ’1)\\left\\lfloor\\frac{s}{2k}\\right\\rfloor\\cdot(k-1)âŒŠ2ksâ€‹âŒ‹â‹…(kâˆ’1) ä¸ªæ•°ã€‚ç„¶åæˆ‘ä»¬è€ƒè™‘æ˜¯ kkk å€æ•°ï¼Œç”±äºä¸èƒ½é€‰æ‹© kkkï¼Œæˆ‘ä»¬åªèƒ½é€‰æ‹© 2k2k2k çš„å€æ•°ã€‚è¿™æ ·è¿™ âŒŠs2kâŒ‹\\left\\lfloor\\frac{s}{2k}\\right\\rfloorâŒŠ2ksâ€‹âŒ‹ æ®µæˆ‘ä»¬å°±èƒ½é€‰å– âŒŠs2kâŒ‹\\left\\lfloor\\frac{s}{2k}\\right\\rfloorâŒŠ2ksâ€‹âŒ‹ ä¸ªæ•°ã€‚äºæ˜¯å‰ âŒŠs2kâŒ‹\\left\\lfloor\\frac{s}{2k}\\right\\rfloorâŒŠ2ksâ€‹âŒ‹ æ®µä¸€å…±æœ€å¤šèƒ½é€‰å– âŒŠs2kâŒ‹â‹…k\\left\\lfloor\\frac{s}{2k}\\right\\rfloor\\cdot kâŒŠ2ksâ€‹âŒ‹â‹…k ä¸ªæ•°ã€‚ ç„¶åæˆ‘ä»¬è€ƒè™‘æœ€åç•™ä¸‹çš„ s mod 2ks\\ \\mathrm{mod}\\ 2ks mod 2k ä¸ªæ•°ï¼Œæˆ‘ä»¬ä¸éš¾å‘ç°æœ€å¤šåªèƒ½é€‰è¿™é‡Œé¢å‰ kâˆ’1k-1kâˆ’1 ä¸ªæ•°äº†ï¼ˆç¬¬ kkk ä¸ªæ•°ä¸èƒ½é€‰äº†æ˜¯å› ä¸ºæˆ‘ä»¬å·²ç»é€‰äº†åŸåºåˆ—ä¸­ç¬¬ kâ‹…âŒŠs2kâŒ‹k\\cdot \\left\\lfloor\\frac{s}{2k}\\right\\rfloorkâ‹…âŒŠ2ksâ€‹âŒ‹ ä¸ªæ•°äº†ï¼‰ã€‚å› æ­¤ï¼Œè¿™ä¸€éƒ¨åˆ†æœ€å¤šèƒ½é€‰ minâ¡{s mod 2k,kâˆ’1}\\min\\left\\{s\\ \\mathrm{mod}\\ 2k, k - 1\\right\\}min{s mod 2k,kâˆ’1} ä¸ªæ•°ã€‚ ç„¶è€Œä¸Šé¢é‚£æ®µå¿˜è®°äº†ä¸€ä¸ªæ¡ä»¶ï¼Œé‚£å°±æ˜¯ç¬¬ sss ä¸ªæ•°æ˜¯å¿…é¡»è¦é€‰çš„ï¼Œå› ä¸º bn=sb_n=sbnâ€‹=sã€‚ä½†æ˜¯å¤§éƒ¨åˆ†æƒ…å†µä¸‹è¿™æ²¡æœ‰å…³ç³»ï¼Œå› ä¸ºå¦‚æœç¬¬ sss ä¸ªæ•°æ²¡æœ‰é€‰çš„è¯ï¼Œé‚£æˆ‘ä»¬è‚¯å®šé€‰æ‹©äº†ç¬¬ sâˆ’ks-ksâˆ’k ä¸ªæ•°ï¼ˆå› ä¸ºæˆ‘ä»¬æ˜¯è´ªå¿ƒé€‰æœ€å¤šçš„ï¼Œå¦‚æœç¬¬ sâˆ’ks-ksâˆ’k ä¸ªæ•°å’Œç¬¬ sss ä¸ªæ•°éƒ½ä¸é€‰çš„è¯ï¼Œé‚£å°±ä¸æ˜¯æœ€ä¼˜çš„äº†ï¼Œå› ä¸ºå¯ä»¥é€‰ä¸€ä¸ªä½¿æ‰€é€‰æ•°åŠ ä¸€ï¼‰ï¼Œäºæ˜¯æˆ‘ä»¬æŠŠç¬¬ sâˆ’ks-ksâˆ’k ä¸ªæ•°åˆ å»ï¼Œé€‰æ‹©ç¬¬ sss ä¸ªæ•°å³å¯ã€‚å”¯ä¸€çš„å½±å“åœ¨äºå¦‚æœå½“ s=ks=ks=k çš„æ—¶å€™ï¼Œé‚£æ—¢ç„¶ç¬¬ sss ä¸ªæ•°ä¸€å®šè¦é€‰ï¼Œé‚£ä¹ˆç­”æ¡ˆå°±åªèƒ½æ˜¯ YES äº†ã€‚ æ‰€ä»¥ï¼Œæˆ‘ä»¬æœ€ç»ˆåªè¦æ¯”è¾ƒ âŒŠs2kâŒ‹â‹…k+minâ¡{s mod 2k,kâˆ’1}\\left\\lfloor\\frac{s}{2k}\\right\\rfloor\\cdot k+\\min\\left\\{s\\ \\mathrm{mod}\\ 2k, k - 1\\right\\}âŒŠ2ksâ€‹âŒ‹â‹…k+min{s mod 2k,kâˆ’1} ä¸ nnn çš„å¤§å°å³å¯å¾—å‡ºç­”æ¡ˆã€‚","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"CodeForces","slug":"CodeForces","permalink":"https://pufanyi.github.io/oi-blog/tags/CodeForces/"},{"name":"æ„é€ ","slug":"æ„é€ ","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%9E%84%E9%80%A0/"}]},{"title":"IOI2019 æ™¯ç‚¹åˆ’åˆ†","slug":"[IOI2019]æ™¯ç‚¹åˆ’åˆ†","date":"2021-10-02T16:00:00.000Z","updated":"2023-12-25T16:08:27.921Z","comments":true,"path":"[IOI2019]æ™¯ç‚¹åˆ’åˆ†/","link":"","permalink":"https://pufanyi.github.io/oi-blog/[IOI2019]%E6%99%AF%E7%82%B9%E5%88%92%E5%88%86/","excerpt":"ç»™ä¸€å¼  n (3â‰¤nâ‰¤105)n\\,(3\\le n\\le 10^5)n(3â‰¤nâ‰¤105) ä¸ªç‚¹ m (2â‰¤mâ‰¤2Ã—105)m\\,(2\\le m\\le 2\\times 10^5)m(2â‰¤mâ‰¤2Ã—105) æ¡è¾¹çš„æ— å‘è¿é€šå›¾ï¼Œä»¥åŠä¸‰ä¸ªæ­£æ•´æ•° a,b,ca,b,ca,b,cï¼Œä¿è¯ a+b+c=na+b+c=na+b+c=nã€‚ä½ éœ€è¦å¯¹æ¯ä¸ªç‚¹æŸ“æˆä¸‰ç§é¢œè‰²ä¸­çš„ä¸€ç§ï¼Œä½¿å¾—è¿™ä¸‰ç§é¢œè‰²çš„ç‚¹çš„ä¸ªæ•°åˆ†åˆ«ä¸º a,b,ca,b,ca,b,cï¼Œä¸”æœ‰ä¸¤ç§é¢œè‰²çš„ç‚¹æ„æˆä¸¤ä¸ªè”ã€è¿é€šå—ã€‚å¯èƒ½æ— è§£ã€‚","text":"ç»™ä¸€å¼  n (3â‰¤nâ‰¤105)n\\,(3\\le n\\le 10^5)n(3â‰¤nâ‰¤105) ä¸ªç‚¹ m (2â‰¤mâ‰¤2Ã—105)m\\,(2\\le m\\le 2\\times 10^5)m(2â‰¤mâ‰¤2Ã—105) æ¡è¾¹çš„æ— å‘è¿é€šå›¾ï¼Œä»¥åŠä¸‰ä¸ªæ­£æ•´æ•° a,b,ca,b,ca,b,cï¼Œä¿è¯ a+b+c=na+b+c=na+b+c=nã€‚ä½ éœ€è¦å¯¹æ¯ä¸ªç‚¹æŸ“æˆä¸‰ç§é¢œè‰²ä¸­çš„ä¸€ç§ï¼Œä½¿å¾—è¿™ä¸‰ç§é¢œè‰²çš„ç‚¹çš„ä¸ªæ•°åˆ†åˆ«ä¸º a,b,ca,b,ca,b,cï¼Œä¸”æœ‰ä¸¤ç§é¢œè‰²çš„ç‚¹æ„æˆä¸¤ä¸ªè”ã€è¿é€šå—ã€‚å¯èƒ½æ— è§£ã€‚ æˆ‘ä»¬å…ˆè€ƒè™‘æˆ‘ä»¬è¿™ä¸¤ä¸ªè¿é€šå—çš„å¤§å°åº”è¯¥ä¸ºå¤šå°‘ã€‚æˆ‘ä»¬ä¸å¦¨ä»¤ aâ‰¤bâ‰¤ca\\le b\\le caâ‰¤bâ‰¤cï¼Œé‚£ä¹ˆæˆ‘ä»¬å‘ç°å…¶å®åªè¦è®© aaa å’Œ bbb æ˜¯è¿é€šå—å³å¯ã€‚å› ä¸ºå¦‚æœæ˜¯ ccc æ˜¯è¿é€šå—ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ˜¾ç„¶å¯ä»¥é€šè¿‡åˆ æ‰éƒ¨åˆ†èŠ‚ç‚¹çš„æ–¹å¼å°†å…¶çš„å¤§å°ç¼©å°ã€‚ è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼Œå¦‚æœè¿™æ˜¯ä¸€æ£µæ ‘çš„è¯ï¼Œé‚£ç®—æ³•å°±ç®€å•äº†ã€‚æˆ‘ä»¬è€ƒè™‘æšä¸¾ä¸€æ¡è¾¹ï¼Œå¦‚æœè¾¹ä¸¤è¾¹çš„ size åˆ†åˆ«å¤§äºäº† aaa å’Œ bbbï¼Œé‚£å°± YES äº†ã€‚å¦‚æœæ‰¾ä¸åˆ°çš„è¯ï¼Œé‚£æ˜¾ç„¶å°±æ˜¯ NOã€‚ ç„¶åæˆ‘ä»¬è€ƒè™‘å›¾çš„æƒ…å†µï¼Œå…¶å®å°±æ˜¯åœ¨è¿™æ£µæ ‘ä¸ŠåŠ äº†å‡ æ¡è¾¹ã€‚è€ƒè™‘åˆ°æˆ‘ä»¬è€ƒè™‘è¿™æ£µæ ‘æ˜¯è¿™å¼ æ— å‘å›¾çš„ dfs æ ‘ï¼Œè¿™æ ·è¿™äº›æ–°åŠ è¿›å»çš„è¾¹å°±ä¸€å®šæ˜¯è¿”ç¥–è¾¹ï¼Œè€Œä¸ä¼šå­˜åœ¨æ¨ªå‰è¾¹çš„æƒ…å†µã€‚æˆ‘ä»¬å…ˆå¿½ç•¥è¿™æ¡è¾¹ï¼Œå¦‚æœæ‰¾åˆ°äº†ä¸€è¾¹å¤§äº aaa ä¸€è¾¹å¤§äº bbbï¼Œé‚£ä¸€å®š YESã€‚æˆ‘ä»¬è€ƒè™‘æ‰¾ä¸åˆ°çš„æƒ…å†µï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥ç”¨é‚£å‡ æ¡è¿”ç¥–è¾¹è¿›è¡Œè°ƒæ•´ã€‚ä¸€ç§æ¯”è¾ƒç›´æ¥çš„è°ƒæ•´æ–¹æ³•æ˜¯ï¼Œè€ƒè™‘ xxx ä¸ fxf_xfxâ€‹ï¼ˆxxx çˆ¶äº²ï¼‰çš„é‚£æ¡è¾¹ï¼Œé‚£æˆ‘ä»¬å¯ä»¥å°† xxx å­æ ‘ä¸­ï¼Œå­˜åœ¨è¿”ç¥–è¾¹ä¸º xxx ç¥–å…ˆçš„é‚£äº›å­æ ‘åŠ å…¥åˆ° fxf_xfxâ€‹ æ‰€åœ¨çš„é‚£ä¸ªé›†åˆä¸­ã€‚ä¹Ÿå°±æ˜¯ç”¨å‡å°‘ xxx æ‰€åœ¨è¿é€šå—å¤§å°çš„ä»£ä»·æ¢å– fxf_xfxâ€‹ æ‰€åœ¨è¿é€šå—å¤§å°çš„å¢åŠ ã€‚è®©æˆ‘ä»¬è€ƒè™‘å¯¹äºä¸€ä¸ª xxxï¼Œä»¤ sxs_xsxâ€‹ è¡¨ç¤ºèŠ‚ç‚¹ xxx çš„å¤§å°ã€‚ç”±äºæˆ‘ä»¬è°ƒæ•´çš„ç›®çš„æ˜¯ä¸ºäº†è®© fxf_xfxâ€‹ æ‰€åœ¨è¿é€šå—æ›´å¤§ï¼Œæ‰€ä»¥æˆ‘ä»¬è€ƒè™‘è®© xxx æ‰€åœ¨è¿é€šå—ä¸ç»è¿‡è°ƒæ•´ä¸èƒ½å†å°äº†ï¼Œä¹Ÿå°±æ˜¯ sxâ‰¥as_x\\ge asxâ€‹â‰¥a ä½†å¯¹äº xxx çš„ä»»æ„ä¸€ä¸ªå„¿å­ tttï¼Œéƒ½æœ‰ st&lt;as_t&lt;astâ€‹&lt;aã€‚ç„¶åæˆ‘ä»¬è€ƒè™‘è¿›è¡Œè°ƒæ•´ã€‚æˆ‘ä»¬æœ€ç»ˆä¸€å®šèƒ½æ‰¾åˆ°ä¸€ä¸ªä¸´ç•Œï¼Œä¹Ÿå°±æ˜¯ä¸èƒ½ç»§ç»­è°ƒæ•´äº†ã€‚è¿™ä¸ªæ—¶å€™æœ‰ä¸¤ç§æƒ…å†µï¼Œç¬¬ä¸€ç§æƒ…å†µæ˜¯ï¼Œè™½ç„¶è¿˜æ˜¯æœ‰æœªåŠ å…¥ fxf_xfxâ€‹ æ‰€åœ¨è¿é€šå—çš„å­˜åœ¨ä¸ä¹‹æœ‰è¿”ç¥–è¾¹è”é€šçš„å­æ ‘ tttï¼Œä½†å¦‚æœåŠ å…¥è¯¥å­æ ‘ï¼Œé‚£ä¹ˆ xxx æ‰€åœ¨è¿é€šå—å¤§å°å°±å°äº aaa äº†ï¼Œè€ƒè™‘åˆ°æ­¤æ—¶ xxx æ‰€åœ¨è¿é€šå—å¤§å°ä¸º uuuï¼Œå­æ ‘ ttt å¤§å°ä¸º vvvï¼Œæˆ‘ä»¬æœ‰ {uâ‰¥auâˆ’v&lt;av&lt;a\\begin{cases}u\\ge a\\\\u - v &lt; a\\\\v &lt; a\\end{cases}â©âªâªâ¨âªâªâ§â€‹uâ‰¥auâˆ’v&lt;av&lt;aâ€‹ï¼Œä¹Ÿå³ aâ‰¤u&lt;2aa\\le u &lt; 2aaâ‰¤u&lt;2a é‚£ä¹ˆæˆ‘ä»¬è€ƒè™‘ fxf_xfxâ€‹ æ‰€åœ¨è¿é€šå—çš„å¤§å°ï¼šnâˆ’u=a+b+câˆ’u&gt;a+b+câˆ’2a=b+(câˆ’a)â‰¥bn-u=a+b+c-u&gt;a+b+c-2a=b+(c-a)\\ge bnâˆ’u=a+b+câˆ’u&gt;a+b+câˆ’2a=b+(câˆ’a)â‰¥bã€‚ä¹Ÿå°±æ˜¯è¯´è¿™ç§æƒ…å†µä¸€å®šæ˜¯ YES çš„ã€‚ç„¶åæˆ‘ä»¬è€ƒè™‘ç¬¬äºŒç§æƒ…å†µï¼Œå°±æ˜¯å·²ç»æ²¡æœ‰å­æ ‘æœ‰å¯ç”¨çš„è¿”ç¥–è¾¹äº†ï¼Œé‚£è¿™æ—¶å€™å¦‚æœ fxf_xfxâ€‹ æ‰€åœ¨è¿é€šå—å¤§å°ä»ç„¶å°äº bbb çš„è¯ï¼Œé‚£å¯¹äºè¿™ä¸ªç‚¹ï¼Œä¸€å®šæ˜¯ä¸å¯èƒ½çš„äº†ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬åªè¦ç»§ç»­è€ƒè™‘å…¶ä»–çš„åŒæ ·æ»¡è¶³ sxâ‰¥as_x\\ge asxâ€‹â‰¥a ä¸”å¯¹äº xxx çš„ä»»æ„å„¿å­ ttt éƒ½æœ‰ st&lt;as_t&lt;astâ€‹&lt;a çš„æ‰€æœ‰ xxx å³å¯ã€‚å¦‚æœéƒ½ä¸æ»¡è¶³æ¡ä»¶ï¼Œé‚£æ˜¾ç„¶ç­”æ¡ˆæ˜¯ NOã€‚è¿™æ ·å¤æ‚åº¦ O(n)\\mathcal{O}(n)O(n)ã€‚","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"æ„é€ ","slug":"æ„é€ ","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%9E%84%E9%80%A0/"},{"name":"å›¾è®º","slug":"å›¾è®º","permalink":"https://pufanyi.github.io/oi-blog/tags/%E5%9B%BE%E8%AE%BA/"}]},{"title":"CodeForces 1562F Tubular Bells","slug":"CF1562F","date":"2021-09-19T16:00:00.000Z","updated":"2023-12-25T16:08:27.873Z","comments":true,"path":"CF1562F/","link":"","permalink":"https://pufanyi.github.io/oi-blog/CF1562F/","excerpt":"å‘Šè¯‰ä½  nnnï¼Œè¦ä½ çŒœä¸€ä¸ªé•¿åº¦ä¸º nnn çš„æ­£æ•´æ•°åºåˆ— {ai}\\left\\{a_i\\right\\}{aiâ€‹}ï¼Œaia_iaiâ€‹ ä¸¤ä¸¤ä¸åŒï¼Œä¸”å­˜åœ¨ 0â‰¤lâ‰¤2Ã—105âˆ’n0\\le l\\le 2\\times 10^5-n0â‰¤lâ‰¤2Ã—105âˆ’n ä½¿å¾— aiâˆˆ(l,l+n]a_i\\in\\left(l,l+n\\right]aiâ€‹âˆˆ(l,l+n]ã€‚ æ¯æ¬¡ä½ å¯ä»¥å‘äº¤äº’åº“è¯¢é—® ? x yï¼ˆxâ‰ yx\\neq yxî€ =yï¼‰ï¼Œäº¤äº’åº“å‘ä½ è¿”å› lcm(ax,ay)\\mathrm{lcm}(a_x,a_y)lcm(axâ€‹,ayâ€‹)ã€‚è¯¢é—®æ¬¡æ•°ä¸º n+5000n+5000n+5000ï¼Œå…¶ä¸­ 3â‰¤nâ‰¤1053\\le n\\le 10^53â‰¤nâ‰¤105ã€‚","text":"å‘Šè¯‰ä½  nnnï¼Œè¦ä½ çŒœä¸€ä¸ªé•¿åº¦ä¸º nnn çš„æ­£æ•´æ•°åºåˆ— {ai}\\left\\{a_i\\right\\}{aiâ€‹}ï¼Œaia_iaiâ€‹ ä¸¤ä¸¤ä¸åŒï¼Œä¸”å­˜åœ¨ 0â‰¤lâ‰¤2Ã—105âˆ’n0\\le l\\le 2\\times 10^5-n0â‰¤lâ‰¤2Ã—105âˆ’n ä½¿å¾— aiâˆˆ(l,l+n]a_i\\in\\left(l,l+n\\right]aiâ€‹âˆˆ(l,l+n]ã€‚ æ¯æ¬¡ä½ å¯ä»¥å‘äº¤äº’åº“è¯¢é—® ? x yï¼ˆxâ‰ yx\\neq yxî€ =yï¼‰ï¼Œäº¤äº’åº“å‘ä½ è¿”å› lcm(ax,ay)\\mathrm{lcm}(a_x,a_y)lcm(axâ€‹,ayâ€‹)ã€‚è¯¢é—®æ¬¡æ•°ä¸º n+5000n+5000n+5000ï¼Œå…¶ä¸­ 3â‰¤nâ‰¤1053\\le n\\le 10^53â‰¤nâ‰¤105ã€‚ æˆ‘ä»¬å…ˆè€ƒè™‘ nnn æ¯”è¾ƒå°çš„æƒ…å†µï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥è€ƒè™‘åˆ°æˆ‘ä»¬æœ‰é‚£ä¸ª 500050005000ï¼Œæˆ‘ä»¬è€ƒè™‘ n2n^2n2 æ¬¡è¯¢é—®ã€‚æˆ‘ä»¬è€ƒè™‘åˆ©ç”¨ä¸€ä¸ªæŸ¿å­ï¼Œä¹Ÿå°±æ˜¯å½“ gcdâ¡(x,y)=1\\gcd(x,y)=1gcd(x,y)=1 æ—¶ï¼Œgcdâ¡(lcm(x,z),lcm(y,z))=gcdâ¡(xzgcdâ¡(x,z),yzgcdâ¡(y,z))=zâ‹…gcdâ¡(xgcdâ¡(x,z),ygcdâ¡(y,z))=z\\gcd(\\mathrm{lcm}(x,z),\\mathrm{lcm}(y,z))=\\gcd(\\frac{xz}{\\gcd(x,z)},\\frac{yz}{\\gcd(y,z)})=z\\cdot\\gcd(\\frac{x}{\\gcd(x,z)},\\frac{y}{\\gcd(y,z)})=zgcd(lcm(x,z),lcm(y,z))=gcd(gcd(x,z)xzâ€‹,gcd(y,z)yzâ€‹)=zâ‹…gcd(gcd(x,z)xâ€‹,gcd(y,z)yâ€‹)=zï¼Œä¸”æœ‰ âˆ€x,yâˆˆN+\\forall x,y\\in \\N_+âˆ€x,yâˆˆN+â€‹ï¼Œzâˆ£gcdâ¡(lcm(x,z),lcm(y,z))z\\mid\\gcd(\\mathrm{lcm}(x,z),\\mathrm{lcm}(y,z))zâˆ£gcd(lcm(x,z),lcm(y,z))ã€‚åˆ âˆ€nâˆˆN+\\forall n\\in \\N_+âˆ€nâˆˆN+â€‹ï¼Œgcdâ¡(n,n+1)=1\\gcd(n,n+1)=1gcd(n,n+1)=1ã€‚æ•…å½“ n=4n=4n=4 æ—¶ï¼Œæˆ‘ä»¬åªè¦ä»¤ ai=gcdâ¡jâ‰ ilcm(ai,aj)a_i=\\gcd_{j\\neq i}\\mathrm{lcm}(a_i,a_j)aiâ€‹=gcdjî€ =iâ€‹lcm(aiâ€‹,ajâ€‹) å³å¯ã€‚è€Œå½“ n=3n=3n=3 æ—¶ï¼Œæˆ‘ä»¬å‘ç°æœ€å¤§çš„é‚£ä¸ªè¯¢é—®ç»“æœå…¶å®æ˜¯ä¸¤ä¸ªæœ€å¤§çš„ç›¸ä¹˜ï¼Œä¹Ÿå³æœ€å°å€¼ä¸º âŒŠæŸ¥è¯¢å¾—åˆ°çš„æœ€å¤§å€¼ âŒ‹âˆ’1\\left\\lfloor\\sqrt{\\text{æŸ¥è¯¢å¾—åˆ°çš„æœ€å¤§å€¼}}\\right\\rfloor-1âŒŠ æŸ¥è¯¢å¾—åˆ°çš„æœ€å¤§å€¼â€‹âŒ‹âˆ’1ï¼Œä¸”æœ€å°å€¼çš„é‚£ä¸ªä½ç½®ç¡®å®šäº†ï¼Œç„¶åå¦å¤–ä¸¤ä¸ªç›´æ¥ä¸æœ€å°å€¼å– lcm\\mathrm{lcm}lcm ä¹‹åå¯¹æ¯”ä¸€ä¸‹å°±ä¹Ÿç¡®å®šäº†ã€‚ è¿™ç§æƒ…å†µä¸‹ï¼Œè¯¢é—®æ¬¡æ•°æ˜¯ nâ‹…(nâˆ’1)2\\frac{n\\cdot(n-1)}{2}2nâ‹…(nâˆ’1)â€‹ï¼Œè€Œ nâ‹…(nâˆ’1)2â‰¤5000+n\\frac{n\\cdot(n-1)}{2}\\le 5000 + n2nâ‹…(nâˆ’1)â€‹â‰¤5000+n æ­£å¥½è§£å¾— nâ‰¤100n\\le 100nâ‰¤100ã€‚ è¿™æ ·æˆ‘ä»¬å°±è§£å†³äº† nâ‰¤100n\\le 100nâ‰¤100 çš„æƒ…å†µï¼Œæˆ‘ä»¬è€ƒè™‘ nnn æ›´å¤§çš„æ—¶å€™ã€‚é¦–å…ˆæˆ‘ä»¬ä¼šè€ƒè™‘åˆ°æˆ‘ä»¬èƒ½å¦æ‰¾åˆ°ä¸€ä¸ªç´ æ•° pppï¼Œä¸”è¿™ä¸ªç´ æ•°èƒ½å°½é‡å¤§ï¼Œæœ€å¥½èƒ½ä¿è¯ lcm(p,ai)=pâ‹…ai\\mathrm{lcm}(p,a_i)=p\\cdot a_ilcm(p,aiâ€‹)=pâ‹…aiâ€‹ã€‚æˆ‘ä»¬è€ƒè™‘èƒ½å¦æ‰¾åˆ° pâ‰¥n2p\\ge \\frac{n}{2}pâ‰¥2nâ€‹ï¼Œè¿™æ ·çš„è¯é™¤äº†æœ‰ä¸€ä¸ª ai=2pa_i=2paiâ€‹=2p å¯èƒ½ä¼šå­˜åœ¨ lcm(p,ai)=2p\\mathrm{lcm}(p,a_i)=2plcm(p,aiâ€‹)=2pã€‚ä¹‹å¤–ï¼Œå…¶ä½™çš„ aia_iaiâ€‹ éƒ½èƒ½ç›´æ¥ä½¿ç”¨ ai=lcm(p,ai)pa_i=\\frac{\\mathrm{lcm}(p,a_i)}{p}aiâ€‹=plcm(p,aiâ€‹)â€‹ å¾—åˆ°ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥å…ˆæŠŠé™¤äº† lcm\\mathrm{lcm}lcm ä¸º 2p2p2p çš„ä½ç½®ç•™ä¸‹ï¼Œå…¶ä½™ä½ç½®æŸ¥è¯¢ä¹‹åï¼Œæ¢ä¸€ä¸ªä¸æ˜¯ 222 çš„ç´ æ•°åˆ¤æ–­é‚£ä¸ªä½ç½®æ˜¯ 222 è¿˜æ˜¯ 2p2p2pã€‚æˆ‘ä»¬è€ƒè™‘æ—¶å€™æœ‰è¿™æ ·çš„ä¸¤ä¸ªç´ æ•°ï¼Œå¤§æ¦‚ä¼°è®¡ Ï€(n))=nlnâ¡n\\pi(n))=\\frac{n}{\\ln n}Ï€(n))=lnnnâ€‹ï¼Œå½“ nnn è¾ƒå¤§çš„æ—¶å€™ç´ æ•°å¯†åº¦æ˜¯è¶Šæ¥è¶Šç–çš„ã€‚è€Œ Ï€(105)âˆ’Ï€(105âˆ’100)=7.93\\pi(10^5)-\\pi(10^5-100)=7.93Ï€(105)âˆ’Ï€(105âˆ’100)=7.93ï¼Œä¹Ÿå°±æ˜¯è¯´åº”è¯¥æ˜¯è¶³å¤Ÿçš„ï¼Œè€Œäº‹å®è¯æ˜å½“ nâ‰¥100n\\ge 100nâ‰¥100 çš„æ—¶å€™ç¡®å®æ˜¯è¶³å¤Ÿçš„ã€‚ ç„¶åæˆ‘ä»¬è€ƒè™‘æ€ä¹ˆæ‰¾ç´ æ•°ï¼Œæˆ‘ä»¬è€ƒè™‘éšæœºæ‰¾ä¸€äº›ä½ç½®å¹¶å°è¯•å°†å…¶ç¡®å®šä¸‹æ¥ã€‚æˆ‘ä»¬å…ˆå¤§æ¦‚çœ‹çœ‹åº”è¯¥éœ€è¦æ‰¾å¤šå°‘ä¸ªä½ç½®ï¼Œæˆ‘ä»¬è€ƒè™‘ç”±äºç´ æ•°å¯†åº¦è¶Šæ¥è¶Šç–ï¼Œæˆ‘ä»¬å°±å½“æ˜¯æœ€å¤§å€¼æ˜¯ 10510^5105ï¼Œäºæ˜¯ç´ æ•°å¯†åº¦ä¸º Ï(n)=Ï€(105)âˆ’Ï€(105âˆ’n)n\\rho(n)=\\frac{\\pi(10^5)-\\pi(10^5-n)}{n}Ï(n)=nÏ€(105)âˆ’Ï€(105âˆ’n)â€‹ï¼Œè€ƒè™‘åˆ°è¶Šå¾€é‡Œç´ æ•°è¶Šå¯†ï¼Œæˆ‘ä»¬ä»ç„¶è®¤ä¸ºé€‰åˆ°ç´ æ•°çš„æ¦‚ç‡æœ€å°å€¼ä¸º Ï(100)=0.08\\rho(100)=0.08Ï(100)=0.08ï¼Œå…¶å®å‘ç°è¿˜æ˜¯æŒºå¤§çš„ã€‚ç„¶åæˆ‘ä»¬è€ƒè™‘å¦‚ä½•ç¡®å®šä¸€ä¸ªæ•°ï¼Œæˆ‘ä»¬ä»ç„¶ç”¨ä¸Šé¢ n2n^2n2 æš´åŠ›çš„æ€è·¯ï¼Œæˆ‘ä»¬è€ƒè™‘æ‰€éšæœºå‡ ä¸ªæ•°ä¸è¦ç¡®å®šçš„è¿™ä¸ªæ•°è¿›è¡Œ lcm\\mathrm{lcm}lcmï¼Œæˆ‘ä»¬è€ƒè™‘éšæœºä¸¤ä¸ªæ•°çš„ç´ æ•°æ¦‚ç‡ä¸ºå¤šå¤§ï¼Œæˆ‘ä»¬ä»¤æ¦‚ç‡ä¸º P\\mathcal{P}Pï¼Œé‚£ä¹ˆæˆ‘ä»¬å‘ç°å¦‚æœéšæœºä¸¤ä¸ªæ•° gcdâ¡\\gcdgcd ä¸º i (iâ‰¥2,iâˆˆN+)i\\,(i\\ge 2,i\\in\\N_+)i(iâ‰¥2,iâˆˆN+â€‹) çš„æ¦‚ç‡ä¸º Pi2\\frac{\\mathcal{P}}{i^2}i2Pâ€‹ï¼Œä¹Ÿå°±æ˜¯è¦åœ¨ ni\\frac{n}{i}inâ€‹ çš„ç©ºé—´é‡Œæ‰¾åˆ°çš„ gcdâ¡\\gcdgcd ä¸º 111 çš„æ–¹æ¡ˆç„¶åæŠŠåŒºé—´æ‹‰é•¿ iii å€ï¼Œç”±äºæ˜¯ä¸¤ä¸ªæ•°æ‰€ä»¥é™¤äº† i2i^2i2ã€‚äºæ˜¯æˆ‘ä»¬æœ‰ P=1âˆ’âˆ‘i=lrPi2\\mathcal{P}=1-\\sum_{i=l}^r\\frac{\\mathcal{P}}{i^2}P=1âˆ’âˆ‘i=lrâ€‹i2Pâ€‹ä¹Ÿå³ P=11+âˆ‘i=lr1i2\\mathcal{P}=\\frac{1}{1+\\sum_{i=l}^r\\frac{1}{i^2}}P=1+âˆ‘i=lrâ€‹i21â€‹1â€‹ï¼ŒæœŸæœ›å°è¯• 1+âˆ‘i=lr1i21+\\sum_{i=l}^r\\frac{1}{i^2}1+âˆ‘i=lrâ€‹i21â€‹ æ¬¡ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„æ•°ã€‚è€Œæˆ‘ä»¬åˆè€ƒè™‘ç”Ÿæ—¥æ‚–è®ºï¼Œå› ä¸ºæˆ‘ä»¬æ˜¯éšæœºæŠ½å–å¤šä¸ªæ•°å­—ï¼Œç„¶ååªè¦æœ‰å…¶ä¸­ä¸¤ä¸ª gcdâ¡\\gcdgcd ä¸º 111 å³å¯ï¼Œæ‰€ä»¥ç†è®ºä¸Šå³ä½¿æ˜¯éæ´²é…‹é•¿ä¹Ÿåº”è¯¥æ˜¯èƒ½è¿‡çš„ã€‚ ç”±äºé™„èµ äº† 500050005000 æ¬¡è¯¢é—®æ¬¡æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬è€ƒè™‘é€‰ 249249249 ä¸ªæ•°ï¼Œæ¯ä¸ªæ•°æŠ½ 202020 ä¸ªæ•°ä¸ä¹‹ lcm\\mathrm{lcm}lcm ä¹‹åæ±‚ gcdâ¡\\gcdgcdã€‚å‰©ä¸‹çš„ 202020 æ¬¡å…¶å®æ˜¯ç»™å‰é¢è¯´çš„é‚£ä¸ª 2p2p2p çš„ç‰¹æ®Šæƒ…å†µç•™çš„ã€‚ç„¶åæœ€åæˆ‘ä»¬ä¸€é O(n)\\mathcal{O}(n)O(n) è¯¢é—®å³å¯ã€‚ ç”±äºäº¤äº’é¢˜å†™äº†å¾ˆå¤šè°ƒè¯•è¯­å¥æ‰€ä»¥ä»£ç å¯èƒ½æœ‰ç‚¹å°é•¿ qaq 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199typedef long long LL; int n; LL ask(int x, int y) &#123; assert(1 &lt;= x &amp;&amp; x &lt;= n &amp;&amp; 1 &lt;= y &amp;&amp; y &lt;= n); std::cout &lt;&lt; &quot;? &quot; &lt;&lt; x &lt;&lt; &#x27; &#x27; &lt;&lt; y &lt;&lt; std::endl; std::cout.flush(); LL ans; std::cin &gt;&gt; ans; return ans;&#125; namespace solve_small &#123; const int maxn = 105; LL lcm[maxn][maxn]; void solve() &#123; memset(lcm, 0, sizeof(lcm)); for (int i = 1; i &lt;= n; ++i) &#123; for (int j = 1; j &lt; i; ++j) &#123; lcm[i][j] = lcm[j][i] = ask(i, j); &#125; &#125; std::pair&lt;int, int&gt; idans(0, 0); if (n == 3) &#123; for (int i = 1; i &lt;= n; ++i) &#123; for (int j = 1; j &lt; i; ++j) &#123; if (lcm[i][j] &gt; lcm[idans.first][idans.second]) &#123; idans = std::make_pair(i, j); &#125; &#125; &#125; std::vector&lt;int&gt; ANS(4); ANS[idans.first] = sqrt(lcm[idans.first][idans.second]); ANS[idans.second] = ANS[idans.first] + 1; ANS[6 - idans.first - idans.second] = ANS[idans.first] - 1; if ((LL) ANS[idans.first] * ANS[6 - idans.first - idans.second] / std::__gcd(ANS[idans.first], ANS[6 - idans.first - idans.second]) != lcm[idans.first][6 - idans.first - idans.second]) &#123; std::swap(ANS[idans.first], ANS[idans.second]); &#125; std::cout &lt;&lt; &quot;! &quot;; for (int i = 1; i &lt;= 3; ++i) &#123; std::cout &lt;&lt; ANS[i] &lt;&lt; &#x27; &#x27;; &#125; std::cout &lt;&lt; std::endl; std::cout.flush(); &#125; else &#123; for (int i = 1; i &lt;= n; ++i) &#123; for (int j = 1; j &lt;= n; ++j) &#123; lcm[i][i] = std::__gcd(lcm[i][i], lcm[i][j]); &#125; &#125; std::cout &lt;&lt; &quot;! &quot;; for (int i = 1; i &lt;= n; ++i) &#123; std::cout &lt;&lt; lcm[i][i] &lt;&lt; &#x27; &#x27;; &#125; std::cout &lt;&lt; std::endl; std::cout.flush(); &#125; &#125;&#125; namespace solve_large &#123; struct debug &#123; int n; std::vector&lt;int&gt; alb; LL ask(int x, int y) &#123; return (LL) alb[x - 1] * alb[y - 1] / std::__gcd(alb[x - 1], alb[y - 1]); &#125; debug() &#123; std::ifstream fin(&quot;a.in&quot;); fin &gt;&gt; n; for (int i = 1; i &lt;= n; ++i) &#123; int xx; fin &gt;&gt; xx; alb.push_back(xx); &#125; &#125; &#125; deb; #ifdef Debug #define ask(x, y) deb.ask(x, y) #endif const int maxn = 200005; LL ans[maxn]; int np[maxn]; std::mt19937 rnd(20030211u); void Euler(const int n = 200000) &#123; std::vector&lt;int&gt; prime; prime.clear(); for (int i = 2; i &lt;= n; ++i) &#123; if (!np[i]) &#123; prime.push_back(i); &#125; for (unsigned j = 0; j &lt; prime.size() &amp;&amp; (LL) i * prime[j] &lt;= n; ++j) &#123; np[i * prime[j]] = true; if (!(i % prime[j])) &#123; break; &#125; &#125; &#125; &#125; void solve() &#123; std::vector&lt;int&gt; id; id.clear(); for (int i = 1; i &lt;= n; ++i) &#123; ans[i] = 0; id.push_back(i); &#125; std::shuffle(id.begin(), id.end(), rnd); int qd = 0; for (int i = 1; i &lt;= 249 &amp;&amp; i &lt;= n; ++i) &#123; qd = id[i - 1]; for (int j = 1; j &lt;= 20; ++j) &#123; int wz = rnd() % n + 1; while (wz == qd) &#123; wz = rnd() % n + 1; &#125; ans[qd] = std::__gcd(ask(qd, wz), ans[qd]); if (ans[qd] &lt;= 200000 &amp;&amp; ans[qd] &amp;&amp; !np[ans[qd]]) &#123; break; &#125; &#125; if (ans[qd] &amp;&amp; !np[ans[qd]] &amp;&amp; ((ans[qd] &lt;&lt; 1) &gt; n)) &#123; break; &#125; &#125; assert(ans[qd] &lt;= 200000 &amp;&amp; ans[qd] &amp;&amp; !np[ans[qd]] &amp;&amp; ((ans[qd] &lt;&lt; 1) &gt; n)); for (int i = 1; i &lt;= n; ++i) &#123; if (!ans[i]) &#123; ans[i] = ask(i, qd) / ans[qd]; &#125; &#125; LL mx = 0; int idd = 0; for (int i = 1; i &lt;= n; ++i) &#123; if (!np[ans[i]] &amp;&amp; ans[i] &gt;= mx) &#123; mx = ans[i]; idd = i; &#125; &#125; for (int i = 1; i &lt;= n; ++i) &#123; if (ans[i] == 2) &#123; ans[i] = ask(i, idd) / mx; &#125; &#125; #ifndef Debug std::cout &lt;&lt; &quot;! &quot;; #endif for (int i = 1; i &lt;= n; ++i) &#123; std::cout &lt;&lt; ans[i] &lt;&lt; &#x27; &#x27;; &#125; std::cout &lt;&lt; std::endl; std::cout.flush(); &#125; #ifdef Debug #undef ask(x, y) deb.ask(x, y) #endif&#125; void solve() &#123; #ifndef Debug std::cin &gt;&gt; n; #else n = solve_large::deb.n; freopen(&quot;a.out&quot;, &quot;w&quot;, stdout); std::cout &lt;&lt; n &lt;&lt; std::endl; #endif if (n &lt;= 100) &#123; solve_small::solve(); &#125; else &#123; solve_large::solve(); &#125;&#125; int main() &#123; solve_large::Euler(); int T; #ifndef Debug std::cin &gt;&gt; T; #else T = 1; #endif while (T--) &#123; solve(); &#125; return 0;&#125;","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"æ•°å­¦","slug":"æ•°å­¦","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%95%B0%E5%AD%A6/"},{"name":"CodeForces","slug":"CodeForces","permalink":"https://pufanyi.github.io/oi-blog/tags/CodeForces/"},{"name":"æ•°è®º","slug":"æ•°è®º","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%95%B0%E8%AE%BA/"},{"name":"äº¤äº’é¢˜","slug":"äº¤äº’é¢˜","permalink":"https://pufanyi.github.io/oi-blog/tags/%E4%BA%A4%E4%BA%92%E9%A2%98/"}]},{"title":"CodeForces 1556C Compressed Bracket Sequence","slug":"CF1556C","date":"2021-08-30T16:00:00.000Z","updated":"2023-12-25T16:08:27.873Z","comments":true,"path":"CF1556C/","link":"","permalink":"https://pufanyi.github.io/oi-blog/CF1556C/","excerpt":"ç»™ä¸€ä¸ªé•¿åº¦ä¸º n (1â‰¤nâ‰¤1000)n\\,(1\\le n\\le 1000)n(1â‰¤nâ‰¤1000) çš„æ­£æ•´æ•°åºåˆ— {cn} (1â‰¤ciâ‰¤109)\\left\\{c_n\\right\\}\\,(1\\le c_i\\le 10^9){cnâ€‹}(1â‰¤ciâ€‹â‰¤109)ã€‚ç”¨è¯¥åºåˆ—ä¸€å¦‚ä¸‹æ–¹å¼æ„é€ ä¸€ä¸ªæ‹¬å·åºåˆ— sssï¼š å¼€å§‹ ccc ä¸ºç©ºï¼› å¯¹ iii ä» 111 åˆ° nnn ä¾æ¬¡éå†ï¼Œè‹¥ iii ä¸ºå¥‡æ•°ï¼Œåˆ™åœ¨ sss åæ’å…¥ cic_iciâ€‹ ä¸ª '('ï¼Œå¦åˆ™æ’å…¥ cic_iciâ€‹ ä¸ª ')'ã€‚ æ±‚æœ‰å¤šå°‘å¯¹ &lt;l,r&gt;\\left&lt;l,r\\right&gt;âŸ¨l,râŸ© ä½¿å¾— slâˆ¼rs_{l\\sim r}slâˆ¼râ€‹ ä¸ºåˆæ³•æ‹¬å·åºåˆ—ã€‚","text":"ç»™ä¸€ä¸ªé•¿åº¦ä¸º n (1â‰¤nâ‰¤1000)n\\,(1\\le n\\le 1000)n(1â‰¤nâ‰¤1000) çš„æ­£æ•´æ•°åºåˆ— {cn} (1â‰¤ciâ‰¤109)\\left\\{c_n\\right\\}\\,(1\\le c_i\\le 10^9){cnâ€‹}(1â‰¤ciâ€‹â‰¤109)ã€‚ç”¨è¯¥åºåˆ—ä¸€å¦‚ä¸‹æ–¹å¼æ„é€ ä¸€ä¸ªæ‹¬å·åºåˆ— sssï¼š å¼€å§‹ ccc ä¸ºç©ºï¼› å¯¹ iii ä» 111 åˆ° nnn ä¾æ¬¡éå†ï¼Œè‹¥ iii ä¸ºå¥‡æ•°ï¼Œåˆ™åœ¨ sss åæ’å…¥ cic_iciâ€‹ ä¸ª '('ï¼Œå¦åˆ™æ’å…¥ cic_iciâ€‹ ä¸ª ')'ã€‚ æ±‚æœ‰å¤šå°‘å¯¹ &lt;l,r&gt;\\left&lt;l,r\\right&gt;âŸ¨l,râŸ© ä½¿å¾— slâˆ¼rs_{l\\sim r}slâˆ¼râ€‹ ä¸ºåˆæ³•æ‹¬å·åºåˆ—ã€‚ æ•´ä¸€ä¸ª O(n)\\mathcal{O}(n)O(n) çš„é¢˜è§£å§ã€‚ æˆ‘ä»¬åˆ†ä¸¤ç§æƒ…å†µè€ƒè™‘åˆæ³•çš„æ‹¬å·åºåˆ—ï¼š å»æ‰æœ€å·¦è¾¹çš„ '(' å’Œæœ€å³è¾¹çš„ ')' ä»æ˜¯åˆæ³•æ‹¬å·åºåˆ—çš„å­—ç¬¦ä¸²ï¼ˆå‡è®¾ç©ºä¸²ä¹Ÿåˆæ³•ï¼‰ï¼Œæ¯”å¦‚ (()()((())))ï¼› å»æ‰æœ€å·¦è¾¹çš„ '(' å’Œæœ€å³è¾¹çš„ ')' ä¸æ˜¯åˆæ³•æ‹¬å·åºåˆ—çš„å­—ç¬¦ä¸²ï¼Œæ¯”å¦‚ ()((())())ã€‚ æˆ‘ä»¬å¯ä»¥å®šä¹‰ç¬¬ä¸€ç§æ‹¬å·åºåˆ—æ˜¯â€œç‹¬ç«‹çš„â€ï¼Œä¹Ÿå°±æ˜¯è¯´å¥¹ä¸èƒ½è¢«åˆ†è£‚æˆä¸¤ä¸ªåˆæ³•æ‹¬å·ä¸²ï¼›è€Œç¬¬äºŒç§æ‹¬å·åºåˆ—æ˜¯â€œä¸ç‹¬ç«‹çš„â€ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¥¹èƒ½è¢«åˆ†è£‚æˆä¸¤ä¸ªåˆæ³•çš„æ‹¬å·ä¸²ã€‚ æˆ‘ä»¬è€ƒè™‘æŠŠä¸¤ç§å­—ç¬¦ä¸²åˆ†å¼€è€ƒè™‘ã€‚å¾ˆæ˜¾ç„¶ï¼Œæ¯ä¸ª ')'ï¼Œåªèƒ½ä½œä¸ºä¸€ä¸ªç‹¬ç«‹æ‹¬å·ä¸²çš„å³ç«¯ç‚¹ï¼Œæ‰€ä»¥æˆ‘ä»¬ç»Ÿè®¡è¿™éƒ¨åˆ†æ˜¯éå¸¸å®¹æ˜“çš„ï¼šè·‘ä¸€éæ ˆï¼Œå’Œå¹³æ—¶ä¸€æ ·ï¼Œåªæ˜¯æ‰¹é‡åœ°å‹æ ˆå’Œå¼¹æ ˆï¼Œè®°å½•å¼¹å‡ºçš„ '(' æ¬¡æ•°ï¼Œå³æ˜¯è¿™éƒ¨åˆ†çš„ç­”æ¡ˆã€‚ å¯¹äºéç‹¬ç«‹çš„æƒ…å†µï¼Œæˆ‘ä»¬è€ƒè™‘åœ¨è®¡ç®—ç‹¬ç«‹ä¸²çš„æ—¶å€™åŒæ—¶ç»Ÿè®¡ä»–ä»¬ï¼Œä¸éš¾å‘ç°åœ¨å¯¹äºä¸€ä¸ªç‹¬ç«‹ä¸²ï¼Œå°†æ­¤ä¸²ä½œä¸ºçœŸåç¼€çš„éç‹¬ç«‹ä¸²ä¸ªæ•°å³ä½¿ä»–å·¦è¾¹çš„è¿ç»­ç‹¬ç«‹ä¸²ä¸ªæ•°å³å¯ï¼Œå¹¶ä¸”æˆ‘ä»¬åªè¦å‘ç°å‡ºç° )( çš„æ—¶å€™æ‰ä¼šæœ‰éç‹¬ç«‹ä¸²å‡ºç°ï¼Œæˆ‘ä»¬è€ƒè™‘åœ¨æ ˆä¸­åŠ æ ‡è®°ï¼Œè®°å½•ä¸€ä¸‹å‡ºç° )( çš„æ—¶å€™å…¶å·¦è¾¹è¿ç»­ç‹¬ç«‹ä¸²çš„ä¸ªæ•°å³å¯ã€‚ å…·ä½“å®ç°çš„è¯ï¼Œæˆ‘ä»¬å¼€ä¸€ä¸ªæ ˆï¼Œæ ˆä¸­å‹å…¥ pairï¼Œ&lt;x,1&gt;\\left&lt;x,1\\right&gt;âŸ¨x,1âŸ© è¡¨ç¤ºæœ‰ xxx ä¸ªè¿ç»­çš„ '('ï¼Œ&lt;x,0&gt;\\left&lt;x,0\\right&gt;âŸ¨x,0âŸ© è¡¨ç¤ºè¿™é‡Œå‡ºç°äº†ä¸€ä¸ª )(ï¼Œè¿™ä¸ª )( å·¦è¾¹è¿˜æœ‰å‡ ä¸ªè¿ç»­çš„ç‹¬ç«‹ä¸²ã€‚å‹å…¥å°±ç›´æ¥å‹è¿ç»­çš„ '(' å³å¯ï¼Œè€Œå¼¹æ ˆçš„æ—¶å€™é‡åˆ° &lt;x,1&gt;\\left&lt;x,1\\right&gt;âŸ¨x,1âŸ©ï¼Œå°±ç»Ÿè®¡ç‹¬ç«‹ä¸²ï¼Œé‡åˆ° &lt;x,0&gt;\\left&lt;x,0\\right&gt;âŸ¨x,0âŸ© å°±ç»Ÿè®¡ä¸€ä¸‹éç‹¬ç«‹ä¸²ã€‚ è€ƒè™‘åˆ°å¤§éƒ¨åˆ†é€‰æ‰‹åº”è¯¥éƒ½ä¸æ˜¯å¾ˆç†Ÿæ‚‰ pythonï¼ŒçªæŠŠä»£ç åšäº†å°½é‡è¯¦ç»†çš„æ³¨é‡Šï¼Œåº”è¯¥å·®ä¸å¤šèƒ½çœ‹æ‡‚äº† qaqã€‚ 1234567891011121314151617181920212223242526272829303132333435n = int(input())aa = list(map(int, input().split())) # è¯»å…¥æ•°ç»„ ans = 0stk = [] # æ ˆ for i in range(n): # [0, n) if not stk: # æ ˆéç©º stk.append([0, 1]) # push if i &amp; 1: while aa[i] and stk: if stk[-1][1] == 0: stk.pop() if stk: now = stk.pop() sub = min(now[0], aa[i]) aa[i] -= sub now[0] -= sub ans += sub if now[0]: stk.append(now) if stk and stk[-1][1] == 0: ans += stk[-1][0] if aa[i]: stk.append([0, 1]) else: if not stk: stk.append([0, 0]) if stk[-1][1] == 0: stk[-1][0] += 1 else: stk.append([1, 0]) else: if stk[-1][1] == 0: stk.append([0, 1]) stk[-1][0] += aa[i]print(ans)","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"CodeForces","slug":"CodeForces","permalink":"https://pufanyi.github.io/oi-blog/tags/CodeForces/"}]},{"title":"CodeForces 1562D Two Hundred Twenty One","slug":"CF1562D","date":"2021-08-27T16:00:00.000Z","updated":"2023-12-25T16:08:27.873Z","comments":true,"path":"CF1562D/","link":"","permalink":"https://pufanyi.github.io/oi-blog/CF1562D/","excerpt":"ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º nnn çš„å­—ç¬¦ä¸²è¡¨ç¤ºä¸€ä¸ªåºåˆ— aia_iaiâ€‹ï¼Œå­—ç¬¦ä¸²ä¸­åªæœ‰ '+'ã€'-'ï¼Œç¬¬ iii ä¸ªå­—ç¬¦ä¸º '+' è¡¨ç¤º ai=1a_i = 1aiâ€‹=1ï¼Œä¸º '-' è¡¨ç¤º ai=âˆ’1a_i = -1aiâ€‹=âˆ’1ã€‚qqq ç»„è¯¢é—®ï¼Œæ¯ç»„è¯¢é—®ç»™å®šä¸¤ä¸ªæ•´æ•° l,r (1â‰¤lâ‰¤râ‰¤n)l, r\\,(1\\le l\\le r\\le n)l,r(1â‰¤lâ‰¤râ‰¤n)ï¼Œå°† alâˆ¼ra_{l\\sim r}alâˆ¼râ€‹ å•ç‹¬å–å‡ºåï¼Œæ±‚æœ€å°‘åˆ é™¤å¤šå°‘ä¸ªæ•°å­—ï¼Œä½¿å¾—æ‰€æˆé•¿åº¦ä¸º mmm çš„åºåˆ— {bi}\\left\\{b_{i}\\right\\}{biâ€‹} æ»¡è¶³ âˆ‘i=1m(âˆ’1)iâˆ’1bi=0\\sum_{i=1}^m(-1)^{i-1}b_i=0âˆ‘i=1mâ€‹(âˆ’1)iâˆ’1biâ€‹=0ã€‚ D1 ä»…è¦æ±‚å‡ºæœ€å°‘åˆ é™¤å¤šå°‘ä¸ªæ•°å­—ï¼ŒD2 éœ€è¦æ±‚å‡ºåˆ é™¤å“ªäº›æ•°å­—ï¼ˆå¤šè§£è¾“å‡ºä»»æ„ä¸€ç»„å³å¯ï¼‰ã€‚ TTT ç»„æ•°æ®ï¼Œ1â‰¤Tâ‰¤103,1â‰¤n,qâ‰¤3â‹…1051\\le T\\le 10^3, 1\\le n, q\\le 3\\cdot 10^51â‰¤Tâ‰¤103,1â‰¤n,qâ‰¤3â‹…105ã€‚","text":"ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º nnn çš„å­—ç¬¦ä¸²è¡¨ç¤ºä¸€ä¸ªåºåˆ— aia_iaiâ€‹ï¼Œå­—ç¬¦ä¸²ä¸­åªæœ‰ '+'ã€'-'ï¼Œç¬¬ iii ä¸ªå­—ç¬¦ä¸º '+' è¡¨ç¤º ai=1a_i = 1aiâ€‹=1ï¼Œä¸º '-' è¡¨ç¤º ai=âˆ’1a_i = -1aiâ€‹=âˆ’1ã€‚qqq ç»„è¯¢é—®ï¼Œæ¯ç»„è¯¢é—®ç»™å®šä¸¤ä¸ªæ•´æ•° l,r (1â‰¤lâ‰¤râ‰¤n)l, r\\,(1\\le l\\le r\\le n)l,r(1â‰¤lâ‰¤râ‰¤n)ï¼Œå°† alâˆ¼ra_{l\\sim r}alâˆ¼râ€‹ å•ç‹¬å–å‡ºåï¼Œæ±‚æœ€å°‘åˆ é™¤å¤šå°‘ä¸ªæ•°å­—ï¼Œä½¿å¾—æ‰€æˆé•¿åº¦ä¸º mmm çš„åºåˆ— {bi}\\left\\{b_{i}\\right\\}{biâ€‹} æ»¡è¶³ âˆ‘i=1m(âˆ’1)iâˆ’1bi=0\\sum_{i=1}^m(-1)^{i-1}b_i=0âˆ‘i=1mâ€‹(âˆ’1)iâˆ’1biâ€‹=0ã€‚ D1 ä»…è¦æ±‚å‡ºæœ€å°‘åˆ é™¤å¤šå°‘ä¸ªæ•°å­—ï¼ŒD2 éœ€è¦æ±‚å‡ºåˆ é™¤å“ªäº›æ•°å­—ï¼ˆå¤šè§£è¾“å‡ºä»»æ„ä¸€ç»„å³å¯ï¼‰ã€‚ TTT ç»„æ•°æ®ï¼Œ1â‰¤Tâ‰¤103,1â‰¤n,qâ‰¤3â‹…1051\\le T\\le 10^3, 1\\le n, q\\le 3\\cdot 10^51â‰¤Tâ‰¤103,1â‰¤n,qâ‰¤3â‹…105ã€‚ å…ˆè€ƒè™‘æ²¡æœ‰å¤šç»„è¯¢é—®ã€‚ çªèŒé¦–å…ˆå‘ç°ä¸€ä¸ªæ€§è´¨ï¼Œé‚£å°±æ˜¯å¦‚æœæœ‰ä¸¤ä¸ªè¿ç»­çš„ç›¸åŒå­—ç¬¦ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªå­—ç¬¦å¯¹ç­”æ¡ˆæ— è´¡çŒ®ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åˆ æ‰ã€‚é‚£æˆ‘ä»¬ä¸€æ¬¡åˆ æ‰ä¹‹åï¼Œæœ€åå¾—åˆ°çš„åºåˆ—åªèƒ½æ˜¯æ­£è´Ÿäº¤æ›¿çš„äº†ã€‚äºæ˜¯æˆ‘ä»¬åªè¦è€ƒè™‘æ­¤ç§æƒ…å†µå³å¯ã€‚æˆ‘ä»¬å‘ç°å¦‚æœåˆ å®Œçš„åºåˆ—é•¿åº¦ä¸ºå¥‡æ•°çš„è¯ï¼Œæˆ‘ä»¬åªè¦åˆ é™¤æœ€ä¸­é—´é‚£ä¸ªæ•°å°±å¯ä»¥äº†ã€‚æˆ‘ä»¬è€ƒè™‘å¶æ•°ï¼Œå¦‚æœé•¿åº¦å·²ç»ä¸º 000ï¼Œé‚£æ˜¾ç„¶å°±ä¸ç”¨åˆ é™¤äº†ï¼Œå¦‚æœä¸ä¸º 000 çš„è¯ï¼Œè€ƒè™‘åˆ°ä»¬æ­¤ç›¸åŒå­—ç¬¦æ¶ˆé™¤ä¸€å®šæ˜¯ä¸¤ä¸ªä¸¤ä¸ªåˆ çš„ï¼Œæ‰€ä»¥è‡³å°‘è¦åˆ ä¸¤ä¸ªæ•°ï¼Œæœ‰è€ƒè™‘åˆ°å¦‚æœéšä¾¿åˆ ä¸€ä¸ªæ•°ï¼Œé‚£ä¹ˆåºåˆ—é•¿åº¦å°±å˜æˆå¥‡æ•°äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦åˆ ä¸¤ä¸ªæ•°å³å¯ã€‚ äºæ˜¯æˆ‘ä»¬å‘ç°ï¼Œå¦‚æœæ˜¯è¯¢é—®ç³»åˆ—é•¿åº¦ä¸ºå¥‡æ•°ï¼Œé‚£ç­”æ¡ˆæœ€å¤šæ˜¯ 111ï¼Œå¦‚æœæ˜¯å¶æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ç»´æŠ¤å‰ç¼€å’Œ Si=âˆ‘j=1i(âˆ’1)jâˆ’1ajS_i=\\sum_{j=1}^i(-1)^{j-1}a_jSiâ€‹=âˆ‘j=1iâ€‹(âˆ’1)jâˆ’1ajâ€‹ï¼Œå¦‚æœ Srâˆ’Slâˆ’1S_r-S_{l-1}Srâ€‹âˆ’Slâˆ’1â€‹ æ˜¯ 000ï¼Œé‚£ç­”æ¡ˆå°±æ˜¯ 000ï¼Œå¦åˆ™æ˜¯ 222ã€‚ è¿™æ · D1 å°±åšå®Œäº†ã€‚ æˆ‘ä»¬è€ƒè™‘ D2ï¼Œæˆ‘ä»¬å…ˆè€ƒè™‘å¥‡æ•°çš„æƒ…å†µï¼Œæˆ‘ä»¬å‡è®¾è¦åˆ æ‰çš„æ•°æ˜¯ç¬¬ kkk ä¸ªï¼Œé‚£æˆ‘ä»¬æœ‰ âˆ‘i=lkâˆ’1(âˆ’1)iâˆ’1ai+(âˆ’1)â‹…âˆ‘i=k+1r(âˆ’1)iâˆ’1ai=0\\sum_{i=l}^{k - 1}(-1)^{i-1}a_{i}+(-1)\\cdot\\sum_{i=k+1}^r(-1)^{i-1}a_i=0âˆ‘i=lkâˆ’1â€‹(âˆ’1)iâˆ’1aiâ€‹+(âˆ’1)â‹…âˆ‘i=k+1râ€‹(âˆ’1)iâˆ’1aiâ€‹=0 ä¹Ÿå³ Skâˆ’1âˆ’Slâˆ’1=Srâˆ’SkS_{k-1}-S_{l-1}=S_{r}-S_{k}Skâˆ’1â€‹âˆ’Slâˆ’1â€‹=Srâ€‹âˆ’Skâ€‹ ä¹Ÿå³ Skâˆ’1+Sk=Slâˆ’1+SrS_{k-1}+S_k=S_{l-1}+S_rSkâˆ’1â€‹+Skâ€‹=Slâˆ’1â€‹+Srâ€‹ï¼Œäºæ˜¯æˆ‘ä»¬å¯¹æ¯ä¸ª Skâˆ’1+SkS_{k-1}+S_kSkâˆ’1â€‹+Skâ€‹ ç›¸åŒçš„å¼€ä¸ª setï¼Œä¹‹åå¯¹æ¯ç»„è¯¢é—® &lt;l,r&gt;\\left&lt;l,r\\right&gt;âŸ¨l,râŸ©ï¼Œæˆ‘ä»¬åªè¦åœ¨æ‰€æœ‰ Skâˆ’1+Sk=Slâˆ’1+SrS_{k-1}+S_k=S_{l-1}+S_rSkâˆ’1â€‹+Skâ€‹=Slâˆ’1â€‹+Srâ€‹ æ•°ä¸­ lower_bound å‡ºä¸€ä¸ªåœ¨ [l,r][l,r][l,r] ä¸­çš„ç­”æ¡ˆå³å¯ã€‚ é•¿åº¦ä¸ºå¶æ•°å°±ç›´æ¥éšä¾¿åˆ æ‰æœ€å·¦è¾¹æˆ–æ˜¯æœ€å³è¾¹çš„æ•°ï¼Œç„¶åæŒ‰ç…§å¥‡æ•°çš„æ–¹æ³•åšå³å¯ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839const int maxn = 300005;int qzh[maxn];char s[maxn];void solve() &#123; int n, q; scanf(&quot;%d%d%s&quot;, &amp;n, &amp;q, s + 1); std::map&lt;int, std::set&lt;int&gt;&gt; mp; for (int i = 1; i &lt;= n; ++i) &#123; qzh[i] = qzh[i - 1] + (((i &amp; 1) == (s[i] == &#x27;+&#x27;)) ? 1 : -1); mp[qzh[i - 1] + qzh[i]].insert(i); &#125; while (q--) &#123; int l, r; scanf(&quot;%d%d&quot;, &amp;l, &amp;r); if (qzh[r] - qzh[l - 1]) &#123; if ((r - l) &amp; 1) &#123; puts(&quot;2&quot;); writesp(r); r--; &#125; else &#123; puts(&quot;1&quot;); &#125; writeln(*mp[qzh[l - 1] + qzh[r]].lower_bound(l)); &#125; else &#123; puts(&quot;0&quot;); &#125; &#125;&#125;int main() &#123; int T; scanf(&quot;%d&quot;, &amp;T); while (T--) &#123; solve(); &#125; return 0;&#125;","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"CodeForces","slug":"CodeForces","permalink":"https://pufanyi.github.io/oi-blog/tags/CodeForces/"}]},{"title":"CodeForces 1562B Scenes From a Memory","slug":"CF1562B","date":"2021-08-26T16:00:00.000Z","updated":"2023-12-25T16:08:27.873Z","comments":true,"path":"CF1562B/","link":"","permalink":"https://pufanyi.github.io/oi-blog/CF1562B/","excerpt":"æœ‰ T (1â‰¤Tâ‰¤103)T\\,(1\\le T\\le 10^3)T(1â‰¤Tâ‰¤103) ç»„æ•°æ®ï¼Œæ¯ç»„ç»™ä¸€ä¸ªé•¿åº¦ä¸º k (1â‰¤kâ‰¤50)k\\,(1\\le k\\le 50)k(1â‰¤kâ‰¤50) çš„åè¿›åˆ¶æ­£æ•´æ•° nnnï¼Œå…¶ä¸­ nnn åœ¨åè¿›åˆ¶ä¸‹ä¸å­˜åœ¨ 000ï¼ˆåŒæ ·ä¸å­˜åœ¨å‰å¯¼ 000ï¼‰ï¼Œè®©ä½ æ±‚ä¸€ä¸ªæ•´æ•° mmmï¼Œä½¿å¾— mmm åœ¨åè¿›åˆ¶ä¸‹ä¸º nnn åœ¨åè¿›åˆ¶ä¸‹çš„å­åºåˆ—ï¼Œä¸” mmm ä¸ºéç´ æ•°ï¼ˆ111 ä¹Ÿæ˜¯éç´ æ•°ï¼‰ã€‚å­åºåˆ—ä¸è¦æ±‚è¿ç»­ã€‚","text":"æœ‰ T (1â‰¤Tâ‰¤103)T\\,(1\\le T\\le 10^3)T(1â‰¤Tâ‰¤103) ç»„æ•°æ®ï¼Œæ¯ç»„ç»™ä¸€ä¸ªé•¿åº¦ä¸º k (1â‰¤kâ‰¤50)k\\,(1\\le k\\le 50)k(1â‰¤kâ‰¤50) çš„åè¿›åˆ¶æ­£æ•´æ•° nnnï¼Œå…¶ä¸­ nnn åœ¨åè¿›åˆ¶ä¸‹ä¸å­˜åœ¨ 000ï¼ˆåŒæ ·ä¸å­˜åœ¨å‰å¯¼ 000ï¼‰ï¼Œè®©ä½ æ±‚ä¸€ä¸ªæ•´æ•° mmmï¼Œä½¿å¾— mmm åœ¨åè¿›åˆ¶ä¸‹ä¸º nnn åœ¨åè¿›åˆ¶ä¸‹çš„å­åºåˆ—ï¼Œä¸” mmm ä¸º éç´ æ•°ï¼ˆ111 ä¹Ÿæ˜¯éç´ æ•°ï¼‰ã€‚å­åºåˆ—ä¸è¦æ±‚è¿ç»­ã€‚ çªèŒè€ƒè™‘å°½é‡æ‰¹é‡è§£å†³ä¸€äº›èƒ½è§£å†³æ•°ã€‚ è€ƒè™‘åˆ°å¦‚æœä¸€ä¸ªæ•°å­—å«æœ‰ 1,4,6,8,91, 4, 6, 8, 91,4,6,8,9ï¼Œé‚£ä¹ˆè¿™ä¸ªæ•°åªè¦ä¿ç•™è¿™ä¸€ä½å³å¯ï¼Œè€Œå…¶ä½™æƒ…å†µå‡éœ€ä¿ç•™ä¸¤ä½ã€‚ å¦‚æœæ²¡æœ‰è¿™äº›æ•°ï¼Œä¹Ÿå°±æ˜¯åªæœ‰ 2,3,5,72, 3, 5, 72,3,5,7ï¼Œå¦‚æœå­˜åœ¨ä¸¤ä¸ªæ•°å­—ç›¸åŒï¼Œé‚£ä¹ˆåªè¦ä¿ç•™è¿™ä¸¤ä¸ªæ•°å­—å°±ä¸€å®šè¢« 111111 æ•´é™¤ï¼Œäºæ˜¯ä½æ•°å¤§äºç­‰äº 555 ä½çš„æ•°å­—éƒ½è§£å†³äº†ã€‚ ç„¶åè€ƒè™‘åˆ°åªè¦ 222 å’Œ 777ã€555 å’Œ 777 åœ¨ä¸€èµ·ï¼Œé‚£ä¹ˆå–è¿™ä¸¤ä¸ªæ•°å°±ä¸€å®šè¢« 333 æ•´é™¤ï¼Œäºæ˜¯ 444 ä½æ•°ä¹Ÿè§£å†³äº†ã€‚ ç„¶åå¦‚æœ 222 å’Œ 555 ä¸æ”¾åœ¨ç¬¬ä¸€ä½ï¼Œé‚£ä¹ˆå°±å¯ä»¥æ•´å‡ºä¸€ä¸ªå°¾æ•°æ˜¯ 222 æˆ–å°¾æ•° 555 çš„ä¸¤ä½æ•°ï¼Œåˆ†åˆ«è¢« 555 å’Œ 222 æ•´é™¤ã€‚ ä¹Ÿå°±æ˜¯è¯´ç°åœ¨çªèŒè¿˜ä¸èƒ½è§£å†³çš„åº”è¯¥æ˜¯ä¸ªä¸‰ä½æ•°ï¼Œåˆå› ä¸º 222 å’Œ 555 è‡³å°‘ä¼šæœ‰ä¸€ä¸ªæ•°è¢«é€‰è¿›è¿™ä¸ªä¸‰ä½æ•°ï¼ˆ2,3,5,72, 3, 5, 72,3,5,7 å››ä¸ªæ•°é‡Œé€‰ä¸‰ä¸ªå˜›ï¼‰ï¼Œæ‰€ä»¥ 777 å°±ä¸èƒ½æ¥äº†ï¼Œè¿™æ · 2,3,52, 3, 52,3,5 ä¸€å®šè¦è¿›åœºï¼Œä½†æ˜¯ 222 å’Œ 555 åˆéƒ½è¦åœ¨å¼€å¤´ï¼Œæ‰€ä»¥æ˜¯ä¸å¯èƒ½çš„ã€‚ äºæ˜¯çªèŒå‘ç°å…¶å®ä¸¤ä½åŠä»¥ä¸Šçš„æ•°å­—çªèŒéƒ½åªéœ€è¦ä¸Šé¢è¯´çš„ 444 ä¸ªç‰¹åˆ¤å°±å¯ä»¥äº†ã€‚ æ€»ç»“ä¸€ä¸‹ï¼Œå…ˆåˆ¤æœ‰æ²¡æœ‰ 1,4,6,8,91, 4, 6, 8, 91,4,6,8,9ï¼Œå¦‚æœæ²¡æœ‰çœ‹æœ‰æ²¡æœ‰åŒæ—¶å‡ºç° 222 å’Œ 777ã€555 å’Œ 777ï¼Œå¦‚æœè¿˜æ²¡æœ‰ï¼Œé‚£æˆ‘çœ‹ä¸€ä¸‹æœ‰æ²¡æœ‰ä¸æ”¾åœ¨å¼€å¤´çš„ 222 å’Œ 555ã€‚è¿™æ ·å°±èƒ½è¦†ç›–åˆ°æ‰€æœ‰å¯è¡Œçš„æ•°å­—äº†ã€‚","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"æ•°å­¦","slug":"æ•°å­¦","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%95%B0%E5%AD%A6/"},{"name":"CodeForces","slug":"CodeForces","permalink":"https://pufanyi.github.io/oi-blog/tags/CodeForces/"}]},{"title":"åˆä¸€ä¸ªé•œåƒ","slug":"cloudflareé•œåƒ","date":"2021-08-25T16:00:00.000Z","updated":"2023-12-25T16:08:27.953Z","comments":true,"path":"cloudflareé•œåƒ/","link":"","permalink":"https://pufanyi.github.io/oi-blog/cloudflare%E9%95%9C%E5%83%8F/","excerpt":"","text":"ç”±äºä¸€äº›åŸå› åˆ é™¤äº† gitee é•œåƒï¼Œä½†ç”±äº github é•œåƒå›½å†…å®åœ¨æœ‰äº›ä¸ç¨³å®šï¼Œäºæ˜¯åˆæ­äº†ä¸€ä¸ª é•œåƒã€‚è™½ç„¶ä¹Ÿæ˜¯å›½å¤–çš„ï¼Œä½†ç¨³å®šä¸€äº›ã€‚","categories":[{"name":"å…¬å‘Š","slug":"å…¬å‘Š","permalink":"https://pufanyi.github.io/oi-blog/categories/%E5%85%AC%E5%91%8A/"}],"tags":[]},{"title":"CodeForces 1558B Up the Strip","slug":"CF1558B","date":"2021-08-24T16:00:00.000Z","updated":"2023-12-25T16:08:27.873Z","comments":true,"path":"CF1558B/","link":"","permalink":"https://pufanyi.github.io/oi-blog/CF1558B/","excerpt":"æœ‰ n (2â‰¤nâ‰¤4â‹…106)n\\,(2\\le n\\le 4\\cdot 10^6)n(2â‰¤nâ‰¤4â‹…106) ä¸ªèŠ‚ç‚¹ï¼Œç¼–å· 1âˆ¼n1\\sim n1âˆ¼nï¼Œä½ ä¸€å¼€å§‹åœ¨èŠ‚ç‚¹ nnnï¼Œæƒ³è¦åˆ°èŠ‚ç‚¹ 111ã€‚å‡è®¾ä½ ç°åœ¨åœ¨èŠ‚ç‚¹ xxxï¼Œä½ å¯ä»¥è¿›è¡Œä»¥ä¸‹ä¸¤ç§æ“ä½œï¼š é€‰æ‹©ä¸€ä¸ªæ­£æ•´æ•° yâˆˆ[1,xâˆ’1]y\\in \\left[1, x - 1\\right]yâˆˆ[1,xâˆ’1]ï¼Œå¹¶ç§»åŠ¨åˆ°èŠ‚ç‚¹ xâˆ’yx-yxâˆ’yã€‚ é€‰æ‹©ä¸€ä¸ªæ­£æ•´æ•° zâˆˆ[2,x]z\\in \\left[2, x\\right]zâˆˆ[2,x]ï¼Œå¹¶ç§»åŠ¨åˆ°èŠ‚ç‚¹ âŒŠxzâŒ‹\\left\\lfloor\\frac{x}{z}\\right\\rfloorâŒŠzxâ€‹âŒ‹ã€‚ æ±‚æœ‰å¤šå°‘ç§æ–¹æ¡ˆåˆ°è¾¾èŠ‚ç‚¹ 111ï¼Œåªè¦æœ‰ä¸€æ¬¡é€‰æ‹©çš„ xxx æˆ– zzz ä¸åŒå°±ç®—æ–¹æ¡ˆä¸åŒã€‚ç­”æ¡ˆå¯¹ mmm å–æ¨¡ï¼Œå…¶ä¸­ mâˆˆ(108,109)m\\in \\left(10^8, 10^9\\right)mâˆˆ(108,109) ä¸” mmm æ˜¯ç´ æ•°ã€‚","text":"æœ‰ n (2â‰¤nâ‰¤4â‹…106)n\\,(2\\le n\\le 4\\cdot 10^6)n(2â‰¤nâ‰¤4â‹…106) ä¸ªèŠ‚ç‚¹ï¼Œç¼–å· 1âˆ¼n1\\sim n1âˆ¼nï¼Œä½ ä¸€å¼€å§‹åœ¨èŠ‚ç‚¹ nnnï¼Œæƒ³è¦åˆ°èŠ‚ç‚¹ 111ã€‚å‡è®¾ä½ ç°åœ¨åœ¨èŠ‚ç‚¹ xxxï¼Œä½ å¯ä»¥è¿›è¡Œä»¥ä¸‹ä¸¤ç§æ“ä½œï¼š é€‰æ‹©ä¸€ä¸ªæ­£æ•´æ•° yâˆˆ[1,xâˆ’1]y\\in \\left[1, x - 1\\right]yâˆˆ[1,xâˆ’1]ï¼Œå¹¶ç§»åŠ¨åˆ°èŠ‚ç‚¹ xâˆ’yx-yxâˆ’yã€‚ é€‰æ‹©ä¸€ä¸ªæ­£æ•´æ•° zâˆˆ[2,x]z\\in \\left[2, x\\right]zâˆˆ[2,x]ï¼Œå¹¶ç§»åŠ¨åˆ°èŠ‚ç‚¹ âŒŠxzâŒ‹\\left\\lfloor\\frac{x}{z}\\right\\rfloorâŒŠzxâ€‹âŒ‹ã€‚ æ±‚æœ‰å¤šå°‘ç§æ–¹æ¡ˆåˆ°è¾¾èŠ‚ç‚¹ 111ï¼Œåªè¦æœ‰ä¸€æ¬¡é€‰æ‹©çš„ xxx æˆ– zzz ä¸åŒå°±ç®—æ–¹æ¡ˆä¸åŒã€‚ç­”æ¡ˆå¯¹ mmm å–æ¨¡ï¼Œå…¶ä¸­ mâˆˆ(108,109)m\\in \\left(10^8, 10^9\\right)mâˆˆ(108,109) ä¸” mmm æ˜¯ç´ æ•°ã€‚ ä»¤ fif_ifiâ€‹ è¡¨ç¤º n=in=in=i æ—¶çš„ç­”æ¡ˆï¼Œæˆ‘ä»¬æœ‰ï¼š fi=âˆ‘j=1iâˆ’1fj+âˆ‘d=2ifâŒŠidâŒ‹f_i=\\sum_{j=1}^{i-1}f_j+\\sum_{d=2}^{i}f_{\\left\\lfloor\\frac{i}{d}\\right\\rfloor} fiâ€‹=j=1âˆ‘iâˆ’1â€‹fjâ€‹+d=2âˆ‘iâ€‹fâŒŠdiâ€‹âŒ‹â€‹ å‰ä¸€éƒ¨åˆ†è¡¨ç¤ºç”¨å‡æ³•ï¼Œåä¸€éƒ¨åˆ†è¡¨ç¤ºç”¨é™¤æ³•ã€‚ è€ƒè™‘ä¼˜åŒ–ï¼Œç¬¬ä¸€éƒ¨åˆ†ç›´æ¥å‰ç¼€å’Œï¼Œæˆ‘ä»¬ç›´æ¥è€ƒè™‘ç¬¬äºŒéƒ¨åˆ†ã€‚ä¸€ç§å¾ˆç›´æ¥çš„ä¼˜åŒ–æ˜¯å°†å°äº i\\sqrt{i}iâ€‹ çš„ ddd ç›´æ¥æ‹¿å‡ºæ¥ç®—ï¼Œå¤§äº i\\sqrt{i}iâ€‹ çš„ ddd æ‹¿å‡ºæ¥ç®—è´¡çŒ®ï¼Œ fkf_{k}fkâ€‹ èƒ½è½¬ç§»åˆ° fif_ifiâ€‹ çš„ ddd åº”è¯¥æ»¡è¶³ kâ‰¤id&lt;k+1k\\le \\frac{i}{d} &lt; k + 1kâ‰¤diâ€‹&lt;k+1ï¼Œä¹Ÿå³ ik+1&lt;dâ‰¤ik\\frac{i}{k+1}&lt;d\\le\\frac{i}{k}k+1iâ€‹&lt;dâ‰¤kiâ€‹ï¼Œäºæ˜¯ fkf_kfkâ€‹ å¯¹ fif_ifiâ€‹ çš„è´¡çŒ®åº”è¯¥ä¸º âŒŠnkâŒ‹âˆ’âŒŠnk+1âŒ‹\\left\\lfloor\\frac{n}{k}\\right\\rfloor-\\left\\lfloor\\frac{n}{k+1}\\right\\rfloorâŒŠknâ€‹âŒ‹âˆ’âŒŠk+1nâ€‹âŒ‹ã€‚è¿™æ ·åšå¤æ‚åº¦æ˜¯ O(nn)\\mathcal{O}(n\\sqrt{n})O(nnâ€‹)ï¼Œè¿‡ä¸å»ï¼Œä½†æ˜¯å¦‚æœä½ æ‰“ Div. 2 çš„è¯å°±èƒ½è¿‡ä¸€ä¸ª easy ç‰ˆ ã€‚ æˆ‘ä»¬è€ƒè™‘æ¢ä¸€ç§æ–¹å¼ï¼Œè€ƒè™‘ fif_ifiâ€‹ è½¬ç§»åˆ° fi+1f_{i+1}fi+1â€‹ï¼Œæˆ‘ä»¬æ¯”è¾ƒ âˆ‘d=2ifâŒŠidâŒ‹\\sum_{d=2}^{i}f_{\\left\\lfloor\\frac{i}{d}\\right\\rfloor}âˆ‘d=2iâ€‹fâŒŠdiâ€‹âŒ‹â€‹ ä¸ âˆ‘d=2i+1fâŒŠi+1dâŒ‹\\sum_{d=2}^{i+1}f_{\\left\\lfloor\\frac{i+1}{d}\\right\\rfloor}âˆ‘d=2i+1â€‹fâŒŠdi+1â€‹âŒ‹â€‹ï¼Œæœ‰å¦‚ä¸‹å˜åŒ–ï¼š å¤šäº†ä¸€ä¸ª f1f_1f1â€‹ï¼Œå› ä¸º ddd å¯ä»¥ç­‰äº i+1i+1i+1ã€‚ å¯¹äºæ‰€æœ‰ dâˆ£i+1d\\mid i+1dâˆ£i+1ï¼ŒâŒŠi+1dâŒ‹=âŒŠidâŒ‹+1\\left\\lfloor\\frac{i+1}{d}\\right\\rfloor=\\left\\lfloor\\frac{i}{d}\\right\\rfloor+1âŒŠdi+1â€‹âŒ‹=âŒŠdiâ€‹âŒ‹+1ï¼Œæ‰€ä»¥ fi+1f_{i+1}fi+1â€‹ æ¯” fif_ifiâ€‹ å¤šäº†ä¸€ä¸ª fâŒŠi+1dâŒ‹f_{\\left\\lfloor\\frac{i+1}{d}\\right\\rfloor}fâŒŠdi+1â€‹âŒ‹â€‹ï¼Œå°‘äº†ä¸€ä¸ª fâŒŠidâŒ‹f_{\\left\\lfloor\\frac{i}{d}\\right\\rfloor}fâŒŠdiâ€‹âŒ‹â€‹ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼š fi+1=âˆ‘j=1ifj+âˆ‘d=2i+1fâŒŠi+1dâŒ‹=fi+âˆ‘j=1iâˆ’1fj+âˆ‘d=2i+1fâŒŠi+1dâŒ‹=fi+fi+f1+âˆ‘dâˆ£i+1(fâŒŠi+1dâŒ‹âˆ’fâŒŠidâŒ‹)=2fi+f1+âˆ‘dâˆ£i+1(fâŒŠi+1dâŒ‹âˆ’fâŒŠidâŒ‹)\\begin{aligned} f_{i+1}&amp;=\\sum_{j=1}^{i}f_j+\\sum_{d=2}^{i+1}f_{\\left\\lfloor\\frac{i+1}{d}\\right\\rfloor}\\\\&amp;=f_i+\\sum_{j=1}^{i-1}f_j+\\sum_{d=2}^{i+1}f_{\\left\\lfloor\\frac{i+1}{d}\\right\\rfloor}\\\\&amp;=f_i+f_i+f_1+\\sum_{d\\mid i+1}\\left(f_{\\left\\lfloor\\frac{i+1}{d}\\right\\rfloor}-f_{\\left\\lfloor\\frac{i}{d}\\right\\rfloor}\\right)\\\\&amp;=2f_i+f_1+\\sum_{d\\mid i+1}\\left(f_{\\left\\lfloor\\frac{i+1}{d}\\right\\rfloor}-f_{\\left\\lfloor\\frac{i}{d}\\right\\rfloor}\\right) \\end{aligned} fi+1â€‹â€‹=j=1âˆ‘iâ€‹fjâ€‹+d=2âˆ‘i+1â€‹fâŒŠdi+1â€‹âŒ‹â€‹=fiâ€‹+j=1âˆ‘iâˆ’1â€‹fjâ€‹+d=2âˆ‘i+1â€‹fâŒŠdi+1â€‹âŒ‹â€‹=fiâ€‹+fiâ€‹+f1â€‹+dâˆ£i+1âˆ‘â€‹(fâŒŠdi+1â€‹âŒ‹â€‹âˆ’fâŒŠdiâ€‹âŒ‹â€‹)=2fiâ€‹+f1â€‹+dâˆ£i+1âˆ‘â€‹(fâŒŠdi+1â€‹âŒ‹â€‹âˆ’fâŒŠdiâ€‹âŒ‹â€‹)â€‹ æˆ‘ä»¬å‘ç°å¯¹äºæ‰€æœ‰ iiiï¼Œæ€»çš„çº¦æ•°ä¸ªæ•°ä¸º âˆ‘i=1nni=O(nlogâ¡n)\\sum_{i=1}^n\\frac{n}{i}=\\mathcal{O}(n\\log n)âˆ‘i=1nâ€‹inâ€‹=O(nlogn)ã€‚å…¶ä½™è½¬ç§»ä¸º O(n)\\mathcal{O}(n)O(n)ï¼Œæ•…æ€»å¤æ‚åº¦ä¸º O(nlogâ¡n)\\mathcal{O}(n\\log n)O(nlogn)ã€‚ è€ƒè™‘å®ç°ï¼Œåœ¨æ¯æ¬¡è®¡ç®—å‡º fif_{i}fiâ€‹ çš„æ—¶å€™ï¼Œå°†æ‰€æœ‰çš„ fkif_{ki}fkiâ€‹ éƒ½åŠ ä¸Š fiâˆ’fiâˆ’1f_i-f_{i-1}fiâ€‹âˆ’fiâˆ’1â€‹ï¼Œè¿™æ ·ç©ºé—´å¤æ‚åº¦å°±æ˜¯ O(n)\\mathcal{O}(n)O(n)ã€‚ 1234567891011121314151617181920212223242526272829303132333435const int maxn = 4000005;int n, mod;void add(int&amp; x, int y) &#123; x += y; if (x &gt;= mod) &#123; x -= mod; &#125; else if (x &lt; 0) &#123; x += mod; &#125;&#125;int f[maxn];int main() &#123; read(n), read(mod); f[1] = 1; for (int i = 2; i &lt;= n; ++i) &#123; int tmp = f[i - 1] &lt;&lt; 1 | 1; if (tmp &gt;= mod) &#123; tmp -= mod; &#125; add(f[i], tmp); if (i == 2) &#123; f[i] = 2; &#125; for (int j = i &lt;&lt; 1; j &lt;= n; j += i) &#123; add(f[j], f[i]); add(f[j], -f[i - 1]); &#125; &#125; writeln(f[n]); return 0;&#125;","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"æ•°å­¦","slug":"æ•°å­¦","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%95%B0%E5%AD%A6/"},{"name":"CodeForces","slug":"CodeForces","permalink":"https://pufanyi.github.io/oi-blog/tags/CodeForces/"},{"name":"DP","slug":"DP","permalink":"https://pufanyi.github.io/oi-blog/tags/DP/"}]},{"title":"2021 æµ™æ±Ÿé«˜è€ƒæ•°å­¦åœ†é”¥æ›²çº¿","slug":"2021æµ™æ±Ÿé«˜è€ƒæ•°å­¦åœ†é”¥æ›²çº¿","date":"2021-08-16T16:00:00.000Z","updated":"2023-12-25T16:08:27.864Z","comments":true,"path":"2021æµ™æ±Ÿé«˜è€ƒæ•°å­¦åœ†é”¥æ›²çº¿/","link":"","permalink":"https://pufanyi.github.io/oi-blog/2021%E6%B5%99%E6%B1%9F%E9%AB%98%E8%80%83%E6%95%B0%E5%AD%A6%E5%9C%86%E9%94%A5%E6%9B%B2%E7%BA%BF/","excerpt":"é«˜è€ƒæ•°å­¦æŒ‚äº† åœ†é”¥æ›²çº¿æœ€åå‡ æ­¥äº†å¿˜äº†å¼€æ ¹ qaq è¿™é‡Œè®¢æ­£ä¸€ä¸‹","text":"é«˜è€ƒæ•°å­¦æŒ‚äº† åœ†é”¥æ›²çº¿æœ€åå‡ æ­¥äº†å¿˜äº†å¼€æ ¹ qaq è¿™é‡Œè®¢æ­£ä¸€ä¸‹ å¦‚å›¾ï¼Œå·²çŸ¥ FFF æ˜¯æŠ›ç‰©çº¿ y2=2px (p&gt;0)y^2=2px\\,(p&gt;0)y2=2px(p&gt;0) çš„ç„¦ç‚¹ï¼ŒMMM æ˜¯æŠ›ç‰©çº¿çš„å‡†çº¿ä¸ xxx è½´çš„äº¤ç‚¹ï¼Œä¸” âˆ£MFâˆ£=2\\left|MF\\right|=2âˆ£MFâˆ£=2 ï¼ˆ1ï¼‰æ±‚æŠ›ç‰©çº¿çš„æ–¹ç¨‹ï¼› è§£ï¼šp=2â‡’y2=4xp=2\\Rightarrow y^2=4xp=2â‡’y2=4x ï¼ˆ2ï¼‰è®¾è¿‡ç‚¹ FFF çš„ç›´çº¿äº¤æŠ›ç‰©çº¿ä¸ AAAï½¤BBB ä¸¤ç‚¹ï¼Œæ–œç‡ä¸º 222 çš„ç›´çº¿ lll ä¸ç›´çº¿ MA, MB, ABMA,\\,MB,\\,ABMA,MB,ABï¼Œxxx è½´ä¾æ¬¡äº¤äºç‚¹ Pï¼ŒQï¼ŒRï¼ŒNPï¼ŒQï¼ŒRï¼ŒNPï¼ŒQï¼ŒRï¼ŒNï¼Œä¸” âˆ£RNâˆ£2=âˆ£PNâˆ£â‹…âˆ£QNâˆ£\\left|RN\\right|^2=\\left|PN\\right|\\cdot\\left|QN\\right|âˆ£RNâˆ£2=âˆ£PNâˆ£â‹…âˆ£QNâˆ£ï¼Œæ±‚ç›´çº¿ lll åœ¨ xxx è½´ä¸Šæˆªè·çš„èŒƒå›´ã€‚ è§£ï¼š è®¾ A(a2,2a), B(b2,2b)A(a^2,2a),\\ B(b^2,2b)A(a2,2a), B(b2,2b)ã€‚æœ‰ AB: (a+b)y=2x+2abAB:\\,(a+b)y=2x+2abAB:(a+b)y=2x+2abã€‚ å°† F(1,0)F(1,0)F(1,0) ä»£å…¥å¾—ï¼šab=âˆ’1ab=-1ab=âˆ’1ï¼Œå³ AB: (a+b)y=2xâˆ’2AB:\\,(a+b)y=2x-2AB:(a+b)y=2xâˆ’2ã€‚ è®¾ l: x=12y+tl:\\,x=\\frac{1}{2}y+tl:x=21â€‹y+tï¼Œä»£å…¥ ABABABï¼Œæœ‰ï¼šyR=2tâˆ’2a+bâˆ’1y_R=\\frac{2t-2}{a+b-1}yRâ€‹=a+bâˆ’12tâˆ’2â€‹ã€‚ è€ƒè™‘åˆ° M(âˆ’1,0)M(-1,0)M(âˆ’1,0)ï¼Œäºæ˜¯ MA: yâˆ’2axâˆ’a2=2aa2+1MA:\\,\\frac{y-2a}{x-a^2}=\\frac{2a}{a^2+1}MA:xâˆ’a2yâˆ’2aâ€‹=a2+12aâ€‹ã€‚ MAMAMA ä¸ lll è”ç«‹ï¼šyP=2a(t+1)a2âˆ’a+1y_P=\\frac{2a(t+1)}{a^2-a+1}yPâ€‹=a2âˆ’a+12a(t+1)â€‹ã€‚åŒç† yQ=2b(t+1)b2âˆ’b+1y_Q=\\frac{2b(t+1)}{b^2-b+1}yQâ€‹=b2âˆ’b+12b(t+1)â€‹ã€‚ åˆ âˆ£PNâˆ£â‹…âˆ£QNâˆ£=âˆ£RNâˆ£2â‡’yR2=âˆ’yPyQ\\left|PN\\right|\\cdot\\left|QN\\right|=\\left|RN\\right|^2\\Rightarrow y_R^2=-y_Py_Qâˆ£PNâˆ£â‹…âˆ£QNâˆ£=âˆ£RNâˆ£2â‡’yR2â€‹=âˆ’yPâ€‹yQâ€‹ã€‚ è€ƒè™‘åˆ° âˆ’yPyQ=âˆ’4ab(t+1)2(a2âˆ’a+1)(b2âˆ’b+1)=4(t+1)2a2+b2+1-y_Py_Q=-\\frac{4ab(t+1)^2}{(a^2-a+1)(b^2-b+1)}=\\frac{4(t+1)^2}{a^2+b^2+1}âˆ’yPâ€‹yQâ€‹=âˆ’(a2âˆ’a+1)(b2âˆ’b+1)4ab(t+1)2â€‹=a2+b2+14(t+1)2â€‹ï¼ŒyR2=4(tâˆ’1)2a2+b2âˆ’2aâˆ’2bâˆ’1y_R^2=\\frac{4(t-1)^2}{a^2+b^2-2a-2b-1}yR2â€‹=a2+b2âˆ’2aâˆ’2bâˆ’14(tâˆ’1)2â€‹ã€‚ å½“ t=Ì¸Â±1t\\not=\\pm 1tî€ =Â±1 æ—¶ï¼š æˆ‘ä»¬æœ‰ï¼šâˆ£PNâˆ£â‹…âˆ£QNâˆ£=âˆ£RNâˆ£2â‡’(tâˆ’1t+1)2=a2+b2âˆ’2aâˆ’2bâˆ’1a2+b2+1\\left|PN\\right|\\cdot\\left|QN\\right|=\\left|RN\\right|^2\\Rightarrow\\left(\\frac{t-1}{t+1}\\right)^2=\\frac{a^2+b^2-2a-2b-1}{a^2+b^2+1}âˆ£PNâˆ£â‹…âˆ£QNâˆ£=âˆ£RNâˆ£2â‡’(t+1tâˆ’1â€‹)2=a2+b2+1a2+b2âˆ’2aâˆ’2bâˆ’1â€‹ã€‚ ä»¤ s=a+bs=a+bs=a+bï¼Œåˆ™ s=aâˆ’1aâˆˆRs=a-\\frac{1}{a}\\in\\Rs=aâˆ’a1â€‹âˆˆRï¼Œa2+b2=s2âˆ’2ab=s2+2a^2+b^2=s^2-2ab=s^2+2a2+b2=s2âˆ’2ab=s2+2ã€‚ é‚£ä¹ˆæˆ‘ä»¬æœ‰ (tâˆ’1t+1)2=(sâˆ’1)2s2+3\\left(\\frac{t-1}{t+1}\\right)^2=\\frac{(s-1)^2}{s^2+3}(t+1tâˆ’1â€‹)2=s2+3(sâˆ’1)2â€‹ å– r=(sâˆ’1)2s2+3r=\\frac{(s-1)^2}{s^2+3}r=s2+3(sâˆ’1)2â€‹ï¼Œæˆ‘ä»¬æœ‰ (râˆ’1)s2+2s+(3râˆ’1)=0(r-1)s^2+2s+(3r-1)=0(râˆ’1)s2+2s+(3râˆ’1)=0ï¼ŒÎ”=4âˆ’4(râˆ’1)(3râˆ’1)â‰¥0\\Delta=4-4(r-1)(3r-1)\\ge 0Î”=4âˆ’4(râˆ’1)(3râˆ’1)â‰¥0ã€‚ äºæ˜¯ râˆˆ[0,43]r\\in \\left[0, \\frac{4}{3}\\right]râˆˆ[0,34â€‹]ï¼Œä¹Ÿå³ tâˆ’1t+1âˆˆ[âˆ’43,43]\\frac{t-1}{t+1}\\in\\left[-\\sqrt{\\frac{4}{3}}, \\sqrt{\\frac{4}{3}}\\right]t+1tâˆ’1â€‹âˆˆ[âˆ’34â€‹â€‹,34â€‹â€‹]ï¼Œæ•… tâ‰¤âˆ’43âˆ’7t\\le -4\\sqrt{3}-7tâ‰¤âˆ’43â€‹âˆ’7 æˆ– tâ‰¥43âˆ’7t\\ge 4\\sqrt{3}-7tâ‰¥43â€‹âˆ’7 ä¸” t=Ì¸1t\\not= 1tî€ =1ã€‚ å½“ t=Â±1t=\\pm 1t=Â±1 æ—¶ï¼š âˆ£RNâˆ£2=0\\left|RN\\right|^2=0âˆ£RNâˆ£2=0ï¼Œä½† âˆ£PNâˆ£â‹…âˆ£QNâˆ£\\left|PN\\right|\\cdot\\left|QN\\right|âˆ£PNâˆ£â‹…âˆ£QNâˆ£ ä¸å¯èƒ½ä¸º 000ï¼Œæ•…ä¸æˆç«‹ã€‚ ç»¼ä¸Šï¼Œtâˆˆ(âˆ’âˆ,âˆ’43âˆ’7]âˆª[43âˆ’7,1)âˆª(1,+âˆ)t\\in\\left(-\\infty, -4\\sqrt{3}-7\\right]\\cup\\left[4\\sqrt{3}-7,1\\right)\\cup\\left(1,+\\infty\\right)tâˆˆ(âˆ’âˆ,âˆ’43â€‹âˆ’7]âˆª[43â€‹âˆ’7,1)âˆª(1,+âˆ)ã€‚","categories":[{"name":"æ–‡åŒ–è¯¾","slug":"æ–‡åŒ–è¯¾","permalink":"https://pufanyi.github.io/oi-blog/categories/%E6%96%87%E5%8C%96%E8%AF%BE/"}],"tags":[{"name":"æ•°å­¦","slug":"æ•°å­¦","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%95%B0%E5%AD%A6/"},{"name":"æ–‡åŒ–è¯¾","slug":"æ–‡åŒ–è¯¾","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%96%87%E5%8C%96%E8%AF%BE/"}]},{"title":"å…³é—­ gitee é•œåƒ","slug":"å…³é—­giteeé•œåƒ","date":"2021-08-16T16:00:00.000Z","updated":"2023-12-25T16:08:28.081Z","comments":true,"path":"å…³é—­giteeé•œåƒ/","link":"","permalink":"https://pufanyi.github.io/oi-blog/%E5%85%B3%E9%97%ADgitee%E9%95%9C%E5%83%8F/","excerpt":"","text":"gitee è¢«å°äº†ï¼Œè¯´æ˜¯æœ‰ä¸€äº›è¿è§„å†…å®¹ã€‚æ‰¾äº†åŠå¤©æ‰¾ä¸åˆ°ï¼Œé‚£å°±ç®—äº†ä¸æ›´é•œåƒäº†ã€‚","categories":[{"name":"å…¬å‘Š","slug":"å…¬å‘Š","permalink":"https://pufanyi.github.io/oi-blog/categories/%E5%85%AC%E5%91%8A/"}],"tags":[]},{"title":"é€€å½¹å•¦ï¼","slug":"AFO","date":"2020-06-21T16:00:00.000Z","updated":"2023-12-25T16:08:27.865Z","comments":true,"path":"AFO/","link":"","permalink":"https://pufanyi.github.io/oi-blog/AFO/","excerpt":"å˜´é‡Œè¯´ç€é€€å½¹ï¼Œä¸çŸ¥ä¸è§‰å°±çœŸçš„é€€å½¹äº†ã€‚","text":"å˜´é‡Œè¯´ç€é€€å½¹ï¼Œä¸çŸ¥ä¸è§‰å°±çœŸçš„é€€å½¹äº†ã€‚ æƒ³èµ·æ¥å·²ç»ä¸¤å¹´åŠäº†ã€‚ä»å¼ƒäº†æ–‡åŒ–è¯¾æ¥æ OIï¼Œåˆ°ç°åœ¨åˆå¾—æ»šå›å»ææ–‡åŒ–è¯¾ï¼ŒçœŸæ˜¯ä¸€æ®µæœ‰æ„æ€çš„ç»å†ã€‚ ä¸¤å¹´å‰ï¼Œæ‰“å­—è¿˜è¦çœ‹ç€é”®ç›˜ï¼Œç„¶è€Œç°åœ¨è¿˜æ˜¯ä¸ä¼šèƒŒé”®ç›˜ ï¼›åœºåœºæ¨¡æ‹Ÿèµ›çˆ†è›‹ï¼Œ ç„¶è€Œç°åœ¨è¿˜æ˜¯åªä¼šçˆ†è›‹ã€‚ NOIP2018 åˆèµ›ç›´æ¥æŒ‚äº†ï¼Œé™©äº›é€€å½¹ã€‚å›æƒ³èµ·æ¥é‚£ç§è‡ªé—­çš„æ„Ÿè§‰ç¡®å®æŒºæœ‰æ„æ€çš„ã€‚ CSP2019 å¥½ä¸å®¹æ˜“è¿‡äº†åˆèµ›ï¼Œç»“æœå¤èµ›çˆ†ç‚¸ï¼ŒDay1T3 å†™ä¸å‡ºæ¥ï¼ŒDay2T1 æœ‰è¢«å¡å¸¸ã€‚ è€ƒå®Œ CSP å»æ‰“ CodeForcesï¼Œå¥½ä¸å®¹æ˜“è¦ä¸Š IM äº†ï¼Œè¿ç»­å‡ åœº fst ç›´æ¥ä¸€å¤œå›åˆ°è§£æ”¾å‰ã€‚ åæ¥æ–‡åŒ–è¯¾å‹åŠ›é€æ¸é‡äº†èµ·æ¥ï¼Œæ¯•ç«Ÿæ˜¯è¦é«˜è€ƒäº†ã€‚ ä¸ç®¡æ€ä¹ˆè¯´ï¼Œæ€»ç®—æ˜¯ AFO äº†ã€‚ è¿˜æœ‰å‡ ç¯‡åšå®¢æ²¡å¡«å®Œçš„ï¼Œå°±è®©å¥¹ä»¬é¸½è¿™å§ï¼ˆ ä¸çŸ¥é“ä»¥åå†æœ‰æ²¡æœ‰æœºä¼šæ‰“ CF äº†ï¼š ä¸çŸ¥é“ä»¥åå†æœ‰æ²¡æœ‰æœºä¼šåˆ·æ´›è°·äº†ï¼š","categories":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%9A%8F%E7%AC%94/"}],"tags":[]},{"title":"Pollard Rho å…¥é—¨","slug":"Rho","date":"2020-04-18T02:16:23.000Z","updated":"2023-12-25T16:08:27.899Z","comments":true,"path":"Rho/","link":"","permalink":"https://pufanyi.github.io/oi-blog/Rho/","excerpt":"è¦å¼€å­¦äº† qaqï¼Œçœ‹èµ·æ¥ä¸èƒ½å†é¸½ä¸‹å»äº†ï¼Œæ¥æ°´ä¸€ç¯‡ã€‚","text":"è¦å¼€å­¦äº† qaqï¼Œçœ‹èµ·æ¥ä¸èƒ½å†é¸½ä¸‹å»äº†ï¼Œæ¥æ°´ä¸€ç¯‡ã€‚ è€ƒè™‘åˆ°è‡ªå·± too naiveï¼Œæ„Ÿè§‰ä¹‹å‰ä¸æ˜¯å¾ˆä¼š Pollard Rhoï¼Œå°±åªå¥½é‡æ–°æ‹¿èµ·ç®—å¯¼çœ‹äº†ä¸€éã€‚çœ‹å®Œå‘ç°è‡ªå·±æœç„¶èœã€‚ é¦–å…ˆæ˜¯ä¸€ä¸ªå«ç”Ÿæ—¥æ‚–è®ºçš„ä¸œè¥¿ã€‚è¿™ç©æ„å„¿å¥½åƒæ¯ä¸€ç¯‡å°† Pollard Rho çš„æ–‡ç« éƒ½ä¼šæœ‰æ‰€æåŠã€‚å‡è®¾ä¸€å¹´æœ‰ nnn å¤©ï¼ŒæœŸæœ›æœ‰å¤šå°‘ä¸ªäººæ‰èƒ½ä½¿æœ‰ä¸¤ä¸ªäººç”Ÿæ—¥ç›¸åŒã€‚ ç­”æ¡ˆå½“ç„¶æ˜¯ O(n)\\mathcal{O}(\\sqrt{n})O(nâ€‹) çš„äº†ï¼Œå…¶å®è¯´å®åœ¨çš„ï¼Œåˆçœ‹è¿˜æ˜¯æŒºåç›´è§‰çš„ï¼Œä½†ä»”ç»†æ¨ä¸€ä¸‹å°±å‘ç°ç¡®å®æ˜¯è¿™æ ·ã€‚å› ä¸ºå‡è®¾æœ‰ kkk ä¸ªäººï¼Œå°±æœ‰ (k2)\\binom{k}{2}(2kâ€‹) å¯¹æ¯”è¾ƒå…³ç³»å˜›ï¼Œè€Œæˆ‘ä»¬å¯ä»¥è¿‘ä¼¼çš„è®¤ä¸ºæ¯å¯¹å…³ç³»æ˜¯ç‹¬ç«‹çš„ï¼Œå³ç›¸ç­‰çš„æ¦‚ç‡æ˜¯ 1n\\frac{1}{n}n1â€‹ï¼Œä¹Ÿå°±æ˜¯æœŸæœ›ç›¸ç­‰çš„ä¸ªæ•°çº¦ä¸º (k2)1n\\binom{k}{2}\\frac{1}{n}(2kâ€‹)n1â€‹ï¼Œè¦ä½¿å…¶å¤§äºç­‰äº 111ï¼Œå¯ä»¥è§£å¾— kkk æ˜¯ O(n)\\mathcal{O}(\\sqrt{n})O(nâ€‹) çš„ã€‚ ç„¶åå°±æ˜¯ rho ç®—æ³•äº†ï¼Œä»–è§£å†³çš„æ˜¯ä¸€ä¸ªè´¨å› å­åˆ†è§£çš„é—®é¢˜ã€‚ ä¸€ä¸ª naive çš„æƒ³æ³•ï¼Œå°±æ˜¯å°±ä¸ä¸€ä¸ªæ•° nnnï¼Œå…ˆåˆ¤æ–­ä»–æ˜¯ä¸æ˜¯è´¨æ•°ï¼Œå¦‚æœæ˜¯çš„è¯ï¼Œå…¶åˆ†è§£å°±æ˜¯è‡ªå·±äº†ï¼Œå¦åˆ™æ¯æ¬¡éšæœºä¸€ä¸ªæ•° xxxï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯ nnn çš„è´¨å› å­ï¼Œå¦‚æœæ˜¯çš„è¯ï¼Œå°±é€’å½’ nx\\frac{n}{x}xnâ€‹ å’Œ xxxã€‚ç„¶è€Œè¿™ä¸ªå¤æ‚åº¦æ˜¾ç„¶æ˜¯ä¸å¯¹çš„ã€‚ è€Œæ ¹æ®ç”Ÿæ—¥æ‚–è®ºï¼Œæˆ‘ä»¬æœ‰ä¼šæœ‰ä¸€ä¸ªæƒ³æ³•ï¼Œé‚£å°±æ˜¯å¤šéšæœºå‡ ä¸ªæ•°ï¼Œä¸¤ä¸¤ä½œå·®ï¼Œæ¯ä¸ªéƒ½ä¸ nnn å–ä¸€ä¸‹ gcd æ¥çœ‹ä¸€çœ‹æ˜¯ä¸æ˜¯ç­‰äº 111ï¼Œä½†è¿™æ ·çš„å¤æ‚åº¦æ˜¾ç„¶å’Œå‰é¢çš„ç®—æ³•ä¸€æ ·ã€‚ æˆ‘ä»¬è€ƒè™‘æ„é€ å‡½æ•° fn(x)=(x2+c) mod nf_{n}(x)=(x^2+c)\\bmod nfnâ€‹(x)=(x2+c)modnï¼Œccc æ˜¯äº‹å…ˆé€‰æ‹©çš„ä¸€ä¸ªæ•°ã€‚é¦–å…ˆæˆ‘ä»¬éœ€è¦çŸ¥é“ä¸€ç‚¹çš„æ˜¯ï¼Œåœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬è®¤ä¸º fn(x)f_{n}(x)fnâ€‹(x) æ˜¯åœ¨ [0,n][0,n][0,n] ä¸‹çš„ä¸€ä¸ªéšæœºå‡½æ•°ï¼Œè€Œäº‹å®å¯èƒ½å¹¶ä¸æ˜¯è¿™æ ·ã€‚ æˆ‘ä»¬è€ƒè™‘æ„é€ ä¸€ä¸ªåºåˆ— {a}\\{a\\}{a}ï¼Œa1a_{1}a1â€‹ æ˜¯ä¸€ä¸ªé¢„å…ˆç»™å‡ºçš„éšæœºæ•°ï¼Œai=fn(aiâˆ’1)a_{i}=f_{n}(a_{i-1})aiâ€‹=fnâ€‹(aiâˆ’1â€‹)ï¼Œä¸éš¾å‘ç°ï¼Œè¿™ä¸ª {a}\\{a\\}{a} åºåˆ—æ˜¯ä¸€ä¸ª Ï\\rhoÏ å­—å½¢ï¼š ç„¶åæˆ‘ä»¬è€ƒè™‘ï¼ŒåŠ å…¥ ppp æ˜¯ nnn çš„ä¸€ä¸ªçº¦æ•°ï¼Œå¯¹äºä¸€ä¸ªé•¿åº¦ â„“\\ellâ„“ï¼Œå¯¹äºä»»æ„çš„ x,yx,yx,yï¼Œæˆ‘ä»¬å‘ç°ï¼š fn(x+â„“)âˆ’fn(x)â‰¡fn(y+â„“)âˆ’fn(y)(modp)f_{n}(x+\\ell)-f_{n}(x)\\equiv f_{n}(y+\\ell)-f_{n}(y)\\pmod p fnâ€‹(x+â„“)âˆ’fnâ€‹(x)â‰¡fnâ€‹(y+â„“)âˆ’fnâ€‹(y)(modp) é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæˆ‘ä»¬è¯•äº† &lt;x,x+â„“&gt;\\left&lt;x,x+\\ell\\right&gt;âŸ¨x,x+â„“âŸ©ï¼Œé‚£å°±ä¸éœ€è¦è¯• &lt;y,y+â„“&gt;\\left&lt;y,y+\\ell\\right&gt;âŸ¨y,y+â„“âŸ©ï¼Œå› ä¸ºå¦‚æœ fn(x+â„“)âˆ’fn(x)f_{n}(x+\\ell)-f_{n}(x)fnâ€‹(x+â„“)âˆ’fnâ€‹(x) ä¸æ˜¯ ppp çš„å€æ•°ï¼Œé‚£ fn(y+â„“)âˆ’fn(y)f_{n}(y+\\ell)-f_{n}(y)fnâ€‹(y+â„“)âˆ’fnâ€‹(y) è‚¯å®šä¹Ÿä¸æ˜¯ ppp çš„å€æ•°ã€‚","categories":[{"name":"å°å°ç»“","slug":"å°å°ç»“","permalink":"https://pufanyi.github.io/oi-blog/categories/%E5%B0%8F%E5%B0%8F%E7%BB%93/"}],"tags":[{"name":"æ•°è®º","slug":"æ•°è®º","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%95%B0%E8%AE%BA/"}]},{"title":"AGC043C Giant Graph","slug":"agc043_c","date":"2020-04-07T01:55:04.000Z","updated":"2023-12-25T16:08:27.924Z","comments":true,"path":"agc043_c/","link":"","permalink":"https://pufanyi.github.io/oi-blog/agc043_c/","excerpt":"æ„é€ ä¸€ä¸ª n3n^3n3 ä¸ªç‚¹çš„æ— å‘å›¾ GGGï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š ç»™å®š 333 å¼  nnn ä¸ªç‚¹çš„æ— å‘å›¾ G1,G2,G3G_1,G_2,G_3G1â€‹,G2â€‹,G3â€‹ã€‚ æ„é€  n3n^3n3 ä¸ªç‚¹ï¼Œæ ‡å·æ˜¯ä¸€ä¸ªä¸‰å…ƒç»„ &lt;i,j,k&gt;\\left&lt;i,j,k\\right&gt;âŸ¨i,j,kâŸ©ã€‚ å¯¹äº G1G_1G1â€‹ ä¸­çš„è¾¹ &lt;u,v&gt;\\left&lt;u,v\\right&gt;âŸ¨u,vâŸ©ï¼Œè¿è¾¹ &lt;u,j,k&gt;\\left&lt;u,j,k\\right&gt;âŸ¨u,j,kâŸ© å’Œ &lt;v,j,k&gt;\\left&lt;v,j,k\\right&gt;âŸ¨v,j,kâŸ©ã€‚ å¯¹äº G2G_2G2â€‹ ä¸­çš„è¾¹ &lt;u,v&gt;\\left&lt;u,v\\right&gt;âŸ¨u,vâŸ©ï¼Œè¿è¾¹ &lt;i,u,k&gt;\\left&lt;i,u,k\\right&gt;âŸ¨i,u,kâŸ© å’Œ &lt;i,v,k&gt;\\left&lt;i,v,k\\right&gt;âŸ¨i,v,kâŸ©ã€‚ å¯¹äº G3G_3G3â€‹ ä¸­çš„è¾¹ &lt;u,v&gt;\\left&lt;u,v\\right&gt;âŸ¨u,vâŸ©ï¼Œè¿è¾¹ &lt;i,j,u&gt;\\left&lt;i,j,u\\right&gt;âŸ¨i,j,uâŸ© å’Œ &lt;i,j,v&gt;\\left&lt;i,j,v\\right&gt;âŸ¨i,j,vâŸ©ã€‚ å¯¹äº GGG ä¸Šçš„ä¸€ä¸ªç‚¹ &lt;i,j,k&gt;\\left&lt;i,j,k\\right&gt;âŸ¨i,j,kâŸ©ï¼Œå…¶ç‚¹æƒä¸º 1018(i+j+k){10}^{18(i+j+k)}1018(i+j+k)ã€‚ ç°åœ¨ï¼Œè¦ä½ æ±‚å‡º GGG çš„æœ€å¤§ç‹¬ç«‹é›†å¤§å°è†œ 998244353998244353998244353 ä»¥åçš„å€¼ã€‚ 2â‰¤nâ‰¤105,1â‰¤m1,m2,m3â‰¤1052\\le n\\le 10^5,1\\le m_1,m_2,m_3\\le 10^52â‰¤nâ‰¤105,1â‰¤m1â€‹,m2â€‹,m3â€‹â‰¤105","text":"æ„é€ ä¸€ä¸ª n3n^3n3 ä¸ªç‚¹çš„æ— å‘å›¾ GGGï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š ç»™å®š 333 å¼  nnn ä¸ªç‚¹çš„æ— å‘å›¾ G1,G2,G3G_1,G_2,G_3G1â€‹,G2â€‹,G3â€‹ã€‚ æ„é€  n3n^3n3 ä¸ªç‚¹ï¼Œæ ‡å·æ˜¯ä¸€ä¸ªä¸‰å…ƒç»„ &lt;i,j,k&gt;\\left&lt;i,j,k\\right&gt;âŸ¨i,j,kâŸ©ã€‚ å¯¹äº G1G_1G1â€‹ ä¸­çš„è¾¹ &lt;u,v&gt;\\left&lt;u,v\\right&gt;âŸ¨u,vâŸ©ï¼Œè¿è¾¹ &lt;u,j,k&gt;\\left&lt;u,j,k\\right&gt;âŸ¨u,j,kâŸ© å’Œ &lt;v,j,k&gt;\\left&lt;v,j,k\\right&gt;âŸ¨v,j,kâŸ©ã€‚ å¯¹äº G2G_2G2â€‹ ä¸­çš„è¾¹ &lt;u,v&gt;\\left&lt;u,v\\right&gt;âŸ¨u,vâŸ©ï¼Œè¿è¾¹ &lt;i,u,k&gt;\\left&lt;i,u,k\\right&gt;âŸ¨i,u,kâŸ© å’Œ &lt;i,v,k&gt;\\left&lt;i,v,k\\right&gt;âŸ¨i,v,kâŸ©ã€‚ å¯¹äº G3G_3G3â€‹ ä¸­çš„è¾¹ &lt;u,v&gt;\\left&lt;u,v\\right&gt;âŸ¨u,vâŸ©ï¼Œè¿è¾¹ &lt;i,j,u&gt;\\left&lt;i,j,u\\right&gt;âŸ¨i,j,uâŸ© å’Œ &lt;i,j,v&gt;\\left&lt;i,j,v\\right&gt;âŸ¨i,j,vâŸ©ã€‚ å¯¹äº GGG ä¸Šçš„ä¸€ä¸ªç‚¹ &lt;i,j,k&gt;\\left&lt;i,j,k\\right&gt;âŸ¨i,j,kâŸ©ï¼Œå…¶ç‚¹æƒä¸º 1018(i+j+k){10}^{18(i+j+k)}1018(i+j+k)ã€‚ ç°åœ¨ï¼Œè¦ä½ æ±‚å‡º GGG çš„æœ€å¤§ç‹¬ç«‹é›†å¤§å°è†œ 998244353998244353998244353 ä»¥åçš„å€¼ã€‚ 2â‰¤nâ‰¤105,1â‰¤m1,m2,m3â‰¤1052\\le n\\le 10^5,1\\le m_1,m_2,m_3\\le 10^52â‰¤nâ‰¤105,1â‰¤m1â€‹,m2â€‹,m3â€‹â‰¤105 è€ƒè™‘åˆ°æ˜¯ç‚¹æƒæ˜¯ä¸€ä¸ªå¤§æ•°çš„å¹‚æ¬¡ï¼Œé‚£è‚¯å®šæ˜¯é€‰çš„æ•°è¶Šå¤§è¶Šå¥½ã€‚ è€ƒè™‘å¦‚æœä½ çŸ¥é“äº†å›¾ GGG ä¹‹åä½ ä¼šæ€ä¹ˆåšã€‚ é¦–å…ˆ &lt;n,n,n&gt;\\left&lt;n,n,n\\right&gt;âŸ¨n,n,nâŸ© è¿™ä¸ªç‚¹å¿…é¡»å¾—é€‰ï¼Œç„¶åå…¶è·Ÿå¥¹è¿è¾¹çš„ç‚¹å°±ä¸èƒ½é€‰äº†ã€‚ ç„¶åå¦‚æœä¸€ä¸ªç‚¹å·²ç»ç¡®å®šäº†æ—è¾¹å·²ç»æ¯”å¥¹å¤§çš„ç‚¹éƒ½ä¸é€‰äº†ï¼Œé‚£ä¹ˆå¥¹æ‰ä¼šé€‰ã€‚ é‚£ä¼šä¸ä¼šæœ‰ä¸¤ä¸ªç›¸é‚»çš„ç‚¹ç‚¹æƒç›¸ç­‰å‘¢ï¼Ÿæ˜¾ç„¶ä¸ä¼šã€‚å› ä¸ºç›¸é‚»çš„ç‚¹å¿…é¡»æœ‰ä¸¤ä¸ªæƒå€¼ç›¸ç­‰ï¼Œé‚£ä¹ˆå¦å¤–ä¸€ä¸ªè‚¯å®šç›¸ç­‰ï¼Œè¿™æ˜¯ä¸åˆæ³•çš„ã€‚ ç„¶åæˆ‘ä»¬å°±è€ƒè™‘è¿™ä¸ªè¿‡ç¨‹ï¼Œå°±æ˜¯æˆ‘ä»¬è€ƒè™‘å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªç‚¹é€‰ä¸é€‰ï¼Œé‚£å°±è¦çœ‹ä¸ä¹‹ç›¸é‚»çš„æ¯”å¥¹å¤§çš„ç‚¹é€‰ä¸é€‰ï¼Œå°±æ˜¯å¦‚æœé‚£äº›ç‚¹éƒ½æ˜¯ä¸åˆæ³•çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªç‚¹åˆæ³•ï¼Œå¦åˆ™ä¸åˆæ³•ã€‚ æˆ‘ä»¬å‘ç°è¿™è·Ÿåšå¼ˆé—®é¢˜å¾ˆåƒï¼Œå°±æ˜¯æœ‰ 333 é¢—æ£‹å­ï¼Œæ¯ä¸ªäººæ¯æ¬¡å¯ä»¥æŠŠä¸€ä¸ªæ£‹å­ç§»åŠ¨åˆ°ä¸€ä¸ªæ¯”å¥¹å¤§çš„æ ¼å­é‡Œï¼Œä¸èƒ½èµ°çš„å°±è¾“äº†ã€‚è€Œå…ˆæ‰‹å¿…è¾“æ€çš„ç‚¹å°±æ˜¯åˆæ³•çš„ã€‚ äºæ˜¯æˆ‘ä»¬åªè¦è®¡ç®—æ¯ä¸ªç‚¹çš„ sg å€¼å³å¯ã€‚ è€ƒè™‘åˆ°æ¯å¼ å›¾ sg å€¼åªä¼šæœ‰ O(n)\\mathcal{O}(\\sqrt n)O(nâ€‹) ä¸ªï¼Œæˆ‘ä»¬åªè¦è®¡ç®—å‡ºä¹‹åæš´åŠ›åˆå¹¶å³å¯ï¼Œäºæ˜¯åˆå¹¶å¤æ‚åº¦æ˜¯ O(n)\\mathcal{O}(n)O(n) çš„ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394namespace dfcmd &#123; typedef long long LL; const int maxn = 100005; const int mod = 998244353; const int di = 1000000000000000000LL % mod; int bin[maxn]; inline void add(int&amp; x, int y) &#123; x += y; if (x &gt;= mod) &#123; x -= mod; &#125; &#125; int n; struct myhnb &#123; int m; int sg[maxn]; int ss[maxn]; struct Edge &#123; int to, nxt; &#125; e[maxn]; int first[maxn]; int cnt = 0; inline void add_edge(int u, int v) &#123; if (u &gt; v) &#123; swap(u, v); &#125; e[++cnt].nxt = first[u]; first[u] = cnt; e[cnt].to = v; &#125; int vis[maxn]; myhnb() &#123; memset(first, 0, sizeof(first)); memset(ss, 0, sizeof(ss)); memset(vis, 0, sizeof(vis)); &#125; inline void Dfs() &#123; for (int now = n; now; --now) &#123; vis[now] = true; set&lt;int&gt; sgg; sgg.clear(); for (int i = first[now]; i; i = e[i].nxt) &#123; sgg.insert(sg[e[i].to]); &#125; sg[now] = 0; while (sgg.count(sg[now])) &#123; sg[now]++; &#125; add(ss[sg[now]], bin[now]); &#125; &#125; inline int&amp; operator [] (int x) &#123; return ss[x]; &#125; &#125; d[3]; int main() &#123; read(n); bin[0] = 1; for (int i = 1; i &lt;= n; ++i) &#123; bin[i] = (LL) bin[i - 1] * di % mod; &#125; for (int i = 0; i &lt; 3; ++i) &#123; read(d[i].m); for (int j = 1; j &lt;= d[i].m; ++j) &#123; int u, v; read(u), read(v); d[i].add_edge(u, v); &#125; d[i].Dfs(); &#125; int ans = 0; for (int i = 0; i &lt;= 1000; ++i) &#123; for (int j = 0; j &lt;= 1000; ++j) &#123; add(ans, (LL) d[0][i] * d[1][j] % mod * d[2][i ^ j] % mod); &#125; &#125; writeln(ans); return 0; &#125;&#125;","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"DP","slug":"DP","permalink":"https://pufanyi.github.io/oi-blog/tags/DP/"},{"name":"AtCoder","slug":"AtCoder","permalink":"https://pufanyi.github.io/oi-blog/tags/AtCoder/"},{"name":"åšå¼ˆ","slug":"åšå¼ˆ","permalink":"https://pufanyi.github.io/oi-blog/tags/%E5%8D%9A%E5%BC%88/"}]},{"title":"AGC043D Merge Triplets","slug":"agc043_d","date":"2020-03-31T01:59:58.000Z","updated":"2023-12-25T16:08:27.925Z","comments":true,"path":"agc043_d/","link":"","permalink":"https://pufanyi.github.io/oi-blog/agc043_d/","excerpt":"ç»™å‡ºä¸€ç§ç”Ÿæˆé•¿åº¦ä¸º 3n3n3n çš„æ’åˆ— PPP çš„æ–¹æ³•ï¼š å…ˆç”Ÿæˆä¸€ä¸ªé•¿åº¦ä¸º 3n3n3n çš„æ’åˆ— AAAï¼Œç„¶åå¯¹äº âˆ€kâˆˆ[0,nâˆ’1]\\forall k\\in [0,n-1]âˆ€kâˆˆ[0,nâˆ’1]ï¼Œå°† 3n+1,3n+2,3n+33n + 1, 3n + 2, 3n + 33n+1,3n+2,3n+3 åˆ†æˆä¸€å—ã€‚ æœ‰ nnn ä¸ªæŒ‡é’ˆï¼Œå¼€å§‹æŒ‡å‘è¿™ nnn ä¸ªå—çš„å¼€å¤´ã€‚ æ¯æ¬¡é€‰æ‹©è¿™ nnn ä¸ªæŒ‡é’ˆæŒ‡å‘çš„æ•°ä¸­æœ€å°çš„å¹¶å°†å…¶æ”¾åœ¨ PPP çš„æœ«å°¾ï¼Œå°†è¿™ä¸ªæŒ‡é’ˆå‘åç§»ä¸€ä½ï¼Œå¦‚æœç§»å‡ºå—äº†ï¼Œå°†æŒ‡é’ˆåˆ é™¤ã€‚ å›åˆ° 2 æ“ä½œç›´åˆ°æ‰€æœ‰æŒ‡é’ˆå‡è¢«åˆ é™¤ã€‚ ç°åœ¨è¦ä½ æ±‚å‡ºï¼Œè¿™æ ·çš„æ–¹å¼å…±èƒ½ç”Ÿæˆå¤šå°‘ç§æœ¬è´¨ä¸åŒçš„æ’åˆ— AAAï¼Œç­”æ¡ˆå¯¹ mmm å–æ¨¡ã€‚ 1â‰¤nâ‰¤2Ã—103,108â‰¤mâ‰¤109+71\\le n\\le 2\\times 10^3,10^8\\le m\\le 10^9+71â‰¤nâ‰¤2Ã—103,108â‰¤mâ‰¤109+7","text":"ç»™å‡ºä¸€ç§ç”Ÿæˆé•¿åº¦ä¸º 3n3n3n çš„æ’åˆ— PPP çš„æ–¹æ³•ï¼š å…ˆç”Ÿæˆä¸€ä¸ªé•¿åº¦ä¸º 3n3n3n çš„æ’åˆ— AAAï¼Œç„¶åå¯¹äº âˆ€kâˆˆ[0,nâˆ’1]\\forall k\\in [0,n-1]âˆ€kâˆˆ[0,nâˆ’1]ï¼Œå°† 3n+1,3n+2,3n+33n + 1, 3n + 2, 3n + 33n+1,3n+2,3n+3 åˆ†æˆä¸€å—ã€‚ æœ‰ nnn ä¸ªæŒ‡é’ˆï¼Œå¼€å§‹æŒ‡å‘è¿™ nnn ä¸ªå—çš„å¼€å¤´ã€‚ æ¯æ¬¡é€‰æ‹©è¿™ nnn ä¸ªæŒ‡é’ˆæŒ‡å‘çš„æ•°ä¸­æœ€å°çš„å¹¶å°†å…¶æ”¾åœ¨ PPP çš„æœ«å°¾ï¼Œå°†è¿™ä¸ªæŒ‡é’ˆå‘åç§»ä¸€ä½ï¼Œå¦‚æœç§»å‡ºå—äº†ï¼Œå°†æŒ‡é’ˆåˆ é™¤ã€‚ å›åˆ° 2 æ“ä½œç›´åˆ°æ‰€æœ‰æŒ‡é’ˆå‡è¢«åˆ é™¤ã€‚ ç°åœ¨è¦ä½ æ±‚å‡ºï¼Œè¿™æ ·çš„æ–¹å¼å…±èƒ½ç”Ÿæˆå¤šå°‘ç§æœ¬è´¨ä¸åŒçš„æ’åˆ— AAAï¼Œç­”æ¡ˆå¯¹ mmm å–æ¨¡ã€‚ 1â‰¤nâ‰¤2Ã—103,108â‰¤mâ‰¤109+71\\le n\\le 2\\times 10^3,10^8\\le m\\le 10^9+71â‰¤nâ‰¤2Ã—103,108â‰¤mâ‰¤109+7 é¦–å…ˆæˆ‘ä»¬ä¸éš¾å‘ç°è¿™ä¸ªåºåˆ—åœ¨ä¸€å®šç¨‹åº¦ä¸Šè‚¯å®šæ˜¯æœ‰å•è°ƒæ€§çš„ï¼Œå› ä¸ºæœ¬èº«è¿™ä¸ªç”Ÿæˆçš„æ–¹å¼å°±æ˜¯ä¸€ä¸ªå•è°ƒçš„è¿‡ç¨‹ã€‚ æˆ‘ä»¬å‘ç°å¯¹äºä¸€ä¸ªå— {a,b,c}\\{a,b,c\\}{a,b,c}ï¼Œå¦‚æœ a&gt;ba&gt;ba&gt;bï¼Œé‚£ bbb ä¸€å®šæ˜¯ç´§è·Ÿåœ¨ aaa åé¢çš„ã€‚è€Œå¦‚æœ a&lt;ba&lt;ba&lt;bï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸éš¾å‘ç°è¿™ä¸ªå¿«å¯ä»¥åˆ†è£‚æˆä¸¤ä¸ªï¼Œä¹Ÿå°±æ˜¯ {a},{b,c}\\{a\\},\\{b,c\\}{a},{b,c}ï¼Œå› ä¸º bbb è‚¯å®šåœ¨ aaa ä¹‹åé€‰ã€‚ é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬ç°åœ¨çš„æƒ…å†µæ˜¯ï¼Œæœ‰ä¸€äº›é•¿åº¦ä¸º 1,2,31,2,31,2,3 çš„å—ï¼Œæ¯ä¸ªå—éƒ½æ˜¯çš„å¼€å¤´éƒ½æ˜¯æœ€å¤§çš„ã€‚è¿™ç»™æˆ‘ä»¬äº†ä¸€ä¸ªæç¤ºï¼Œå› ä¸ºè¿™æ ·çš„ä¸œè¥¿ç»™äº†æˆ‘ä»¬ä¸€ä¸ªå°†æ„é€ æ–¹æ³•å’Œåºåˆ—è¿ç»“èµ·æ¥çš„æ¡¥æ¢ã€‚å› ä¸ºè¿™ä¸ªä¸œè¥¿ä¸åºåˆ—ä¸€ä¸€å¯¹åº”ï¼Œè¿™ä¸ªåªè¦å°†é¦–å­—æ¯æ’åºä¸€ä¸‹å°±å¯ä»¥äº†ã€‚é‚£ä¹ˆæˆ‘ä»¬ç°åœ¨å°±åªè¦è€ƒè™‘æŠŠåˆ’åˆ†åçš„å—å’Œåˆ’åˆ†å‰çš„å—ä¸€ä¸€å¯¹åº”å°±å¯ä»¥äº†ã€‚ ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬éœ€è¦æ‰¾åˆ°å…¶å……è¦æ¡ä»¶ã€‚æˆ‘ä»¬å‘ç°ï¼Œå…¶å®é•¿åº¦ä¸º 333 çš„å—å†å¤šä¹Ÿä¸è¦ç´§ï¼Œå› ä¸ºæœ¬æ¥çš„å—å°±æ˜¯é•¿åº¦ 333 çš„ï¼Œæˆ‘ä»¬è€ƒè™‘åˆ’åˆ†åçš„å—ã€‚ä¸éš¾å‘ç°æ¯æ¬¡åˆ’åˆ†è¦ä¹ˆå°±æ˜¯å»æ‰ä¸€ä¸ªé•¿åº¦ä¸º 333 çš„å—ï¼ŒåŠ ä¸Šä¸€ä¸ªé•¿åº¦ä¸º 222 çš„å—å’Œä¸€ä¸ª 111 çš„å—ï¼Œè¦ä¹ˆå°±æ˜¯å°†ä¸€ä¸ª 222 çš„å—åˆ’åˆ†æˆä¸¤ä¸ª 111 çš„å—ã€‚æˆ‘ä»¬è€ƒè™‘è¿™ä»¶äº‹æƒ…ï¼Œå°±ä¸éš¾å‘ç°è¿™ä¸ªæ¡ä»¶äº†ï¼š222 çš„å—æ•°å°äºç­‰äº 111 çš„å—æ•°ã€‚ ç°åœ¨æˆ‘ä»¬åªè¦å°†åˆ’åˆ†å®Œçš„å—æ‹¼èµ·æ¥å°±å¯ä»¥äº†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªåºåˆ—åˆæ³•çš„å……è¦æ¡ä»¶æ˜¯ï¼šå­˜åœ¨ä¸€ç§åˆ’åˆ†æ–¹æ¡ˆï¼Œä½¿å¾—åˆ’åˆ†åæ¯ä¸ªå—å¤§å°å°äºç­‰äº 333ï¼Œè€Œä¸”æ¯ä¸ªå—çš„å¼€å¤´æ˜¯å—ä¸­æœ€å¤§çš„ï¼Œä¸”æ¯”å…¶ä¹‹å‰çš„æ•°éƒ½è¦å¤§ã€‚ç»è¿‡ä¹‹å‰çš„æ¨å¯¼ï¼Œæˆ‘ä»¬ä¹ŸçŸ¥é“äº†è¿™ç§åˆ’åˆ†æ–¹æ¡ˆæ˜¯å”¯ä¸€çš„ã€‚ æˆ‘ä»¬æ€è€ƒè¿™ä¸œè¥¿æ€ä¹ˆè®¡ç®—ï¼Œæˆ‘ä»¬å…ˆè€ƒè™‘å¦‚æœåˆ’åˆ†æ–¹æ¡ˆå·²ç»ç»™å‡ºï¼Œæ•°å­—éšä¾¿å¡«ï¼Œè¿™æ ·æœ‰å‡ ç§æ–¹æ¡ˆã€‚ æˆ‘ä»¬å‘ç°ï¼Œä¸€äº›é™åˆ¶å°±æ˜¯ï¼šaia_iaiâ€‹ åœ¨ [1,r][1,r][1,r] ä¸­æ˜¯æœ€å¤§çš„ã€‚å¦‚æœé•¿åº¦ä¸º nnnï¼Œé‚£ä¹ˆç­”æ¡ˆå°±æ˜¯ n!âˆr\\frac{n!}{\\prod r}âˆrn!â€‹ã€‚äºæ˜¯æˆ‘ä»¬ç”¨è¿™ä¸ªæ€§è´¨å°±å¯ä»¥ dp äº†ã€‚ æˆ‘ä»¬ä»¤ fi,jf_{i,j}fi,jâ€‹ è¡¨ç¤ºå¦‚æœæ’åˆ—çš„é•¿åº¦ä¸º iiiï¼ˆåªèƒ½å¡«å‰ iii ä¸ªæ•°ï¼‰ï¼Œé•¿åº¦ä¸º 111 çš„å—çš„ä¸ªæ•°å‡å»é•¿åº¦ä¸º 222 çš„å—çš„ä¸ªæ•°ä¸º jjj çš„æ–¹æ¡ˆæ•°ã€‚å…¶å®å°±æ˜¯è€ƒè™‘å³é¢åŠ ä¸€ä¸ªä»€ä¹ˆæ ·çš„å—ã€‚æ ¹æ®ä¸Šé¢çš„å¼å­ï¼Œæˆ‘ä»¬ä¸éš¾å¾—åˆ°ï¼š {fi+1,j+1â†fi,ji+1 è¢«é™¤æ‰äº†fi+2,jâˆ’1â†fi,jâ‹…(i+1)i+2 è¢«é™¤æ‰äº†fi+3,jâ†fi,jâ‹…(i+1)â‹…(i+2)i+3 è¢«é™¤æ‰äº†\\begin{cases} f_{i+1,j+1}&amp;\\leftarrow&amp;f_{i,j}&amp;\\text{$i+1$ è¢«é™¤æ‰äº†}\\\\ f_{i+2,j-1}&amp;\\leftarrow&amp;f_{i,j}\\cdot(i+1)&amp;\\text{$i+2$ è¢«é™¤æ‰äº†}\\\\ f_{i+3,j}&amp;\\leftarrow&amp;f_{i,j}\\cdot(i+1)\\cdot(i+2)&amp;\\text{$i+3$ è¢«é™¤æ‰äº†} \\end{cases} â©âªâªâ¨âªâªâ§â€‹fi+1,j+1â€‹fi+2,jâˆ’1â€‹fi+3,jâ€‹â€‹â†â†â†â€‹fi,jâ€‹fi,jâ€‹â‹…(i+1)fi,jâ€‹â‹…(i+1)â‹…(i+2)â€‹i+1 è¢«é™¤æ‰äº† i+2 è¢«é™¤æ‰äº† i+3 è¢«é™¤æ‰äº†â€‹ ç„¶åå°±å¯ä»¥æ„‰å¿«åœ°è½¬ç§»å•¦ï¼ 1234567891011121314151617181920212223242526272829303132333435namespace dfcmd &#123; typedef long long LL; const int maxn = 2000; const int base = maxn * 3 + 2; int n, mod; int f[maxn * 3 + 5][maxn * 6 + 5]; inline void add(int&amp; x, int y) &#123; x += y; if (x &gt;= mod) &#123; x -= mod; &#125; &#125; int main() &#123; read(n), read(mod); n *= 3; f[0][base] = 1; for (register int i = 0; i &lt; n; ++i) &#123; for (register int j = 1; j &lt;= base &lt;&lt; 1; ++j) &#123; add(f[i + 1][j + 1], f[i][j]); add(f[i + 2][j - 1], (LL) f[i][j] * (i + 1) % mod); add(f[i + 3][j], (LL) f[i][j] * (i + 1) * (i + 2) % mod); &#125; &#125; int ans = 0; for (int i = base; i &lt;= base &lt;&lt; 1; ++i) &#123; add(ans, f[n][i]); &#125; writeln(ans); return 0; &#125;&#125;","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"DP","slug":"DP","permalink":"https://pufanyi.github.io/oi-blog/tags/DP/"},{"name":"AtCoder","slug":"AtCoder","permalink":"https://pufanyi.github.io/oi-blog/tags/AtCoder/"}]},{"title":"AGC041F Histogram Rooks","slug":"agc041_f","date":"2020-03-18T16:00:00.000Z","updated":"2023-12-25T16:08:27.924Z","comments":true,"path":"agc041_f/","link":"","permalink":"https://pufanyi.github.io/oi-blog/agc041_f/","excerpt":"æœ‰ä¸€ä¸ª nÃ—nn\\times nnÃ—n çš„æ£‹ç›˜ï¼ˆnâ‰¤300n\\le 300nâ‰¤300ï¼‰ï¼Œç„¶åå¯¹äºæ¯ä¸€åˆ—ï¼Œè€ƒè™‘å°†æ‰€æœ‰è¯¥åˆ—çºµåæ ‡å¤§äºç­‰äº aia_iaiâ€‹ çš„æ ¼å­å…¨éƒ¨åˆ æ‰ã€‚åœ¨å‰©ä½™æœŸç›¼ä¸­ï¼Œé—®æœ‰å¤šå°‘ç§æ”¾è½¦çš„æ–¹æ¡ˆèƒ½ä½¿æ¯ä¸ªæ ¼å­éƒ½èƒ½è¢«è‡³å°‘ä¸€ä¸ªè½¦æ”»å‡»åˆ°ã€‚","text":"æœ‰ä¸€ä¸ª nÃ—nn\\times nnÃ—n çš„æ£‹ç›˜ï¼ˆnâ‰¤300n\\le 300nâ‰¤300ï¼‰ï¼Œç„¶åå¯¹äºæ¯ä¸€åˆ—ï¼Œè€ƒè™‘å°†æ‰€æœ‰è¯¥åˆ—çºµåæ ‡å¤§äºç­‰äº aia_iaiâ€‹ çš„æ ¼å­å…¨éƒ¨åˆ æ‰ã€‚åœ¨å‰©ä½™æœŸç›¼ä¸­ï¼Œé—®æœ‰å¤šå°‘ç§æ”¾è½¦çš„æ–¹æ¡ˆèƒ½ä½¿æ¯ä¸ªæ ¼å­éƒ½èƒ½è¢«è‡³å°‘ä¸€ä¸ªè½¦æ”»å‡»åˆ°ã€‚ é¦–å…ˆè€ƒè™‘åˆ°è¿™æ ·ä¸€ä»¶äº‹æƒ…ï¼Œå°±æ˜¯å¦‚æœç”¨ &lt;l,r,h&gt;\\left&lt;l,r,h\\right&gt;âŸ¨l,r,hâŸ© è¡¨ç¤ºçš„æ˜¯ [l,r][l,r][l,r] åŒºé—´å†…ï¼Œçºµåæ ‡å¤§äº hhh çš„æ ¼å­ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªè¿™æ ·çš„ä¸‰å…ƒç»„ä¸ºä¸€ä¸ªçŠ¶æ€ã€‚ ç„¶åæˆ‘ä»¬è€ƒè™‘å¯¹äºæ¯ä¸ªçŠ¶æ€ï¼Œå®ƒé‡Œé¢çš„æ ¼å­ï¼Œå¦‚æœè¦åˆæ³•çš„è¯ï¼Œæ¯ä¸€åˆ—ä¸€å®šæ˜¯ä¸‹é¢ä¸‰ç§ä¸­çš„å…¶ä¸­ä¸€ç§ï¼š è¿™ä¸€åˆ—ä¸­è‡³å°‘æœ‰ä¸€ä¸ªè½¦ã€‚è¿™æ—¶å€™çš„è¯ï¼Œè¿™ä¸€åˆ—ä¸­çš„æ¯ä¸ªæ ¼å­å°±ä¸€å®šåˆæ³•ã€‚ è¿™ä¸€åˆ—æ²¡æœ‰è½¦ï¼Œä½†æ˜¯è¿™äº›æ ¼å­éƒ½è¢«ä¸€ä¸ªè½¦è¦†ç›–åˆ°äº†ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªäºŒå…ƒç»„æ‰€åŒ…å«çš„æ ¼å­ä¸­æ²¡æœ‰ã€‚ è¿™ä¸€åˆ—æ²¡æœ‰è½¦ï¼Œè€Œä¸”éƒ¨åˆ†æ ¼å­å¹¶æ²¡æœ‰è¢«è½¦è¦†ç›–åˆ°ï¼Œè¿™æ—¶å€™ï¼Œå°±è¿™ä¸€åˆ—åªèƒ½åœ¨ hhh ä¸‹é¢æœ‰è½¦æ‰èƒ½åˆæ³•ã€‚ ç°åœ¨æˆ‘ä»¬è€ƒè™‘ dpï¼Œft,i,jf_{t,i,j}ft,i,jâ€‹ è¡¨ç¤ºçŠ¶æ€ä¸º ttt çš„æ—¶å€™ï¼Œç°åœ¨æœ‰ iii ä¸ª 222 ç±»ç‚¹ï¼Œjjj ä¸ª 333 ç±»ç‚¹ï¼Œé‚£ä¹ˆæ˜¾ç„¶ 111 ç±»ç‚¹å°±æ˜¯ râˆ’l+1âˆ’iâˆ’jr-l+1-i-jrâˆ’l+1âˆ’iâˆ’j ä¸ªã€‚ ç„¶åæˆ‘ä»¬è€ƒè™‘è½¬ç§»ï¼Œæˆ‘ä»¬è€ƒè™‘ ttt æ‰€è¡¨ç¤ºçš„æ–¹æ ¼æ˜¯å¦å®Œå…¨è¢«åˆ†æˆäº†ä¸¤å—ï¼Œä¹Ÿå°±æ˜¯ hhh æ˜¯å¦è·Ÿ [l,r][l,r][l,r] ä¸­æœ€å°çš„ aaa ç›¸ç­‰ã€‚å¦‚æœæ˜¯çš„è¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å°†å…¶åˆ†æˆä¸¤åŠè¿›è¡Œ dpï¼Œè®°å·¦è¾¹é‚£ä¸ªçŠ¶æ€ä¸º l(t)l(t)l(t)ï¼Œå³è¾¹ä¸º r(t)r(t)r(t)ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å¾—åˆ°è½¬ç§» ft,i,j+1=âˆ‘a,bfl(t),a,bâ‹…fr(t),iâˆ’a,jâˆ’bf_{t,i,j+1}=\\sum_{a,b}f_{l(t),a,b}\\cdot f_{r(t),i-a,j-b}ft,i,j+1â€‹=âˆ‘a,bâ€‹fl(t),a,bâ€‹â‹…fr(t),iâˆ’a,jâˆ’bâ€‹ï¼Œå› ä¸ºä¸¤å—æ˜¯ä¸ç›¸å¹²çš„ã€‚ ç„¶åæˆ‘ä»¬å¦‚æœæ²¡æœ‰ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬è¦ä» &lt;l,r,h+1&gt;\\left&lt;l,r,h+1\\right&gt;âŸ¨l,r,h+1âŸ© å‘ &lt;l,r,h&gt;\\left&lt;l,r,h\\right&gt;âŸ¨l,r,hâŸ© è½¬ç§»ã€‚æˆ‘ä»¬ä»¤u=&lt;l,r,h+1&gt;u=\\left&lt;l,r,h+1\\right&gt;u=âŸ¨l,r,h+1âŸ©ï¼Œk,i,jk,i,jk,i,j åˆ†åˆ«è¡¨ç¤ºä¸‰ç±»åˆ—çš„æ•°é‡ã€‚è¿™ä¸ªè½¬ç§»éœ€è¦åˆ† 222 ä¸­æƒ…å†µè®¨è®ºï¼š å¦‚æœè¿™ä¸€è¡Œä¸æ”¾è½¦ï¼šft,0,i+jâ†fu,i,jf_{t,0,i+j}\\leftarrow f_{u,i,j}ft,0,i+jâ€‹â†fu,i,jâ€‹ã€‚ å¦‚æœè¿™ä¸€è¡Œçš„è½¦åªæ”¾åœ¨ä¸€ç±»åˆ—ä¸Šï¼šft,i,jâ†fu,i,jâ‹…(2k1âˆ’1)f_{t,i,j}\\leftarrow f_{u,i,j}\\cdot (2^{k_1}-1)ft,i,jâ€‹â†fu,i,jâ€‹â‹…(2k1â€‹âˆ’1)ã€‚ å¦‚æœ xxx ä¸ªè½¦æ”¾åœ¨ 222 ç±»åˆ—ï¼Œyyy ä¸ªè½¦æ”¾åœ¨ 333 ç±»åˆ—ï¼šft,iâˆ’x,jâˆ’yâ†fu,i,jâ‹…(ix)(jy)â‹…2kf_{t,i-x,j-y}\\leftarrow f_{u,i,j}\\cdot\\binom{i}{x}\\binom{j}{y}\\cdot2^{k}ft,iâˆ’x,jâˆ’yâ€‹â†fu,i,jâ€‹â‹…(xiâ€‹)(yjâ€‹)â‹…2kã€‚ æˆ‘ä»¬è€ƒè™‘ä¼˜åŒ–è¿™ä¸ª dpã€‚ æˆ‘ä»¬å‘ç°å¯¹äºä¸€ä¸ªçŠ¶æ€ tttï¼Œæœ‰ä¸¤ç§å½¢å¼ï¼š æ¯ä¸€è¡Œéƒ½è‡³å°‘æœ‰ä¸€è¾†è½¦ã€‚ æœ‰ä¸€è¡Œæ²¡æœ‰è½¦ã€‚ ä¸ºä»€ä¹ˆè¦æŠŠè¿™ä¸¤ç§åˆ†å¼€æ¥è®¨è®ºå‘¢ï¼Ÿ æˆ‘ä»¬è€ƒè™‘è¿™ä¸¤ç§æœ‰ä»€ä¹ˆä¸ä¸€æ ·ã€‚ç¬¬ä¸€ç§å½¢å¼ï¼Œéƒ½æœ‰ä¸€ä¸ªè½¦ï¼Œé‚£ä¹ˆå°±æ²¡æœ‰ç¬¬ 333 ç±»åˆ—äº†ï¼Œå¦åˆ™å¦‚æœæ˜¯ç¬¬äºŒç§å½¢å¼ï¼Œé‚£å°±æœ€ç»ˆå°±æ²¡æœ‰ç¬¬ 222 ç±»åˆ—äº†ã€‚è¿™æ ·å­ï¼Œå…¶å®æˆ‘ä»¬å°±ç›¸å½“äºåˆ†ä¸¤ç§æƒ…å†µï¼ŒæŠŠ 222 ç±»åˆ—å’Œ 333 ç±»åˆ—çœ‹æˆæ˜¯ä¸€ä¸ªä¸œè¥¿ä¸€èµ·è½¬ç§»äº†ï¼Œå¯ä»¥æŠŠå¥¹ä»¬æ”¾åœ¨åŒä¸€ç»´é‡Œï¼Œç„¶ååŠ ä¸€ç»´ 0/10/10/1 å³å¯ã€‚ è¿™æ ·ç¬¬äºŒç§è½¬ç§»çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¹Ÿåªè¦æšä¸¾ä¸€ç»´ xxx è¡¨ç¤º 2,32,32,3 ç±»åˆ—æ€»çš„æ”¾è½¦ä¸ªæ•°ï¼Œè€ƒè™‘åˆ°å¤æ‚åº¦ä¸º âˆ‘â„“2\\sum \\ell^2âˆ‘â„“2ï¼Œâ„“\\ellâ„“ è¡¨ç¤ºçš„æ˜¯æ¯ä¸ªæœ‰ç”¨çŠ¶æ€çš„é•¿åº¦ï¼Œä¸éš¾å‘ç°å¤æ‚åº¦ä¸º O(n3)\\mathcal{O}(n^3)O(n3)ã€‚ updï¼šå•¥å¬è¯´è¿™é¢˜ std è¢«è‰¹äº†ï¼Ÿç®—äº†å…ˆé¸½ç€ï¼Œä¸¢ä¸ª é“¾æ¥ï¼Œåº”è¯¥ä¼šè¡¥çš„ï¼ˆ","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"DP","slug":"DP","permalink":"https://pufanyi.github.io/oi-blog/tags/DP/"},{"name":"AtCoder","slug":"AtCoder","permalink":"https://pufanyi.github.io/oi-blog/tags/AtCoder/"}]},{"title":"AGC041E Balancing Network","slug":"agc041_e","date":"2020-03-10T16:00:00.000Z","updated":"2023-12-25T16:08:27.923Z","comments":true,"path":"agc041_e/","link":"","permalink":"https://pufanyi.github.io/oi-blog/agc041_e/","excerpt":"æœ‰ nnn æ¡çº¿ mmm ä¸ªå¹³è¡¡å™¨ï¼Œä»å·¦å¾€å³ç¬¬ iii ä¸ªå¹³è¡¡å™¨è¿æ¥äº† xi,yix_i,y_ixiâ€‹,yiâ€‹ æ¡ç”µçº¿ï¼ˆ1â‰¤xi&lt;yiâ‰¤n1\\le x_i&lt;y_i\\le n1â‰¤xiâ€‹&lt;yiâ€‹â‰¤nï¼‰ï¼Œæ¯ä¸ªå¹³è¡¡å™¨éƒ½æœ‰ä¸€ä¸ªçŠ¶æ€ï¼šå‘ä¸Šæˆ–å‘ä¸‹ã€‚è€ƒè™‘ä¸€ä¸ªä»¤ç‰Œï¼Œä»æœ€å·¦è¾¹çš„æŸä¸€æ¡å¯¼çº¿å¼€å§‹ï¼Œå¦‚æœåœ¨ç¬¬ iii ä¸ªä½ç½®ï¼Œå¦‚æœä»–åœ¨ xix_ixiâ€‹ å¯¼çº¿ä¸Šä¸”å¹³è¡¡å™¨çŠ¶æ€å‘ä¸‹ï¼Œé‚£ä¹ˆå°±åˆ° yiy_iyiâ€‹ï¼ŒåŒç†å¦‚æœåœ¨ yiy_iyiâ€‹ ä¸”çŠ¶æ€å‘ä¸Šï¼Œåˆ™åˆ° xix_ixiâ€‹ã€‚è®° kik_ikiâ€‹ è¡¨ç¤ºä»¤ç‰Œä»å¯¼çº¿ iii å¼€å§‹åˆ°æ— ç©·è¿œå¤„æ˜¯ä»–åœ¨å“ªæ¡å¯¼çº¿ä¸Šã€‚ è®©ä½ æ„é€ ä¸¤ç§è§£ï¼Œæ¯ç§è§£ç”¨ä¸€ä¸ªå­—ç¬¦ä¸²è¡¨ç¤ºï¼Œè¡¨ç¤ºæ¯ä¸ªå¹³è¡¡å™¨çš„çŠ¶æ€ã€‚ç¬¬ä¸€ç»„è§£è¦æ±‚æ‰€æœ‰çš„ kik_ikiâ€‹ ç›¸ç­‰ï¼Œç¬¬äºŒç»„æ¥è¦æ±‚è‡³å°‘æœ‰ä¸¤ä¸ª kik_ikiâ€‹ ä¸ç›¸ç­‰ã€‚æ— è§£è¾“å‡º âˆ’1-1âˆ’1ã€‚ æ•°æ®èŒƒå›´ 2â‰¤nâ‰¤5Ã—104, 1â‰¤mâ‰¤1052\\le n\\le 5\\times 10^4,\\,1\\le m\\le 10^52â‰¤nâ‰¤5Ã—104,1â‰¤mâ‰¤105ã€‚","text":"æœ‰ nnn æ¡çº¿ mmm ä¸ªå¹³è¡¡å™¨ï¼Œä»å·¦å¾€å³ç¬¬ iii ä¸ªå¹³è¡¡å™¨è¿æ¥äº† xi,yix_i,y_ixiâ€‹,yiâ€‹ æ¡ç”µçº¿ï¼ˆ1â‰¤xi&lt;yiâ‰¤n1\\le x_i&lt;y_i\\le n1â‰¤xiâ€‹&lt;yiâ€‹â‰¤nï¼‰ï¼Œæ¯ä¸ªå¹³è¡¡å™¨éƒ½æœ‰ä¸€ä¸ªçŠ¶æ€ï¼šå‘ä¸Šæˆ–å‘ä¸‹ã€‚è€ƒè™‘ä¸€ä¸ªä»¤ç‰Œï¼Œä»æœ€å·¦è¾¹çš„æŸä¸€æ¡å¯¼çº¿å¼€å§‹ï¼Œå¦‚æœåœ¨ç¬¬ iii ä¸ªä½ç½®ï¼Œå¦‚æœä»–åœ¨ xix_ixiâ€‹ å¯¼çº¿ä¸Šä¸”å¹³è¡¡å™¨çŠ¶æ€å‘ä¸‹ï¼Œé‚£ä¹ˆå°±åˆ° yiy_iyiâ€‹ï¼ŒåŒç†å¦‚æœåœ¨ yiy_iyiâ€‹ ä¸”çŠ¶æ€å‘ä¸Šï¼Œåˆ™åˆ° xix_ixiâ€‹ã€‚è®° kik_ikiâ€‹ è¡¨ç¤ºä»¤ç‰Œä»å¯¼çº¿ iii å¼€å§‹åˆ°æ— ç©·è¿œå¤„æ˜¯ä»–åœ¨å“ªæ¡å¯¼çº¿ä¸Šã€‚ è®©ä½ æ„é€ ä¸¤ç§è§£ï¼Œæ¯ç§è§£ç”¨ä¸€ä¸ªå­—ç¬¦ä¸²è¡¨ç¤ºï¼Œè¡¨ç¤ºæ¯ä¸ªå¹³è¡¡å™¨çš„çŠ¶æ€ã€‚ç¬¬ä¸€ç»„è§£è¦æ±‚æ‰€æœ‰çš„ kik_ikiâ€‹ ç›¸ç­‰ï¼Œç¬¬äºŒç»„æ¥è¦æ±‚è‡³å°‘æœ‰ä¸¤ä¸ª kik_ikiâ€‹ ä¸ç›¸ç­‰ã€‚æ— è§£è¾“å‡º âˆ’1-1âˆ’1ã€‚ æ•°æ®èŒƒå›´ 2â‰¤nâ‰¤5Ã—104, 1â‰¤mâ‰¤1052\\le n\\le 5\\times 10^4,\\,1\\le m\\le 10^52â‰¤nâ‰¤5Ã—104,1â‰¤mâ‰¤105ã€‚ ä¸€é“æœ‰è¶£çš„æ„é€ é¢˜ã€‚ é¦–å…ˆæˆ‘ä»¬è€ƒè™‘æ„é€ ç¬¬ä¸€ç»„è§£ã€‚æˆ‘ä»¬è€ƒè™‘ä»åå¾€å‰åšï¼Œæšä¸¾ ttt åˆ¤æ–­æ˜¯å¦æœ‰ä¸€ç»„è§£ä½¿å¾—æœ€ç»ˆæ‰€æœ‰ ki=tk_i=tkiâ€‹=tã€‚ä»¤ fi,jf_{i,j}fi,jâ€‹ è¡¨ç¤ºä»…æœ‰æœ€å iii ä¸ªå¹³è¡¡å™¨æ—¶ï¼Œç¬¬ jjj æ¡çº¿ä¸Šçš„ä»¤ç‰Œæ˜¯å¦åˆ°äº† tttã€‚è€ƒè™‘åœ¨æœ€å‰é¢åŠ ä¸€ä¸ªå¹³è¡¡å™¨ã€‚å‘ç°å…¶å®å°±æ˜¯ fi+1,xnâˆ’i=fi+1,ynâˆ’i=fi,xjâˆ¨fi,ynâˆ’if_{i+1,x_{n-i}}=f_{i+1,y_{n-i}}=f_{i,x_j}\\vee f_{i,y_{n-i}}fi+1,xnâˆ’iâ€‹â€‹=fi+1,ynâˆ’iâ€‹â€‹=fi,xjâ€‹â€‹âˆ¨fi,ynâˆ’iâ€‹â€‹ã€‚å› ä¸ºåªè¦æœ‰ä¸€æ¡çº¿ä¸Šå¯ä»¥åˆ°è¾¾ tttï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¸¤æ¡çº¿ä¸Šçš„ä»¤ç‰Œéƒ½å¯¼åˆ°è¿™æ¡çº¿ä¸Šã€‚ è€ƒè™‘ä¸Šé¢çš„åšæ³•å°†ç¬¬ä¸€ç»´æ»šæ‰ä¹‹åæ˜¯ O(m)\\mathcal{O}(m)O(m) çš„ï¼Œäºæ˜¯æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ª O(nm)\\mathcal{O}(nm)O(nm) çš„ç®—æ³•ã€‚è€ƒè™‘ä¼˜åŒ–ï¼Œæˆ‘ä»¬ä»¤ gi,j,tg_{i,j,t}gi,j,tâ€‹ è¡¨ç¤ºæœ€å iii ä¸ªï¼Œç¬¬ jjj æ¡çº¿æ˜¯å¦èƒ½åˆ°è¾¾ tttã€‚æˆ‘ä»¬è€ƒè™‘è½¬ç§»å°±æ˜¯ gi+1,xnâˆ’i,t=gi+1,ynâˆ’i,t=gi,xnâˆ’i,tâˆ¨gi,ynâˆ’i,tg_{i+1,x_{n-i},t}=g_{i+1,y_{n-i},t}=g_{i,x_{n-i},t}\\vee g_{i,y_{n-i},t}gi+1,xnâˆ’iâ€‹,tâ€‹=gi+1,ynâˆ’iâ€‹,tâ€‹=gi,xnâˆ’iâ€‹,tâ€‹âˆ¨gi,ynâˆ’iâ€‹,tâ€‹ã€‚ä¸éš¾å‘ç°è¿™ä¸ªä¸œè¥¿å¯ä»¥ç”¨ bitset è¿›è¡Œä¼˜åŒ–ã€‚å¸¸æ•° 164\\frac{1}{64}641â€‹ï¼Œå¯ä»¥è¿‡ã€‚ ç„¶åè€ƒè™‘æ„é€ ï¼Œè¿™å°±ç®€å•äº†ï¼Œç›´æ¥æ²¿ç€ä¸€ä¸ªæœ‰è§£çš„ tttï¼Œç»§ç»­åšä¸€éä¸Šé¢çš„ dp å³å¯ã€‚ ç„¶åè€ƒè™‘ç¬¬äºŒé—®ï¼Œé¦–å…ˆæˆ‘ä»¬å‘ç°ä¹‹åå½“ n=2n=2n=2 çš„æ—¶å€™æ‰ä¼šå‘ç”Ÿæ— è§£ã€‚å…¶ä½™æ—¶åˆ»éƒ½ä¸ä¼šï¼Œè‡³äºä¸ºä»€ä¹ˆï¼Œæˆ‘ä»¬è€ƒè™‘ä¸€ä¸‹çš„æ„é€ æ–¹æ³•ã€‚ ä»ç„¶è€ƒè™‘å€’ç€åšï¼Œfi,jf_{i,j}fi,jâ€‹ è¡¨ç¤ºåŠ å…¥æœ€åçš„ iii ä¸ªå¹³è¡¡å™¨ï¼Œç¬¬ jjj æ ¹çº¿ä¸Šçš„ä»¤ç‰Œç°åœ¨åœ¨å“ªå„¿ã€‚ æˆ‘ä»¬è€ƒè™‘åŠ å…¥ä¸€ä¸ªä»¤ç‰Œï¼Œé‚£åªä¼šæœ‰ä¸¤ç§çŠ¶æ€ï¼šfi+1,xnâˆ’i=fi+1,ynâˆ’i=fi,xnâˆ’if_{i+1,x_{n-i}}=f_{i+1,y_{n-i}}=f_{i,x_{n-i}}fi+1,xnâˆ’iâ€‹â€‹=fi+1,ynâˆ’iâ€‹â€‹=fi,xnâˆ’iâ€‹â€‹ æˆ–æ˜¯ fi+1,xnâˆ’i=fi+1,ynâˆ’i=fi,ynâˆ’if_{i+1,x_{n-i}}=f_{i+1,y_{n-i}}=f_{i,y_{n-i}}fi+1,xnâˆ’iâ€‹â€‹=fi+1,ynâˆ’iâ€‹â€‹=fi,ynâˆ’iâ€‹â€‹ã€‚è€Œæœ€ç»ˆçš„ç›®çš„æ˜¯è®©è‡³å°‘æœ‰ä¸¤ä¸ª fff å€¼æ˜¯ä¸ç›¸ç­‰çš„ã€‚é‚£ä¹ˆæˆ‘ä»¬è€ƒè™‘ gi,jg_{i,j}gi,jâ€‹ è¡¨ç¤º fi,k=jf_{i,k}=jfi,kâ€‹=j çš„æ•°é‡ã€‚è¿™æ ·æˆ‘ä»¬åªè¦æ¯”è¾ƒä¸¤ä¸ª fff çš„ gggï¼Œçœ‹çœ‹é‚£ä¸ªå¤šï¼Œè®©å¤šçš„ç»™å°‘çš„ä¸€ä¸ªã€‚è€ƒè™‘åˆ° n&gt;2n&gt;2n&gt;2ï¼Œæ¯æ¬¡å°†ä¸€ä¸ª ggg åŠ  111ï¼Œä¸€ä¸ª ggg å‡ 111ã€‚ä¸éš¾å‘ç°ä¸€å®šæœ‰ä¸¤ä¸ª ggg æ˜¯å¤§äº 000 çš„ã€‚äºæ˜¯ä¸€å®šæœ‰ä¸€ç§æ–¹æ¡ˆåˆæ³•ã€‚ ä»£ç ","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"æ„é€ ","slug":"æ„é€ ","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%9E%84%E9%80%A0/"},{"name":"AtCoder","slug":"AtCoder","permalink":"https://pufanyi.github.io/oi-blog/tags/AtCoder/"}]},{"title":"ä¸€ä¸ªé•œåƒ","slug":"giteeé•œåƒ","date":"2020-03-04T16:00:00.000Z","updated":"2023-12-25T16:08:27.953Z","comments":true,"path":"giteeé•œåƒ/","link":"","permalink":"https://pufanyi.github.io/oi-blog/gitee%E9%95%9C%E5%83%8F/","excerpt":"","text":"2021-08-17 upd: gitee è¢«å°äº†ï¼Œè¯´æ˜¯æœ‰ä¸€äº›è¿è§„å†…å®¹ã€‚æ‰¾äº†åŠå¤©æ‰¾ä¸åˆ°ï¼Œé‚£å°±ç®—äº†ä¸æ›´é•œåƒäº†ã€‚ ç”±äºæœ€è¿‘ github.io æœ‰äº›ä¸ç¨³å®šï¼Œæˆ‘åšäº†ä¸ª é•œåƒï¼Œä¼šä¸å®šæœŸåŒæ­¥åšå®¢ä¸Šçš„å†…å®¹ã€‚","categories":[{"name":"å…¬å‘Š","slug":"å…¬å‘Š","permalink":"https://pufanyi.github.io/oi-blog/categories/%E5%85%AC%E5%91%8A/"}],"tags":[]},{"title":"AGC041D Problem Scores","slug":"agc041_d","date":"2020-03-03T16:00:00.000Z","updated":"2023-12-25T16:08:27.923Z","comments":true,"path":"agc041_d/","link":"","permalink":"https://pufanyi.github.io/oi-blog/agc041_d/","excerpt":"é—®å­˜åœ¨å¤šå°‘ä¸ªé•¿åº¦ä¸º n (2â‰¤nâ‰¤5000)n\\,(2\\le n\\le 5000)n(2â‰¤nâ‰¤5000) çš„å•è°ƒä¸å‡åºåˆ— aaaï¼Œæ»¡è¶³ 1â‰¤aiâ‰¤n1\\le a_i\\le n1â‰¤aiâ€‹â‰¤nï¼Œä¸”å¯¹äºä»»æ„ k (1â‰¤k&lt;n)k\\,(1\\le k&lt;n)k(1â‰¤k&lt;n)ï¼Œéƒ½æœ‰ï¼šå¯¹ä»»æ„å¤§å°ä¸º kkk çš„å­é›† SSS å’Œå¤§å°ä¸º k+1k+1k+1 çš„å­é›† TTTï¼Œæ»¡è¶³ âˆ‘xâˆˆSAx&lt;âˆ‘xâˆˆTAx\\sum_{x\\in S}A_x&lt;\\sum_{x\\in T}A_xâˆ‘xâˆˆSâ€‹Axâ€‹&lt;âˆ‘xâˆˆTâ€‹Axâ€‹ã€‚ç­”æ¡ˆå¯¹å¤§è´¨æ•° mmm å–æ¨¡ã€‚","text":"é—®å­˜åœ¨å¤šå°‘ä¸ªé•¿åº¦ä¸º n (2â‰¤nâ‰¤5000)n\\,(2\\le n\\le 5000)n(2â‰¤nâ‰¤5000) çš„å•è°ƒä¸å‡åºåˆ— aaaï¼Œæ»¡è¶³ 1â‰¤aiâ‰¤n1\\le a_i\\le n1â‰¤aiâ€‹â‰¤nï¼Œä¸”å¯¹äºä»»æ„ k (1â‰¤k&lt;n)k\\,(1\\le k&lt;n)k(1â‰¤k&lt;n)ï¼Œéƒ½æœ‰ï¼šå¯¹ä»»æ„å¤§å°ä¸º kkk çš„å­é›† SSS å’Œå¤§å°ä¸º k+1k+1k+1 çš„å­é›† TTTï¼Œæ»¡è¶³ âˆ‘xâˆˆSAx&lt;âˆ‘xâˆˆTAx\\sum_{x\\in S}A_x&lt;\\sum_{x\\in T}A_xâˆ‘xâˆˆSâ€‹Axâ€‹&lt;âˆ‘xâˆˆTâ€‹Axâ€‹ã€‚ç­”æ¡ˆå¯¹å¤§è´¨æ•° mmm å–æ¨¡ã€‚ é¦–å…ˆéœ€è¦å‘ç°ä¸€ä¸ªæ€§è´¨ï¼Œå°±æ˜¯å¦‚æœ k=âŒŠn2âŒ‹k=\\left\\lfloor\\frac{n}{2}\\right\\rfloork=âŒŠ2nâ€‹âŒ‹ çš„æ—¶å€™æ»¡è¶³äº†ï¼Œé‚£ä¹ˆå…¶ä»–çš„ kkk éƒ½èƒ½æ»¡è¶³ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿé¦–å…ˆæ˜¯å¯¹äºæ¯ä¸ª kkkï¼Œæ˜¾ç„¶å¦‚æœæ»¡è¶³äº† âˆ‘i=1k+1aiâ‰¥âˆ‘i=nâˆ’k+1nai\\sum_{i=1}^{k+1}a_i\\ge \\sum_{i=n-k+1}^na_iâˆ‘i=1k+1â€‹aiâ€‹â‰¥âˆ‘i=nâˆ’k+1nâ€‹aiâ€‹ï¼Œå°±æ»¡è¶³æ‰€æœ‰çš„ SSS å’Œ TTT äº†ã€‚ç„¶åå¦‚æœæ»¡è¶³äº† k=âŒŠn2âŒ‹k=\\left\\lfloor\\frac{n}{2}\\right\\rfloork=âŒŠ2nâ€‹âŒ‹ çš„æƒ…å†µï¼Œå¦‚æœ k&gt;âŒŠn2âŒ‹k&gt;\\left\\lfloor\\frac{n}{2}\\right\\rfloork&gt;âŒŠ2nâ€‹âŒ‹ï¼Œè€ƒè™‘åˆ°åºåˆ—å•è°ƒä¸é™ï¼Œå·¦è¾¹åŠ ä¸Šä¸€ä¸ªè¾ƒå¤§çš„æ•°ï¼Œå³è¾¹åŠ ä¸Šä¸€ä¸ªè¾ƒå°çš„æ•°ï¼Œé‚£ä¹ˆä¸ç­‰å¼è‚¯å®šä»ç„¶æˆç«‹ã€‚å¦åˆ™ï¼Œå¦‚æœ k&lt;âŒŠn2âŒ‹k&lt;\\left\\lfloor\\frac{n}{2}\\right\\rfloork&lt;âŒŠ2nâ€‹âŒ‹ï¼Œå…¶å®å°±æ˜¯å·¦è¾¹å‡å»ä¸€ä¸ªè¾ƒå°çš„æ•°ï¼Œå³è¾¹åŠ ä¸Šä¸€ä¸ªè¾ƒå¤§çš„æ•°ï¼Œä¸ç­‰å¼ä¹Ÿä»ç„¶æˆç«‹ã€‚ é‚£è¿™ä¸ªä¸œè¥¿æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Œæˆ‘ä»¬è€ƒè™‘å¯¹ä¸€æ³¢å¼å­ã€‚é¦–å…ˆæˆ‘ä»¬éœ€è¦å»æ‰ä¸€ä¸ªå•è°ƒæ€§ï¼Œæˆ‘ä»¬æ„é€ ä¸€ä¸ªå·®åˆ†æ•°ç»„ Î”ai=aiâˆ’aiâˆ’1\\Delta a_i=a_i-a_{i-1}Î”aiâ€‹=aiâ€‹âˆ’aiâˆ’1â€‹ï¼Œä¸ºäº†ä¸è®© Î”a1\\Delta a_1Î”a1â€‹ å¥‡æ€ªï¼Œæˆ‘ä»¬å°±è®© a0=1a_0=1a0â€‹=1ï¼Œè¿™æ ·å­å…¶å®å°±æ˜¯ ai=1+âˆ‘i=1nÎ”aia_i=1+\\sum_{i=1}^n\\Delta a_iaiâ€‹=1+âˆ‘i=1nâ€‹Î”aiâ€‹ï¼Œç„¶åæˆ‘ä»¬çš„å¼å­å°±å˜æˆäº†ï¼š âˆ‘i=1âŒŠn2âŒ‹+1âˆ‘j=1iÎ”ajâ‰¥âˆ‘i=nâˆ’âŒŠn2âŒ‹+1nâˆ‘j=1iÎ”aj\\sum_{i=1}^{\\left\\lfloor\\frac{n}{2}\\right\\rfloor+1}\\sum_{j=1}^i\\Delta a_j\\ge \\sum_{i=n-\\left\\lfloor\\frac{n}{2}\\right\\rfloor+1}^n\\sum_{j=1}^i\\Delta a_j i=1âˆ‘âŒŠ2nâ€‹âŒ‹+1â€‹j=1âˆ‘iâ€‹Î”ajâ€‹â‰¥i=nâˆ’âŒŠ2nâ€‹âŒ‹+1âˆ‘nâ€‹j=1âˆ‘iâ€‹Î”ajâ€‹ è¿™ä¸ªä¸‹å–æ•´æ„Ÿè§‰å¾ˆéš¾å—ï¼Œæˆ‘ä»¬å°±ç›´æ¥å°† nnn å¥‡å¶è®¨è®ºå¥½äº†ï¼š å½“ nnn æ˜¯å¥‡æ•°æ—¶ï¼ŒâŒŠn2âŒ‹=nâˆ’12\\left\\lfloor\\frac{n}{2}\\right\\rfloor=\\frac{n-1}{2}âŒŠ2nâ€‹âŒ‹=2nâˆ’1â€‹ï¼Œä¹Ÿå°±æ˜¯åŸå¼å°±å˜æˆäº†ï¼š âˆ‘i=1n+12âˆ‘j=1iÎ”ajâ‰¥âˆ‘i=n+12+1nâˆ‘j=1iÎ”aj\\sum_{i=1}^{\\frac{n+1}{2}}\\sum_{j=1}^i\\Delta a_j\\ge \\sum_{i=\\frac{n+1}{2}+1}^n\\sum_{j=1}^i\\Delta a_j i=1âˆ‘2n+1â€‹â€‹j=1âˆ‘iâ€‹Î”ajâ€‹â‰¥i=2n+1â€‹+1âˆ‘nâ€‹j=1âˆ‘iâ€‹Î”ajâ€‹ ä¸¤è¾¹éƒ½åŠ ä¸ª âˆ‘i=1n+12âˆ‘j=1iÎ”aj\\sum_{i=1}^{\\frac{n+1}{2}}\\sum_{j=1}^i\\Delta a_jâˆ‘i=12n+1â€‹â€‹âˆ‘j=1iâ€‹Î”ajâ€‹ æŠŠå³è¾¹ç»™è¡¥ä¸€ä¸‹ï¼š 2âˆ‘i=1n+12âˆ‘j=1iÎ”ajâ‰¥âˆ‘i=1nâˆ‘j=1iÎ”aj2\\sum_{i=1}^{\\frac{n+1}{2}}\\sum_{j=1}^i\\Delta a_j\\ge \\sum_{i=1}^n\\sum_{j=1}^i\\Delta a_j 2i=1âˆ‘2n+1â€‹â€‹j=1âˆ‘iâ€‹Î”ajâ€‹â‰¥i=1âˆ‘nâ€‹j=1âˆ‘iâ€‹Î”ajâ€‹ æ ¹æ®å¥—è·¯ï¼Œæˆ‘ä»¬éœ€è¦æŠŠå‰é¢çš„ Î£\\SigmaÎ£ æ‹†æ‰ï¼Œäºæ˜¯æˆ‘ä»¬æ‹†æ‰å®ƒï¼š 2âˆ‘i=1n+12(n+12âˆ’i+1)Î”aiâ‰¥âˆ‘i=1n(nâˆ’i+1)Î”ai2\\sum_{i=1}^{\\frac{n+1}{2}}\\left(\\frac{n+1}{2}-i+1\\right)\\Delta a_i\\ge \\sum_{i=1}^n\\left(n-i+1\\right)\\Delta a_i 2i=1âˆ‘2n+1â€‹â€‹(2n+1â€‹âˆ’i+1)Î”aiâ€‹â‰¥i=1âˆ‘nâ€‹(nâˆ’i+1)Î”aiâ€‹ è€ƒè™‘æˆ‘ä»¬å°† aia_iaiâ€‹ å·®åˆ†çš„ç›®çš„ï¼Œå…¶å®å°±æ˜¯æƒ³æŠŠå·¦è¾¹çš„å¼å­å‡è¿‡å»ï¼Œç„¶ååˆå¹¶èµ·æ¥ï¼š âˆ‘i=1nciÎ”aiâ‰¤0\\sum_{i=1}^nc_i\\Delta a_i\\le 0 i=1âˆ‘nâ€‹ciâ€‹Î”aiâ€‹â‰¤0 å…¶ä¸­ ci={iâˆ’2iâ‰¤n+12nâˆ’i+1i&gt;n+12c_i= \\begin{cases} i-2 &amp; i\\le \\frac{n+1}{2}\\\\ n-i+1 &amp; i&gt;\\frac{n+1}{2} \\end{cases} ciâ€‹={iâˆ’2nâˆ’i+1â€‹iâ‰¤2n+1â€‹i&gt;2n+1â€‹â€‹ åŒæ ·åœ°ï¼Œæˆ‘ä»¬æ¥è€ƒè™‘ nnn æ˜¯å¶æ•°çš„æƒ…å†µï¼š âˆ‘i=1n2âˆ‘j=1iÎ”ajâ‰¥âˆ‘i=n2+2nâˆ‘j=1iÎ”aj\\sum_{i=1}^{\\frac{n}{2}}\\sum_{j=1}^i\\Delta a_j\\ge \\sum_{i=\\frac{n}{2}+2}^n\\sum_{j=1}^i\\Delta a_j i=1âˆ‘2nâ€‹â€‹j=1âˆ‘iâ€‹Î”ajâ€‹â‰¥i=2nâ€‹+2âˆ‘nâ€‹j=1âˆ‘iâ€‹Î”ajâ€‹ è¡¥ä¸€è¡¥ï¼š 2âˆ‘i=1n2âˆ‘j=1iÎ”ajâ‰¥âˆ‘i=1nâˆ‘j=1iÎ”ajâˆ’âˆ‘i=1n2+1Î”ai2\\sum_{i=1}^{\\frac{n}{2}}\\sum_{j=1}^i\\Delta a_j\\ge \\sum_{i=1}^n\\sum_{j=1}^i\\Delta a_j-\\sum_{i=1}^{\\frac{n}{2}+1}\\Delta a_i 2i=1âˆ‘2nâ€‹â€‹j=1âˆ‘iâ€‹Î”ajâ€‹â‰¥i=1âˆ‘nâ€‹j=1âˆ‘iâ€‹Î”ajâ€‹âˆ’i=1âˆ‘2nâ€‹+1â€‹Î”aiâ€‹ æ‹†ä¸ª Î£\\SigmaÎ£ï¼š 2âˆ‘i=1n2(n2âˆ’i+1)Î”aiâ‰¥âˆ‘i=1n(nâˆ’i+1)Î”aiâˆ’âˆ‘i=1n2+1Î”ai2\\sum_{i=1}^{\\frac{n}{2}}\\left(\\frac{n}{2}-i+1\\right)\\Delta a_i\\ge \\sum_{i=1}^n\\left(n-i+1\\right)\\Delta a_i-\\sum_{i=1}^{\\frac{n}{2}+1}\\Delta a_i 2i=1âˆ‘2nâ€‹â€‹(2nâ€‹âˆ’i+1)Î”aiâ€‹â‰¥i=1âˆ‘nâ€‹(nâˆ’i+1)Î”aiâ€‹âˆ’i=1âˆ‘2nâ€‹+1â€‹Î”aiâ€‹ å†™æˆ âˆ‘ciÎ”aiâ‰¤0\\sum c_i\\Delta a_i\\le 0âˆ‘ciâ€‹Î”aiâ€‹â‰¤0 çš„å½¢å¼ï¼Œå¯ä»¥å¾—åˆ°ï¼š ci={iâˆ’2iâ‰¤n2nâˆ’ii=n2+1nâˆ’i+1i&gt;n2+1c_i= \\begin{cases} i-2 &amp; i\\le\\frac{n}{2}\\\\ n-i &amp; i=\\frac{n}{2}+1\\\\ n-i+1 &amp; i&gt;\\frac{n}{2}+1 \\end{cases} ciâ€‹=â©âªâªâ¨âªâªâ§â€‹iâˆ’2nâˆ’inâˆ’i+1â€‹iâ‰¤2nâ€‹i=2nâ€‹+1i&gt;2nâ€‹+1â€‹ ä¸éš¾å‘ç°å½“ i=n2+1i=\\frac{n}{2}+1i=2nâ€‹+1 æ—¶ï¼Œnâˆ’i=n2âˆ’1=iâˆ’2n-i=\\frac{n}{2}-1=i-2nâˆ’i=2nâ€‹âˆ’1=iâˆ’2ï¼Œæ‰€ä»¥ï¼š ci={iâˆ’2iâ‰¤n2+1nâˆ’i+1i&gt;n2+1c_i= \\begin{cases} i-2 &amp; i\\le\\frac{n}{2}+1\\\\ n-i+1 &amp; i&gt;\\frac{n}{2}+1 \\end{cases} ciâ€‹={iâˆ’2nâˆ’i+1â€‹iâ‰¤2nâ€‹+1i&gt;2nâ€‹+1â€‹ ç»¼åˆå¥‡å¶ä¸¤ä¸ªå¼å­ï¼Œæˆ‘ä»¬å‡å¯ä»¥å¾—åˆ°ï¼š âˆ‘i=1nciÎ”aiâ‰¤0\\sum_{i=1}^nc_i\\Delta a_i\\le 0 i=1âˆ‘nâ€‹ciâ€‹Î”aiâ€‹â‰¤0 å…¶ä¸­ ci={iâˆ’2iâ‰¤âŒŠn2âŒ‹+1nâˆ’i+1i&gt;âŒŠn2âŒ‹+1c_i= \\begin{cases} i-2 &amp; i\\le\\left\\lfloor\\frac{n}{2}\\right\\rfloor+1\\\\ n-i+1 &amp; i&gt;\\left\\lfloor\\frac{n}{2}\\right\\rfloor+1 \\end{cases} ciâ€‹={iâˆ’2nâˆ’i+1â€‹iâ‰¤âŒŠ2nâ€‹âŒ‹+1i&gt;âŒŠ2nâ€‹âŒ‹+1â€‹ æˆ‘ä»¬å›åˆ°é¢˜ç›®ï¼Œé™¤äº†è¿™ä¸ªæ¡ä»¶ï¼Œæˆ‘ä»¬å†å›è¿‡å¤´æ¥çœ‹çœ‹æœ‰ä»€ä¹ˆç¼ºçš„æ¡ä»¶ï¼Œä»”ç»†æ‰¾äº†æ‰¾å¥½åƒåªæœ‰ âˆ‘Î”ai+1â‰¤n\\sum\\Delta a_i+1\\le nâˆ‘Î”aiâ€‹+1â‰¤n äº†ã€‚ äºæ˜¯æˆ‘ä»¬è€ƒè™‘ç¡®å®š a2âˆ¼ana_2\\sim a_na2â€‹âˆ¼anâ€‹ çš„å€¼ï¼Œç„¶åå›è¿‡å¤´æ¥çœ‹çœ‹æœ‰å¤šå°‘ä¸ªç¬¦åˆæ¡ä»¶çš„ a1a_1a1â€‹ã€‚ æˆ‘ä»¬å‘ç°åªæœ‰ä¸¤ä¸ªæ¡ä»¶ï¼š {a1â‰¤nâˆ’1âˆ’âˆ‘i=2naia1â‰¥âˆ‘i=2nciai\\begin{cases} a_1\\le n-1-\\sum_{i=2}^na_i\\\\ a_1\\ge \\sum_{i=2}^nc_ia_i \\end{cases} {a1â€‹â‰¤nâˆ’1âˆ’âˆ‘i=2nâ€‹aiâ€‹a1â€‹â‰¥âˆ‘i=2nâ€‹ciâ€‹aiâ€‹â€‹ äºæ˜¯æ»¡è¶³æ¡ä»¶çš„ a1a_1a1â€‹ ä¸ªæ•°å°±æ˜¯ï¼š maxâ¡(0,nâˆ’âˆ‘i=2n(ci+1)ai)\\max\\left(0, n-\\sum_{i=2}^n\\left(c_i+1\\right)a_i\\right) max(0,nâˆ’i=2âˆ‘nâ€‹(ciâ€‹+1)aiâ€‹) æˆ‘ä»¬ä»¤ fif_ifiâ€‹ è¡¨ç¤º âˆ‘j=2n(cj+1)aj=i\\sum_{j=2}^n\\left(c_j+1\\right)a_j=iâˆ‘j=2nâ€‹(cjâ€‹+1)ajâ€‹=i çš„æ–¹æ¡ˆæ•°ï¼Œé‚£ä¹ˆæœ€ç»ˆçš„ç­”æ¡ˆå°±æ˜¯ âˆ‘i=0nâˆ’1(nâˆ’i)â‹…fi\\sum_{i=0}^{n-1} (n-i)\\cdot f_iâˆ‘i=0nâˆ’1â€‹(nâˆ’i)â‹…fiâ€‹ã€‚ æˆ‘ä»¬æœ€åè¦åšçš„ä¸€ä»¶äº‹æƒ…å°±æ˜¯è®¡ç®— fif_ifiâ€‹ äº†ï¼Œä¸éš¾å‘ç°å…¶å®å°±æ˜¯ä¸€ä¸ªèƒŒåŒ…ï¼Œç¬¬ iii ä¸ªç‰©å“é‡é‡ cic_iciâ€‹ï¼Œå¯ä»¥é€‰ aia_iaiâ€‹ ä¸ªï¼Œç›´æ¥å¤§åŠ› dp è¿‡å»å³å¯ã€‚ äºæ˜¯å¤æ‚åº¦ O(n2)\\mathcal{O}(n^2)O(n2)ã€‚ ä»£ç ","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"DP","slug":"DP","permalink":"https://pufanyi.github.io/oi-blog/tags/DP/"},{"name":"AtCoder","slug":"AtCoder","permalink":"https://pufanyi.github.io/oi-blog/tags/AtCoder/"}]},{"title":"ARC099F Eating Symbols Hard","slug":"arc099_d","date":"2020-03-03T16:00:00.000Z","updated":"2023-12-25T16:08:27.936Z","comments":true,"path":"arc099_d/","link":"","permalink":"https://pufanyi.github.io/oi-blog/arc099_d/","excerpt":"æœ‰ä¸€æ®µæ ‡å·ä» âˆ’âˆ-\\inftyâˆ’âˆ åˆ° +âˆ+\\infty+âˆ çš„åºåˆ— AAAï¼Œåˆå§‹æ˜¯ Ai=0A_i=0Aiâ€‹=0ã€‚ç°åœ¨æœ‰ä¸€ä¸ªäººåœ¨ 000 ä½ç½®ï¼Œæœ‰ä¸€æ®µæ“ä½œåºåˆ— sssï¼Œä¾æ¬¡è¿›è¡Œæ“ä½œã€‚ å‡è®¾ iii æ—¶åˆ»è¿™ä¸ªäººåœ¨ä½ç½® pppï¼Œå¦‚æœ sis_isiâ€‹ æ˜¯ '+'ï¼Œåˆ™å°† ApA_pApâ€‹ åŠ  111ï¼Œå¦‚æœæ˜¯ '-'ï¼Œåˆ™å‡ 111ï¼›å¦‚æœæ˜¯ '&lt;' åˆ™è¯¥äººå·¦ç§»ä¸€æ ¼ï¼Œå¦åˆ™æ˜¯ '&gt;' åˆ™å³ç§»ä¸€æ ¼ã€‚ è¦æ±‚æ•°å‡º sss çš„æ‰€æœ‰è¿ç»­å­ä¸²ä¸­æœ€ç»ˆå¾—åˆ°çš„ AAA ä¸ sss æœ€ç»ˆå¾—åˆ°ç›¸åŒ AAA åºåˆ—çš„ä¸ªæ•°ã€‚ æ•°æ®èŒƒå›´ âˆ£sâˆ£â‰¤250000|s|\\le 250000âˆ£sâˆ£â‰¤250000ã€‚","text":"æœ‰ä¸€æ®µæ ‡å·ä» âˆ’âˆ-\\inftyâˆ’âˆ åˆ° +âˆ+\\infty+âˆ çš„åºåˆ— AAAï¼Œåˆå§‹æ˜¯ Ai=0A_i=0Aiâ€‹=0ã€‚ç°åœ¨æœ‰ä¸€ä¸ªäººåœ¨ 000 ä½ç½®ï¼Œæœ‰ä¸€æ®µæ“ä½œåºåˆ— sssï¼Œä¾æ¬¡è¿›è¡Œæ“ä½œã€‚ å‡è®¾ iii æ—¶åˆ»è¿™ä¸ªäººåœ¨ä½ç½® pppï¼Œå¦‚æœ sis_isiâ€‹ æ˜¯ '+'ï¼Œåˆ™å°† ApA_pApâ€‹ åŠ  111ï¼Œå¦‚æœæ˜¯ '-'ï¼Œåˆ™å‡ 111ï¼›å¦‚æœæ˜¯ '&lt;' åˆ™è¯¥äººå·¦ç§»ä¸€æ ¼ï¼Œå¦åˆ™æ˜¯ '&gt;' åˆ™å³ç§»ä¸€æ ¼ã€‚ è¦æ±‚æ•°å‡º sss çš„æ‰€æœ‰è¿ç»­å­ä¸²ä¸­æœ€ç»ˆå¾—åˆ°çš„ AAA ä¸ sss æœ€ç»ˆå¾—åˆ°ç›¸åŒ AAA åºåˆ—çš„ä¸ªæ•°ã€‚ æ•°æ®èŒƒå›´ âˆ£sâˆ£â‰¤250000|s|\\le 250000âˆ£sâˆ£â‰¤250000ã€‚ è€ƒè™‘æ„é€ ä¸€æ³¢ç±»ä¼¼ç”Ÿæˆå‡½æ•°çš„ä¸œè¥¿ f(x)=âˆ‘i=âˆ’âˆ+âˆAixif(x)=\\sum_{i=-\\infty}^{+\\infty}A_ix^if(x)=âˆ‘i=âˆ’âˆ+âˆâ€‹Aiâ€‹xiï¼Œå¦å¤–è¿˜æœ‰ä¸€ä¸ªæŒ‡é’ˆ gggï¼Œå¼€å§‹æ˜¯ ggg æŒ‡å‘ 000 ä½ç½®ï¼Œæ˜¾ç„¶åˆå§‹æ—¶ f(x)=0f(x)=0f(x)=0ã€‚ æˆ‘ä»¬ä»¤ fi(x)f_i(x)fiâ€‹(x) è¡¨ç¤º 1âˆ¼i1\\sim i1âˆ¼i è¿™ä¸€æ®µå­ä¸²æ“ä½œæ‰€å¾—åˆ°çš„ fff å€¼ï¼Œgig_igiâ€‹ è¡¨ç¤º 1âˆ¼i1\\sim i1âˆ¼i æ“ä½œåçš„æŒ‡é’ˆä½ç½®ã€‚è€ƒè™‘åœ¨æœ«å°¾åŠ å…¥ä¸€ä¸ªå­—ç¬¦ cccï¼Œå¦‚æœ ccc æ˜¯ '+' æˆ– '-'ï¼Œé‚£æ˜¾ç„¶ {fi(x)=fiâˆ’1(x)Â±xgigi=giâˆ’1\\begin{cases}f_i(x)=f_{i-1}(x)\\pm x^{g_i}\\\\g_i=g_{i-1}\\end{cases}{fiâ€‹(x)=fiâˆ’1â€‹(x)Â±xgiâ€‹giâ€‹=giâˆ’1â€‹â€‹ï¼ŒåŒç†å¦‚æœ ccc æ˜¯ '&lt;' æˆ– '&gt;'ï¼Œé‚£æ˜¾ç„¶ {fi(x)=fiâˆ’1(x)gi=giâˆ’1âˆ“1\\begin{cases}f_i(x)=f_{i-1}(x)\\\\g_i=g_{i-1}\\mp 1\\end{cases}{fiâ€‹(x)=fiâˆ’1â€‹(x)giâ€‹=giâˆ’1â€‹âˆ“1â€‹ã€‚ å¦‚æœè¦è®¡ç®— [l,r][l,r][l,r] çš„ fff å€¼ï¼Œä¸éš¾å‘ç°å°±æ˜¯ fr(x)âˆ’flâˆ’1(x)xglâˆ’1\\frac{f_r(x)-f_{l-1}(x)}{x^{g_{l-1}}}xglâˆ’1â€‹frâ€‹(x)âˆ’flâˆ’1â€‹(x)â€‹ã€‚ äºæ˜¯æˆ‘ä»¬è¦ç®—çš„å°±æ˜¯ fn(x)=fr(x)âˆ’flâˆ’1(x)xglâˆ’1f_n(x)=\\frac{f_r(x)-f_{l-1}(x)}{x^{g_{l-1}}}fnâ€‹(x)=xglâˆ’1â€‹frâ€‹(x)âˆ’flâˆ’1â€‹(x)â€‹ï¼Œè€ƒè™‘éšä¾¿é€‰ä¸€ä¸ª xxxï¼Œç®—å‡ºè¿™ä¸ªå¤šé¡¹å¼çš„å€¼ç„¶åå“ˆå¸Œä¸€ä¸‹å³å¯ã€‚ ä»£ç ","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"DP","slug":"DP","permalink":"https://pufanyi.github.io/oi-blog/tags/DP/"},{"name":"AtCoder","slug":"AtCoder","permalink":"https://pufanyi.github.io/oi-blog/tags/AtCoder/"},{"name":"hash","slug":"hash","permalink":"https://pufanyi.github.io/oi-blog/tags/hash/"}]},{"title":"AGC029F Construction of a tree","slug":"agc029_f","date":"2020-02-22T16:00:00.000Z","updated":"2023-12-25T16:08:27.923Z","comments":true,"path":"agc029_f/","link":"","permalink":"https://pufanyi.github.io/oi-blog/agc029_f/","excerpt":"é¢˜æ„å¤§æ¦‚å°±æ˜¯ç»™ä½  nâˆ’1n-1nâˆ’1 ä¸ªç‚¹é›†ï¼Œå…¨é›†æ˜¯ {1,2,â€¦,n}\\{1,2,\\dots, n\\}{1,2,â€¦,n}ï¼Œç°åœ¨è¦ä»æ¯ä¸ªç‚¹ç‚¹é›†ä¸­æŠ½å‡ºä¸¤ä¸ªç‚¹æ¥è¿è¾¹ï¼Œæœ€ç»ˆå½¢æˆä¸€æ£µæ ‘ã€‚è®©ä½ è¾“å‡ºæ–¹æ¡ˆæˆ–åˆ¤æ–­æ— è§£ã€‚nnn æœ‰ 10510^5105ï¼Œæ‰€æœ‰é›†åˆå¤§å°ä¹‹å’Œä¸è¶…è¿‡ 2Ã—1052\\times 10^52Ã—105ã€‚","text":"é¢˜æ„å¤§æ¦‚å°±æ˜¯ç»™ä½  nâˆ’1n-1nâˆ’1 ä¸ªç‚¹é›†ï¼Œå…¨é›†æ˜¯ {1,2,â€¦,n}\\{1,2,\\dots, n\\}{1,2,â€¦,n}ï¼Œç°åœ¨è¦ä»æ¯ä¸ªç‚¹ç‚¹é›†ä¸­æŠ½å‡ºä¸¤ä¸ªç‚¹æ¥è¿è¾¹ï¼Œæœ€ç»ˆå½¢æˆä¸€æ£µæ ‘ã€‚è®©ä½ è¾“å‡ºæ–¹æ¡ˆæˆ–åˆ¤æ–­æ— è§£ã€‚nnn æœ‰ 10510^5105ï¼Œæ‰€æœ‰é›†åˆå¤§å°ä¹‹å’Œä¸è¶…è¿‡ 2Ã—1052\\times 10^52Ã—105ã€‚ è€ƒè™‘æ„é€ ï¼Œå„¿å­å‘çˆ¶äº²è¿è¾¹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯ä¸ªé›†åˆæœ€åéƒ½æ˜¯å„¿å­ â†’\\toâ†’ çˆ¶äº²çš„ä¸€æ¡è¾¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥éšä¾¿é€‰ä¸€ä¸ªç‚¹ä½œä¸ºè·Ÿï¼Œå…¶ä½™ç‚¹è‚¯å®šå¯¹åº”ä¸€ä¸ªé›†åˆï¼Œè¡¨ç¤ºè¿™ä¸ªé›†åˆæ‰€å¯¹åº”çš„è¾¹ï¼Œä¸€ç«¯æ˜¯ä»–ï¼Œå¦ä¸€ç«¯æ˜¯ä»–çˆ¶äº²ã€‚å…¶å®ä¹Ÿå°±æ˜¯ä¸€ä¸ªåŒ¹é…ï¼Œå·¦è¾¹æ˜¯é™¤äº†æ ¹èŠ‚ç‚¹ä»¥å¤–çš„æ‰€æœ‰ç‚¹ï¼Œå³è¾¹æ˜¯æ‰€æœ‰ç‚¹é›†ã€‚ç‚¹ä¸ç‚¹é›†æœ‰è¾¹å½“ä¸”ä»…å½“è¿™ä¸ªç‚¹åœ¨ç‚¹é›†ä¸­å‡ºç°ã€‚ æ˜¾ç„¶åœ°ï¼Œå¦‚æœè¿™ä¸ªåŒ¹é…æ— è§£é‚£ä¹ˆæœ€ç»ˆè‚¯å®šæ— è§£ï¼Œå› ä¸ºæ ¹æœ¬æ‰¾ä¸åˆ°ä¸€ä¸ªå®Œç¾çš„å„¿å­ â†’\\toâ†’ çˆ¶äº²çš„æ˜ å°„ã€‚æ‰¾åˆ°åŒ¹é…ä¹‹åæˆ‘ä»¬æŠŠæ ¹åŠ ä¸Šå»ï¼Œè·Ÿå‰é¢çš„è¿æ³•ä¸€æ ·ã€‚å¦‚æœè¿ä¸Šä¹‹åè¿™å¼ å›¾ä»ç„¶ä¸è¿é€šï¼Œé‚£ä¹ˆæ˜¾ç„¶æ— è§£ï¼Œå› ä¸ºä¸¤ä¸ªç‹¬ç«‹çš„è¿é€šå—æ˜¾ç„¶æ²¡æœ‰ç”Ÿæˆæ ‘ã€‚ é‚£å¦‚æœä¸Šé¢çš„åˆ¤æ‰ä¹‹åæ˜¯å¦å°±ä¸€å®šæœ‰è§£äº†å‘¢ï¼Ÿæˆ‘ä»¬è€ƒè™‘æ„é€ è§£ã€‚æˆ‘ä»¬ä»æ ¹èŠ‚ç‚¹å¼€å§‹ bfsï¼Œæˆ‘ä»¬è€ƒè™‘æ ¹èŠ‚ç‚¹æ‰€æœ‰è¿å‡ºå»çš„é›†åˆï¼Œè¿™äº›é›†åˆçš„åŒ¹é…ç‚¹çš„çˆ¶äº²éƒ½å®šä½œæ˜¯è¿™ä¸ªæ ¹ï¼Œç„¶åè¿™æ ·é€’å½’ä¸‹å»ã€‚ä¸éš¾å‘ç°ï¼Œè¿™æ ·åšæ˜¯è‚¯å®šæœ‰è§£çš„ã€‚ è€ƒè™‘å¤æ‚åº¦ï¼Œè¾¹æ•° mmm æ˜¯é›†åˆçš„æ€»å¤§å°ï¼Œç”¨ Dinic åšäºŒåˆ†å›¾åŒ¹é…ï¼Œå¤æ‚åº¦ O(mn)\\mathcal{O}(m\\sqrt{n})O(mnâ€‹)ï¼Œä¹‹åçš„æ„é€ è§£å¤æ‚åº¦ O(m)\\mathcal{O}(m)O(m)ï¼Œæ‰€ä»¥æ€»å¤æ‚åº¦ O(mn)\\mathcal{O}(m\\sqrt{n})O(mnâ€‹)ã€‚ ä»£ç ","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"ç½‘ç»œæµ","slug":"ç½‘ç»œæµ","permalink":"https://pufanyi.github.io/oi-blog/tags/%E7%BD%91%E7%BB%9C%E6%B5%81/"},{"name":"AtCoder","slug":"AtCoder","permalink":"https://pufanyi.github.io/oi-blog/tags/AtCoder/"}]},{"title":"AGC024D Isomorphism Freak","slug":"agc024_d","date":"2020-02-18T16:00:00.000Z","updated":"2023-12-25T16:08:27.923Z","comments":true,"path":"agc024_d/","link":"","permalink":"https://pufanyi.github.io/oi-blog/agc024_d/","excerpt":"å®šä¹‰ä¸€æ£µæ ‘ä¸Šä¸¤ä¸ªç‚¹ç­‰ä»·å½“ä¸”ä»…å½“ä»¥è¿™ä¸¤ä¸ªç‚¹ä¸ºæ ¹çš„æœ‰æ ¹æ ‘åŒæ„ï¼Œä¸€æ£µæ ‘çš„æƒå€¼å®šä¹‰ä¸ºè¿™æ£µæ ‘çš„ç­‰ä»·ç±»ä¸ªæ•°ã€‚ ç»™å‡ºä¸€æ£µ nnn ä¸ªç‚¹çš„æ ‘ï¼Œå¯ä»¥åœ¨è¿™æ£µæ ‘åŸºç¡€ä¸æ–­çš„åŠ å¶å­ï¼Œä½¿å¾—æœ€åæ ‘çš„æƒå€¼æœ€å°ï¼Œæ±‚å‡ºè¿™ä¸ªæƒå€¼ï¼Œä»¥åŠæ»¡è¶³ä¹‹å‰æ¡ä»¶çš„æ‰€æœ‰æ ‘ä¸­æœ€å°å¶å­æ•°ã€‚ æ•°æ®èŒƒå›´ nâ‰¤100n\\le 100nâ‰¤100ã€‚","text":"å®šä¹‰ä¸€æ£µæ ‘ä¸Šä¸¤ä¸ªç‚¹ç­‰ä»·å½“ä¸”ä»…å½“ä»¥è¿™ä¸¤ä¸ªç‚¹ä¸ºæ ¹çš„æœ‰æ ¹æ ‘åŒæ„ï¼Œä¸€æ£µæ ‘çš„æƒå€¼å®šä¹‰ä¸ºè¿™æ£µæ ‘çš„ç­‰ä»·ç±»ä¸ªæ•°ã€‚ ç»™å‡ºä¸€æ£µ nnn ä¸ªç‚¹çš„æ ‘ï¼Œå¯ä»¥åœ¨è¿™æ£µæ ‘åŸºç¡€ä¸æ–­çš„åŠ å¶å­ï¼Œä½¿å¾—æœ€åæ ‘çš„æƒå€¼æœ€å°ï¼Œæ±‚å‡ºè¿™ä¸ªæƒå€¼ï¼Œä»¥åŠæ»¡è¶³ä¹‹å‰æ¡ä»¶çš„æ‰€æœ‰æ ‘ä¸­æœ€å°å¶å­æ•°ã€‚ æ•°æ®èŒƒå›´ nâ‰¤100n\\le 100nâ‰¤100ã€‚ æˆ‘ä»¬å‘ç°å…¶å®æœ€ç»ˆæ‰€å¾—çš„æ ‘åªæœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯ä»¥ä¸€æ¡è¾¹ä¸ºä¸­å¿ƒï¼Œå·¦å³ä¸¤è¾¹åŒæ„ï¼Œä¸€ç§æ˜¯ä»¥ç‚¹ä¸ºä¸­å¿ƒï¼Œå‘ˆæ”¾å°„çŠ¶åˆ†å¸ƒã€‚ å…¶å®è¿™ä¸¤ç§éƒ½ä¸€æ ·ï¼Œä»¥è¾¹ä¸ºæ”¾å°„çŠ¶çš„åªè¦æŠŠè¿™æ¡è¾¹çœ‹æˆä¸€ä¸ªç‚¹å°±å¯ä»¥äº†ã€‚ è¿™æ ·æˆ‘ä»¬è€ƒè™‘æšä¸¾ä¸­å¿ƒï¼Œè¦æ±‚å…¶æƒå€¼ï¼Œé¦–å…ˆä¸éš¾å‘ç°åŒæ„çš„æ•°é‡å…¶å®å°±æ˜¯ä»¥ä¸­å¿ƒä¸ºæ ¹çš„æ ‘çš„æ·±åº¦ã€‚ç„¶åæˆ‘ä»¬è€ƒè™‘å¶å­ä¸ªæ•°ï¼Œæˆ‘ä»¬åªè¦æƒ³æƒ³æ„é€ è¿™æ£µæ ‘çš„è¿‡ç¨‹ï¼Œå…¶å®å°±æ˜¯æŠŠæ¯ä¸€å±‚æ·±åº¦çš„æ‰€æœ‰ç‚¹çš„å„¿å­æ•°è¡¥æˆç›¸åŒï¼Œé‚£ä¹ˆè¡¥å®Œåæ ‘çš„å¶å­ä¸ªæ•°å°±æ˜¯æ¯å±‚éå¶å­èŠ‚ç‚¹å„¿å­ä¸ªæ•°çš„ä¹˜ç§¯ï¼Œå¯¹äºåŸæ ‘æ¥è®²å°±æ˜¯æ¯å±‚å„¿å­æ ‘æœ€å¤šçš„å„¿å­ä¸ªæ•°çš„ä¹˜ç§¯ã€‚ å¤æ‚åº¦ O(n2)\\mathcal{O}(n^2)O(n2)ï¼Œå¼€ 100100100 å¤§æ¦‚æ˜¯ä¸ºäº†ä¸çˆ† long longã€‚ è¿™é‡Œæ˜¯ä»£ç ","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"è´ªå¿ƒ","slug":"è´ªå¿ƒ","permalink":"https://pufanyi.github.io/oi-blog/tags/%E8%B4%AA%E5%BF%83/"},{"name":"AtCoder","slug":"AtCoder","permalink":"https://pufanyi.github.io/oi-blog/tags/AtCoder/"}]},{"title":"CodeForces 512D Fox And Travelling","slug":"CF512D","date":"2020-02-13T16:00:00.000Z","updated":"2023-12-25T16:08:27.880Z","comments":true,"path":"CF512D/","link":"","permalink":"https://pufanyi.github.io/oi-blog/CF512D/","excerpt":"æœ‰ä¸€å¼  nnn ä¸ªç‚¹ mmm æ¡è¾¹çš„ç®€å•æ— å‘å›¾ï¼Œæ¯æ¬¡é€‰æ‹©ä¸€ä¸ªåº¦æ•°å°äºç­‰äº 111 çš„ç‚¹ç„¶åå°†å…¶åˆ é™¤ï¼Œå¯¹äºæ¯ä¸ª kkk æ±‚åˆ å» kkk ä¸ªç‚¹çš„æ–¹æ¡ˆæ•°ã€‚nâ‰¤100, mâ‰¤nÃ—(nâˆ’1)2n\\le 100,\\,m\\le \\frac{n\\times(n-1)}{2}nâ‰¤100,mâ‰¤2nÃ—(nâˆ’1)â€‹ã€‚","text":"æœ‰ä¸€å¼  nnn ä¸ªç‚¹ mmm æ¡è¾¹çš„ç®€å•æ— å‘å›¾ï¼Œæ¯æ¬¡é€‰æ‹©ä¸€ä¸ªåº¦æ•°å°äºç­‰äº 111 çš„ç‚¹ç„¶åå°†å…¶åˆ é™¤ï¼Œå¯¹äºæ¯ä¸ª kkk æ±‚åˆ å» kkk ä¸ªç‚¹çš„æ–¹æ¡ˆæ•°ã€‚nâ‰¤100, mâ‰¤nÃ—(nâˆ’1)2n\\le 100,\\,m\\le \\frac{n\\times(n-1)}{2}nâ‰¤100,mâ‰¤2nÃ—(nâˆ’1)â€‹ã€‚ é¦–å…ˆç¯ä¸Šç‚¹è‚¯å®šåˆ ä¸æ‰ï¼Œå¦‚æœä¸€ä¸ªè¿é€šå—ä¹‹é—´æœ‰ä¸¤ä¸ªç¯ï¼Œé‚£ä¹ˆè¢«ä¸¤ä¸ªç¯å¤¹ç€çš„ç‚¹è‚¯å®šä¹Ÿåˆ ä¸æ‰ã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬è€ƒè™‘ä¸¤ä»¶äº‹æƒ…ï¼Œä¸€ä»¶äº‹æƒ…å°±æ˜¯å¦‚æœä¸€ä¸ªè¿é€šå—æœ¬èº«ä¸æ˜¯ä¸€æ£µæ ‘ï¼Œé‚£ä¹ˆå¦‚æœå®ƒçš„ä¸€éƒ¨åˆ†ç‚¹èƒ½è¢«åˆ æ‰ï¼Œé‚£è¿™éƒ¨åˆ†ç‚¹è‚¯å®šç»„æˆä¸€ä¸ªæ£®æ—ï¼Œæ¯æ£µæ ‘è‚¯å®šä¹‹é ç€ä¸€ä¸ªç¯ã€‚å¤–é¢çš„ç‚¹å…ˆè¢«åˆ ï¼Œè€Œç¯æ—è¾¹çš„ç‚¹æ˜¯æœ€åè¢«åˆ çš„ï¼Œé‚£æˆ‘ä»¬ç›¸å½“äºå¯¹äºæ¯æ£µæ ‘å°±å¯ä»¥ä»¥ç¯æ—è¾¹é‚£ä¸ªç‚¹ä¸ºæ ¹ï¼Œç„¶å dp ä¸Šå»ã€‚è¿™ä¸ª dp å¾ˆæ–¹ä¾¿ï¼Œè€ƒè™‘åˆ°æ²¡ä¸¤ä¸ªç‚¹åªä¼šåœ¨å…¶ LCA ä¸Šè¢«åˆå¹¶ä¸€æ¬¡ï¼Œæ‰€ä»¥è¿™éƒ¨åˆ†çš„å¤æ‚åº¦æ˜¯ O(n2)\\mathcal{O}(n^2)O(n2) çš„ã€‚ ç„¶åæˆ‘ä»¬è€ƒè™‘è¿™ä¸ªè¿é€šå—æœ¬èº«å°±æ˜¯ä¸€æ£µæ ‘çš„æƒ…å†µï¼Œè¿™ä¸ªæƒ…å†µä¸‹å…¶å®å°±æ˜¯æ¯ä¸ªç‚¹éƒ½æ˜¯å¯ä»¥ä½œä¸º dp çš„æ ¹çš„ï¼Œè¿™æ ·åšå‡ºæ¥çš„è¯å¦‚æœå…¨åˆ å®Œé‚£æ˜¾ç„¶æ˜¯å¯¹çš„ï¼Œä½†æ˜¯å‘ç°å¦‚æœä¸åˆ å®Œçš„è¯æ˜¯ä¼šç®—é‡çš„ã€‚æˆ‘ä»¬è€ƒè™‘ä¸åˆ å®Œçš„ä¸€ç§æ–¹æ¡ˆï¼Œå¦‚æœç•™äº† xxx ä¸ªèŠ‚ç‚¹ï¼Œé‚£ä¹ˆå¯¹äºç•™ä¸‹æ¥çš„è¿™ xxx ä¸ªèŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä½œä¸ºæ ¹ dp çš„æ—¶å€™éƒ½ä¼šæŠŠè¿™ç§æ–¹æ¡ˆç®—ä¸€éã€‚äºæ˜¯å…¶å®å°±æ˜¯è¿™ç§æ–¹æ¡ˆå¯¹ç­”æ¡ˆçš„è´¡çŒ®æ˜¯ xxx è€Œä¸æ˜¯ 111 äº†ã€‚äºæ˜¯æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥æŠŠ dp å‡ºæ¥çš„ç»“æ„é™¤ä»¥ xxx ä¾¿ä½¿ç­”æ¡ˆäº†ã€‚ æœ€åæ¯ä¸ªè¿é€šå—çš„åˆå¹¶ç›´æ¥æš´åŠ›å·ä¸€ä¸‹å°±å¯ä»¥äº†ï¼Œåˆ«å¿˜äº†ä¹˜ä¸ªç»„åˆæ•°ã€‚ ä»£ç åœ¨è¿™é‡Œ","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"CodeForces","slug":"CodeForces","permalink":"https://pufanyi.github.io/oi-blog/tags/CodeForces/"},{"name":"DP","slug":"DP","permalink":"https://pufanyi.github.io/oi-blog/tags/DP/"}]},{"title":"CodeForces 576D Flights for Regular Customers","slug":"CF576D","date":"2020-02-12T16:00:00.000Z","updated":"2023-12-25T16:08:27.882Z","comments":true,"path":"CF576D/","link":"","permalink":"https://pufanyi.github.io/oi-blog/CF576D/","excerpt":"æœ‰ä¸€å¼  nnn ä¸ªç‚¹ mmm æ¡è¾¹çš„æ— å‘å›¾ï¼Œç¬¬ iii æ¡è¾¹å¼€é€šçš„æ¡ä»¶æ˜¯ä½ å·²ç»èµ°è¿‡äº† did_idiâ€‹ æ¡è¾¹ï¼Œé—® 1â†’n1\\to n1â†’n è‡³å°‘éœ€è¦èµ°å¤šå°‘æ¡è¾¹ï¼Œæˆ–è¾“å‡ºæ— è§£ã€‚nâ‰¤mâ‰¤150, 0â‰¤diâ‰¤109n\\le m\\le 150,\\,0\\le d_i\\le 10^9nâ‰¤mâ‰¤150,0â‰¤diâ€‹â‰¤109ã€‚","text":"æœ‰ä¸€å¼  nnn ä¸ªç‚¹ mmm æ¡è¾¹çš„æ— å‘å›¾ï¼Œç¬¬ iii æ¡è¾¹å¼€é€šçš„æ¡ä»¶æ˜¯ä½ å·²ç»èµ°è¿‡äº† did_idiâ€‹ æ¡è¾¹ï¼Œé—® 1â†’n1\\to n1â†’n è‡³å°‘éœ€è¦èµ°å¤šå°‘æ¡è¾¹ï¼Œæˆ–è¾“å‡ºæ— è§£ã€‚nâ‰¤mâ‰¤150, 0â‰¤diâ‰¤109n\\le m\\le 150,\\,0\\le d_i\\le 10^9nâ‰¤mâ‰¤150,0â‰¤diâ€‹â‰¤109ã€‚ é¦–å…ˆæœ‰ä¸€ä¸ª simple çš„æƒ³æ³•å°±æ˜¯æšä¸¾è·¯å¾„ä¸Šçš„ ddd æœ€å¤§çš„è¾¹ï¼Œç„¶åå…ˆç”¨æ¯”è¯¥è¾¹ ddd å°çš„è¾¹æ»¡è¶³è¦æ±‚åœ°èµ° did_idiâ€‹ æ­¥ï¼Œç„¶åå†ç”¨ ddd å°äºç­‰äºè¯¥è¾¹çš„è¾¹èµ°åˆ°ç»ˆç‚¹ã€‚ æˆ‘ä»¬è€ƒè™‘å°†è¾¹ä»å¤§åˆ°å°æ’åºï¼Œé¦–å…ˆè¦ç®—å‡ºå‰ did_idiâ€‹ æ­¥èƒ½åˆ°å“ªå„¿ï¼Œè¿™ä¸éš¾ç”¨çŸ©ä¹˜ï¼Œç„¶åæ˜¯èµ°ç”¨å°äºç­‰äº did_idiâ€‹ çš„è¾¹èµ°åˆ°ç»ˆç‚¹ï¼Œè¿™ä¸€ä¸ª bfs å³å¯è§£å†³ã€‚ ä»£ç åœ¨è¿™é‡Œ","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"CodeForces","slug":"CodeForces","permalink":"https://pufanyi.github.io/oi-blog/tags/CodeForces/"},{"name":"å›¾è®º","slug":"å›¾è®º","permalink":"https://pufanyi.github.io/oi-blog/tags/%E5%9B%BE%E8%AE%BA/"},{"name":"æœ€çŸ­è·¯","slug":"æœ€çŸ­è·¯","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%9C%80%E7%9F%AD%E8%B7%AF/"}]},{"title":"CodeForces 516D Drazil and Morning Exercise","slug":"CF516D","date":"2020-02-11T16:00:00.000Z","updated":"2023-12-25T16:08:27.880Z","comments":true,"path":"CF516D/","link":"","permalink":"https://pufanyi.github.io/oi-blog/CF516D/","excerpt":"ç»™ä½ ä¸€æ£µæ ‘ï¼Œè¾¹æœ‰è¾¹æƒï¼Œå®šä¹‰ fx=maxâ¡i=1ndistâ¡(x,i)f_x=\\max_{i=1}^n\\operatorname{dist}(x,i)fxâ€‹=maxi=1nâ€‹dist(x,i)ã€‚qqq æ¬¡è¯¢é—®ï¼Œæ¯æ¬¡ç»™å‡ºä¸€ä¸ªæ•° lll æ±‚æœ€å¤§çš„è¿é€šå— sss æ»¡è¶³ maxâ¡xâˆˆsfxâˆ’minâ¡xâˆˆsfxâ‰¤l\\max_{x\\in s}f_x-\\min_{x\\in s}f_x\\le lmaxxâˆˆsâ€‹fxâ€‹âˆ’minxâˆˆsâ€‹fxâ€‹â‰¤lã€‚nâ‰¤105,qâ‰¤50n\\le 10^5,q\\le 50nâ‰¤105,qâ‰¤50ã€‚","text":"ç»™ä½ ä¸€æ£µæ ‘ï¼Œè¾¹æœ‰è¾¹æƒï¼Œå®šä¹‰ fx=maxâ¡i=1ndistâ¡(x,i)f_x=\\max_{i=1}^n\\operatorname{dist}(x,i)fxâ€‹=maxi=1nâ€‹dist(x,i)ã€‚qqq æ¬¡è¯¢é—®ï¼Œæ¯æ¬¡ç»™å‡ºä¸€ä¸ªæ•° lll æ±‚æœ€å¤§çš„è¿é€šå— sss æ»¡è¶³ maxâ¡xâˆˆsfxâˆ’minâ¡xâˆˆsfxâ‰¤l\\max_{x\\in s}f_x-\\min_{x\\in s}f_x\\le lmaxxâˆˆsâ€‹fxâ€‹âˆ’minxâˆˆsâ€‹fxâ€‹â‰¤lã€‚nâ‰¤105,qâ‰¤50n\\le 10^5,q\\le 50nâ‰¤105,qâ‰¤50ã€‚ é¦–å…ˆå‡è®¾è¿™æ£µæ ‘çš„ç›´å¾„çš„ä¸¤ä¸ªç«¯ç‚¹ä¸º u,vu,vu,vï¼Œä¸éš¾å‘ç° fx=maxâ¡(distâ¡(u,x)v,xâ¡)f_x=\\max(\\operatorname{dist}(u,x)\\operatorname{v,x})fxâ€‹=max(dist(u,x)v,x)ã€‚è¿™ä¸ªç”¨è¯æ˜ç›´å¾„çš„æ–¹æ³•å¯ä»¥è¯æ˜ã€‚ ç„¶åæˆ‘ä»¬éœ€è¦å‘ç°ä¸€ä¸ªæ€§è´¨ï¼Œé‚£å°±æ˜¯å°†ç‚¹æŒ‰ç…§ fff ä»å¤§åˆ°å°æ’åºï¼Œé‚£ä¹ˆå„¿å­ä¸€å®šæ’åœ¨çˆ¶äº²çš„å‰é¢ã€‚ ç„¶åå°±å¥½åŠäº†ï¼Œæˆ‘ä»¬è€ƒè™‘å°†ç‚¹æŒ‰ fff ä»å¤§åˆ°å°æ’åºï¼Œç„¶åæˆ‘ä»¬è€ƒè™‘åœ¨ä¸Šé¢ two pointsï¼Œä¸€è¾¹ç”¨å¹¶æŸ¥é›†ç»´æŠ¤ä¸¤ä¸ªæŒ‡é’ˆæ‰€åœ¨åŒºé—´çš„è”é€šæ€§ï¼Œæ’å…¥ä¸€ä¸ªç‚¹ç›´æ¥å°†å…¶å„¿å­åˆå¹¶ï¼Œåˆ é™¤èŠ‚ç‚¹æ˜¯å‘ç°åªä¼šåˆ é™¤å¶å­èŠ‚ç‚¹ï¼Œä¸ä¼šæ”¹å˜è¿é€šæ€§ï¼Œåªè¦æŠŠè¯¥è¿é€šå— size å‡æ‰å³å¯ã€‚ è¿™é‡Œæ˜¯ä»£ç ","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"CodeForces","slug":"CodeForces","permalink":"https://pufanyi.github.io/oi-blog/tags/CodeForces/"},{"name":"å¹¶æŸ¥é›†","slug":"å¹¶æŸ¥é›†","permalink":"https://pufanyi.github.io/oi-blog/tags/%E5%B9%B6%E6%9F%A5%E9%9B%86/"},{"name":"two points","slug":"two-points","permalink":"https://pufanyi.github.io/oi-blog/tags/two-points/"}]},{"title":"CodeForces 575I Robots protection","slug":"CF575I","date":"2020-02-10T16:00:00.000Z","updated":"2023-12-25T16:08:27.881Z","comments":true,"path":"CF575I/","link":"","permalink":"https://pufanyi.github.io/oi-blog/CF575I/","excerpt":"ä½ éœ€è¦åœ¨å¹³é¢ç›´è§’åæ ‡ç³»ä¸Šè¿›è¡Œ qqq æ¬¡æ“ä½œã€‚æ¯æ¬¡æ“ä½œæœ‰ä¸¤ç§ï¼Œè¦ä¹ˆæ”¾ç½®ä¸€ä¸ªä¸¤æ¡ç›´è§’è¾¹å¹³è¡Œäºåæ ‡è½´çš„ç­‰è…°ç›´è§’ä¸‰è§’å½¢ï¼Œè¦ä¹ˆæŸ¥è¯¢æŸä¸€ä¸ªç‚¹è¢«å¤šå°‘ä¸ªä¸‰è§’å½¢è¦†ç›–ã€‚ä¿è¯æ‰€æœ‰ç‚¹çš„åæ ‡éƒ½æ˜¯æ•´æ•°ä¸” âˆˆ[1,n]\\in [1,n]âˆˆ[1,n]ã€‚nâ‰¤5Ã—103,qâ‰¤105n \\le 5 \\times 10^3, q \\le 10^5nâ‰¤5Ã—103,qâ‰¤105ã€‚","text":"ä½ éœ€è¦åœ¨å¹³é¢ç›´è§’åæ ‡ç³»ä¸Šè¿›è¡Œ qqq æ¬¡æ“ä½œã€‚æ¯æ¬¡æ“ä½œæœ‰ä¸¤ç§ï¼Œè¦ä¹ˆæ”¾ç½®ä¸€ä¸ªä¸¤æ¡ç›´è§’è¾¹å¹³è¡Œäºåæ ‡è½´çš„ç­‰è…°ç›´è§’ä¸‰è§’å½¢ï¼Œè¦ä¹ˆæŸ¥è¯¢æŸä¸€ä¸ªç‚¹è¢«å¤šå°‘ä¸ªä¸‰è§’å½¢è¦†ç›–ã€‚ä¿è¯æ‰€æœ‰ç‚¹çš„åæ ‡éƒ½æ˜¯æ•´æ•°ä¸” âˆˆ[1,n]\\in [1,n]âˆˆ[1,n]ã€‚nâ‰¤5Ã—103,qâ‰¤105n \\le 5 \\times 10^3, q \\le 10^5nâ‰¤5Ã—103,qâ‰¤105ã€‚ è€ƒè™‘åˆ°å››ç§æ–¹å‘æ˜¯å¯¹ç§°çš„ï¼Œæˆ‘ä»¬åªè€ƒè™‘å…¶ä¸­ä¸€ç§æƒ…å†µï¼Œæ¯”å¦‚è¯´ç›´è§’é¡¶ç‚¹åœ¨å·¦ä¸‹è§’çš„æƒ…å†µï¼Œä»¤ä¸‰ä¸ªé¡¶ç‚¹ä¸º (x,y),(x+l,y),(x,y+l)(x,y), (x+l,y), (x,y+l)(x,y),(x+l,y),(x,y+l)ã€‚ é¦–å…ˆæˆ‘ä»¬å‘ç°éœ€è¦åŠ çš„æ‰€æœ‰ç‚¹ (xâ€²,yâ€²)(x&#x27;,y&#x27;)(xâ€²,yâ€²)ï¼Œéƒ½æ»¡è¶³ x+yâ‰¤xâ€²+yâ€²â‰¤x+y+lx+y\\le x&#x27;+y&#x27;\\le x+y+lx+yâ‰¤xâ€²+yâ€²â‰¤x+y+lï¼Œè¿™ä¸ªä¸œè¥¿ç”¨ä¸€æ£µæ ‘çŠ¶æ•°ç»„å°±å¯ä»¥ç»´æŠ¤ï¼š ç„¶åæˆ‘ä»¬å°±æ˜¯è¦å‡å»è¿™ä¸¤å—ï¼š æˆ‘ä»¬è€ƒè™‘å¦‚ä½•å‡å»ï¼Œè§‚å¯Ÿè¿™äº›ç‚¹çš„æ€§è´¨ï¼Œé¦–å…ˆå‡æ»¡è¶³ xâ€²+yâ€²âˆˆ[x+y,x+y+l]x&#x27;+y&#x27;\\in [x+y,x+y+l]xâ€²+yâ€²âˆˆ[x+y,x+y+l]ï¼Œç„¶åå…¶è¿˜æ»¡è¶³ xâ€²&lt;xx&#x27;&lt;xxâ€²&lt;x æˆ– yâ€²&lt;yy&#x27;&lt;yyâ€²&lt;yã€‚äºæ˜¯æˆ‘ä»¬å¯ä»¥è€ƒè™‘å¼€ä¸¤æ£µäºŒç»´æ ‘çŠ¶æ•°ç»„ï¼Œä¸€æ£µç»´æŠ¤ä¸‹æ ‡ (x+y,x)(x+y,x)(x+y,x)ï¼Œå¦ä¸€æ£µç»´æŠ¤ä¸‹æ ‡ (x+y,y)(x+y,y)(x+y,y)ï¼Œç„¶ååœ¨è¿™ä¸¤æ£µæ ‘çŠ¶æ•°ç»„ä¸ŠçŸ©é˜µåŠ å³å¯ã€‚ æ—¶é—´å¤æ‚åº¦ O(qlogâ¡2n)\\mathcal{O}(q\\log^2n)O(qlog2n)ï¼Œç©ºé—´ O(n2)\\mathcal{O}(n^2)O(n2)ã€‚ ä»£ç åœ¨è¿™å„¿ ã€‚","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"CodeForces","slug":"CodeForces","permalink":"https://pufanyi.github.io/oi-blog/tags/CodeForces/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"},{"name":"æ ‘çŠ¶æ•°ç»„/çº¿æ®µæ ‘","slug":"æ ‘çŠ¶æ•°ç»„-çº¿æ®µæ ‘","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84-%E7%BA%BF%E6%AE%B5%E6%A0%91/"}]},{"title":"CodeForces 391F3 Stock Trading","slug":"CF391F3","date":"2020-02-09T16:00:00.000Z","updated":"2023-12-25T16:08:27.875Z","comments":true,"path":"CF391F3/","link":"","permalink":"https://pufanyi.github.io/oi-blog/CF391F3/","excerpt":"ç»™å‡º n (1â‰¤nâ‰¤4000000)n\\,(1\\le n\\le 4000000)n(1â‰¤nâ‰¤4000000) å¤©çš„è‚¡ç¥¨ä»·æ ¼ï¼Œæ¯å¤©å¯ä¹°è¿›æˆ–å–å‡ºä¸€è‚¡ï¼Œå¯ä»¥åŒæ—¶ä¹°è¿›æˆ–å–å‡ºï¼Œä¹Ÿå¯ä»¥ä¸æ“ä½œï¼Œä½†æœ€ç»ˆæ‰‹ä¸Šåªèƒ½æœ‰ä¸€è‚¡ã€‚é—®æœ€å¤š kkk æ¬¡ä¹°è¿›å’Œå–å‡ºåçš„æœ€å¤§æ”¶ç›Šã€‚","text":"ç»™å‡º n (1â‰¤nâ‰¤4000000)n\\,(1\\le n\\le 4000000)n(1â‰¤nâ‰¤4000000) å¤©çš„è‚¡ç¥¨ä»·æ ¼ï¼Œæ¯å¤©å¯ä¹°è¿›æˆ–å–å‡ºä¸€è‚¡ï¼Œå¯ä»¥åŒæ—¶ä¹°è¿›æˆ–å–å‡ºï¼Œä¹Ÿå¯ä»¥ä¸æ“ä½œï¼Œä½†æœ€ç»ˆæ‰‹ä¸Šåªèƒ½æœ‰ä¸€è‚¡ã€‚é—®æœ€å¤š kkk æ¬¡ä¹°è¿›å’Œå–å‡ºåçš„æœ€å¤§æ”¶ç›Šã€‚ æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸ª O(nlogâ¡n)\\mathcal{O}(n\\log n)O(nlogn) çš„åšæ³•ã€‚é¦–å…ˆæˆ‘ä»¬è€ƒè™‘å¦‚æœæ˜¯ä¸€æ®µè¿ç»­çš„é€’å¢è‚¡ç¥¨ï¼Œé‚£æˆ‘ä»¬ç›¸å½“äºæ˜¯ä¸€å¼€å§‹ä¹°è¿›ï¼Œæœ€åå–å‡ºã€‚å¦‚æœè¿™æ ·è¿ç»­çš„æ®µå°äºç­‰äº kkkï¼Œé‚£ä¹ˆå°±ç›´æ¥å¯ä»¥è¿”å›ç­”æ¡ˆäº†ã€‚å¦‚æœæ¯” kkk å¤§ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦åšå‡ºè¿™æ ·ä¸¤ç§é€‰æ‹©ï¼šè¦ä¹ˆé€‰æ‹©ä¸€ä¸ªä¸Šå‡çš„åŒºé—´æ”¾å¼ƒï¼Œè¦ä¹ˆé€‰æ‹©ä¸€æ®µä¸‹é™çš„åŒºé—´æŠŠä¸¤æ®µä¸Šå‡çš„åŒºé—´ç»™è¿èµ·æ¥ã€‚è¿™ä¸ªä¸œè¥¿æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªå †æˆ–è€… set æ¥ç»´æŠ¤ã€‚ ä½†æ˜¯æˆ‘ä»¬è¿˜æœ‰ä¸€ä¸ª O(n)\\mathcal{O}(n)O(n) çš„åšæ³•ï¼Œéœ€è¦è§‚å¯Ÿä¸€äº›æ€§è´¨ã€‚æˆ‘ä»¬æŠŠè¯»å…¥çš„è‚¡ç¥¨çœ‹æˆæ˜¯ä¸€ä¸ªä¸ªå•è°ƒä¸å‡çš„åŒºé—´ã€‚å½“ç„¶æœ‰äº›åŒºé—´å¯èƒ½åªæœ‰ä¸€ä¸ªæ•°ã€‚ æˆ‘ä»¬è€ƒè™‘ä¸€äº›åŒºé—´å¯ä»¥åˆå¹¶æˆä¸€ä¸ªç­‰ä»·çš„åŒºé—´ï¼Œæˆ‘ä»¬è€ƒè™‘å°†åŒºé—´ä»å·¦å¾€åä¸€ä¸ªä¸ªåŠ å…¥ã€‚æˆ‘ä»¬å†å¼€ä¸€ä¸ªæ•°ç»„ bbbï¼Œè®°å½•é‚£äº›ä¸å¯èƒ½è·Ÿåé¢çš„åŒºé—´åˆå¹¶çš„åŒºé—´ã€‚ æˆ‘ä»¬é¦–å…ˆå¯ä»¥å¾—åˆ°ä¸€ä¸ªç»“è®ºï¼šåœ¨ä»»ä¸€æ—¶åˆ»å¯¹äºé‚£äº›å¯èƒ½ä¸åé¢åˆå¹¶çš„åŒºé—´ï¼Œå…¶ä¹°å…¥æ—¶çš„ä»·æ ¼ä¸€å®šæ˜¯å•è°ƒé€’å¢çš„ã€‚å› ä¸ºå¦‚æœä¸æ˜¯é€’å¢çš„ï¼Œå¦‚ä¸‹å›¾æƒ…å†µï¼ŒåŸæ¥é»˜è®¤çš„åŒ¹é…æ˜¯ [x1,x2][x_1,x_2][x1â€‹,x2â€‹]ï¼Œ[x3,x4][x_3,x_4][x3â€‹,x4â€‹]ï¼Œç°åœ¨åŠ å…¥äº†ä¸€ä¸ªå³ç«¯ç‚¹ x5x_5x5â€‹ï¼ˆå·¦ç«¯ç‚¹åœ¨å“ªå„¿æˆ‘ä»¬å¹¶ä¸éœ€è¦å…³å¿ƒï¼‰ï¼Œå¦‚æœ x1x_1x1â€‹ è·Ÿ x5x_5x5â€‹é…ï¼Œé‚£æ˜¾ç„¶ä¸å¦‚ x3x_3x3â€‹ è·Ÿ x5x_5x5â€‹ é…ï¼Œå› ä¸ºè¿™æ ·ä¸ä»…èŠ‚çœäº†ä¸€æ®µåŒºé—´ï¼ˆ[x1,x2][x_1,x_2][x1â€‹,x2â€‹]ï¼‰ï¼Œç­”æ¡ˆè¿˜æ›´ä¼˜ã€‚ æˆ‘ä»¬è¿˜éœ€è¦å‘ç°ä¸€ä¸ªæ€§è´¨ï¼Œé‚£å°±æ˜¯å¦‚æœç°åœ¨æœ‰ä¸¤ä¸ªåŒºé—´ [l1,r1],[l2,r2][l_1,r_1],[l_2,r_2][l1â€‹,r1â€‹],[l2â€‹,r2â€‹]ï¼Œå¦‚æœæœ‰ l1&lt;l2l_1&lt;l_2l1â€‹&lt;l2â€‹ ä¸” r1&lt;r2r_1&lt;r_2r1â€‹&lt;r2â€‹ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒç­‰ä»·æˆä¸º [l1,r2],[l2,r1][l_1,r_2],[l_2,r_1][l1â€‹,r2â€‹],[l2â€‹,r1â€‹] è¿™æ ·ä¸¤æ®µåŒºé—´ã€‚è€Œ [l2,r1][l_2,r_1][l2â€‹,r1â€‹] æ˜¯ä¸å¯èƒ½å†è·Ÿåé¢çš„åŒ¹é…äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥å°†å…¶æ‰”è¿› bbb ä¸­ã€‚ æ ¹æ®è¿™æ ·ä¸¤ä¸ªæ€§è´¨ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å¾ˆå¤šä¸ªåŒºé—´ã€‚ä¸éš¾å‘ç°è¿™äº›åŒºé—´æ˜¯ç‹¬ç«‹çš„ã€‚æœ€åæˆ‘ä»¬å–å‰ kkk å¤§çš„åŒºé—´å³å¯ã€‚ å…·ä½“ä»£ç å¯ä»¥ æˆ³è¿™é‡Œã€‚","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"CodeForces","slug":"CodeForces","permalink":"https://pufanyi.github.io/oi-blog/tags/CodeForces/"},{"name":"è´ªå¿ƒ","slug":"è´ªå¿ƒ","permalink":"https://pufanyi.github.io/oi-blog/tags/%E8%B4%AA%E5%BF%83/"}]},{"title":"CodeForces 708E Student's Camp","slug":"CF708E","date":"2020-02-09T16:00:00.000Z","updated":"2023-12-25T16:08:27.882Z","comments":true,"path":"CF708E/","link":"","permalink":"https://pufanyi.github.io/oi-blog/CF708E/","excerpt":"æœ‰ä¸€ä¸ª (n+2)Ã—m(n + 2) \\times m(n+2)Ã—m çš„é•¿æ–¹å½¢ï¼Œé™¤äº†ç¬¬ä¸€è¡Œå’Œæœ€åä¸€è¡Œï¼Œå…¶ä»–æ¯ä¸€è¡Œæ¯ä¸€å¤©æœ€å·¦è¾¹å’Œæœ€å³è¾¹çš„æ ¼å­éƒ½æœ‰ ppp çš„æ¦‚ç‡è¢«æ‘§æ¯ï¼Œæ¯è¡Œä¹‹é—´ç‹¬ç«‹ä¸”å·¦è¾¹å’Œå³è¾¹ç‹¬ç«‹ï¼Œæ±‚ kkk å¤©ä¹‹åæœ€ä¸Šé¢ä¸€è¡Œä¸æœ€ä¸‹é¢ä¸€è¡Œå››è”é€šçš„æ¦‚ç‡ã€‚ å…¶ä¸­ 1â‰¤n,mâ‰¤1500, 0â‰¤kâ‰¤1051\\le n,m\\le 1500,\\,0\\le k\\le 10^51â‰¤n,mâ‰¤1500,0â‰¤kâ‰¤105ï¼Œç­”æ¡ˆå¯¹ 109+710^9+7109+7 å–æ¨¡ã€‚","text":"æœ‰ä¸€ä¸ª (n+2)Ã—m(n + 2) \\times m(n+2)Ã—m çš„é•¿æ–¹å½¢ï¼Œé™¤äº†ç¬¬ä¸€è¡Œå’Œæœ€åä¸€è¡Œï¼Œå…¶ä»–æ¯ä¸€è¡Œæ¯ä¸€å¤©æœ€å·¦è¾¹å’Œæœ€å³è¾¹çš„æ ¼å­éƒ½æœ‰ ppp çš„æ¦‚ç‡è¢«æ‘§æ¯ï¼Œæ¯è¡Œä¹‹é—´ç‹¬ç«‹ä¸”å·¦è¾¹å’Œå³è¾¹ç‹¬ç«‹ï¼Œæ±‚ kkk å¤©ä¹‹åæœ€ä¸Šé¢ä¸€è¡Œä¸æœ€ä¸‹é¢ä¸€è¡Œå››è”é€šçš„æ¦‚ç‡ã€‚ å…¶ä¸­ 1â‰¤n,mâ‰¤1500, 0â‰¤kâ‰¤1051\\le n,m\\le 1500,\\,0\\le k\\le 10^51â‰¤n,mâ‰¤1500,0â‰¤kâ‰¤105ï¼Œç­”æ¡ˆå¯¹ 109+710^9+7109+7 å–æ¨¡ã€‚ ä¸€ä¸ªç®€å•çš„æƒ³æ³•å°±æ˜¯æˆ‘ä»¬ä»¤ hi,l,rh_{i,l,r}hi,l,râ€‹ è¡¨ç¤º kkk å¤©åç¬¬ iii è¡Œè¿˜å‰©ä¸‹ [l,r][l,r][l,r]ï¼Œå‰ iii è¡Œè”é€šçš„æ¦‚ç‡ã€‚Pl,rP_{l,r}Pl,râ€‹ è¡¨ç¤ºå•ç‹¬ä¸€è¡Œåªå‰© [l,r][l,r][l,r] çš„æ¦‚ç‡ã€‚ é¦–å…ˆæˆ‘ä»¬æœ‰ï¼š hi,l,r=Pl,râˆ‘[l,r]âˆ©[lâ€²,râ€²]â‰ âˆ…hiâˆ’1,lâ€²,râ€²h_{i,l,r}=P_{l,r}\\sum_{[l,r]\\cap[l&#x27;,r&#x27;]\\neq\\emptyset}h_{i-1,l&#x27;,r&#x27;} hi,l,râ€‹=Pl,râ€‹[l,r]âˆ©[lâ€²,râ€²]î€ =âˆ…âˆ‘â€‹hiâˆ’1,lâ€²,râ€²â€‹ æ¥ä¸‹æ¥æˆ‘ä»¬è€ƒè™‘ Pl,rP_{l,r}Pl,râ€‹ï¼Œæˆ‘ä»¬ä»¤ qi=(ki)pi(1âˆ’p)kâˆ’iq_{i}=\\binom{k}{i}p^i(1-p)^{k-i}qiâ€‹=(ikâ€‹)pi(1âˆ’p)kâˆ’iï¼Œä¸éš¾å‘ç°ï¼š Pl,r=qlâˆ’1qmâˆ’rP_{l,r}=q_{l-1}q_{m-r} Pl,râ€‹=qlâˆ’1â€‹qmâˆ’râ€‹ ç„¶åæˆ‘ä»¬ä»¤ fi,rf_{i,r}fi,râ€‹ è¡¨ç¤ºå³ç«¯ç‚¹ä¸º rrr çš„æ‰€æœ‰ hhh ä¹‹å’Œï¼ŒåŒç† gi,lg_{i,l}gi,lâ€‹ è¡¨ç¤ºä»¥å·¦ç«¯ç‚¹ä¸º lll çš„æ‰€æœ‰ hhh ä¹‹å’Œï¼Œå†ä»¤ Fi,rF_{i,r}Fi,râ€‹ è¡¨ç¤ºå³ç«¯ç‚¹å°äºç­‰äº rrr çš„æ‰€æœ‰ hhh ä¹‹å’Œï¼ŒåŒç† Gi,lG_{i,l}Gi,lâ€‹ è¡¨ç¤ºä»¥å·¦ç«¯ç‚¹å¤§äºç­‰äº lll çš„æ‰€æœ‰ hhh ä¹‹å’Œã€‚ å…·ä½“åœ°ï¼š fi,r=âˆ‘l=1rhi,l,rgi,l=âˆ‘r=lmhi,l,rFi,r=âˆ‘R=1rfi,RGi,l=âˆ‘L=lmgi,L\\begin{aligned} f_{i,r}&amp;=\\sum_{l=1}^rh_{i,l,r}\\\\ g_{i,l}&amp;=\\sum_{r=l}^mh_{i,l,r}\\\\ F_{i,r}&amp;=\\sum_{R=1}^rf_{i,R}\\\\ G_{i,l}&amp;=\\sum_{L=l}^mg_{i,L} \\end{aligned} fi,râ€‹gi,lâ€‹Fi,râ€‹Gi,lâ€‹â€‹=l=1âˆ‘râ€‹hi,l,râ€‹=r=lâˆ‘mâ€‹hi,l,râ€‹=R=1âˆ‘râ€‹fi,Râ€‹=L=lâˆ‘mâ€‹gi,Lâ€‹â€‹ äºæ˜¯æˆ‘ä»¬å°±æœ‰ï¼š hi,l,r=Pl,r(Fiâˆ’1,mâˆ’Fiâˆ’1,lâˆ’1âˆ’Giâˆ’1,r+1)h_{i,l,r}=P_{l,r}\\left(F_{i-1,m}-F_{i-1,l-1}-G_{i-1,r+1}\\right) hi,l,râ€‹=Pl,râ€‹(Fiâˆ’1,mâ€‹âˆ’Fiâˆ’1,lâˆ’1â€‹âˆ’Giâˆ’1,r+1â€‹) å°† hhh ä»£å…¥ fff å’Œ gggï¼Œæˆ‘ä»¬æœ‰ï¼š fi,r=âˆ‘l=1rqlâˆ’1qmâˆ’r(Fiâˆ’1,mâˆ’Fiâˆ’1,lâˆ’1âˆ’Giâˆ’1,r+1)=qmâˆ’r(âˆ‘l=1rqlâˆ’1(Fiâˆ’1,mâˆ’Fiâˆ’1,lâˆ’1)âˆ’Giâˆ’1,r+1âˆ‘l=1rqlâˆ’1)gi,l=âˆ‘r=lmqlâˆ’1qmâˆ’r(Fiâˆ’1,mâˆ’Fiâˆ’1,lâˆ’1âˆ’Giâˆ’1,r+1)=qlâˆ’1(âˆ‘r=lmqmâˆ’r(Fiâˆ’1,mâˆ’Giâˆ’1,r+1)âˆ’Fiâˆ’1,lâˆ’1âˆ‘r=lmqmâˆ’r)\\begin{aligned} f_{i,r}&amp;=\\sum_{l=1}^rq_{l-1}q_{m-r}\\left(F_{i-1,m}-F_{i-1,l-1}-G_{i-1,r+1}\\right)\\\\ &amp;=q_{m-r}\\left(\\sum_{l=1}^rq_{l-1}\\left(F_{i-1,m}-F_{i-1,l-1}\\right)-G_{i-1,r+1}\\sum_{l=1}^rq_{l-1}\\right)\\\\ g_{i,l}&amp;=\\sum_{r=l}^mq_{l-1}q_{m-r}\\left(F_{i-1,m}-F_{i-1,l-1}-G_{i-1,r+1}\\right)\\\\ &amp;=q_{l-1}\\left(\\sum_{r=l}^mq_{m-r}\\left(F_{i-1,m}-G_{i-1,r+1}\\right)-F_{i-1,l-1}\\sum_{r=l}^mq_{m-r}\\right) \\end{aligned} fi,râ€‹gi,lâ€‹â€‹=l=1âˆ‘râ€‹qlâˆ’1â€‹qmâˆ’râ€‹(Fiâˆ’1,mâ€‹âˆ’Fiâˆ’1,lâˆ’1â€‹âˆ’Giâˆ’1,r+1â€‹)=qmâˆ’râ€‹(l=1âˆ‘râ€‹qlâˆ’1â€‹(Fiâˆ’1,mâ€‹âˆ’Fiâˆ’1,lâˆ’1â€‹)âˆ’Giâˆ’1,r+1â€‹l=1âˆ‘râ€‹qlâˆ’1â€‹)=r=lâˆ‘mâ€‹qlâˆ’1â€‹qmâˆ’râ€‹(Fiâˆ’1,mâ€‹âˆ’Fiâˆ’1,lâˆ’1â€‹âˆ’Giâˆ’1,r+1â€‹)=qlâˆ’1â€‹(r=lâˆ‘mâ€‹qmâˆ’râ€‹(Fiâˆ’1,mâ€‹âˆ’Giâˆ’1,r+1â€‹)âˆ’Fiâˆ’1,lâˆ’1â€‹r=lâˆ‘mâ€‹qmâˆ’râ€‹)â€‹ è€ƒè™‘åˆ°æœ€åç­”æ¡ˆæ˜¯ Fn,mF_{n,m}Fn,mâ€‹ï¼Œæˆ‘ä»¬å‘ç°æˆ‘ä»¬å¯ä»¥ç»•è¿‡ hhh æ¥æ±‚ FFFã€‚ æœ€ç»ˆå¤æ‚åº¦ O(k+nm)\\mathcal{O}(k+nm)O(k+nm)ã€‚ ä»£ç å¯ä»¥çœ‹ è¿™é‡Œã€‚","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"CodeForces","slug":"CodeForces","permalink":"https://pufanyi.github.io/oi-blog/tags/CodeForces/"},{"name":"DP","slug":"DP","permalink":"https://pufanyi.github.io/oi-blog/tags/DP/"}]},{"title":"AGC032E Modulo Pairing","slug":"agc032_e","date":"2020-02-09T16:00:00.000Z","updated":"2023-12-25T16:08:27.923Z","comments":true,"path":"agc032_e/","link":"","permalink":"https://pufanyi.github.io/oi-blog/agc032_e/","excerpt":"ç»™ä¸€ä¸ªé•¿åº¦ä¸º 2n2n2n çš„åºåˆ—ï¼Œè¦æ±‚å°†å…¶ä¸¤ä¸¤åŒ¹é…æˆ nnn ç»„ï¼Œå‡è®¾ç¬¬ iii ç»„ä¸º (xi,yi)(x_i,y_i)(xiâ€‹,yiâ€‹)ï¼Œæ±‚ maxâ¡i=1n(xi+yi) mod m\\max_{i=1}^n(x_i+y_i)\\bmod mmaxi=1nâ€‹(xiâ€‹+yiâ€‹)modm çš„æœ€å°å€¼ï¼Œ1â‰¤nâ‰¤105,1â‰¤mâ‰¤109,0â‰¤ai&lt;m1\\le n\\le 10^5,1\\le m\\le 10^9,0\\le a_i&lt;m1â‰¤nâ‰¤105,1â‰¤mâ‰¤109,0â‰¤aiâ€‹&lt;mã€‚","text":"ç»™ä¸€ä¸ªé•¿åº¦ä¸º 2n2n2n çš„åºåˆ—ï¼Œè¦æ±‚å°†å…¶ä¸¤ä¸¤åŒ¹é…æˆ nnn ç»„ï¼Œå‡è®¾ç¬¬ iii ç»„ä¸º (xi,yi)(x_i,y_i)(xiâ€‹,yiâ€‹)ï¼Œæ±‚ maxâ¡i=1n(xi+yi) mod m\\max_{i=1}^n(x_i+y_i)\\bmod mmaxi=1nâ€‹(xiâ€‹+yiâ€‹)modm çš„æœ€å°å€¼ï¼Œ1â‰¤nâ‰¤105,1â‰¤mâ‰¤109,0â‰¤ai&lt;m1\\le n\\le 10^5,1\\le m\\le 10^9,0\\le a_i&lt;m1â‰¤nâ‰¤105,1â‰¤mâ‰¤109,0â‰¤aiâ€‹&lt;mã€‚ æˆ‘ä»¬é¦–å…ˆæˆ‘ä»¬æœ‰ï¼š (x+y) mod m={x+yx+yâ‰¤mx+yâˆ’mx+y&gt;m(x+y)\\bmod m=\\begin{cases} x+y&amp;x+y\\le m\\\\ x+y-m&amp;x+y&gt;m \\end{cases} (x+y)modm={x+yx+yâˆ’mâ€‹x+yâ‰¤mx+y&gt;mâ€‹ æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹å‡ ç§æƒ…å†µï¼š å¦‚æœæˆ‘ä»¬æœ‰ x1â‰¤x2â‰¤x3â‰¤x4x_1\\le x_2\\le x_3\\le x_4x1â€‹â‰¤x2â€‹â‰¤x3â€‹â‰¤x4â€‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬æœ‰è¿™æ · 444 ä¸­æƒ…å†µï¼š ç¬¬ä¸€ç§ï¼Œx3+x4&lt;mx_3+x_4&lt;mx3â€‹+x4â€‹&lt;mï¼Œé‚£æ˜¾ç„¶ (x1,x4),(x2,x3)(x_1,x_4),(x_2,x_3)(x1â€‹,x4â€‹),(x2â€‹,x3â€‹) æ›´ä¼˜ã€‚ ç¬¬äºŒç§ï¼Œx1+x2â‰¥mx_1+x_2\\ge mx1â€‹+x2â€‹â‰¥mï¼Œå’Œç¬¬ä¸€ç§ä¸€æ ·ã€‚ ç¬¬ä¸‰ç§ï¼Œ{x1+x3&lt;mx2+x4â‰¥m\\begin{cases}x_1+x_3&lt;m\\\\x_2+x_4\\ge m\\end{cases}{x1â€‹+x3â€‹&lt;mx2â€‹+x4â€‹â‰¥mâ€‹ï¼Œè€ƒè™‘åˆ° x2+x4âˆ’m&lt;x2x_2+x_4-m&lt;x_2x2â€‹+x4â€‹âˆ’m&lt;x2â€‹ï¼Œæ•…æœ‰ maxâ¡{x1+x3,x2+x4âˆ’m}=x1+x3\\max\\{x_1+x_3,x_2+x_4-m\\}=x_1+x_3max{x1â€‹+x3â€‹,x2â€‹+x4â€‹âˆ’m}=x1â€‹+x3â€‹ï¼Œè€Œè€ƒè™‘åˆ° {x1+x2â‰¤x1+x3x3+x4âˆ’m&lt;x3\\begin{cases}x_1+x_2\\le x_1+x_3\\\\x_3+x_4-m&lt;x_3\\end{cases}{x1â€‹+x2â€‹â‰¤x1â€‹+x3â€‹x3â€‹+x4â€‹âˆ’m&lt;x3â€‹â€‹ï¼Œæ•…æœ‰ maxâ¡{x1+x3,x2+x4âˆ’m}â‰¥maxâ¡{x1+x2,x3+x4âˆ’m}\\max\\{x_1+x_3,x_2+x_4-m\\}\\ge \\max\\{x_1+x_2,x_3+x_4-m\\}max{x1â€‹+x3â€‹,x2â€‹+x4â€‹âˆ’m}â‰¥max{x1â€‹+x2â€‹,x3â€‹+x4â€‹âˆ’m}ã€‚æ‰€ä»¥ (x1,x2),(x3,x4)(x_1,x_2),(x_3,x_4)(x1â€‹,x2â€‹),(x3â€‹,x4â€‹) ä¸€å®šæ¯” (x1,x3),(x2,x4)(x_1,x_3),(x_2,x_4)(x1â€‹,x3â€‹),(x2â€‹,x4â€‹) ä¼˜ã€‚ æˆ‘ä»¬å†æ¥çœ‹ (x1,x4),(x2,x3)(x_1,x_4),(x_2,x_3)(x1â€‹,x4â€‹),(x2â€‹,x3â€‹) çš„æƒ…å†µã€‚å¦‚æœæœ‰ {x1+x4â‰¥mx2+x3â‰¥m\\begin{cases}x_1+x_4\\ge m\\\\x_2+x_3\\ge m\\end{cases}{x1â€‹+x4â€‹â‰¥mx2â€‹+x3â€‹â‰¥mâ€‹ï¼Œé‚£å°±æœ‰ {x1+x4âˆ’m&lt;x1x2+x3âˆ’m&lt;x2\\begin{cases}x_1+x_4-m&lt;x1\\\\x_2+x_3-m&lt;x_2\\end{cases}{x1â€‹+x4â€‹âˆ’m&lt;x1x2â€‹+x3â€‹âˆ’m&lt;x2â€‹â€‹ï¼Œæ‰€ä»¥ maxâ¡{x1+x4âˆ’m,x2+x3âˆ’m}&lt;x2â‰¤maxâ¡{x1+x2,x3+x4âˆ’m}\\max\\{x_1+x_4-m,x_2+x_3-m\\}&lt;x_2\\le \\max\\{x_1+x_2,x_3+x_4-m\\}max{x1â€‹+x4â€‹âˆ’m,x2â€‹+x3â€‹âˆ’m}&lt;x2â€‹â‰¤max{x1â€‹+x2â€‹,x3â€‹+x4â€‹âˆ’m}ï¼Œæ­¤æ—¶ (x1,x4),(x2,x3)(x_1,x_4),(x_2,x_3)(x1â€‹,x4â€‹),(x2â€‹,x3â€‹) çš„æ–¹æ¡ˆæ›´ä¼˜ã€‚ä½†æ˜¯å¦‚æœæœ‰ x1+x4â‰¤mx_1+x_4\\le mx1â€‹+x4â€‹â‰¤m æˆ–æ˜¯ x2+x3â‰¤mx_2+x_3\\le mx2â€‹+x3â€‹â‰¤mï¼Œåˆ™ç­”æ¡ˆå°†ä¼šæ›´å¤§ã€‚ ç¬¬å››ç§ï¼Œ{x1+x4&lt;mx2+x3&lt;mx3+x6â‰¥mx4+x5â‰¥m\\begin{cases}x_1+x_4&lt;m\\\\x_2+x_3&lt;m\\\\x_3+x_6\\ge m\\\\x_4+x_5\\ge m\\end{cases}â©âªâªâªâªâ¨âªâªâªâªâ§â€‹x1â€‹+x4â€‹&lt;mx2â€‹+x3â€‹&lt;mx3â€‹+x6â€‹â‰¥mx4â€‹+x5â€‹â‰¥mâ€‹ã€‚æ ¹æ®å‰é¢çš„è®¨è®ºï¼Œæˆ‘ä»¬ä»…éœ€æ¯”è¾ƒ (x1,x4),(x2,x3),(x5,x6)(x_1,x_4),(x_2,x_3),(x_5,x_6)(x1â€‹,x4â€‹),(x2â€‹,x3â€‹),(x5â€‹,x6â€‹) å’Œ (x1,x2),(x3,x4),(x5,x6)(x_1,x_2),(x_3,x_4),(x_5,x_6)(x1â€‹,x2â€‹),(x3â€‹,x4â€‹),(x5â€‹,x6â€‹) å³å¯ï¼Œä¸éš¾å‘ç° {x1+x2â‰¤x1+x4x3+x6âˆ’m&lt;x3â‰¤x2+x3x4+x5âˆ’mâ‰¤x5+x6âˆ’m\\begin{cases}x_1+x_2\\le x_1+x_4\\\\x_3+x_6-m&lt;x_3\\le x_2+x_3\\\\x_4+x_5-m\\le x_5+x_6-m\\end{cases}â©âªâªâ¨âªâªâ§â€‹x1â€‹+x2â€‹â‰¤x1â€‹+x4â€‹x3â€‹+x6â€‹âˆ’m&lt;x3â€‹â‰¤x2â€‹+x3â€‹x4â€‹+x5â€‹âˆ’mâ‰¤x5â€‹+x6â€‹âˆ’mâ€‹ï¼Œäºæ˜¯ maxâ¡{x1+x2,x3+x6âˆ’m,x4+x5âˆ’m}â‰¤maxâ¡{x1+x4,x2+x3,x5+x6âˆ’m}\\max\\{x_1+x_2,x_3+x_6-m,x_4+x_5-m\\}\\le \\max\\{x_1+x_4,x_2+x_3,x_5+x_6-m\\}max{x1â€‹+x2â€‹,x3â€‹+x6â€‹âˆ’m,x4â€‹+x5â€‹âˆ’m}â‰¤max{x1â€‹+x4â€‹,x2â€‹+x3â€‹,x5â€‹+x6â€‹âˆ’m}ã€‚ æ ¹æ®ç¬¬ä¸€ã€äºŒã€ä¸‰ç§æƒ…å†µï¼Œæˆ‘ä»¬å‘ç°ï¼Œæœ€ç»ˆçš„åˆ’åˆ†ç»“æœè‚¯å®šæ˜¯è¢«åˆ†æˆä¸¤éƒ¨åˆ†ï¼Œå·¦è¾¹éƒ¨åˆ†æœ€å°çš„åŒ¹é…ï¼Œæ¬¡å¤§çš„å’Œæ¬¡å°çš„åŒ¹é…â€¦â€¦å³è¾¹ä¹Ÿè¿™æ ·åŒ¹é…ã€‚å…¶ä¸­å·¦è¾¹æ‰€æœ‰çš„åŒ¹é… (x,y)(x,y)(x,y) éƒ½æœ‰ x+y&lt;mx+y&lt;mx+y&lt;mï¼Œå³è¾¹çš„åŒ¹é… (x,y)(x,y)(x,y) éƒ½æœ‰ x+yâ‰¥mx+y\\ge mx+yâ‰¥mã€‚ æ ¹æ®ç¬¬å››ç§æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°è“è‰²çš„åŒ¹é…æ•°è¶Šå¤šè¶Šå¥½ï¼Œäºæ˜¯æˆ‘ä»¬è€ƒè™‘äºŒåˆ†è“è‰²çš„åŒ¹é…æ•°é‡ï¼Œæœ€ç»ˆç¡®å®šç­”æ¡ˆã€‚ ä»£ç å¯ä»¥çœ‹ è¿™é‡Œã€‚","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"äºŒåˆ†","slug":"äºŒåˆ†","permalink":"https://pufanyi.github.io/oi-blog/tags/%E4%BA%8C%E5%88%86/"},{"name":"AtCoder","slug":"AtCoder","permalink":"https://pufanyi.github.io/oi-blog/tags/AtCoder/"}]},{"title":"CodeForces 1288F Red-Blue Graph","slug":"CF1288F","date":"2020-02-06T16:00:00.000Z","updated":"2023-12-25T16:08:27.873Z","comments":true,"path":"CF1288F/","link":"","permalink":"https://pufanyi.github.io/oi-blog/CF1288F/","excerpt":"æœ‰ä¸€å¼ äºŒåˆ†å›¾ï¼Œå·¦è¾¹æœ‰ n1n_1n1â€‹ ä¸ªç‚¹ï¼Œå³è¾¹æœ‰ n2n_2n2â€‹ ä¸ªç‚¹ï¼Œmmm æ¡è¾¹ã€‚æ¯ä¸ªç‚¹å¯èƒ½æœ‰ä¸€ç§é¢œè‰² R æˆ–è€… Bï¼Œä¹Ÿå¯èƒ½æ²¡æœ‰ï¼Œä¹Ÿå°±æ˜¯ Uã€‚ç°åœ¨è¦ç»™ä¸€äº›è¾¹æŸ“è‰²ï¼ŒæŠŠè¾¹æŸ“æˆ R è¦èŠ±è´¹ rrr çš„ä»£ä»·ï¼ŒæŠŠè¾¹æŸ“æˆ B è¦èŠ±è´¹ bbb çš„ä»£ä»·ï¼Œè¦æ±‚å¯¹äºæ¯ä¸ªé¢œè‰²ä¸º R çš„ç‚¹ï¼Œä¸ä¹‹ç›¸é‚»çš„è¾¹ä¸­ R çš„è¾¹ä¸¥æ ¼å¤šäº B çš„è¾¹ï¼›å¯¹äºæ¯ä¸ªé¢œè‰²ä¸º B çš„ç‚¹ï¼Œä¸ä¹‹ç›¸é‚»çš„è¾¹ä¸­ B çš„è¾¹ä¸¥æ ¼å¤šäº R çš„è¾¹ã€‚æ±‚èŠ±è´¹æœ€å°çš„æ–¹æ¡ˆï¼Œè¾“å‡ºä»»æ„ä¸€ç§ï¼Œæ— è§£è¾“å‡º âˆ’1-1âˆ’1ã€‚å…¶ä¸­ 1â‰¤n1,n2,m,r,bâ‰¤2001 \\le n_1, n_2, m, r, b \\le 2001â‰¤n1â€‹,n2â€‹,m,r,bâ‰¤200ã€‚","text":"æœ‰ä¸€å¼ äºŒåˆ†å›¾ï¼Œå·¦è¾¹æœ‰ n1n_1n1â€‹ ä¸ªç‚¹ï¼Œå³è¾¹æœ‰ n2n_2n2â€‹ ä¸ªç‚¹ï¼Œmmm æ¡è¾¹ã€‚æ¯ä¸ªç‚¹å¯èƒ½æœ‰ä¸€ç§é¢œè‰² R æˆ–è€… Bï¼Œä¹Ÿå¯èƒ½æ²¡æœ‰ï¼Œä¹Ÿå°±æ˜¯ Uã€‚ç°åœ¨è¦ç»™ä¸€äº›è¾¹æŸ“è‰²ï¼ŒæŠŠè¾¹æŸ“æˆ R è¦èŠ±è´¹ rrr çš„ä»£ä»·ï¼ŒæŠŠè¾¹æŸ“æˆ B è¦èŠ±è´¹ bbb çš„ä»£ä»·ï¼Œè¦æ±‚å¯¹äºæ¯ä¸ªé¢œè‰²ä¸º R çš„ç‚¹ï¼Œä¸ä¹‹ç›¸é‚»çš„è¾¹ä¸­ R çš„è¾¹ ä¸¥æ ¼å¤šäº B çš„è¾¹ï¼›å¯¹äºæ¯ä¸ªé¢œè‰²ä¸º B çš„ç‚¹ï¼Œä¸ä¹‹ç›¸é‚»çš„è¾¹ä¸­ B çš„è¾¹ ä¸¥æ ¼å¤šäº R çš„è¾¹ã€‚æ±‚èŠ±è´¹æœ€å°çš„æ–¹æ¡ˆï¼Œè¾“å‡ºä»»æ„ä¸€ç§ï¼Œæ— è§£è¾“å‡º âˆ’1-1âˆ’1ã€‚å…¶ä¸­ 1â‰¤n1,n2,m,r,bâ‰¤2001 \\le n_1, n_2, m, r, b \\le 2001â‰¤n1â€‹,n2â€‹,m,r,bâ‰¤200ã€‚ è€ƒè™‘ç½‘ç»œæµå»ºå›¾ï¼Œå¯¹äºæ¯æ¡è¾¹ &lt;u,v&gt;\\left&lt;u,v\\right&gt;âŸ¨u,vâŸ©ï¼Œåœ¨ç½‘ç»œæµå›¾ä¸Šå»ºç«‹ä¸¤æ¡è¾¹ï¼šuâ†’vu\\to vuâ†’vï¼Œå¦‚æœæµè¡¨ç¤ºå°†è¯¥è¾¹æŸ“æˆçº¢è‰²ï¼Œvâ†’uv\\to uvâ†’uï¼Œè¡¨ç¤ºå°†æ”¹å˜æŸ“æˆé»‘è‰²ã€‚ å»ºç«‹è¶…æº sss å’Œè¶…æ±‡ tttï¼Œè€ƒè™‘å·¦è¾¹çº¢è‰²ç‚¹ï¼Œsss å‘è¯¥ç‚¹è¿ä¸€æ¡ä¸‹ç•Œä¸º 111 çš„è¾¹ï¼Œè¡¨ç¤ºå¼ºåˆ¶æµçº¢å¤§äºæµé»‘ï¼Œå¯¹äºå·¦è¾¹é»‘è‰²ç‚¹ï¼Œè¯¥ç‚¹å‘ ttt è¿ä¸€æ¡ä¸‹ç•Œä¸º 111 çš„è¾¹ï¼Œè¡¨ç¤ºå¼ºåˆ¶æµé»‘å¤§äºæµçº¢ï¼Œå³è¾¹åŒç†ã€‚ æœ€åè·‘ä¸€éè´¹ç”¨æµå³å¯ã€‚","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"CodeForces","slug":"CodeForces","permalink":"https://pufanyi.github.io/oi-blog/tags/CodeForces/"},{"name":"ç½‘ç»œæµ","slug":"ç½‘ç»œæµ","permalink":"https://pufanyi.github.io/oi-blog/tags/%E7%BD%91%E7%BB%9C%E6%B5%81/"}]},{"title":"CERC 2017 Cumulative Code","slug":"CERC2017C","date":"2020-01-30T16:00:00.000Z","updated":"2023-12-25T16:08:27.871Z","comments":true,"path":"CERC2017C/","link":"","permalink":"https://pufanyi.github.io/oi-blog/CERC2017C/","excerpt":"ç»™ä½ ä¸€æ£µ k (kâ‰¤30)k\\ (k\\le 30)k (kâ‰¤30) é˜¶çš„æ»¡äºŒå‰æ ‘ï¼Œä»ä¸Šåˆ°ä¸‹ã€ä»å·¦åˆ°å³ä» 111 å¼€å§‹ç¼–å·ï¼Œè®¾ {pn}\\{p_{n}\\}{pnâ€‹} æ˜¯å®ƒçš„ PrÃ¼fer åºåˆ—ã€‚ç»™ä½ ä¸‰ä¸ªæ•° a,d,ma,d,ma,d,mï¼Œæ±‚ âˆ‘i=0mâˆ’1pa+id\\sum_{i=0}^{m-1}p_{a+id}âˆ‘i=0mâˆ’1â€‹pa+idâ€‹ã€‚","text":"ç»™ä½ ä¸€æ£µ k (kâ‰¤30)k\\ (k\\le 30)k (kâ‰¤30) é˜¶çš„æ»¡äºŒå‰æ ‘ï¼Œä»ä¸Šåˆ°ä¸‹ã€ä»å·¦åˆ°å³ä» 111 å¼€å§‹ç¼–å·ï¼Œè®¾ {pn}\\{p_{n}\\}{pnâ€‹} æ˜¯å®ƒçš„ PrÃ¼fer åºåˆ—ã€‚ç»™ä½ ä¸‰ä¸ªæ•° a,d,ma,d,ma,d,mï¼Œæ±‚ âˆ‘i=0mâˆ’1pa+id\\sum_{i=0}^{m-1}p_{a+id}âˆ‘i=0mâˆ’1â€‹pa+idâ€‹ã€‚ è¿™é¢˜ä¸»è¦æ˜¯è¦å‘ç°ä¸€ä¸ªæ€§è´¨ï¼Œå°±æ˜¯è€ƒè™‘å®šä¹‰ fi,k,h(x)f_{i,k,h}(x)fi,k,hâ€‹(x) è¡¨ç¤ºä»¥ xxx ä¸ºæ ¹ï¼Œæ·±åº¦ä¸º kkk çš„å­æ ‘ï¼Œç°åœ¨è¦å¼€å§‹åˆ çš„æ˜¯ PrÃ¼fer åºåˆ—ä¸­çš„ç¬¬ iii ä½ï¼Œå¯¹ç­”æ¡ˆçš„å…±çŒ®ï¼Œhhhè¡¨ç¤º xxx æ˜¯å¦æœ‰çˆ¶äº²ï¼Œé‚£ä¹ˆ fi,k,h(x)f_{i,k,h}(x)fi,k,hâ€‹(x) å¯ä»¥è¡¨ç¤ºæˆ ai,k,hx+bi,k,hâŒŠx2âŒ‹+ci,k,ha_{i,k,h}x+b_{i,k,h}\\lfloor\\frac{x}{2}\\rfloor+c_{i,k,h}ai,k,hâ€‹x+bi,k,hâ€‹âŒŠ2xâ€‹âŒ‹+ci,k,hâ€‹ çš„å½¢å¼ã€‚ ä»¤ QQQ è¡¨ç¤ºè¯¢é—®é›†åˆï¼Œè€ƒè™‘å·¦å„¿å­å¯¹ç­”æ¡ˆçš„è´¡çŒ®ä¸ºfi,kâˆ’1,1(2x)f_{i,k-1,1}(2x)fi,kâˆ’1,1â€‹(2x)ï¼Œä¹Ÿå°±æ˜¯å¯¹çˆ¶äº²çš„è´¡çŒ®æ˜¯2ai,kâˆ’1,1x+bi,kâˆ’1,1âŒŠ2x2âŒ‹+ci,kâˆ’1,1=(2ai,kâˆ’1,1+bi,kâˆ’1,1)x+ci,kâˆ’1,12a_{i,k-1,1}x+b_{i,k-1,1}\\lfloor\\frac{2x}{2}\\rfloor+c_{i,k-1,1}=\\left(2a_{i,k-1,1}+b_{i,k-1,1}\\right)x+c_{i,k-1,1}2ai,kâˆ’1,1â€‹x+bi,kâˆ’1,1â€‹âŒŠ22xâ€‹âŒ‹+ci,kâˆ’1,1â€‹=(2ai,kâˆ’1,1â€‹+bi,kâˆ’1,1â€‹)x+ci,kâˆ’1,1â€‹ï¼Œå³{2ai,kâˆ’1,1+bi,kâˆ’1,1,0,ci,kâˆ’1,1}\\{2a_{i,k-1,1}+b_{i,k-1,1},0,c_{i,k-1,1}\\}{2ai,kâˆ’1,1â€‹+bi,kâˆ’1,1â€‹,0,ci,kâˆ’1,1â€‹}ï¼Œå³å„¿å­åŒç†å¯æ¨å‡ºï¼Œä¸º{2a+b,0,a+c}\\{2a+b,0,a+c\\}{2a+b,0,a+c}ã€‚ æˆ‘ä»¬è€ƒè™‘è®°æœï¼Œè®°æœçš„ç­”æ¡ˆç›´æ¥å­˜çš„æ˜¯ a,b,ca,b,ca,b,cï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥çœæ‰xxx å¯¹ç­”æ¡ˆçš„å½±å“ã€‚æˆ‘ä»¬å‘ç° iii å…¶å®å¯ä»¥è¡¨ç¤ºæˆåˆ°ä¸‹ä¸€ä¸ªè¯¢é—®çš„è·ç¦»ï¼Œä¹Ÿå°±æ˜¯å…¶ lower_boundï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥çœä¸€ç‚¹ç©ºé—´ã€‚ ä½†æ˜¯æˆ‘ä»¬å‘ç°è¿˜æ˜¯éœ€è¦ 2n2^n2n çº§åˆ«ï¼Œæˆ‘ä»¬è€ƒè™‘å°èŒƒå›´æš´æœï¼Œå…¶ä½™è®°æœï¼Œå³ k&gt;15k&gt;15k&gt;15 æ˜¯ä¸è®¡å…¥çŠ¶æ€ï¼Œç„¶åå¦‚æœé€’å½’åˆ°ä¸€æ£µå­æ ‘å‘ç°å®ƒæ²¡æœ‰è¯¢é—®èŠ‚ç‚¹ï¼Œé‚£ä¹ˆç›´æ¥ return æ‰ï¼Œè¿™æ ·å°±ä½¿å¾— iii å°äºç­‰äºå­æ ‘ size äº†ã€‚ å…¶å® h=0h=0h=0 æˆ‘ä»¬ä¹Ÿä¸ç”¨è®¡å…¥çŠ¶æ€ï¼Œå› ä¸ºä¸éš¾å‘ç° h=0h=0h=0 åªä¼šæœç´¢ O(k)\\mathcal{O}(k)O(k) æ¬¡ï¼Œå®Œå…¨å¯ä»¥æ¥å—ã€‚ æœ€åç¨ç¨åˆ¤ä¸€ä¸‹è¾¹ç•Œå³å¯ã€‚ è¿™æ ·æ·±åº¦å°äºç­‰äº k2\\frac{k}{2}2kâ€‹ çš„èŠ‚ç‚¹åªæœ‰ O(2k2)\\mathcal{O}(2^\\frac{k}{2})O(22kâ€‹) ä¸ªï¼Œæ·±åº¦å¤§äº k2\\frac{k}{2}2kâ€‹ çš„åªæœ‰ O(k2k2)\\mathcal{O}(k2^\\frac{k}{2})O(k22kâ€‹) ä¸ªï¼Œæ‰€ä»¥å•æ¬¡è¯¢é—®æ—¶ç©ºå¤æ‚åº¦å‡ä¸ºO(k2k2)\\mathcal{O}(k2^\\frac{k}{2})O(k22kâ€‹)ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495#include &lt;iostream&gt;#include &lt;algorithm&gt;using namespace std;typedef long long LL;const int maxl = 16;const int lim = 15;struct Solution &#123; LL a, b, c; Solution (LL a = 0, LL b = 0, LL c = 0) &#123; this-&gt;a = a, this-&gt;b = b, this-&gt;c = c; &#125; inline LL calc(int x) &#123; return a * x + b * (x &gt;&gt; 1) + c; &#125;&#125; F[maxl][1 &lt;&lt; maxl];int vis[maxl][1 &lt;&lt; maxl];inline void addls(Solution&amp; a, const Solution b) &#123; a.a += 2 * b.a + b.b; a.c += b.c;&#125;inline void addrs(Solution&amp; a, const Solution b) &#123; a.a += 2 * b.a + b.b; a.c += b.a + b.c;&#125;int kase;#define jian(x, y) &#123; \\ x -= y; \\&#125;inline Solution f(int k, int first, int m, int d, bool h) &#123; if (k == 1) &#123; return Solution(0, 1, 0); &#125; int siz = (1 &lt;&lt; k) - 1; if (siz &lt; first || !m) &#123; return Solution(0, 0, 0); &#125; bool flg = k &lt;= lim &amp;&amp; h &amp;&amp; first + m * d &gt;= siz; if (flg) &#123; if (vis[k][first] == kase) &#123; return F[k][first]; &#125; &#125; int fstbak = first; Solution ans; int sizs = (1 &lt;&lt; (k - 1)) - 1; Solution xx; if (first &lt; sizs &amp;&amp; m &gt; 0) &#123; int nowm = min(m, (sizs - first - 1) / d + 1); addls(ans, xx = f(k - 1, first, nowm, d, true)); first += nowm * d; m -= nowm; &#125; jian(first, sizs); if (!h) &#123; if (m &gt; 0 &amp;&amp; !first) &#123; ans.a += 2, ans.c++; first += d, m--; &#125; jian(first, 1); &#125; if (first &lt; sizs &amp;&amp; m &gt; 0) &#123; int nowm = min(m, (sizs - first - 1) / d + 1); addrs(ans, xx = f(k - 1, first, nowm, d, h)); first += nowm * d; m -= nowm; &#125; jian(first, sizs); if (h &amp;&amp; m &gt; 0) &#123; ans.b++; &#125; if (flg) &#123; vis[k][fstbak] = kase; F[k][fstbak] = ans; &#125; return ans;&#125;int main() &#123; int k, q; cin &gt;&gt; k &gt;&gt; q; while (q--) &#123; int a, d, m; cin &gt;&gt; a &gt;&gt; d &gt;&gt; m; a--, kase++; Solution ans = f(k, a, m, d, false); cout &lt;&lt; ans.a + ans.c &lt;&lt; &#x27;\\n&#x27;; &#125; return 0;&#125;","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"è®°å¿†åŒ–æœç´¢","slug":"è®°å¿†åŒ–æœç´¢","permalink":"https://pufanyi.github.io/oi-blog/tags/%E8%AE%B0%E5%BF%86%E5%8C%96%E6%90%9C%E7%B4%A2/"}]},{"title":"CodeForces 1264D Beautiful Bracket Sequence","slug":"CF1264D","date":"2020-01-30T16:00:00.000Z","updated":"2023-12-25T16:08:27.873Z","comments":true,"path":"CF1264D/","link":"","permalink":"https://pufanyi.github.io/oi-blog/CF1264D/","excerpt":"ç»™å®šä¸€ä¸ªé•¿åº¦ä¸ºnnnçš„å­—ç¬¦ä¸²ï¼Œå…¶ä¸­åªæœ‰ '(', ')', '?' ä¸‰ç§å­—ç¬¦ï¼Œå…¶ä¸­ '?' å¯ä»¥ä¸º '(' æˆ–è€… ')'ã€‚å¯¹äºä¸€ä¸ªæ‹¬å·åºåˆ—ï¼Œå®šä¹‰å…¶æƒå€¼ä¸ºå…¶é€šè¿‡åˆ é™¤å­—ç¬¦åå¯ä»¥å¾—åˆ°çš„åˆæ³•çš„æ‹¬å·åŒ¹é…çš„æœ€æ·±çš„æ·±åº¦ï¼Œæ±‚å‡ºæ‰€æœ‰å¯èƒ½çš„æ‹¬å·åºåˆ—ï¼ˆå³é—®å·æ›¿æ¢åï¼‰çš„æƒå€¼å’Œã€‚ åœ¨ D1 ä¸­ï¼Œnâ‰¤2000n\\le 2000nâ‰¤2000ï¼›åœ¨ D2 ä¸­ï¼Œnâ‰¤106n\\le 10^6nâ‰¤106ã€‚","text":"ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º nnn çš„å­—ç¬¦ä¸²ï¼Œå…¶ä¸­åªæœ‰ '(', ')', '?' ä¸‰ç§å­—ç¬¦ï¼Œå…¶ä¸­ '?' å¯ä»¥ä¸º '(' æˆ–è€… ')'ã€‚å¯¹äºä¸€ä¸ªæ‹¬å·åºåˆ—ï¼Œå®šä¹‰å…¶æƒå€¼ä¸ºå…¶é€šè¿‡åˆ é™¤å­—ç¬¦åå¯ä»¥å¾—åˆ°çš„åˆæ³•çš„æ‹¬å·åŒ¹é…çš„æœ€æ·±çš„æ·±åº¦ï¼Œæ±‚å‡ºæ‰€æœ‰å¯èƒ½çš„æ‹¬å·åºåˆ—ï¼ˆå³é—®å·æ›¿æ¢åï¼‰çš„æƒå€¼å’Œã€‚ åœ¨ D1 ä¸­ï¼Œnâ‰¤2000n\\le 2000nâ‰¤2000ï¼›åœ¨ D2 ä¸­ï¼Œnâ‰¤106n\\le 10^6nâ‰¤106ã€‚ è€ƒè™‘æšä¸¾ç­”æ¡ˆè®¡ç®—æ–¹æ¡ˆæ•°ï¼Œæ˜¾ç„¶å¯¹äºä¸€ä¸ªæ‹¬å·åºåˆ—ï¼Œå­˜åœ¨ä¸€ä¸ªåˆ’åˆ†ç‚¹ä½¿å¾—åˆ’åˆ†ç‚¹å·¦è¾¹çš„å·¦æ‹¬å·ä¸ªæ•°ç­‰äºåˆ’åˆ†ç‚¹å³è¾¹çš„æœ‰æ‹¬å·ä¸ªæ•°ã€‚åˆ™æ­¤æ—¶è¯¥æ‹¬å·åºåˆ—çš„æ·±åº¦å°±æ˜¯åˆ’åˆ†ç‚¹å·¦è¾¹çš„å·¦æ‹¬å·ä¸ªæ•°ã€‚è¿™æ · dp ä¹‹ååˆå¹¶ä¸€ä¸‹æ˜¯ O(n2)\\mathcal{O}(n^2)O(n2) çš„ã€‚è¿™æ · D1 å°±åšå®Œäº†ã€‚ è€ƒè™‘æŠŠå‰é¢ dp çš„å¼å­è½¬æ¢æˆç»„åˆæ•°ï¼Œæˆ‘ä»¬è€ƒè™‘æ¯ä¸ªåˆ†å‰²ç‚¹ï¼Œå‰é¢æœ‰ lll ä¸ªå·¦æ‹¬å·ï¼Œrrrä¸ªå³æ‹¬å·ï¼Œå‰é¢æœ‰ xxx ä¸ªé—®å·ï¼Œåé¢æœ‰ yyy ä¸ªé—®å·ã€‚ å…¶å®ç­”æ¡ˆå°±æ˜¯ï¼š âˆ‘i=0x(l+i)(xi)(yl+iâˆ’r)=lâˆ‘i=0x(xi)(yl+iâˆ’r)+âˆ‘i=0xi(xi)(yl+iâˆ’r)\\sum_{i=0}^x(l+i)\\binom{x}{i}\\binom{y}{l+i-r}=l\\sum_{i=0}^x\\binom{x}{i}\\binom{y}{l+i-r}+\\sum_{i=0}^xi\\binom{x}{i}\\binom{y}{l+i-r} i=0âˆ‘xâ€‹(l+i)(ixâ€‹)(l+iâˆ’ryâ€‹)=li=0âˆ‘xâ€‹(ixâ€‹)(l+iâˆ’ryâ€‹)+i=0âˆ‘xâ€‹i(ixâ€‹)(l+iâˆ’ryâ€‹) å¯¹äºå·¦è¾¹çš„å¼å­ï¼š lâˆ‘i=0x(xi)(yl+iâˆ’r)= lâˆ‘i=0x(xi)(yy+râˆ’lâˆ’i)= l(x+yy+râˆ’l)\\begin{aligned} &amp;l\\sum_{i=0}^x\\binom{x}{i}\\binom{y}{l+i-r}\\\\ =\\ &amp;l\\sum_{i=0}^x\\binom{x}{i}\\binom{y}{y+r-l-i}\\\\ =\\ &amp;l\\binom{x+y}{y+r-l} \\end{aligned} = = â€‹li=0âˆ‘xâ€‹(ixâ€‹)(l+iâˆ’ryâ€‹)li=0âˆ‘xâ€‹(ixâ€‹)(y+râˆ’lâˆ’iyâ€‹)l(y+râˆ’lx+yâ€‹)â€‹ å¯¹äºå³è¾¹çš„å¼å­ï¼š âˆ‘i=0xi(xi)(yl+iâˆ’r)= âˆ‘i=0xx(xâˆ’1iâˆ’1)(yyâˆ’lâˆ’i+r)= x(x+yâˆ’1yâˆ’l+râˆ’1)\\begin{aligned} &amp;\\sum_{i=0}^xi\\binom{x}{i}\\binom{y}{l+i-r}\\\\ =\\ &amp;\\sum_{i=0}^xx\\binom{x-1}{i-1}\\binom{y}{y-l-i+r}\\\\ =\\ &amp;x\\binom{x+y-1}{y-l+r-1} \\end{aligned} = = â€‹i=0âˆ‘xâ€‹i(ixâ€‹)(l+iâˆ’ryâ€‹)i=0âˆ‘xâ€‹x(iâˆ’1xâˆ’1â€‹)(yâˆ’lâˆ’i+ryâ€‹)x(yâˆ’l+râˆ’1x+yâˆ’1â€‹)â€‹ æ‰€ä»¥è¯¥ç‚¹çš„è´¡çŒ®ä¸ºï¼š l(x+yy+râˆ’l)+x(x+yâˆ’1yâˆ’l+râˆ’1)l\\binom{x+y}{y+r-l}+x\\binom{x+y-1}{y-l+r-1} l(y+râˆ’lx+yâ€‹)+x(yâˆ’l+râˆ’1x+yâˆ’1â€‹) ä»£ç å°±ç›´æ¥ä¸¢é“¾æ¥äº†ï¼šD1ã€D2ã€‚","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"æ•°å­¦","slug":"æ•°å­¦","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%95%B0%E5%AD%A6/"},{"name":"CodeForces","slug":"CodeForces","permalink":"https://pufanyi.github.io/oi-blog/tags/CodeForces/"},{"name":"DP","slug":"DP","permalink":"https://pufanyi.github.io/oi-blog/tags/DP/"}]},{"title":"æ¢äº†ä¸ªä¸»é¢˜","slug":"æ¢ä¸ªä¸»é¢˜","date":"2020-01-28T16:00:00.000Z","updated":"2023-12-25T16:08:28.081Z","comments":true,"path":"æ¢ä¸ªä¸»é¢˜/","link":"","permalink":"https://pufanyi.github.io/oi-blog/%E6%8D%A2%E4%B8%AA%E4%B8%BB%E9%A2%98/","excerpt":"ä¹‹å‰çš„ä¸»é¢˜å¤ªä¸‘äº†â€¦â€¦","text":"ä¹‹å‰çš„ä¸»é¢˜å¤ªä¸‘äº†â€¦â€¦ æ¢ä¸Šäº† Material Xï¼Œå¾ˆå¤šä¿®æ”¹ç›´æ¥å·äº† myh çš„ä»£ç  ã€‚ ä¹‹å‰æ­å¾—å¤ªè‡ƒè‚¿äº†ï¼Œç°åœ¨åˆ åº“ä¹‹åå…¨éƒ¨é‡æ–°æ­äº†ä¸€éâ€¦â€¦ å¥½æ„Ÿäººå•Šï¼Œæ­å®Œå‘ç°é€Ÿåº¦å¿«äº†å¥½å¤šâ€¦â€¦","categories":[],"tags":[]},{"title":"ç”Ÿæˆæ ‘å…¥é—¨","slug":"ç”Ÿæˆæ ‘å…¥é—¨","date":"2020-01-28T16:00:00.000Z","updated":"2023-12-25T16:08:28.083Z","comments":true,"path":"ç”Ÿæˆæ ‘å…¥é—¨/","link":"","permalink":"https://pufanyi.github.io/oi-blog/%E7%94%9F%E6%88%90%E6%A0%91%E5%85%A5%E9%97%A8/","excerpt":"ä¸‡å¹´ä¸æ›´äº†ï¼Œéšä¾¿å†™ç‚¹ä»€ä¹ˆå§ã€‚","text":"ä¸‡å¹´ä¸æ›´äº†ï¼Œéšä¾¿å†™ç‚¹ä»€ä¹ˆå§ã€‚ é¦–å…ˆæœ€å°ç”Ÿæˆæ ‘çš„ä¸¤ç§æ±‚æ³• Kruskal å’Œ Primï¼Œå¼ºè¡Œä¸¢ é“¾æ¥ã€‚ å…¶ä»–è¿˜æœ‰ä¸€ä¸ª BorÅ¯vka ç®—æ³•ï¼Œå¤§æ¦‚æ€è·¯å°±æ˜¯æ¯æ¬¡å°†æ¯ä¸ªé›†åˆä¼¸å‡ºå»çš„æœ€çŸ­çš„é‚£æ¡è¾¹é€‰å…¥ï¼Œé€‰å…¥åå°†ä¸¤ä¸ªé›†åˆåˆå¹¶æˆä¸€ä¸ªæ–°çš„é›†åˆï¼Œè€ƒè™‘åˆ°æ¯æ¬¡é›†åˆä¸ªæ•°å‡åŠï¼Œæ‰€ä»¥å¤æ‚åº¦ O(mlogâ¡n)\\mathcal{O}(m\\log n)O(mlogn)ã€‚å·äº†å¼  Wikipedia çš„å›¾ï¼š é‚£è¿™ä¸œè¥¿æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿæœ‰ è¿™ä¹ˆä¸€é“é¢˜ï¼Œå¤§æ¦‚æ˜¯æœ‰ä¸€ä¸ª n (nâ‰¤200000)n\\,(n\\le 200000)n(nâ‰¤200000) ä¸ªç‚¹çš„å®Œå…¨å›¾ï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„ç¼–å·ä¸º ai (0â‰¤ai&lt;230)a_i\\,(0\\le a_i&lt;2^{30})aiâ€‹(0â‰¤aiâ€‹&lt;230)ï¼Œiii ä¸ jjj çš„è¾¹çš„æƒå€¼æ˜¯ aiâ¨‚aja_i\\bigotimes a_jaiâ€‹â¨‚ajâ€‹ï¼Œâ¨‚\\bigotimesâ¨‚ æ˜¯æŒ‰ä½å¼‚æˆ–ï¼Œæ±‚è¯¥å›¾çš„æœ€å°ç”Ÿæˆæ ‘ã€‚ è¿™é“é¢˜å¤§æ¦‚ç”¨åˆ°äº† BorÅ¯vka çš„æ€æƒ³ï¼Œå…ˆç”¨æ‰€æœ‰ç‚¹æƒå»ºä¸€æ£µ Trie æ ‘ï¼Œè€ƒè™‘ Trie æ ‘ä¸Šä¸€æ£µå­æ ‘ï¼Œæ˜¾ç„¶ä¸€å¼€å§‹è‚¯å®šæ˜¯ä»–ä»¬è‡ªå·±è¿æˆä¸€æ£µ MSTï¼Œç„¶åå†å’Œå…¶å…„å¼Ÿè¿ä¸€æ¡è¾¹ï¼Œå› ä¸ºè·¨è¶Šå­æ ‘åƒå…„å¼Ÿè¿ä¸€æ¡è¾¹éœ€è¦ 2d2^d2d çš„ä»£ä»·ï¼Œddd æ˜¯èŠ‚ç‚¹æ·±åº¦ï¼Œæ˜¾ç„¶è‡ªå·±è¿æ›´ä¼˜ï¼Œäºæ˜¯å»ºå‡º Trie æ ‘ä¹‹ååˆ†æ²»ï¼ˆå…¶å®å°±æ˜¯ dfsï¼‰ä¸‹å»å³å¯ã€‚ å…·ä½“ä»£ç å¯ä»¥ æˆ³è¿™é‡Œã€‚ æœ‰ä¸€é“å« æœ€å° mex ç”Ÿæˆæ ‘ çš„é¢˜ç›®ï¼Œé¢˜ç›®å¤§æ„æ˜¯ç»™å®š nnn ä¸ªç‚¹ mmm æ¡è¾¹çš„æ— å‘è¿é€šå›¾ï¼Œæ±‚ä¸€æ£µç”Ÿæˆæ ‘ï¼Œä½¿å¾—å…¶è¾¹æƒé›†åˆçš„ mex\\mathrm{mex}mex å°½å¯èƒ½å°ã€‚1â‰¤nâ‰¤106, 1â‰¤mâ‰¤105, 0â‰¤wâ‰¤1051\\le n\\le 10^6,\\,1\\le m\\le 10^5,\\,0\\le w\\le 10^51â‰¤nâ‰¤106,1â‰¤mâ‰¤105,0â‰¤wâ‰¤105ã€‚ è€ƒè™‘ä¸€ä¸ªåšæ³•ï¼šæšä¸¾ç­”æ¡ˆ xxxï¼ŒæŠŠè¾¹æƒä¸º xxx çš„æ‰€æœ‰è¾¹å…¨éƒ¨åˆ æ‰ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½æ„æˆä¸€æ£µç”Ÿæˆæ ‘ã€‚ å»ºä¸€æ£µä»¥è¾¹æƒä¸ºä¸‹æ ‡çš„çº¿æ®µæ ‘ï¼Œå¯¹äºæ¯æ¡è¾¹æƒä¸º www çš„è¾¹å°†å…¶æ”¾åˆ° [0,wâˆ’1][0,w-1][0,wâˆ’1] å’Œ [w+1,105][w+1,10^5][w+1,105] ä¸Šã€‚ç„¶ååœ¨çº¿æ®µæ ‘ä¸Šéå†ï¼Œéå†åˆ°ä¸€ä¸ªèŠ‚ç‚¹å°±å°†å®ƒä¸Šé¢æŒ‚ç€çš„è¾¹è¿ä¸Šï¼Œè¿™æ ·å­åˆ°å¶ç»“ç‚¹æ—¶å°±è¿ä¸Šäº†æ‰€æœ‰ä¸åŒ…å«è¯¥è¾¹æƒçš„è¾¹ï¼Œç”¨å¯æ’¤é”€å¹¶æŸ¥é›†åˆ¤æ–­å›¾æ˜¯å¦è¿é€šå³å¯ã€‚ ç”¨å¯æ’¤é”€æŒ‰ç§©åˆå¹¶å¹¶æŸ¥é›†ï¼Œå¤æ‚åº¦ O(nlogâ¡2n)\\mathcal{O}(n\\log^2n)O(nlog2n)ã€‚å¹¶ä¸æ˜¯å¾ˆæ‡‚ä¸ºä»€ä¹ˆä¸¤åª logâ¡\\loglog èƒ½è¿‡ 10610^6106ã€‚ æœ€å°æ¯”ç‡ç”Ÿæˆæ ‘ï¼Œä¹Ÿå°±æ˜¯ç»™ä½ ä¸€å¼ å›¾ï¼Œæ¯æ¡è¾¹æœ‰ä¸€ä¸ªéè´Ÿæƒå€¼ ai,bia_i,b_iaiâ€‹,biâ€‹ï¼Œæ±‚ä¸€æ£µç”Ÿæˆæ ‘ TTTï¼Œä½¿å¾— âˆ‘eâˆˆTaeâˆ‘eâˆˆTbe\\frac{\\sum_{e\\in T}a_e}{\\sum_{e\\in T}b_e}âˆ‘eâˆˆTâ€‹beâ€‹âˆ‘eâˆˆTâ€‹aeâ€‹â€‹ æœ€å°ã€‚ å¤§æ¦‚å°±æ˜¯ä¸€ä¸ª 01 åˆ†æ•°è§„åˆ’é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘äºŒåˆ†ç­”æ¡ˆ lllï¼Œæ¡ä»¶æ˜¯ âˆ‘eâˆˆTaeâˆ‘eâˆˆTbeâ‰¤l\\frac{\\sum_{e\\in T}a_e}{\\sum_{e\\in T}b_e}\\le lâˆ‘eâˆˆTâ€‹beâ€‹âˆ‘eâˆˆTâ€‹aeâ€‹â€‹â‰¤lï¼Œä¹Ÿå°±æ˜¯ âˆ‘eâˆˆTaeâˆ’lâ‹…beâ‰¤0\\sum_{e\\in T}a_e-l\\cdot b_e\\le 0âˆ‘eâˆˆTâ€‹aeâ€‹âˆ’lâ‹…beâ€‹â‰¤0ã€‚ è€ƒè™‘åˆ° aiâ‰¥0,biâ‰¥0a_i\\ge 0,b_i\\ge 0aiâ€‹â‰¥0,biâ€‹â‰¥0ï¼Œæ‰€ä»¥å·¦è¾¹çš„ä¸œè¥¿è‚¯å®šéš lll é€’å‡ã€‚ ä»¥ aiâˆ’lâ‹…bia_i-l\\cdot b_iaiâ€‹âˆ’lâ‹…biâ€‹ ä¸ºè¾¹æƒå»ºæ ‘äºŒåˆ†å³å¯ã€‚ æ¨¡æ¿é¢˜å¤§æ¦‚æ˜¯ è¿™é“ ï¼Œä»£ç å¯ä»¥ æˆ³è¿™é‡Œã€‚ æ¥ä¸‹æ¥æ˜¯é‚£åˆ°ç»å…¸çš„ wqs äºŒåˆ†å¥½é¢˜ ï¼Œé¢˜ç›®å¤§æ„å°±æ˜¯ç»™ä½ ä¸€ä¸ªæ— å‘å¸¦æƒè¿é€šå›¾ï¼Œæ¯æ¡è¾¹æ˜¯é»‘è‰²æˆ–ç™½è‰²ã€‚è®©ä½ æ±‚ä¸€æ£µæœ€å°æƒçš„æ°å¥½æœ‰ xxx æ¡ç™½è‰²è¾¹çš„ç”Ÿæˆæ ‘ã€‚Vâ‰¤50000, Eâ‰¤100000V\\le 50000,\\,E\\le 100000Vâ‰¤50000,Eâ‰¤100000ï¼Œè¾¹æƒä¸º[1,100][1,100][1,100] ä¸­çš„æ•´æ•°ã€‚ é¦–å…ˆæˆ‘ä»¬å…ˆè¦çŸ¥é“ wqs äºŒåˆ†æ˜¯ä»€ä¹ˆï¼Œé‚£å°±å…ˆè¯´ä¸€é“é¢˜å§ï¼Œå¤§æ¦‚å°±æ˜¯æœ‰ä¸€ä¸ªé•¿åº¦ä¸º n (nâ‰¤105)n\\,(n\\le 10^5)n(nâ‰¤105) çš„æ­£æ•´æ•°åºåˆ— {a}\\{a\\}{a}ï¼Œè¦åˆ†æˆ KKK æ®µï¼Œç¬¬ iii æ®µä¹‹å’Œè®°ä¸º sis_isiâ€‹ï¼Œæ±‚æœ€å°çš„ âˆ‘i=1Ksi2\\sum_{i=1}^Ks_i^2âˆ‘i=1Kâ€‹si2â€‹ã€‚ æˆ‘ä»¬ä»¤ fkf_kfkâ€‹ è¡¨ç¤ºåˆ†æˆ kkk æ®µçš„æœ€å°å€¼ï¼Œæœ‰ä¸€ä¸ªæ˜¾ç„¶çš„ç»“è®ºå°±æ˜¯ fkf_kfkâ€‹ æ˜¯é€’å‡çš„ï¼Œå› ä¸º (a+b)2&gt;a2+b2\\left(a+b\\right)^2&gt; a^2+b^2(a+b)2&gt;a2+b2ï¼ŒæŠŠä¸€æ®µç»™æ‹†å¼€æ¥è‚¯å®šæ›´ä¼˜ã€‚ æˆ‘ä»¬æ¥è€ƒè™‘ fff çš„å·®åˆ†æ•°åˆ—ï¼Œæˆ‘ä»¬å‘ç° fff çš„å·®åˆ†æ•°åˆ—æ˜¯å•è°ƒä¸å¢çš„ã€‚æ„Ÿè§‰æˆ‘çš„è¯æ˜æ¯”è¾ƒå£èƒ¡ï¼Œå¤§å®¶æ„ä¼šä¸€ä¸‹å°±å¯ä»¥äº†ã€‚å¦‚æœå¤§å®¶å¯¹è¯æ˜æ²¡ä»€ä¹ˆå…´è¶£ï¼Œä¹Ÿå¯ä»¥ä¸è·³è¿‡è¿™ä¸€æ®µï¼Œåæ­£åªè¦æ„ä¼šä¸€ä¸‹è¿™æ˜¯å•è°ƒçš„å°±å¯ä»¥äº†ã€‚æˆ‘ä»¬è€ƒè™‘ä»åˆ†æˆ kkk æ®µåˆ°åˆ†æˆ kâˆ’1k-1kâˆ’1 æ®µçš„æƒ…å†µï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¦æŠŠæ®µæ•°å‡ 111ã€‚æ­¤æ—¶ï¼Œæœ‰ä¸¤ç§åŠæ³•ï¼Œä¸€ç§æ˜¯åˆå¹¶å…¶ä¸­çš„ä¸¤æ®µï¼Œå¦ä¸€ç§æ˜¯æ‹†æ‰åŸæœ‰çš„ä¸€äº›æ®µã€‚é¦–å…ˆçœ‹åˆå¹¶ä¸¤æ®µã€‚è€ƒè™‘åˆ°å¦‚æœåˆå¹¶è¿™ä¸¤æ®µæ‰€å‡çš„é‡æ¯” fk+1âˆ’fkf_{k+1}-f_kfk+1â€‹âˆ’fkâ€‹ è¦å°ï¼Œé‚£ä¹ˆ k+1â†’kk+1\\to kk+1â†’k çš„æ—¶å€™å°±åº”è¯¥åˆå¹¶è¿™ä¸¤æ®µã€‚å½“ç„¶å¯èƒ½è¿™ä¸¤æ®µå¯èƒ½æ˜¯ k+1â†’kk+1\\to kk+1â†’k çš„æ—¶å€™å‡ºç°çš„ï¼Œè¿™æ—¶å€™æˆ‘ä»¬è€ƒè™‘åˆ° aâ‹…(b+c)â‰¥aba\\cdot(b+c)\\ge abaâ‹…(b+c)â‰¥ab å³å¯ã€‚è¿˜æœ‰ä¸€ç§æ–¹æ³•å°±æ˜¯æ‹†æ‰ä¸€äº›æ®µç„¶ååˆå¹¶ã€‚ä¸éš¾å‘ç°è¿™å…¶å®åªæœ‰å’ŒäºŒåˆ†å›¾å¢å¹¿ä¸€æ ·çš„æƒ…å†µï¼Œå°±æ˜¯ 0101010 å˜æˆ 1010101ã€‚å¦‚æœ k+1â†’kk+1\\to kk+1â†’k æ‰€ç”Ÿæˆçš„æ®µå’Œè¿™äº›æ®µæ— å…³ï¼Œé‚£æ˜¾ç„¶è¿™æ ·æ“ä½œçš„ä»£ä»·æ¯” k+1â†’kk+1\\to kk+1â†’k çš„ä»£ä»·åŠ£ï¼Œå¦‚æœæœ‰å…³ï¼Œæˆ‘ä»¬è€ƒè™‘è¿™ä¸€æ®µï¼Œå¦‚æœ kâ†’kâˆ’1k\\to k-1kâ†’kâˆ’1 çš„ä»£ä»·æ¯” k+1â†’kk+1\\to kk+1â†’k ä¼˜ï¼Œè€ƒè™‘ kâ†’kâˆ’1k\\to k-1kâ†’kâˆ’1 è¿™ä¸€æ¬¡â€œå¢å¹¿â€æ—¶è¯¥å—æ‰€æ–­å¼€çš„é‚£ä¸ªä½ç½®ï¼Œæˆ‘ä»¬è€ƒè™‘ k+1â†’kk+1\\to kk+1â†’k æ—¶ä¸å°†é‚£ä¸€æ®µåˆå¹¶ï¼Œè€Œæ˜¯å°†æˆ‘ä»¬åˆšæ‰æ‰¾åˆ°çš„é‚£ä¸ªä½ç½®å‘å·¦ä¾§æˆ–å³ä¾§è·Ÿ kâ†’kâˆ’1k\\to k-1kâ†’kâˆ’1 è¿™æ ·çš„æ ·å­çš„æ–¹å‘è¿›è¡Œâ€œå¢å¹¿â€ï¼Œä¸éš¾è¯æ˜è¿™æ ·åšçš„ä»£ä»·ä¼˜äº fk+1âˆ’fkf_{k+1}-f_kfk+1â€‹âˆ’fkâ€‹ï¼Œè€Œç”±äºæˆ‘ä»¬ä¹‹å‰è®¤ä¸º fk+1âˆ’fkf_{k+1}-f_kfk+1â€‹âˆ’fkâ€‹ æ˜¯æœ€ä¼˜çš„ï¼ŒçŸ›ç›¾äº†ï¼Œæ‰€ä»¥ä¸åˆã€‚ç»¼ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥å‘ç° fff çš„å·®åˆ†æ•°åˆ—æ˜¯å•è°ƒä¸å¢çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ˜¯ä¸€ä¸ªå‡¸å£³ã€‚ é‚£æˆ‘ä»¬æ—¢ç„¶æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªå‡¸å£³ï¼Œä½†æ˜¯æˆ‘ä»¬å¹¶ä¸çŸ¥é“å‡¸å£³ä¸Šå…·ä½“ç‚¹çš„çºµåæ ‡ï¼Œæˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªåšæ³•ï¼šè€ƒè™‘ç”¨ä¸€æ¡ç›´çº¿ y=kx+by=kx+by=kx+b å»åˆ‡è¿™ä¸ªå‡¸å£³ï¼Œæˆ‘ä»¬äºŒåˆ† kkkï¼Œå¦‚æœèƒ½å¿«é€Ÿæ±‚å‡º bbb å’Œå…·ä½“åˆ‡åˆ°äº†å‡¸å£³ä¸Šçš„é‚£ä¸€ä¸ªç‚¹ï¼Œé‚£ä¹ˆå°±èƒ½å¾—å‡ºç­”æ¡ˆã€‚ å¯¹äºè¿™é“é¢˜ï¼Œæˆ‘ä»¬å‘ç°äºŒåˆ†çš„ kkk å…¶å®å°±æ˜¯ç»™æ¯æ®µå¢åŠ äº†ä¸€ä¸ªä»£ä»·ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯æ®µçš„ä»£ä»·ä¸å†æ˜¯ si2s_i^2si2â€‹ï¼Œè€Œæ˜¯ si2âˆ’ks_i^2-ksi2â€‹âˆ’kï¼ˆæ˜¾ç„¶ï¼Œè¿™é‡Œéœ€è¦äºŒåˆ†çš„ kkk æ˜¯è´Ÿæ•°ï¼‰ã€‚è¿™æ ·åšæœ‰ä¸€ä¸ªå¥½å¤„ï¼Œå°±æ˜¯æˆ‘ä»¬ä¸å¿…è€ƒè™‘éœ€è¦é€‰ KKK æ®µçš„é™åˆ¶ï¼Œè€Œæ˜¯åªè¦æ±‚å‡ºæœ€ä¼˜è§£åˆ†æˆäº†å‡ æ®µï¼ˆä¹Ÿå°±æ˜¯åˆ‡åˆ°äº†é‚£ä¸ªç‚¹ï¼‰ï¼Œä»¥åŠæœ€ä¼˜è§£çš„ç­”æ¡ˆï¼ˆä¹Ÿå°±æ˜¯ bbbï¼‰å³å¯ã€‚ è¿™ä¸ªä¸œè¥¿æˆ‘ä»¬å¯ä»¥è€ƒè™‘ä¸€ä¸ªæœ´ç´ çš„ dpï¼Œä»¤ gig_igiâ€‹ è¡¨ç¤ºä»¥ iii ç»“å°¾çš„ç­”æ¡ˆï¼Œæ˜¾ç„¶æˆ‘ä»¬æœ‰ï¼š gi=minâ¡j=1iâˆ’1(gj+(âˆ‘t=jiat)2)âˆ’kg_i=\\min_{j=1}^{i-1}\\left(g_j+\\left(\\sum_{t=j}^ia_t\\right)^2\\right)-k giâ€‹=j=1miniâˆ’1â€‹ââ›â€‹gjâ€‹+(t=jâˆ‘iâ€‹atâ€‹)2â ââ€‹âˆ’k æˆ‘ä»¬ä»¤ Si=âˆ‘j=1iajS_i=\\sum_{j=1}^ia_jSiâ€‹=âˆ‘j=1iâ€‹ajâ€‹ï¼Œä¸éš¾å¾—åˆ°ï¼š gi=minâ¡j=1iâˆ’1(gj+sj2âˆ’2sisj)âˆ’kâˆ’si2g_i=\\min_{j=1}^{i-1}\\left(g_j+s_j^2-2s_is_j\\right)-k-s_i^2 giâ€‹=j=1miniâˆ’1â€‹(gjâ€‹+sj2â€‹âˆ’2siâ€‹sjâ€‹)âˆ’kâˆ’si2â€‹ ä¸éš¾å‘ç°è¿™ä¸ªä¸œè¥¿å¯ä»¥æ–œç‡ä¼˜åŒ–ï¼Œäºæ˜¯æˆ‘ä»¬å°±å¯ä»¥é¡ºåˆ©åœ°è§£å†³è¿™é“é¢˜ã€‚ æˆ‘ä»¬å›è¿‡å¤´æ¥çœ‹ä¹‹å‰é‚£é“é¢˜ï¼šç»™ä½ ä¸€ä¸ªæ— å‘å¸¦æƒè¿é€šå›¾ï¼Œæ¯æ¡è¾¹æ˜¯é»‘è‰²æˆ–ç™½è‰²ã€‚è®©ä½ æ±‚ä¸€æ£µæœ€å°æƒçš„æ°å¥½æœ‰ xxx æ¡ç™½è‰²è¾¹çš„ç”Ÿæˆæ ‘ã€‚ è¿™é“é¢˜çš„ç­”æ¡ˆä¼¼ä¹å¹¶ä¸æ˜¯éš xxx å•è°ƒçš„ï¼Œåº”è¯¥æ˜¯ä¸€ä¸ªå•å³°çš„å‡½æ•°ï¼Œä½†æ˜¯æˆ‘ä»¬è€ƒè™‘å…¶å·®åˆ†æ•°åˆ—ï¼Œå‘ç°å…¶ä¹Ÿæ˜¯å•è°ƒçš„ã€‚å› ä¸ºæƒ³è±¡å¦‚æœä½ å¿…é¡»æ‰”æ‰ä¸€æ¡è¾¹è€Œå»é€‰æ‹©å¦ä¸€ç§é¢œè‰²ä¸€æ¡è¾¹ï¼Œé‚£ä¸€å®šæ˜¯æœ‰å¾ˆå¤šä¸­é€‰æ‹©ï¼ˆå¦‚å¼ƒ aaa é€‰ bbbï¼Œå¼ƒ ccc é€‰ dddï¼‰ï¼Œè€Œè¿™äº›å†³ç­–æ˜¯ç‹¬ç«‹çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©ä»»æ„ä¸€ä¸ªï¼Œè€Œæ˜¾ç„¶æ˜¯ä¼šå»é€‰æ‹©æœ€å°çš„ä¸€ä¸ªã€‚äºæ˜¯è¿™ä»ç„¶æ˜¯ä¸€ä¸ªå‡¸å£³ã€‚æˆ‘ä»¬ä»ç„¶èƒ½ç”¨åˆšæ‰çš„æ€è·¯ï¼Œç”¨ä¸€æ¡ç›´çº¿å»å¡ï¼ŒäºŒåˆ†æ–œç‡ï¼Œå‘ç°æ–œç‡å°±æ˜¯ç»™æ¯æ¡ç™½è‰²è¾¹åŠ ä¸€ä¸ªæƒå€¼ï¼Œç„¶åå°±å¯ä»¥ç›´æ¥åšäº†ã€‚å¦‚æœå…ˆå°†é»‘ç™½è¾¹åˆ†åˆ«æ’åºï¼Œæœ€åæ¯æ¬¡äºŒåˆ†æ˜¯å½’å¹¶ä¸€ä¸‹ï¼Œé‚£ä¹ˆæ’åºçš„å¤æ‚åº¦å˜æˆäº† O(E)\\mathcal{O}(E)O(E)ï¼Œäºæ˜¯å¤æ‚åº¦ O(Elogâ¡C Î±(V))\\mathcal{O}(E\\log C\\,\\alpha(V))O(ElogCÎ±(V))ï¼ŒCCC æ˜¯äºŒåˆ†èŒƒå›´ã€‚ æ¥ç€åº”è¯¥æ˜¯ ä¸¥æ ¼æ¬¡å°ç”Ÿæˆæ ‘ ï¼Œé¢˜ç›®å°±æ˜¯è®©ä½ æ±‚ä¸€æ£µä¸¥æ ¼æ¬¡å°ç”Ÿæˆæ ‘å§ã€‚å…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œé¦–å…ˆå‘ç°ä»»æ„ä¸€æ£µæœ€å°ç”Ÿæˆæ ‘éƒ½å¯ä»¥é€šè¿‡åŠ ä¸€æ¡è¾¹å†åˆ ä¸€æ¡è¾¹å˜æˆä¸€æ£µä¸¥æ ¼æ¬¡å°ç”Ÿæˆæ ‘ï¼Œäºæ˜¯å°±å¯ä»¥å»ºå‡ºä¸€æ£µæœ€å°ç”Ÿæˆæ ‘ï¼Œç”¨å€å¢ã€æ ‘å‰–æˆ–æ˜¯ LCT ç»´æŠ¤é“¾æœ€å¤§å€¼ï¼Œæ¯æ¬¡æšä¸¾ä¸€æ¡éæ ‘è¾¹å°è¯•åˆ é™¤ä¸€æ¡æ ‘è¾¹ï¼Œå¤æ‚åº¦ O(nlogâ¡2n)/O(nlogâ¡n)\\mathcal{O}(n\\log^2n)/\\mathcal{O}(n\\log n)O(nlog2n)/O(nlogn)ã€‚ä»£ç çœ‹ è¿™é‡Œã€‚ æœ€å°æƒå€¼ç”Ÿæˆæ ‘ï¼Ÿå°±æ˜¯è¦æ±‚ âˆ‘wisi\\sum w_is_iâˆ‘wiâ€‹siâ€‹ æœ€å°ã€‚wiw_iwiâ€‹ æ˜¯ iii ä»¥ 111 ä¸ºæ ¹æ—¶ä¸çˆ¶äº²è¾¹æƒçš„å¤§å°ï¼Œw1=0w_1=0w1â€‹=0ï¼Œsis_isiâ€‹ æ˜¯ä»¥ 111 ä¸ºæ ¹æ—¶ iii çš„å­æ ‘å¤§å°ã€‚1â‰¤n,mâ‰¤105, wiâ‰¥01\\le n,m\\le 10^5,\\,w_i\\ge 01â‰¤n,mâ‰¤105,wiâ€‹â‰¥0ã€‚ å‘ç° âˆ‘wisi=âˆ‘di\\sum w_is_i=\\sum d_iâˆ‘wiâ€‹siâ€‹=âˆ‘diâ€‹ï¼Œdid_idiâ€‹ è¡¨ç¤º iii åˆ° 111 çš„è·ç¦»ï¼Œäºæ˜¯æœ€çŸ­è·¯å¾„æ ‘å³æ˜¯ç­”æ¡ˆã€‚ æœ€å°æå·®ç”Ÿæˆæ ‘ï¼Ÿé¦–å…ˆæœ‰ä¸€ä¸ª O(m2)\\mathcal{O}(m^2)O(m2) çš„åšæ³•ï¼Œå°±æ˜¯æšä¸¾æœ€å°è¾¹ï¼Œç„¶åå°±æ˜¯æœ€å°ç“¶é¢ˆç”Ÿæˆæ ‘äº†ï¼Œç›´æ¥ Kruskalã€‚ ç„¶åæˆ‘ä»¬å‘ç°æˆ‘ä»¬å¯ä»¥å€’ç€æšä¸¾è¾¹ï¼Œæ¯æ¬¡åŠ å…¥ä¸€ä¸ªæœ€å°çš„ï¼Œå½¢æˆä¸€ä¸ªç¯ï¼Œæ˜¾ç„¶æ˜¯åˆ å»ç¯ä¸­æœ€å¤§çš„ï¼Œè¿™ä¸ªæˆ‘ä»¬å¯ä»¥ç›´æ¥ç”¨ LCT ç»´æŠ¤ï¼Œç»´æŠ¤è¾¹æƒçš„æ—¶å€™å°†è¾¹å˜æˆä¸€ä¸ªè™šç‚¹å³å¯ã€‚æ—¶é—´å¤æ‚åº¦ O(mlogâ¡(n+m))\\mathcal{O}(m\\log (n+m))O(mlog(n+m))ã€‚ æ¨¡æ¿é¢˜å¯ä»¥çœ‹ è¿™é“ ï¼Œä»£ç å¯ä»¥çœ‹ è¿™é‡Œã€‚æœ‰ä¸€ä¸ªå¤§å‘å°±æ˜¯è¿™é“é¢˜æœ‰è‡ªç¯ã€‚ è¿˜æœ‰æœ€å°ä¹˜ç§¯ç”Ÿæˆæ ‘ã€‚å°±æ˜¯æ¯æ¡è¾¹æœ‰ä¸¤ä¸ªæƒå€¼ ai,bia_i,b_iaiâ€‹,biâ€‹ï¼Œæ±‚ä¸€æ£µç”Ÿæˆæ ‘ TTTï¼Œæœ€å°åŒ– âˆ‘eâˆˆTaeÃ—âˆ‘eâˆˆTbe\\sum_{e\\in T}a_e\\times\\sum_{e\\in T}b_eâˆ‘eâˆˆTâ€‹aeâ€‹Ã—âˆ‘eâˆˆTâ€‹beâ€‹ã€‚æ•°æ®èŒƒå›´ 1â‰¤nâ‰¤200, 1â‰¤mâ‰¤10000, 0â‰¤aiâ‰¤biâ‰¤2551\\le n\\le 200,\\,1\\le m\\le 10000,\\,0\\le a_i\\le b_i\\le 2551â‰¤nâ‰¤200,1â‰¤mâ‰¤10000,0â‰¤aiâ€‹â‰¤biâ€‹â‰¤255ã€‚ è€ƒè™‘å°†æ¯æ£µæœ€å°ç”Ÿæˆæ ‘ TTT éƒ½æ˜ å°„åˆ°ä¸€ä¸ªç‚¹ (âˆ‘eâˆˆTae,âˆ‘eâˆˆTbe)\\left(\\sum_{e\\in T} a_e,\\sum_{e\\in T} b_e\\right)(âˆ‘eâˆˆTâ€‹aeâ€‹,âˆ‘eâˆˆTâ€‹beâ€‹)ã€‚ä¹Ÿå°±æ˜¯æ±‚å…¶ä¸ (0,0)(0,0)(0,0) æ‰€å›´æˆçš„é¢ç§¯æœ€å°ã€‚ ç„¶åå°±ä¸éš¾å‘ç°ç­”æ¡ˆä¸€å®šåœ¨å‡¸å£³ä¸Šï¼Œæˆ‘ä»¬è€ƒè™‘æ‰¾åˆ°è¿™ä¸ªå‡¸å£³ã€‚ æœ‰ä¸€ç§å«åš Quick-Hull çš„æ‰¾å‡¸åŒ…çš„æ–¹æ³•ï¼Œå°±æ˜¯é€‰å–ä¸¤ä¸ªå‡¸åŒ…ä¸Šçš„ç‚¹ï¼Œè¿æˆä¸€æ¡çº¿ï¼Œæ‰¾åˆ°è·ç¦»è¿™æ¡çº¿æœ€è¿œçš„ç‚¹ï¼ˆä¸€ä¾§ï¼‰ï¼Œç„¶ååˆ†æ²»ä¸‹å»ï¼ˆç»§ç»­å·ä¸€å¼  Wikipedia ä¸Šçš„å›¾ï¼‰ï¼š è¿™ç§æ–¹æ³•å¯ä»¥ç”¨åœ¨è¿™é“é¢˜ç›®ä¸Šï¼Œæˆ‘ä»¬è€ƒè™‘å…ˆæ‰¾åˆ°ä¸¤ä¸ªç‚¹ï¼Œæœ€å¥½æ‰¾çš„å°±æ˜¯å·¦ä¸Šè§’å’Œå³ä¸‹è§’äº†ï¼Œä¸€ä¸ªæ˜¯ä»¥ aaa å»ºä¸€æ£µæœ€å°ç”Ÿæˆæ ‘ï¼Œå¦ä¸€ä¸ªä»¥ bbb å»ºæœ€å°ç”Ÿæˆæ ‘ã€‚ ç„¶åæˆ‘ä»¬è€ƒè™‘æ‰¾æœ€è¿œçš„ç‚¹ï¼Œé‚£æ˜¾ç„¶å°±æ˜¯é¢ç§¯æœ€å¤§çš„ç‚¹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæˆ‘ä»¬æ‰¾åˆ°å·¦ä¸Šè§’çš„ç‚¹ A(xa,ya)A(x_a,y_a)A(xaâ€‹,yaâ€‹)ï¼Œå³ä¸‹è§’ B(xb,yb)B(x_b,y_b)B(xbâ€‹,ybâ€‹)ï¼Œæˆ‘ä»¬è¦æ‰¾ä¸€ä¸ªç‚¹ C(xc,yc)C(x_c,y_c)C(xcâ€‹,ycâ€‹)ï¼Œæˆ‘ä»¬è¦æœ€å¤§åŒ– ACâ†’Ã—ABâ†’\\overrightarrow{AC}\\times \\overrightarrow{AB}ACÃ—ABã€‚ æˆ‘ä»¬è€ƒè™‘åˆ°ï¼š ACâ†’Ã—ABâ†’=(xcâˆ’xa,ycâˆ’ya)Ã—(xbâˆ’xa,ybâˆ’ya)=(xcâˆ’xa)â‹…(ybâˆ’ya)âˆ’(xbâˆ’xa)â‹…(ycâˆ’ya)=xcybâˆ’xcyaâˆ’xayb+xayaâˆ’xbyc+xayc+xbyaâˆ’xaya=xc(ybâˆ’ya)+yc(xaâˆ’xb)+xbyaâˆ’xayb\\begin{aligned} \\overrightarrow{AC}\\times \\overrightarrow{AB}&amp;=\\left(x_c-x_a,y_c-y_a\\right)\\times\\left(x_b-x_a,y_b-y_a\\right)\\\\ &amp;=(x_c-x_a)\\cdot(y_b-y_a)-(x_b-x_a)\\cdot(y_c-y_a)\\\\ &amp;=x_cy_b-x_cy_a-x_ay_b+x_ay_a-x_by_c+x_ay_c+x_by_a-x_ay_a\\\\ &amp;=x_c(y_b-y_a)+y_c(x_a-x_b)+x_by_a-x_ay_b \\end{aligned} ACÃ—ABâ€‹=(xcâ€‹âˆ’xaâ€‹,ycâ€‹âˆ’yaâ€‹)Ã—(xbâ€‹âˆ’xaâ€‹,ybâ€‹âˆ’yaâ€‹)=(xcâ€‹âˆ’xaâ€‹)â‹…(ybâ€‹âˆ’yaâ€‹)âˆ’(xbâ€‹âˆ’xaâ€‹)â‹…(ycâ€‹âˆ’yaâ€‹)=xcâ€‹ybâ€‹âˆ’xcâ€‹yaâ€‹âˆ’xaâ€‹ybâ€‹+xaâ€‹yaâ€‹âˆ’xbâ€‹ycâ€‹+xaâ€‹ycâ€‹+xbâ€‹yaâ€‹âˆ’xaâ€‹yaâ€‹=xcâ€‹(ybâ€‹âˆ’yaâ€‹)+ycâ€‹(xaâ€‹âˆ’xbâ€‹)+xbâ€‹yaâ€‹âˆ’xaâ€‹ybâ€‹â€‹ è€ƒè™‘åˆ° xbyaâˆ’xaybx_by_a-x_ay_bxbâ€‹yaâ€‹âˆ’xaâ€‹ybâ€‹ æ˜¯ä¸€ä¸ªå®šå€¼ï¼Œæˆ‘ä»¬åªè¦æœ€å¤§åŒ– xc(ybâˆ’ya)+yc(xaâˆ’xb)x_c(y_b-y_a)+y_c(x_a-x_b)xcâ€‹(ybâ€‹âˆ’yaâ€‹)+ycâ€‹(xaâ€‹âˆ’xbâ€‹)ï¼Œå³æœ€å°åŒ– xc(yaâˆ’yb)+yc(xbâˆ’xa)x_c(y_a-y_b)+y_c(x_b-x_a)xcâ€‹(yaâ€‹âˆ’ybâ€‹)+ycâ€‹(xbâ€‹âˆ’xaâ€‹) å³å¯ã€‚ äºæ˜¯æˆ‘ä»¬åªè¦å°†è¾¹æƒå®šä¸º ac(yaâˆ’yb)+bc(xbâˆ’xa)a_c(y_a-y_b)+b_c(x_b-x_a)acâ€‹(yaâ€‹âˆ’ybâ€‹)+bcâ€‹(xbâ€‹âˆ’xaâ€‹)ï¼Œç„¶åå°±ä¸€éæœ€å°ç”Ÿæˆæ ‘å³å¯ã€‚ å¤æ‚åº¦ï¼Ÿå¤§æ¦‚å£èƒ¡ä¸€ä¸‹ï¼šå†³ç­–ç‚¹åº”è¯¥æ˜¯æœ‰ O(nnâˆ’2)\\mathcal{O}\\left(n^{n-2}\\right)O(nnâˆ’2) ä¸ªã€‚å…³äºå…¶ä¼šä½¿å‡¸åŒ…ä¸Šçš„ç‚¹æœŸæœ›æœ‰å¤šå°‘ä¸ªï¼Œè‡ªå·± å®æµ‹ äº†ä¸€ä¸‹æ„Ÿè§‰åƒæ˜¯ O(logâ¡n)\\mathcal{O}(\\log n)O(logn) çš„ï¼Œåæ¥åœ¨ çŸ¥ä¹ ä¸Šçœ‹åˆ°äº†ä¸€ç¯‡å¥‡æ€ªçš„è¯æ˜ï¼Œè¯´ç¡®å®æ˜¯ O(logâ¡n)\\mathcal{O}(\\log n)O(logn)ï¼Œä½†æ˜¯å¬è¯´è¿™ä¸ªè¯æ˜æœ‰ç‚¹é”…ï¼Œç„¶åæœ‰æ‰¾åˆ°äº†ä¸€ç¯‡ è®ºæ–‡ï¼Œå¹¶ä¸æ˜¯å¾ˆæ‡‚é‡Œé¢çš„å†…å®¹ï¼Œæœ‰å…´è¶£çš„å¯ä»¥çœ‹ä¸€ä¸‹ã€‚äºæ˜¯å‡¸åŒ…ä¸Šçš„æœŸæœ›ç‚¹æ•°åº”è¯¥æ˜¯ O(logâ¡(nnâˆ’2))=O(nlogâ¡n)\\mathcal{O}\\left(\\log \\left(n^{n-2}\\right)\\right)=\\mathcal{O}(n\\log n)O(log(nnâˆ’2))=O(nlogn) çš„ã€‚æ¯æ¬¡æ‰¾ä¸€ä¸ªç‚¹çš„å¤æ‚åº¦æ˜¯ O(mlogâ¡m)\\mathcal{O}(m\\log m)O(mlogm) çš„ï¼Œæ‰€ä»¥æœŸæœ›å¤æ‚åº¦åº”è¯¥æ˜¯ O(nmlogâ¡nlogâ¡m)\\mathcal{O}(nm\\log n\\log m)O(nmlognlogm)ã€‚ æ¨¡æ¿é¢˜åœ¨ è¿™é‡Œ ï¼Œä»£ç åœ¨ è¿™é‡Œã€‚ å…³äºè¿™ä¸ªé—®é¢˜çš„å¤æ‚åº¦åœ¨çŸ¥ä¹ä¸Šç¿»åˆ°äº†ä¸€ä¸ªå¥‡æ€ªçš„è®¨è®ºï¼Œå¤§å®¶å¯ä»¥ å»çœ‹çœ‹ã€‚ ç„¶åæ˜¯ Matrix-Tree å®šç†ã€‚å…³äºè¿™éƒ¨åˆ†å†…å®¹çš„å¾ˆå¤šä¸œè¥¿å‡å·è‡ª è¿™ç¯‡è®ºæ–‡ã€‚ åœ¨æ­¤ä¹‹å‰å…ˆéœ€è¦ä»‹ç»ä¸€ä¸‹è¡Œåˆ—å¼æ˜¯ä»€ä¹ˆï¼Œé¦–å…ˆæˆ‘ä»¬æ¥å…ˆä»‹ç»ä¸€ä¸‹ç½®æ¢ã€‚å…³äºç½®æ¢ï¼Œè®°ä¸º (12â‹¯na1a2â‹¯an)\\begin{pmatrix} 1 &amp; 2 &amp; \\cdots &amp; n\\\\ a_1 &amp; a_2 &amp; \\cdots &amp; a_n \\end{pmatrix} (1a1â€‹â€‹2a2â€‹â€‹â‹¯â‹¯â€‹nanâ€‹â€‹) å…¶ä¸­ aaa æ˜¯ 1âˆ¼nâ€‹1\\sim nâ€‹1âˆ¼nâ€‹ çš„ä¸€ä¸ªæ’åˆ—ã€‚ æ˜¾ç„¶å¯¹äºä»»æ„ä¸€ä¸ªæ’åˆ—ï¼Œè¦å°†å…¶æ’åºçš„è¯ï¼Œå…¶äº¤æ¢æ¬¡æ•°çš„å¥‡å¶æ€§ä¸äº¤æ¢æ–¹å¼æ— å…³ï¼Œæˆ‘ä»¬ä»¤æœ€å°äº¤æ¢æ¬¡æ•°ä¸º tttï¼Œæˆ‘ä»¬å®šä¹‰ï¼š Î´(12â‹¯na1a2â‹¯an)=(âˆ’1)t\\delta\\begin{pmatrix} 1 &amp; 2 &amp; \\cdots &amp; n\\\\ a_1 &amp; a_2 &amp; \\cdots &amp; a_n \\end{pmatrix}=(-1)^t Î´(1a1â€‹â€‹2a2â€‹â€‹â‹¯â‹¯â€‹nanâ€‹â€‹)=(âˆ’1)t ç„¶åæ˜¯è¡Œåˆ—å¼ï¼Œå…¶å®è¯´ç™½äº†ä»–æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå°†ä¸€ä¸ª nÃ—nn\\times nnÃ—n çš„çŸ©é˜µæ˜ å°„åˆ°äº†ä¸€ä¸ªæ ‡é‡ï¼Œæˆ‘ä»¬è®°ä¸º detâ¡A\\det AdetA æˆ– âˆ£Aâˆ£\\left|A\\right|âˆ£Aâˆ£ã€‚æˆ‘ä»¬å®šä¹‰ï¼š detâ¡A=âˆ‘(12â‹¯ni1i2â‹¯in)Î´(12â‹¯ni1i2â‹¯in)âˆj=1naj,ij\\det A=\\sum_{\\begin{pmatrix} 1 &amp; 2 &amp; \\cdots &amp; n\\\\ i_1 &amp; i_2 &amp; \\cdots &amp; i_n \\end{pmatrix}}\\delta\\begin{pmatrix} 1 &amp; 2 &amp; \\cdots &amp; n\\\\ i_1 &amp; i_2 &amp; \\cdots &amp; i_n \\end{pmatrix}\\prod_{j=1}^na_{j,i_j} detA=(1i1â€‹â€‹2i2â€‹â€‹â‹¯â‹¯â€‹ninâ€‹â€‹)âˆ‘â€‹Î´(1i1â€‹â€‹2i2â€‹â€‹â‹¯â‹¯â€‹ninâ€‹â€‹)j=1âˆnâ€‹aj,ijâ€‹â€‹ è§‚å¯Ÿä¸Šå¼ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€äº›æ€§è´¨ï¼Œè€ƒè™‘åˆ°è¿™äº›æ€§è´¨éƒ½å¯ä»¥ç›´æ¥ç”±å®šä¹‰å¾—åˆ°ï¼Œè¯æ˜å°±ä¸å†ä¸€ä¸€å±•å¼€ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬æœ‰ï¼š detâ¡AT=detâ¡A\\det A^{\\mathrm{T}}=\\det A detAT=detA ATA^{\\mathrm{T}}AT æ˜¯ AAA çš„è½¬ç½®ï¼Œå¤§æ¦‚å°±æ˜¯è¿™æ ·å­å§ï¼š è¿™æš—ç¤ºç€æˆ‘ä»¬ï¼Œè¡Œåˆ—å¼ä¸­è¡Œå’Œåˆ—æ˜¯ç­‰ä»·çš„ï¼Œä¸‹é¢åœ¨è®¨è®ºè¡Œçš„é—®é¢˜æ—¶ï¼Œåˆ—éƒ½æ˜¯ä¸€æ ·çš„ã€‚ ç„¶åæ˜¯å¦‚æœå°†è¡Œåˆ—å¼ä¸­çš„ä¸¤è¡Œäº’æ¢ï¼Œé‚£ä¹ˆè¡Œåˆ—å¼å˜å·ã€‚äºæ˜¯æˆ‘ä»¬æœ‰ä¸€ä¸ªæ¨è®ºï¼Œé‚£å°±æ˜¯å¦‚æœçŸ©é˜µ AAA ä¸­ä¸¤è¡Œç›¸åŒï¼Œé‚£ä¹ˆäº¤æ¢è¿™ä¸¤è¡Œä¸ä¼šæ”¹å˜ AAAï¼Œäºæ˜¯æˆ‘ä»¬æœ‰ detâ¡A=âˆ’detâ¡A\\det A=-\\det AdetA=âˆ’detAï¼Œå³ detâ¡A=0\\det A=0detA=0ã€‚ åœ¨è¡Œåˆ—å¼ä¸­ï¼ŒæŸä¸€è¡Œçš„æ¯ä¸ªå…ƒç´ æ˜¯ä¸¤æ•°ä¹‹å’Œï¼Œåˆ™æ­¤è¡Œåˆ—å¼å¯æ‹†åˆ†ä¸ºä¸¤ä¸ªç›¸åŠ çš„è¡Œåˆ—å¼ã€‚ âˆ£a11a12â€¦a1nâ‹®â‹®â€¦â‹®ai1+bi1ai2+bi2â€¦ain+binâ‹®â‹®â‹±â‹®an1an2â€¦annâˆ£=âˆ£a11a12â€¦a1nâ‹®â‹®â€¦â‹®ai1ai2â€¦ainâ‹®â‹®â‹±â‹®an1an2â€¦annâˆ£+âˆ£a11a12â€¦a1nâ‹®â‹®â€¦â‹®bi1bi2â€¦binâ‹®â‹®â‹±â‹®an1an2â€¦annâˆ£{\\begin{vmatrix}a_{11}&amp;a_{12}&amp;\\dots &amp;a_{1n}\\\\\\vdots &amp;\\vdots &amp;\\dots &amp;\\vdots \\\\{\\color {blue}a_{i1}}+{\\color {green}b_{i1}}&amp;{\\color {blue}a_{i2}}+{\\color {green}b_{i2}}&amp;\\dots &amp;{\\color {blue}a_{in}}+{\\color {green}b_{in}}\\\\\\vdots &amp;\\vdots &amp;\\ddots &amp;\\vdots \\\\a_{n1}&amp;a_{n2}&amp;\\dots &amp;a_{nn}\\end{vmatrix}}={\\begin{vmatrix}a_{11}&amp;a_{12}&amp;\\dots &amp;a_{1n}\\\\\\vdots &amp;\\vdots &amp;\\dots &amp;\\vdots \\\\{\\color {blue}a_{i1}}&amp;{\\color {blue}a_{i2}}&amp;\\dots &amp;{\\color {blue}a_{in}}\\\\\\vdots &amp;\\vdots &amp;\\ddots &amp;\\vdots \\\\a_{n1}&amp;a_{n2}&amp;\\dots &amp;a_{nn}\\end{vmatrix}}+{\\begin{vmatrix}a_{11}&amp;a_{12}&amp;\\dots &amp;a_{1n}\\\\\\vdots &amp;\\vdots &amp;\\dots &amp;\\vdots \\\\{\\color {green}b_{i1}}&amp;{\\color {green}b_{i2}}&amp;\\dots &amp;{\\color {green}b_{in}}\\\\\\vdots &amp;\\vdots &amp;\\ddots &amp;\\vdots \\\\a_{n1}&amp;a_{n2}&amp;\\dots &amp;a_{nn}\\end{vmatrix}} âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£â€‹a11â€‹â‹®ai1â€‹+bi1â€‹â‹®an1â€‹â€‹a12â€‹â‹®ai2â€‹+bi2â€‹â‹®an2â€‹â€‹â€¦â€¦â€¦â‹±â€¦â€‹a1nâ€‹â‹®ainâ€‹+binâ€‹â‹®annâ€‹â€‹âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£â€‹=âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£â€‹a11â€‹â‹®ai1â€‹â‹®an1â€‹â€‹a12â€‹â‹®ai2â€‹â‹®an2â€‹â€‹â€¦â€¦â€¦â‹±â€¦â€‹a1nâ€‹â‹®ainâ€‹â‹®annâ€‹â€‹âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£â€‹+âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£â€‹a11â€‹â‹®bi1â€‹â‹®an1â€‹â€‹a12â€‹â‹®bi2â€‹â‹®an2â€‹â€‹â€¦â€¦â€¦â‹±â€¦â€‹a1nâ€‹â‹®binâ€‹â‹®annâ€‹â€‹âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£â€‹ æ ¹æ®ä¸Šé¢ä¸€æ¡ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ï¼Œå¦‚æœå°†çŸ©é˜µçš„ä¸€è¡Œæˆ–æ˜¯ä¸€åˆ—éƒ½ä¹˜ä»¥ä¸€ä¸ªæ•° Î»\\lambdaÎ»ï¼Œé‚£ä¹ˆè¯¥çŸ©é˜µçš„è¡Œåˆ—å¼ä¹Ÿå°†ä¹˜ä»¥ Î»\\lambdaÎ»ã€‚ç»“åˆä¸Šé¢é‚£ä¸ªæ€§è´¨çš„æ¨è®ºï¼Œæˆ‘ä»¬ä¸éš¾å‘ç°å¦‚æœçŸ©é˜µä¸­æœ‰ä¸¤è¡Œæˆ–ä¸¤åˆ—æˆæ¯”ä¾‹ï¼Œé‚£ä¹ˆè¯¥çŸ©é˜µçš„è¡Œåˆ—å¼ä¸º 000ã€‚ âˆ£a11a12â€¦a1nâ‹®â‹®â€¦â‹®kai1kai2â€¦kainâ‹®â‹®â‹±â‹®an1an2â€¦annâˆ£=kâˆ£a11a12â€¦a1nâ‹®â‹®â€¦â‹®ai1ai2â€¦ainâ‹®â‹®â‹±â‹®an1an2â€¦annâˆ£{\\begin{vmatrix}a_{11}&amp;a_{12}&amp;\\dots &amp;a_{1n}\\\\\\vdots &amp;\\vdots &amp;\\dots &amp;\\vdots \\\\{\\color {blue}k}a_{i1}&amp;{\\color {blue}k}a_{i2}&amp;\\dots &amp;{\\color {blue}k}a_{in}\\\\\\vdots &amp;\\vdots &amp;\\ddots &amp;\\vdots \\\\a_{n1}&amp;a_{n2}&amp;\\dots &amp;a_{nn}\\end{vmatrix}}={\\color {blue}k}{\\begin{vmatrix}a_{11}&amp;a_{12}&amp;\\dots &amp;a_{1n}\\\\\\vdots &amp;\\vdots &amp;\\dots &amp;\\vdots \\\\a_{i1}&amp;a_{i2}&amp;\\dots &amp;a_{in}\\\\\\vdots &amp;\\vdots &amp;\\ddots &amp;\\vdots \\\\a_{n1}&amp;a_{n2}&amp;\\dots &amp;a_{nn}\\end{vmatrix}} âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£â€‹a11â€‹â‹®kai1â€‹â‹®an1â€‹â€‹a12â€‹â‹®kai2â€‹â‹®an2â€‹â€‹â€¦â€¦â€¦â‹±â€¦â€‹a1nâ€‹â‹®kainâ€‹â‹®annâ€‹â€‹âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£â€‹=kâˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£â€‹a11â€‹â‹®ai1â€‹â‹®an1â€‹â€‹a12â€‹â‹®ai2â€‹â‹®an2â€‹â€‹â€¦â€¦â€¦â‹±â€¦â€‹a1nâ€‹â‹®ainâ€‹â‹®annâ€‹â€‹âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£â€‹ æ ¹æ®ä¸Šé¢çš„ä¸œè¥¿ï¼Œæˆ‘ä»¬å°±å¯ä»¥å‘ç°ï¼š âˆ£â‹®â‹®â‹®â‹®ai1ai2â€¦ainaj1aj2â€¦ajnâ‹®â‹®â‹®â‹®âˆ£=âˆ£â‹®â‹®â‹®â‹®ai1ai2â€¦ainaj1aj2â€¦ajnâ‹®â‹®â‹®â‹®âˆ£+âˆ£â‹®â‹®â‹®â‹®ai1ai2â€¦ainkai1kai2â€¦kainâ‹®â‹®â‹®â‹®âˆ£=âˆ£â‹®â‹®â‹®â‹®ai1ai2â€¦ainaj1+kai1aj2+kai2â€¦ajn+kainâ‹®â‹®â‹®â‹®âˆ£\\begin{aligned} {\\begin{vmatrix}\\vdots &amp;\\vdots &amp;\\vdots &amp;\\vdots \\\\a_{i1}&amp;a_{i2}&amp;\\dots &amp;a_{in}\\\\a_{j1}&amp;a_{j2}&amp;\\dots &amp;a_{jn}\\\\\\vdots &amp;\\vdots &amp;\\vdots &amp;\\vdots \\\\\\end{vmatrix}}&amp;={\\begin{vmatrix}\\vdots &amp;\\vdots &amp;\\vdots &amp;\\vdots \\\\a_{i1}&amp;a_{i2}&amp;\\dots &amp;a_{in}\\\\a_{j1}&amp;a_{j2}&amp;\\dots &amp;a_{jn}\\\\\\vdots &amp;\\vdots &amp;\\vdots &amp;\\vdots \\\\\\end{vmatrix}}+{\\begin{vmatrix}\\vdots &amp;\\vdots &amp;\\vdots &amp;\\vdots \\\\a_{i1}&amp;a_{i2}&amp;\\dots &amp;a_{in}\\\\{\\color {blue}ka_{i1}}&amp;{\\color {blue}ka_{i2}}&amp;\\dots &amp;{\\color {blue}ka_{in}}\\\\\\vdots &amp;\\vdots &amp;\\vdots &amp;\\vdots \\\\\\end{vmatrix}}\\\\&amp;={\\begin{vmatrix}\\vdots &amp;\\vdots &amp;\\vdots &amp;\\vdots \\\\a_{i1}&amp;a_{i2}&amp;\\dots &amp;a_{in}\\\\a_{j1}{\\color {blue}+ka_{i1}}&amp;a_{j2}{\\color {blue}+ka_{i2}}&amp;\\dots &amp;a_{jn}{\\color {blue}+ka_{in}}\\\\\\vdots &amp;\\vdots &amp;\\vdots &amp;\\vdots \\\\\\end{vmatrix}} \\end{aligned} âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£â€‹â‹®ai1â€‹aj1â€‹â‹®â€‹â‹®ai2â€‹aj2â€‹â‹®â€‹â‹®â€¦â€¦â‹®â€‹â‹®ainâ€‹ajnâ€‹â‹®â€‹âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£â€‹â€‹=âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£â€‹â‹®ai1â€‹aj1â€‹â‹®â€‹â‹®ai2â€‹aj2â€‹â‹®â€‹â‹®â€¦â€¦â‹®â€‹â‹®ainâ€‹ajnâ€‹â‹®â€‹âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£â€‹+âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£â€‹â‹®ai1â€‹kai1â€‹â‹®â€‹â‹®ai2â€‹kai2â€‹â‹®â€‹â‹®â€¦â€¦â‹®â€‹â‹®ainâ€‹kainâ€‹â‹®â€‹âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£â€‹=âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£â€‹â‹®ai1â€‹aj1â€‹+kai1â€‹â‹®â€‹â‹®ai2â€‹aj2â€‹+kai2â€‹â‹®â€‹â‹®â€¦â€¦â‹®â€‹â‹®ainâ€‹ajnâ€‹+kainâ€‹â‹®â€‹âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£â€‹â€‹ ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¡Œåˆ—å¼ä¸­çš„æŸè¡Œçš„æ¯ä¸ªç¯è¯‰ä¹˜ä¸Šä¸€ä¸ªå¸¸æ•° kkkï¼ŒåŠ åˆ°å¦ä¸€è¡Œä¸Šå»ã€‚ æ ¹æ®è¿™ä¸€ä¸ªæ€§è´¨ï¼Œæˆ‘ä»¬ä¸éš¾ä½¿ç”¨ç±»ä¼¼é«˜æ–¯æ¶ˆå…ƒçš„åšæ³•å§è¡Œåˆ—å¼è½¬æ¢æˆä¸Šä¸‰è§’çš„å½¢å¼ï¼š âˆ£a1,1a1,2a1,3â€¦a1,na2,2a2,3â€¦a2,nâ‹®â‹±â‹±â‹®(0)â‹±anâˆ’1,n0â‹¯an,nâˆ£=âˆi=1nai,i{\\begin{vmatrix}a_{1,1}&amp;a_{1,2}&amp;a_{1,3}&amp;\\ldots &amp;a_{1,n}\\\\&amp;a_{2,2}&amp;a_{2,3}&amp;\\ldots &amp;a_{2,n}\\\\\\vdots &amp;&amp;\\ddots &amp;\\ddots &amp;\\vdots \\\\&amp;(0)&amp;&amp;\\ddots &amp;a_{n-1,n}\\\\0&amp;&amp;\\cdots &amp;&amp;a_{n,n}\\end{vmatrix}}=\\prod_{i=1}^na_{i,i} âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£â€‹a1,1â€‹â‹®0â€‹a1,2â€‹a2,2â€‹(0)â€‹a1,3â€‹a2,3â€‹â‹±â‹¯â€‹â€¦â€¦â‹±â‹±â€‹a1,nâ€‹a2,nâ€‹â‹®anâˆ’1,nâ€‹an,nâ€‹â€‹âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£â€‹=i=1âˆnâ€‹ai,iâ€‹ äºæ˜¯æˆ‘ä»¬å°±å¯ä»¥ O(n3)\\mathcal{O}(n^3)O(n3) è®¡ç®—è¡Œåˆ—å¼å•¦ï¼ è¿™é‡Œæœ‰ä¸€é“ æ¨¡æ¿é¢˜ï¼Œå…¶ä¸­æœ‰æ¨¡æ•° pppï¼Œä¸ä¿è¯æ˜¯è´¨æ•°ã€‚ ç”±äºä¸æ˜¯è´¨æ•°ï¼Œæ‰€ä»¥å¯èƒ½ä¸å­˜åœ¨é€†å…ƒã€‚æˆ‘ä»¬è€ƒè™‘åœ¨æ¶ˆå…ƒçš„æ—¶å€™ï¼Œä½¿ç”¨ç±»ä¼¼è¾—è½¬ç›¸é™¤çš„æ–¹æ³•ã€‚è¿™æ ·æ—¶é—´å¤æ‚åº¦ O(n3logâ¡n)\\mathcal{O}(n^3\\log n)O(n3logn)ã€‚ä»£ç åœ¨ è¿™å„¿ã€‚ å½“ç„¶ï¼Œæˆ‘ä»¬è¿˜æœ‰èƒ½å‘ç°ï¼Œå¦‚æœçŸ©é˜µ AAA ä¸­æ¯ä¸€è¡Œå’Œä¸º 000ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æŠŠçŸ©é˜µä¸­çš„ç¬¬ä¸€åˆ—åŠ ä¸Šå…¶ä½™å„åˆ—ï¼Œè¿™æ ·å­ç¬¬ä¸€åˆ—å°±å…¨ 000 äº†ï¼Œäºæ˜¯ detâ¡A=0\\det A=0detA=0ã€‚ æ¥ä¸‹æ¥æ˜¯ä¸€ä¸ªéå¸¸ç‰›é€¼çš„ä¸œè¥¿å«åšæŸ¯è¥¿ - æ¯”å†…å…¬å¼ï¼Œå¤§æ¦‚å°±æ˜¯å‡è®¾ AAA æ˜¯ä¸€ä¸ª mÃ—nm\\times nmÃ—n çš„çŸ©é˜µï¼ŒBBB æ˜¯ä¸€ä¸ª nÃ—nn\\times nnÃ—n çš„çŸ©é˜µï¼Œå¦‚æœ SSS æ˜¯ 1,â€¦,n{1, \\dots, n}1,â€¦,n ä¸­å…·æœ‰ mmm ä¸ªå…ƒç´ çš„å­é›†ï¼Œæˆ‘ä»¬è®° ASA_SASâ€‹ ä¸º AAA ä¸­åˆ—ä¸‹æ ‡ä½äº SSS ä¸­çš„ mÃ—mm\\times mmÃ—m å­çŸ©é˜µã€‚ç±»ä¼¼åœ°ï¼Œè®° BSB_SBSâ€‹ ä¸º BBB ä¸­è¡Œä¸‹æ ‡ä½äº SSS ä¸­çš„ mÃ—mm\\times mmÃ—m å­çŸ©é˜µã€‚Binet-Cauchy å…¬å¼è¯´ï¼š detâ¡(AB)=âˆ‘detâ¡ASâ‹…detâ¡BS\\det(AB)=\\sum\\det A_{S}\\cdot \\det B_{S} det(AB)=âˆ‘detASâ€‹â‹…detBSâ€‹ è¿™ä¸ªä¸œè¥¿æˆ‘å¤ªèœäº†ä¸ä¼šè¯å•Šï¼Œå¦‚æœæœ‰å…´è¶£çš„åŒå­¦å¯ä»¥è‡ªå·±çœ‹ è®ºæ–‡ æˆ–æ˜¯ æ°´çŸ¥ä¹ã€‚ æ ¹æ®ä¸Šé¢çš„å…¬å¼ï¼Œå½“ n=mn=mn=m æ—¶ï¼Œdetâ¡(AB)=detâ¡Adetâ¡B\\det(AB)=\\det A\\det Bdet(AB)=detAdetB ç„¶åæˆ‘ä»¬ä¼šåˆ°ç”Ÿæˆæ ‘ä¸Šæ¥ï¼Œé—®é¢˜å¤§æ¦‚å°±æ˜¯è®©ä½ æ±‚ä¸€å¼ æ— å‘å›¾çš„ç”Ÿæˆæ ‘ä¸ªæ•°ï¼Œnâ‰¤100n\\le 100nâ‰¤100ã€‚ å…ˆè¯´ç»“è®ºï¼Œå‡è®¾ç»™å‡ºå›¾ä¸º GGGï¼Œå®šä¹‰ä¸€ä¸ª nÃ—nn\\times nnÃ—n çš„çŸ©é˜µ D(G)D(G)D(G) è¡¨ç¤º GGG ä¸ªç‚¹çš„åº¦æ•°ï¼Œå½“ iâ‰ ji\\neq jiî€ =jæ—¶ï¼Œdi,j=0d_{i,j}=0di,jâ€‹=0ï¼Œå½“ i=ji=ji=j æ—¶ï¼Œdi,jd_{i,j}di,jâ€‹ ç­‰äºèŠ‚ç‚¹ iii çš„åº¦æ•°ã€‚å†å®šä¹‰ä¸€ä¸ª nÃ—nn\\times nnÃ—n çš„çŸ©é˜µ AGA_GAGâ€‹ è¡¨ç¤º GGG çš„é‚»æ¥çŸ©é˜µï¼ŒAi,jA_{i,j}Ai,jâ€‹ è¡¨ç¤º iii åˆ° jjj çš„è¾¹æ•°ã€‚ç„¶åæˆ‘ä»¬å®šä¹‰åŸºå°”éœå¤«çŸ©é˜µ C(G)=D(G)âˆ’A(G)C(G)=D(G)-A(G)C(G)=D(G)âˆ’A(G)ã€‚åˆ™ GGG ä¸­ç”Ÿæˆæ ‘ä¸ªæ•°ç­‰äº C(G)C(G)C(G) ä¸­ä»»æ„ä¸€ä¸ª nâˆ’1n-1nâˆ’1 é˜¶ä¸»å­å¼çš„è¡Œåˆ—å¼çš„ç»å¯¹å€¼ã€‚æ‰€è°“ä¸€ä¸ªçŸ©é˜µ MMM çš„ nâˆ’1n-1nâˆ’1 é˜¶ä¸»å­å¼å°±æ˜¯å¯¹äºä¸¤ä¸ªæ•´æ•° r (1â‰¤râ‰¤n)r\\,(1\\le r\\le n)r(1â‰¤râ‰¤n)ï¼Œå°† MMM å»æ‰ç¬¬ rrr è¡Œå’Œç¬¬ rrr åˆ—åå½¢æˆçš„ nâˆ’1n-1nâˆ’1 é˜¶çš„çŸ©é˜µï¼Œè®°ä½œ MrM_{r}Mrâ€‹ã€‚ ä¸¾ä¸ªæ —å­ï¼Œæ¯”å¦‚è¯´ç°åœ¨æœ‰è¿™æ ·å¼ å›¾ï¼Œå…¶ç”Ÿæˆæ ‘æœ‰ 888 ä¸ªï¼ˆç›´æ¥å· Wikipedia ä¸Šçš„å›¾äº†ï¼‰ï¼š å…¶åº¦æ•°çŸ©é˜µ D(G)=[2000030000300002]D(G)=\\begin{bmatrix}2&amp;0&amp;0&amp;0\\\\0&amp;3&amp;0&amp;0\\\\0&amp;0&amp;3&amp;0\\\\0&amp;0&amp;0&amp;2\\end{bmatrix} D(G)=â£â¢â¢â¢â¡â€‹2000â€‹0300â€‹0030â€‹0002â€‹â¦â¥â¥â¥â¤â€‹ å…¶é‚»æ¥çŸ©é˜µ A(G)=[0110101111010110]A(G)=\\begin{bmatrix}0&amp;1&amp;1&amp;0\\\\1&amp;0&amp;1&amp;1\\\\1&amp;1&amp;0&amp;1\\\\0&amp;1&amp;1&amp;0\\end{bmatrix} A(G)=â£â¢â¢â¢â¡â€‹0110â€‹1011â€‹1101â€‹0110â€‹â¦â¥â¥â¥â¤â€‹ äºæ˜¯å…¶åŸºå°”éœå¤«çŸ©é˜µ C(G)=[2âˆ’1âˆ’10âˆ’13âˆ’1âˆ’1âˆ’1âˆ’13âˆ’10âˆ’1âˆ’12]C(G)=\\begin{bmatrix}2&amp;-1&amp;-1&amp;0\\\\-1&amp;3&amp;-1&amp;-1\\\\-1&amp;-1&amp;3&amp;-1\\\\0&amp;-1&amp;-1&amp;2\\end{bmatrix} C(G)=â£â¢â¢â¢â¡â€‹2âˆ’1âˆ’10â€‹âˆ’13âˆ’1âˆ’1â€‹âˆ’1âˆ’13âˆ’1â€‹0âˆ’1âˆ’12â€‹â¦â¥â¥â¥â¤â€‹ æˆ‘ä»¬å– r=2r=2r=2ï¼Œå¾—åˆ°å…¶ä¸»å­å¼ C2(G)=[2âˆ’10âˆ’13âˆ’10âˆ’12]C_2(G)=\\begin{bmatrix}2&amp;-1&amp;0\\\\-1&amp;3&amp;-1\\\\0&amp;-1&amp;2\\end{bmatrix} C2â€‹(G)=â£â¢â¡â€‹2âˆ’10â€‹âˆ’13âˆ’1â€‹0âˆ’12â€‹â¦â¥â¤â€‹ å¾—åˆ°çš„è¡Œåˆ—å¼ detâ¡C2(G)=âˆ£2âˆ’10âˆ’13âˆ’10âˆ’12âˆ£=âˆ£2âˆ’10052âˆ’10085âˆ£=2Ã—52Ã—85=8\\det C_2(G)=\\begin{vmatrix}2&amp;-1&amp;0\\\\-1&amp;3&amp;-1\\\\0&amp;-1&amp;2\\end{vmatrix}=\\begin{vmatrix}2&amp;-1&amp;0\\\\0&amp;\\frac{5}{2}&amp;-1\\\\0&amp;0&amp;\\frac{8}{5}\\end{vmatrix}=2\\times\\frac{5}{2}\\times \\frac{8}{5}=8 detC2â€‹(G)=âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£â€‹2âˆ’10â€‹âˆ’13âˆ’1â€‹0âˆ’12â€‹âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£â€‹=âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£â€‹200â€‹âˆ’125â€‹0â€‹0âˆ’158â€‹â€‹âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£âˆ£â€‹=2Ã—25â€‹Ã—58â€‹=8 é‚£ä¸ºä»€ä¹ˆæ˜¯è¿™æ ·å‘¢ï¼Ÿ é¦–å…ˆæˆ‘ä»¬æ¥è§‚å¯Ÿä¸€ä¸‹ C(G)C(G)C(G) çš„æ€§è´¨ã€‚æˆ‘ä»¬è€ƒè™‘å¦‚æœæˆ‘ä»¬æŠŠä¸¤ä¸ªç‚¹åœ¨çŸ©é˜µä¸­çš„å‡ºç°é¡ºåºäº¤æ¢ï¼Œå…¶å®å°±æ˜¯æŠŠè¡Œäº¤æ¢ä¸€æ¬¡ï¼Œåˆ—äº¤æ¢ä¸€æ¬¡ï¼Œä¸€å…±äº¤æ¢å¶æ•°æ¬¡ï¼Œæ‰€ä»¥è¡Œåˆ—å¼ä¸å˜ã€‚äºæ˜¯æˆ‘ä»¬å‘ç°ï¼ŒC(G)C(G)C(G) å’Œ Cr(G)C_r(G)Crâ€‹(G) çš„è¡Œåˆ—å¼ä¸å…¶é¡¶ç‚¹çš„é¡ºåºæ— å…³ã€‚ æˆ‘ä»¬è€ƒè™‘æ„é€ ä¸€ä¸ª nÃ—mn\\times mnÃ—mï¼ˆnnn æ˜¯ç‚¹æ•°ï¼Œmmm æ˜¯è¾¹æ•°ï¼‰çš„çŸ©é˜µ BBBï¼Œå¦‚æœå¯¹äºç¬¬ iii æ¡è¾¹ï¼Œå¦‚æœè¿æ¥ &lt;u,v&gt;\\left&lt;u,v\\right&gt;âŸ¨u,vâŸ©ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä»¤ bu,i=1,bv,i=âˆ’1b_{u,i}=1,b_{v,i}=-1bu,iâ€‹=1,bv,iâ€‹=âˆ’1ï¼Œå…¶ä½™éƒ½æ˜¯ 000ã€‚å…¶å®è°æ˜¯ 111 è°æ˜¯ âˆ’1-1âˆ’1 ä¸é‡è¦ï¼Œå› ä¸ºæ˜¯æ— å‘å›¾ï¼Œåªè¦ä¸€ä¸ªæ˜¯ âˆ’1-1âˆ’1 ä¸€ä¸ªæ˜¯ 111 å³å¯ã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è€ƒè™‘ BBTBB^{\\mathrm T}BBTã€‚æˆ‘ä»¬å‘ç°å¯¹äº (BBT)i,j(BB^{\\mathrm T})_{i,j}(BBT)i,jâ€‹ï¼Œå¦‚æœ i=ji=ji=jï¼Œé‚£ä¹ˆ (BBT)i,j=âˆ‘k=1mBi,k2(BB^{\\mathrm T})_{i,j}=\\sum_{k=1}^mB_{i,k}^2(BBT)i,jâ€‹=âˆ‘k=1mâ€‹Bi,k2â€‹ï¼Œä¹Ÿå°±æ˜¯ iii çš„åº¦æ•°ï¼›å¦‚æœ iâ‰ ji\\neq jiî€ =jï¼Œé‚£ä¹ˆ (BBT)i,j=âˆ‘k=1mBi,kBj,k(BB^{\\mathrm T})_{i,j}=\\sum_{k=1}^mB_{i,k}B_{j,k}(BBT)i,jâ€‹=âˆ‘k=1mâ€‹Bi,kâ€‹Bj,kâ€‹ï¼Œä¹Ÿå°±æ˜¯ iii åˆ° jjj çš„è¾¹æ•°çš„ç›¸åæ•°ã€‚äºæ˜¯æˆ‘ä»¬å‘ç°ï¼ŒBBTBB^{\\mathrm T}BBT å°±æ˜¯åŸºå°”éœå¤«çŸ©é˜µï¼Œå³ C(G)=BBTC(G)=BB^\\mathrm{T}C(G)=BBTã€‚ ä»¤ HHH è¡¨ç¤º BBB å»æ‰ rrr è¡Œåçš„çŸ©é˜µï¼Œæ˜“å¾— C(G)r=HHTC(G)_r=HH^\\mathrm{T}C(G)râ€‹=HHTã€‚äºæ˜¯æ ¹æ® Binet-Cauchy å…¬ å¼ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ï¼š detâ¡C(G)=detâ¡(HHT)=âˆ‘Sdetâ¡HSdetâ¡HST=âˆ‘S(detâ¡HS)2=âˆ‘Sdetâ¡HS2\\det C(G)=\\det (HH^\\mathrm{T})=\\sum_{S}\\det H_S\\det H_S^\\mathrm{T}=\\sum_{S}\\left(\\det H_S\\right)^2=\\sum_{S}\\det H_S^2 detC(G)=det(HHT)=Sâˆ‘â€‹detHSâ€‹detHSTâ€‹=Sâˆ‘â€‹(detHSâ€‹)2=Sâˆ‘â€‹detHS2â€‹ æˆ‘ä»¬è§‚å¯Ÿè¿™åªå¼å­ï¼Œå‘ç°ä»–å…¶å®å°±æ˜¯åœ¨å¹²è¿™æ ·ä¸€ä»¶äº‹æƒ…ï¼šæ¯æ¬¡åœ¨è¿™ mmm æ¡è¾¹ä¸­å–å‡º nâˆ’1n-1nâˆ’1 æ¡ï¼Œå¹¶å¯¹ç­”æ¡ˆè®¡å…¥ detâ¡HS2\\det H_S^2detHS2â€‹ çš„è´¡çŒ®ã€‚ é‚£æˆ‘ä»¬æ¥çœ‹è¿™ä¸ª detâ¡HS2\\det H_S^2detHS2â€‹ã€‚æˆ‘ä»¬å°† SSS ä¸­é€‰å‡ºçš„è¿™äº›è¾¹ç»„åˆæˆä¸€ä¸ªé›†åˆï¼Œå’Œ nnn ä¸ªç‚¹ç»„åˆæˆä¸€å¼ å›¾ï¼Œè®°ä¸º Gâ€²G&#x27;Gâ€²ï¼Œä¸éš¾å‘ç° C(Gâ€²)=HS2C(G&#x27;)=H_S^2C(Gâ€²)=HS2â€‹ï¼Œäºæ˜¯ detâ¡HS2=detâ¡C(Gâ€²)\\det H_S^2=\\det C(G&#x27;)detHS2â€‹=detC(Gâ€²)ã€‚ ç„¶åæˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªåŸºå°”éœå¤«çŸ©é˜µ C(G)C(G)C(G)ï¼Œç”±äºå…¶å„è¡Œå„åˆ—ä¹‹å’Œå‡ä¸º 000ï¼Œdetâ¡C(G)=0\\det C(G)=0detC(G)=0ã€‚å¦‚æœ GGG æ˜¯ä¸€ä¸ªéè¿é€šå›¾ï¼Œé‚£ä¹ˆæˆ‘ä»¬å‘ç° C(G)C(G)C(G) ä¸€å®šå¯ä»¥é€šè¿‡è°ƒæ•´ç‚¹çš„ç¼–å·å˜æˆè¿™æ ·ï¼š [a1,1â€¦a1,k0â€¦0â‹®â‹±â‹®â‹®â‹±â‹®ak,1â€¦ak,k0â€¦00â€¦0ak+1,k+1â€¦ak+1,nâ‹®â‹±â‹®â‹®â‹±â‹®0â€¦0an,k+1â€¦an,n]\\begin{bmatrix} a_{1,1}&amp;\\ldots&amp;a_{1,k}&amp;0&amp;\\ldots&amp;0\\\\ \\vdots&amp;\\ddots&amp;\\vdots&amp;\\vdots&amp;\\ddots&amp;\\vdots\\\\ a_{k,1}&amp;\\ldots&amp;a_{k,k}&amp;0&amp;\\ldots&amp;0\\\\ 0&amp;\\ldots&amp;0&amp;a_{k+1,k+1}&amp;\\ldots&amp;a_{k+1,n}\\\\ \\vdots&amp;\\ddots&amp;\\vdots&amp;\\vdots&amp;\\ddots&amp;\\vdots\\\\ 0&amp;\\ldots&amp;0&amp;a_{n,k+1}&amp;\\ldots&amp;a_{n,n}\\\\ \\end{bmatrix} â£â¢â¢â¢â¢â¢â¢â¢â¢â¢â¡â€‹a1,1â€‹â‹®ak,1â€‹0â‹®0â€‹â€¦â‹±â€¦â€¦â‹±â€¦â€‹a1,kâ€‹â‹®ak,kâ€‹0â‹®0â€‹0â‹®0ak+1,k+1â€‹â‹®an,k+1â€‹â€‹â€¦â‹±â€¦â€¦â‹±â€¦â€‹0â‹®0ak+1,nâ€‹â‹®an,nâ€‹â€‹â¦â¥â¥â¥â¥â¥â¥â¥â¥â¥â¤â€‹ ä¸éš¾å‘ç°è¿™ä¸¤ä¸ªè¿é€šå—éƒ½å¯ä»¥ç‹¬ç«‹åœ°å˜æˆä¸€ä¸ªä¸Šä¸‰è§’ã€‚ç”±äº Cr(G)C_r(G)Crâ€‹(G) åªæŠ½èµ°äº†ä¸€è¡Œå’Œä¸€åˆ—ï¼Œé‚£ä¹Ÿå°±æ˜¯è¯´è‚¯å®šæœ‰ä¸€ä¸ªå—æœ€åå¯¹è§’çº¿ä¸Šæœ‰ä¸€ä¸ª 000ï¼Œäºæ˜¯è¡Œåˆ—å¼çš„å€¼ä¸º 000ã€‚ æ‰€ä»¥è¯´ï¼Œå¦‚æœ Gâ€²G&#x27;Gâ€² ä¸æ˜¯è¿é€šå›¾ï¼Œé‚£å…¶å¯¹ç­”æ¡ˆçš„è´¡çŒ®æ˜¯ 000ï¼Œè€ƒè™‘åˆ° Gâ€²G&#x27;Gâ€² åªæœ‰ nâˆ’1n-1nâˆ’1 æ¡è¾¹ï¼Œå¦‚æœè”é€šï¼Œé‚£è‚¯å®šåªèƒ½æ˜¯æ£µæ ‘äº†ã€‚äºæ˜¯æˆ‘ä»¬æ¥è€ƒè™‘æ•°çš„æƒ…å†µã€‚ ä¸è¦å¿˜äº†æˆ‘ä»¬æ‰”å‡ºå»äº†ä¸€ä¸ª rrrï¼Œæˆ‘ä»¬ä»¥ rrr ä¸ºæ ¹å¯¹è¿™æ£µæ ‘è¿›è¡Œ dfsï¼Œå°†èŠ‚ç‚¹é‡æ–°æŒ‰ç…§ dfs åºæ ‡å·ã€‚ç„¶åæˆ‘ä»¬ä»å¤§å¾€å°å€’ç€æ¥ã€‚è€ƒè™‘å¯¹æ¯ä¸ªç‚¹ï¼Œç”¨ä»–å»æ¶ˆä»–çš„çˆ¶äº²ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå°†å®ƒçˆ¶äº²çš„æ¯é‚£ä¸€è¡Œå‡å»è‡ªå·±çš„é‚£ä¸€è¡Œã€‚ä¸éš¾å‘ç°ï¼Œå¦‚æœè¿™æ ·åšï¼Œä¸»å¯¹è§’çº¿éƒ½æ˜¯ 111ï¼Œå› ä¸ºåªæœ‰å®ƒä¸å®ƒçˆ¶äº²çš„é‚£æ¡è¾¹æ²¡è¢«å‡ï¼Œå…¶ä»–è¾¹éƒ½è¢«å„¿å­å‡æ‰äº†ã€‚è¿™æ ·å°±å½¢æˆäº†ä¸€ä¸ªä¸‹ä¸‰è§’çŸ©é˜µï¼Œæˆ‘ä»¬æŠŠå®ƒè½¬ç½®ä¸€ä¸‹å°±å˜æˆäº†ä¸Šä¸‰è§’ï¼Œå…¶è´¡çŒ®å°±æ˜¯å¯¹è§’çº¿çš„ä¹˜ç§¯ï¼Œä¹Ÿå°±æ˜¯ 111ã€‚äºæ˜¯ä»–å¯¹ç­”æ¡ˆçš„è´¡çŒ®å°±æ˜¯ 111ã€‚ æˆ‘ä»¬å†æ¥å›é¡¾ä¸€ä¸‹è¿™åªå¼å­ï¼š detâ¡C(G)=âˆ‘Sdetâ¡HS2\\det C(G)=\\sum_{S}\\det H_S^2 detC(G)=Sâˆ‘â€‹detHS2â€‹ ç»è¿‡ä¸Šé¢çš„è®ºè¯ï¼Œå¦‚æœ Gâ€²G&#x27;Gâ€² æ˜¯æ£µæ ‘ï¼Œé‚£ä¹ˆ detâ¡HS2=1\\det H_S^2=1detHS2â€‹=1ï¼Œå¦åˆ™ detâ¡HS2=0\\det H_S^2=0detHS2â€‹=0ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªå¼å­åœ¨æšä¸¾æ‰€æœ‰ nâˆ’1n-1nâˆ’1 æ¡è¾¹çš„å­é›†ï¼Œå¦‚æœè¿™ä¸ªå­é›†æ˜¯ä¸€æ£µç”Ÿæˆæ ‘ï¼Œé‚£ä¹ˆå°±å°†ç­”æ¡ˆåŠ  111ï¼Œäºæ˜¯æˆ‘ä»¬æˆåŠŸåœ¨ O(n3)\\mathcal{O}(n^3)O(n3) çš„æ—¶é—´å¤æ‚åº¦å†…å®Œæˆäº†ç”Ÿæˆæ ‘è®¡æ•°é—®é¢˜ã€‚ é‚£å°±è®©æˆ‘ä»¬æ¥åšä¸€ä¸‹è¿™é“ æ¨¡æ¿é¢˜ ï¼Œä»£ç åœ¨ è¿™é‡Œã€‚ ç„¶åæ˜¯æœ€å°ç”Ÿæˆæ ‘è®¡æ•°ã€‚è¿™ä¸ªå¤§æ¦‚å°±æ˜¯å‘ç°æ¯ä¸ªæœ€å°ç”Ÿæˆæ ‘æ¯ç§è¾¹æƒçš„è¾¹æ•°åº”è¯¥æ˜¯ä¸€æ ·çš„ï¼Œä¸”å°†è¿™äº›è¾¹å»æ‰åæ‰€å¾—çš„è¿é€šå—ç›¸åŒã€‚ äºæ˜¯æˆ‘ä»¬è€ƒè™‘å»ºå‡ºä¸€æ£µæœ€å°ç”Ÿæˆæ ‘ï¼Œæšä¸¾è¾¹æƒç„¶åæŠŠåŸæ¥æœ€å°ç”Ÿæˆæ ‘ä¸Šè¯¥è¾¹æƒçš„è¾¹åˆ æ‰ï¼Œç„¶åè·‘çŸ©é˜µæ ‘ã€‚ å¤æ‚åº¦ï¼Ÿå‡è®¾ç¦»æ•£ä¹‹åè¾¹æƒ iii å…±æœ‰ aia_iaiâ€‹ æ¡è¾¹ï¼Œé‚£ä¹ˆæ˜¾ç„¶ âˆ‘ai=m\\sum a_i=mâˆ‘aiâ€‹=mã€‚å¦‚æœå›¾æ²¡æœ‰é‡è¾¹ï¼Œåˆ™ Kruscal å¤æ‚åº¦ O(mlogâ¡m)\\mathcal{O}(m\\log m)O(mlogm)ï¼ŒçŸ©é˜µæ ‘å¤æ‚åº¦ä¸º O(âˆ‘(n+m+minâ¡(n,ai)3))\\mathcal{O}\\left(\\sum \\left(n+m+\\min(n, a_i)^3\\right)\\right)O(âˆ‘(n+m+min(n,aiâ€‹)3))ï¼Œç”±äºæ²¡æœ‰é‡è¾¹ï¼Œå‰é¢çš„ n+mn+mn+m é‚£ä¸€é¡¹å¡æ»¡ä¸è¿‡ O(mÃ—(n+m))=O(m2)=O(n2m)\\mathcal{O}(m\\times (n+m))=\\mathcal{O}(m^2)=\\mathcal{O}(n^2m)O(mÃ—(n+m))=O(m2)=O(n2m)ï¼Œè€Œåé¢é‚£ä¸€é¡¹å½“æ¯ä¸ª aia_iaiâ€‹ å–åˆ° nnn æ—¶æœ€å¤§ï¼Œå³ O(mnÃ—n3)=O(n2m)\\mathcal{O}\\left(\\frac{m}{n}\\times n^3\\right)=\\mathcal{O}(n^2m)O(nmâ€‹Ã—n3)=O(n2m)ï¼Œæ‰€ä»¥æ€»å¤æ‚åº¦ O(n2m)\\mathcal{O}(n^2m)O(n2m)ã€‚ æ¨¡æ¿é¢˜åœ¨ è¿™å„¿ ï¼Œä»£ç åœ¨ è¿™å„¿ã€‚ é‚£å¦‚ä½•è®¡ç®—æ ‘å½¢å›¾å‘¢ï¼Ÿæˆ‘ä»¬å…ˆè€ƒè™‘æ ‘æ˜¯å¶å­å‘æ ¹çš„æƒ…å†µã€‚æˆ‘ä»¬è€ƒè™‘åˆšæ‰çš„è¯æ˜ï¼Œä¸éš¾æ„é€ å‡ºæ ‘å½¢å›¾çš„è§£ã€‚å¤§æ¦‚å°±æ˜¯å°†åŸæ¥çš„åº¦æ•°çŸ©é˜µæ”¹æˆå‡ºåº¦çŸ©é˜µï¼Œç„¶åå®šä¹‰åŸºå°”éœå¤«çŸ©é˜µã€‚è¿™æ ·ä¸€æ£µæ ‘å·²ç»å¯ä»¥ç›´æ¥å˜æˆä¸€ä¸ªä¸Šä¸‰è§’äº†ã€‚æˆ‘ä»¬è€ƒè™‘æšä¸¾ rrrï¼Œå¯¹æ¯ä¸ª rrr éƒ½åšä¸€éçŸ©é˜µæ ‘ï¼Œæœ€åæ±‚å’Œå³å¯ã€‚ é‚£ä»æ ¹å‘å¶å­å‘¢ï¼ŸæŠŠè¾¹åä¸€åå°±å¯ä»¥äº†ã€‚å…·ä½“ç›´æ¥æŠŠå‡ºåº¦çŸ©é˜µæ”¹æˆå…¥åº¦çŸ©é˜µå³å¯ã€‚ çŸ©é˜µæ ‘å°±æš‚æ—¶åˆ°è¿™å„¿å§ã€‚ æœªå®Œå¾…ç»­â€¦â€¦ åˆ—å‡ ç¯‡å†™è¿™ç¯‡åšå®¢æ—¶çœ‹åˆ°çš„æœ‰è¶£çš„æ–‡ç« ï¼Œä¸Šé¢çš„å¾ˆå¤šå†…å®¹å¾ˆå¤š å‚è€ƒ æŠ„è‡ªè¿™äº›æ–‡ç« ï¼Œå½“ç„¶æœ‰äº›æ–‡ç« çœ‹ä¸æ‡‚ï¼Œä¹Ÿåˆ—åœ¨äº†è¿™é‡Œï¼š ç½—é›¨å±çš„è¯¾ä»¶ CMXRYNP çš„åšå®¢ï¼š01 åˆ†æ•°è§„åˆ’å­¦ä¹ ç¬”è®° wqs çš„è®ºæ–‡ï¼šã€Šæµ…æä¸€ç±»äºŒåˆ†æ–¹æ³•ã€‹ clj çš„è®ºæ–‡ï¼šã€ŠTree è§£é¢˜æŠ¥å‘Šã€‹ YoungNeal çš„åšå®¢ï¼š[æ€»ç»“] wqs äºŒåˆ†å­¦ä¹ ç¬”è®° Creeper_LKF çš„åšå®¢ï¼šå…³äº WQS äºŒåˆ†ç®—æ³•ä»¥åŠå…¶ä¸€ä¸ªç»†èŠ‚è¯æ˜ Wikipedia è¯æ¡ï¼šQuickhull ä¸€ç¯‡å…³äºå‡¸åŒ…æœŸæœ›ä¸ªæ•°çš„è®ºæ–‡ çŸ¥ä¹ä¸Šå…³äºæœ€å°ä¹˜ç§¯ç”Ÿæˆæ ‘çš„è®¨è®º ã€Šç”Ÿæˆæ ‘çš„è®¡æ•°åŠå…¶åº”ç”¨ã€‹ å‘¨å†¬ MoebiusMeow çš„åšå®¢ï¼šåº·å¤è®¡åˆ’ #5 Matrix-Tree å®šç† (ç”Ÿæˆæ ‘è®¡æ•°) çš„å¦ç±»è¯æ˜å’Œç®€å•æ‹“å±• Wikipedia è¯æ¡ï¼šè¡Œåˆ—å¼ Stilwell çš„è¯¾ä»¶ï¼šçº¿æ€§ä»£æ•° å…³äº Cauchy-Binet å…¬å¼çš„ä¸€ä¸ªè¯æ˜ ã€Œfrom CommonAntsã€Matrix-Tree å®šç†ç›¸å…³","categories":[{"name":"å°å°ç»“","slug":"å°å°ç»“","permalink":"https://pufanyi.github.io/oi-blog/categories/%E5%B0%8F%E5%B0%8F%E7%BB%93/"}],"tags":[{"name":"ç”Ÿæˆæ ‘","slug":"ç”Ÿæˆæ ‘","permalink":"https://pufanyi.github.io/oi-blog/tags/%E7%94%9F%E6%88%90%E6%A0%91/"}]},{"title":"çº¿æ®µæ ‘å…¥é—¨","slug":"çº¿æ®µæ ‘å…¥é—¨","date":"2020-01-26T16:00:00.000Z","updated":"2023-12-25T16:08:28.153Z","comments":true,"path":"çº¿æ®µæ ‘å…¥é—¨/","link":"","permalink":"https://pufanyi.github.io/oi-blog/%E7%BA%BF%E6%AE%B5%E6%A0%91%E5%85%A5%E9%97%A8/","excerpt":"ä¸‡å¹´ä¸æ›´äº†ï¼Œå†³å®šæ‰”ç‚¹ä»€ä¹ˆä¸œè¥¿ä¸Šæ¥å‡‘æ•°å§ã€‚","text":"ä¸‡å¹´ä¸æ›´äº†ï¼Œå†³å®šæ‰”ç‚¹ä»€ä¹ˆä¸œè¥¿ä¸Šæ¥å‡‘æ•°å§ã€‚","categories":[{"name":"å°å°ç»“","slug":"å°å°ç»“","permalink":"https://pufanyi.github.io/oi-blog/categories/%E5%B0%8F%E5%B0%8F%E7%BB%93/"}],"tags":[{"name":"æ ‘çŠ¶æ•°ç»„/çº¿æ®µæ ‘","slug":"æ ‘çŠ¶æ•°ç»„-çº¿æ®µæ ‘","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84-%E7%BA%BF%E6%AE%B5%E6%A0%91/"}]},{"title":"CSP2019 ååšçš„ä¸€äº›é¢˜","slug":"CSP2019ååšçš„ä¸€äº›é¢˜","date":"2019-11-30T16:00:00.000Z","updated":"2023-12-25T16:08:27.883Z","comments":true,"path":"CSP2019ååšçš„ä¸€äº›é¢˜/","link":"","permalink":"https://pufanyi.github.io/oi-blog/CSP2019%E5%90%8E%E5%81%9A%E7%9A%84%E4%B8%80%E4%BA%9B%E9%A2%98/","excerpt":"æ„Ÿè§‰å·²ç»æ¿’ä¸´AFOäº†ã€‚","text":"æ„Ÿè§‰å·²ç»æ¿’ä¸´ AFO äº†ã€‚ é¢˜è§£ä¸­çš„ç¿»è¯‘å¤§éƒ¨åˆ†æ¥è‡ªç½‘ä¸Šï¼Œå¦‚æœæœ‰ä¾µæƒè¡Œä¸ºè¯·è”ç³»æˆ‘ã€‚","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"USACO","slug":"USACO","permalink":"https://pufanyi.github.io/oi-blog/tags/USACO/"}]},{"title":"CSP2019 æ¸¸è®°","slug":"CSP2019æ¸¸è®°","date":"2019-11-23T14:11:44.000Z","updated":"2023-12-25T16:08:27.886Z","comments":true,"path":"CSP2019æ¸¸è®°/","link":"","permalink":"https://pufanyi.github.io/oi-blog/CSP2019%E6%B8%B8%E8%AE%B0/","excerpt":"å£°æ˜ï¼šæœ¬æ¸¸è®°çš„æ‰€æœ‰å†…å®¹å‡æ˜¯åœ¨CSPç»“æŸä¹‹åå†™çš„ã€‚ éƒ½é«˜äºŒäº†ï¼Œç¬¬ä¸€æ¬¡æ­£å¼å‡ºå»ç©ï¼Œç¬¬ä¸€æ¬¡å†™æ¸¸è®°ã€‚","text":"å£°æ˜ï¼šæœ¬æ¸¸è®°çš„æ‰€æœ‰å†…å®¹å‡æ˜¯åœ¨ CSP ç»“æŸä¹‹åå†™çš„ã€‚ éƒ½é«˜äºŒäº†ï¼Œç¬¬ä¸€æ¬¡æ­£å¼å‡ºå»ç©ï¼Œç¬¬ä¸€æ¬¡å†™æ¸¸è®°ã€‚ Day0 ä¸Šåˆä¿¡å¿ƒèµ›ï¼Œç„¶å yk å°±æ”¾äº†åœº Day2ï¼Œçªæ‰“åˆ°è‡ªé—­äº†ã€‚ å•¥æˆ‘ T2 æ‰“äº†ä¸ªå¥‡æ€ªçš„è´ªå¿ƒè¿‡äº†ï¼Ÿï¼Ÿï¼Ÿæ—ºä»”å’Œ zyy ç«Ÿç„¶ T1 åŒæ—¶æ²¡å¼€å¤§æ•°ç»„åŒä¸€ä¸ªæ•°ç»„æµ·æ˜Ÿâ€¦â€¦ å¬è¯´å¦‚æœè¿™åœºæŠŠ RP ç”¨å…‰ä¼šå¯¼è‡´ CSP çˆ† 0ï¼Œçªæ€•ä¸æ˜¯è¯ä¸¸ã€‚ é«˜äºŒè€å¹´é€‰æ‰‹ç¬¬ä¸€æ¬¡å‚åŠ NOIPCSPï¼Œæ˜¯ä¸æ˜¯æ™šäº†ç‚¹ã€‚ è·¯ä¸Šå¥½å¤šäººéƒ½åœ¨å¥¶ä»Šå¹´åŸé¢˜å¤§æˆ˜ã€‚ å…ˆå»å­¦è½¦æƒ³å›´è§‚ä¸€ä¸‹è€ƒåœºï¼Œç„¶è€Œä¸è®©è¿›ã€‚ å’Œ daifucong ä½ä¸€ä¸ªæˆ¿é—´ï¼Œæ„Ÿè§‰é…’åº—ç¯å¢ƒä¸€èˆ¬ï¼Œä½†ä¹Ÿè¿˜ç®—è¿‡å¾—å»ã€‚ å¬è¯´é‚£å«â€œç»´ä¹Ÿçº³ä¸‰å¥½é…’åº—â€ï¼Œåå­—ä¸é”™ã€‚ æ™šä¸Š daifucong å‹¾å¼•æˆ‘æ‰“ cs1.6ï¼Œå°è¯•ä¸‹ç„¶é¹…è¢«å¡å·´åŸºä½¬åˆ äº†ï¼Œå¬è¯´ dfc é‚£ä¸ªä¹Ÿè¢« 360 åˆ äº†ã€‚ ç„¶åå¼€å§‹æ— æ‰€äº‹äº‹ã€‚ dfc ç»™æˆ‘è®²äº† pkuwc2019 çš„ D1T1ï¼Œç„¶åæˆ‘æƒ³äº†å¥½ä¹…æ˜¯ä¸æ˜¯è¯ä¸¸â€¦â€¦ è‡ªé—­åå¼€å§‹èƒŒæ¿ï¼Œç„¶é¹…è¿˜æ²¡å¼€å§‹è¢«å°±è¢« dfc çš„èŒ„å­å¸å¼•è¿‡å»äº†â€¦â€¦ 10:00 å‡†æ—¶ç¡è§‰ã€‚ Day1 é—¹é“ƒåˆ° 6:50ï¼Œç»“æœ 26 åˆ†å°±è¢«é‡èŠ±çš„å¥‡æ€ªçš„â€œé…’åº—è‡ªåŠ¨å«é†’ç”µè¯â€ç»™åµé†’äº†ã€‚ ä¸ºä»€ä¹ˆé…’åº—è¿˜æœ‰è¿™ç§æœåŠ¡ï¼Œæˆ‘æ€ä¹ˆæ‰èƒ½å…³æ‰å®ƒã€‚ æ—©é¥­é™¤äº†è±†è…è„‘å…¶ä»–éƒ½ä¸€èˆ¬ã€‚ ç‰¹åˆ«æ˜¯èœåŒ…å’Œè‚‰åŒ…æ˜¯æ”¾åœ¨ä¸€èµ·ä¸”ä¸€æ¨¡ä¸€æ ·çš„ï¼Œawslâ€¦â€¦ å¤§å·´è½¦åˆšå¼€åˆ°é…’åº—é—¨å£å°±è¢«ä¸€ç¾¤ä¿å®‰æ¥ä½äº†ï¼Œå¬è¯´æ˜¯å‡ºå£è´¼å°ç„¶åè½¦å¼€å‡ºå»çš„æ—¶å€™æ“¦ç ´äº†ä¸€ç‚¹ä»€ä¹ˆä¸œè¥¿ã€‚ ç»“æœå‘ç°èŠ±å’Œ âˆ‘\\sumâˆ‘ çš„è½¦å·²ç»å¼€èµ°äº†ï¼Œäºæ˜¯æˆ‘ä»¬è¢«å›°ä½äº†ã€‚ äºæ˜¯åˆ° 8:10 è¿˜æ²¡å‡ºé…’åº—ã€‚ ç„¶åå¥½åƒä¸€å †äººä¸‹è½¦ï¼Œç„¶åè½¦å°±å¼€èµ°äº†ã€‚å¹¶ä¸çŸ¥é“ä¸ºä»€ä¹ˆ ä¸Šè½¦èµ¶åˆ°è€ƒåœºï¼Œå±…ç„¶è¿˜æ²¡å¼€å§‹ã€‚ èµ¶ç´§å¼€é¢˜ã€‚ é¦–å…ˆå‘ç°äº†é¢˜é¢ç”»é£ä¸å¾€å¹´å¥½åƒä¸ä¸€æ ·ï¼Œæ˜æ˜¾æ˜¯ç”¨ tex å†™çš„ã€‚ è¿™ä¸ªè¾“å…¥è¾“å‡ºæ–‡ä»¶çš„å­—ä½“å¥½ç†Ÿæ‚‰å•Šâ€¦â€¦ ç„¶è€Œä½†ç»“æŸè·Ÿ daifucong èŠå¤©çš„æ—¶å€™æ‰æƒ³èµ·æ¥è¿™å¥½åƒæ˜¯ noi çš„æ¨¡æ¿ã€‚ T1 ç›´æ¥æ¨¡æ‹Ÿå°±å¯ä»¥äº†ã€‚è™½ç„¶è®°å¾—å°æ—¶å€™å·çœ‹æˆ‘çˆ¸çš„é€šæŠ€ä¹¦çš„æ—¶å€™å¥½åƒè®°å¾—æ ¼é›·ç æ˜¯æœ‰å•¥å…¬å¼çš„ã€‚ä½†åæ­£è¿™ä¸ªä¸œè¥¿ç›´æ¥åšä¹Ÿä¸çƒ¦ã€‚ çœ‹ T2ã€‚çœ‹åˆ°â€œæœ‰å¤šå°‘ä¸ª äº’ä¸ç›¸åŒçš„å­ä¸² æ˜¯åˆæ³•æ‹¬å·ä¸²â€è¿™å¥è¯æœ‰ç‚¹æ…Œï¼ŒDay1T2 å°±è€ƒæ•°æ•°ï¼Ÿ å†·é™åˆ†æä¸€ä¸‹ä¹‹åå‘ç°æœ€ä¸Šé¢çš„é¢˜æ„å·²ç»æœ‰æç¤ºäº†ã€‚æˆ‘ä»¬è€ƒè™‘ fif_ifiâ€‹ è¡¨ç¤ºä»æ ¹åˆ°è¯¥ç»“ç‚¹çš„ç­”æ¡ˆï¼Œgig_igiâ€‹è¡¨ç¤ºä»¥è¯¥ç»“ç‚¹ä¸ºæœ«å°¾çš„åˆæ³•ä¸²çš„æ•°é‡ã€‚lil_iliâ€‹è¡¨ç¤º liâˆ¼il_i\\sim iliâ€‹âˆ¼i è¿™ä¸€æ®µæ˜¯ä»¥ iii ä¸ºç»“å°¾æœ€çŸ­çš„åˆæ³•ä¸²ï¼ˆå¯èƒ½ li=0l_i=0liâ€‹=0 å³ä¸å­˜åœ¨ï¼‰ã€‚ä¸éš¾å‘ç°å¦‚æœç¬¬ iii ä¸ªæ•°æ˜¯å·¦æ‹¬å·æ˜¯ä¸ç”¨è·³çš„ï¼Œå¦‚æœæ˜¯å³æ‹¬å·å°±è®© lil_iliâ€‹ æš´åŠ›å¾€ä¸Šè·³ï¼Œç›´åˆ°æœ‰ä¸€ä¸ªå·¦æ‹¬å·åœæ­¢å³å¯ã€‚æœ‰äº† lil_iliâ€‹ï¼Œfif_ifiâ€‹ å’Œgig_igiâ€‹éƒ½å¯ä»¥è½¬ç§»äº†ã€‚ è€ƒè™‘åˆ°æ¯ä¸ªç‚¹åªä¼šè¢«è·³ä¸€æ¬¡ï¼Œæ‰€ä»¥å¤æ‚åº¦æ˜¯ O(n)\\mathcal{O}(n)O(n) çš„ã€‚ æ„Ÿè§‰ T1T2 éƒ½å¾ˆå¥½å†™ï¼Œå°±æ²¡æœ‰å…ˆå»çœ‹ T3ï¼Œå…ˆæŠŠ T1T2 å†™å®Œäº†ã€‚ çœ‹æ—¶é—´è¿˜æœ‰ä¸¤ä¸ªåŠå°æ—¶ï¼Œæ„Ÿè§‰è‚ä¸€é“ Day1T3 æ²¡é—®é¢˜ï¼ˆ æ˜¾ç„¶é¦–å…ˆæ˜¯ 111 è¦ç§»åˆ° 111 å·èŠ‚ç‚¹ï¼Œç„¶åå‘ç°é“¾ä¸Šï¼Œç„¶åå‘ç°å…ˆè¦æŠŠé“¾ä¸Šç‚¹çš„å‡ºé“¾ä¸Šè¾¹å¤–çš„è¾¹åˆ æ‰ï¼Œç„¶åå†åˆ é“¾ä¸Šè¾¹ï¼Œæœ€ååˆ  111 æ‰€åœ¨èŠ‚ç‚¹æ‰€è¿å‡ºå»çš„é‚£äº›è¾¹ã€‚ å¤§æ¦‚å®ç°è¿‡ç¨‹æ˜¯æ‰¾é“¾ï¼Œç„¶åæŠŠé“¾ä¸Šç‚¹çš„ç¼–å·äº¤æ¢å¤„ç†ä¸€ä¸‹ï¼Œç„¶åé€’å½’å¤„ç†ä¸‹å»ã€‚ ç„¶åå¼€å§‹ç ã€‚ ç„¶åå‘ç°åªæœ‰åŠä¸ªå°æ—¶äº†ã€‚ å¼€å§‹è‡ªé—­ã€‚ å‘ç°è‡ªå·±è¿˜æ²¡æ‰“è¿‡æš´åŠ›ã€‚ å½“æ—¶å±…ç„¶æ²¡æœ‰ä¿åº•ï¼Œè€Œå»ç»§ç»­è‚äº†ï¼Œå¹¶ä¸çŸ¥é“å½“æ—¶ä¸ºä»€ä¹ˆä¼šè¿™ä¹ˆæƒ³ã€‚ å…¶å®è¿™ä¸ªä»£ç æ”¹æˆé“¾çš„éƒ¨åˆ†åˆ†åº”è¯¥æ˜¯å¾ˆå¿«çš„ã€‚ åˆ°è·ç¦»ç»“æŸè¿˜æœ‰å¤§æ¦‚ 15 åˆ†é’Ÿçš„æ—¶å€™è¿‡äº†å°æ ·ä¾‹ã€‚ç»“æœå¤§æ ·ä¾‹æ­»æ´»è¿‡ä¸å»ã€‚ è¿˜æœ‰ 5 åˆ†é’Ÿçš„æ—¶å€™å‘ç°æƒå€¼å¿˜è®°äº¤æ¢äº†ã€‚ æˆ‘å½“æ—¶åœ¨å†™ä»€ä¹ˆâ€¦â€¦ è¯ä¸¸ã€‚ æ„Ÿè§‰è¦ 100+100+0ã€‚ å‡ºæ¥ä¹‹åå‘ç°å…¨äººç±»éƒ½æ¯”æˆ‘é«˜ã€‚ åƒåˆé¥­çš„æ—¶å€™ï¼š dfcï¼šT1 è¾“å…¥ 64 2^64-1 è¾“å‡ºå•¥ï¼Ÿ æˆ‘ï¼šå•¥ä¸ºå•¥ nnn å¼€äº†646464ï¼Œæˆ‘å…¨å¼€äº†long longï¼Ÿï¼Ÿï¼Ÿ dfcï¼šâ€¦â€¦ ï¼ˆè¿‡äº†ä¸€ä¼šå„¿ï¼‰ dfcï¼šç­‰ç­‰ 264âˆ’12^{64}-1264âˆ’1 æ˜¯ä¸æ˜¯åº”è¯¥è¾“å‡º 111 åé¢å¾ˆå¤š 000 å•Šï¼Ÿï¼Ÿï¼Ÿ æˆ‘ï¼šï¼Ÿï¼Ÿï¼Ÿ dfcï¼šæˆ‘å¥½åƒæœ€åä¸€ä½æ˜¯111ï¼Œæˆ‘è€ƒåœºä¸Šä»¥ä¸ºè¿™æ˜¯å¯¹çš„ã€‚ äºæ˜¯å‘ç°åªæœ‰æˆ‘å’Œ dfc ä¸ä¼š Day1T1ã€‚ å¼€å§‹è‡ªé—­ã€‚ ï¼ˆè¿‡äº†ä¸€ä¼šå„¿ï¼‰ dfcï¼šT2 ä½ æ‹äº†å—ï¼Ÿ æˆ‘ï¼šæ²¡æ‹ã€‚ dfcï¼šT2 å¤§æ ·ä¾‹å¥½åƒæ€ä¹ˆéƒ½èƒ½è¿‡ã€‚ æˆ‘ï¼šå®Œäº†ã€‚ æ€•ä¸æ˜¯95+0+095+0+095+0+0ï¼Ÿï¼Ÿï¼Ÿ åæ¥ zyk ä¸€ç›´è·Ÿæˆ‘è¯´ï¼Œä¸ç¡®å®šå°±ç®—å¯¹ï¼Œç„¶è€Œæˆ‘è¿˜æ˜¯å¾ˆè‡ªé—­â€¦â€¦ å¼€å§‹å»é…’åº—éº»ç—¹è‡ªæˆ‘â€¦â€¦ ç„¶ååƒæ™šé¥­çš„æ—¶å€™å¬è¯´é«˜ä¸€å·²ç»æœ‰ä¸¤ä¸ªå°å“¥ T2 è¿‡äº†å¤§æ ·ä¾‹ç„¶åå»ç‰›å®¢ä¸Šæµ‹ WA æˆ101010åˆ†äº†ã€‚ çªæ€•ä¸æ˜¯å‡‰äº†ã€‚ ç»§ç»­å›é…’åº—éº»ç—¹è‡ªæˆ‘â€¦â€¦ dfc å…ˆçœ‹äº†ä¼šå„¿èŒ„å­ï¼Œç„¶åå¼€å§‹ é»„é‡‘çŸ¿å·¥ æŠ“çŒªï¼Œç„¶åå’Œæˆ‘å®Œäº†ä¼šå„¿å¦å…‹åŠ¨è¡ã€‚ é¥¥è’çœŸå¥½ç©â€¦â€¦ å¸Œæœ› Day2 èƒ½å‹å–„ä¸€ç‚¹ã€‚ Day2 å»è€ƒåœºçš„è·¯ä¸Šç«Ÿç„¶ä¸€è·¯é¡ºé£ã€‚ å›å¿†ä¸€ä¸‹æ˜¨å¤©æ™šä¸Šï¼Œdaifucong å¥¶äº†ä¸€å£ CSP æ˜¯ä¸ä¼šå‡ºç° 998244353998244353998244353 çš„ã€‚ ç„¶åå¼€é¢˜å°±æ…Œäº†â€¦â€¦ ç„¶åå°±å‘ç°å·¦è¾¹å°å“¥å·²ç»åœ¨æ‰«é›·äº†ã€‚ æ›´æ…Œã€‚ å…ˆçœ‹ T1ã€‚æ˜¾ç„¶æ˜¯ä¸ªå®¹æ–¥ã€‚ç„¶åé‚£ä¸ª O(n3m)\\mathcal{O}(n^3m)O(n3m) çš„dpå¾ˆå¥½æƒ³ï¼Œåˆ†æ•°æŒºé«˜çš„ã€‚ ç„¶åçœ‹ T2ï¼Œä¸€çœ¼ç¥åˆ°æ ·ä¾‹ã€‚ç­‰ç­‰æ€ä¹ˆæœ€åä¸€ä¸ªæ ·ä¾‹è¾“å‡ºè¿™ä¹ˆé•¿å•Šâ€¦â€¦å›å»å›´è§‚äº†ä¸€ä¸‹è¾“å‡ºæ ¼å¼ï¼š è¾“å‡ºä¸€è¡Œä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºç­”æ¡ˆã€‚ è¿™ä¸æ˜¯å­—ç¬¦ä¸²é¢˜å•Šâ€¦â€¦ æœ¬æ¥å°±å°‘çš„å¯æ€œçš„å¼€é¢˜æ•° -= 1 æœæ–­å…ˆçœ‹ T3ã€‚ ä¼—æ‰€å‘¨çŸ¥ Day2T3 æ˜¯ä¸å¯åšçš„ã€‚ ä½†æ˜¯å‘ç° O(n2)\\mathcal{O}(n^2)O(n2) æš´åŠ›å¾ˆå¥½å†™ã€‚ äºæ˜¯ä¼šè¿‡å»çœ‹ T2ã€‚é¢˜é¢å†™å¾—ä¸é”™ï¼Œä¸‹ä¸€ä¸ªã€‚ å…ˆå†™ T1ï¼Œç„¶åå‘ç°å†™æŒ‚äº†ã€‚ æƒ³ç¡®å®šä¸€ä¸‹ dp æœ‰æ²¡æœ‰æ¨å¯¹ï¼Œåœ¨è‰ç¨¿çº¸ä¸Šå†™äº†ä¸€ä¸‹è¿™ä¸ªdpã€‚ ç­‰ç­‰åä¸¤ç»´ä¸æ˜¯å¯ä»¥æ”¾åœ¨ä¸€èµ·å—ï¼Ÿ äºæ˜¯å°±å˜æˆäº†O(n2m)\\mathcal{O}(n^2m)O(n2m)ã€‚ ç„¶åå‘ç°å·¨å¥½å†™ã€‚ ç„¶åå°±å¬è¯´ T2 çš„å‰é¢ 88 åˆ†ä¸ç”¨é«˜ç²¾ï¼Œä¿è¯ansâ‰¤4Ã—1018ans\\le 4\\times 10^{18}ansâ‰¤4Ã—1018ã€‚ è¯´çš„å¥½åƒæˆ‘ä¼šåšçš„æ ·å­ã€‚ ç„¶åå‘ç° O(n2)\\mathcal{O}(n^2)O(n2) å¾ˆå¥½æƒ³ä¹Ÿå¾ˆå¥½å†™ã€‚ äºæ˜¯å°±å†™äº†ä¸ª O(n2)\\mathcal{O}(n^2)O(n2) èµ°äº†ã€‚ æƒ³æƒ³èƒ½ä¸èƒ½åœ¨å¤šå‡ åˆ†ã€‚ æ„Ÿè§‰æœ‰å•è°ƒæ€§ã€‚ ç„¶åå°±ä¸ä¼šäº†ã€‚ è‡ªé—­ï¼Œæ—¶é—´ä¸å¤šäº†ï¼Œå»çœ‹ T3ã€‚ å…ˆæ‰“äº†ä¸ªæš´åŠ›ã€‚ ç„¶åæ‰“äº†æ¡£é“¾ã€‚ å‘ç°é“¾çš„é‚£æ¡£æŒ‚äº†ã€‚ è°ƒäº†ä¸€å¹´ï¼Œlen = (r - l + 1) &gt;&gt; 1æµ·æ˜Ÿã€‚ ç„¶åå‘ç°æƒ³äºŒå‰æ ‘ï¼Œå¹¶æ²¡æœ‰å‘ç°æ•°æ®ä¸­ç»™å‡ºçš„æ˜¯æ»¡äºŒå‰æ ‘ï¼Œä»¥ä¸ºåªæ˜¯æ¯ä¸ªéå¶å­èŠ‚ç‚¹éƒ½æœ‰ä¸¤ä¸ªèŠ‚ç‚¹ã€‚äºæ˜¯æ·±åº¦å¯èƒ½æ˜¯ O(n)\\mathcal{O}(n)O(n) çš„ã€‚ äºæ˜¯æˆ‘å†ä¹Ÿæ²¡æœ‰æƒ³å‡ºæ¥â€¦â€¦ æƒŠæ…Œä¹‹ä¸­æ£€æŸ¥äº†ä¸€ä¸‹å¤§æ ·ä¾‹ã€‚ä¸é”™ï¼Œç›®æµ‹éƒ½å¾ˆå¼ºã€‚ ç„¶åå°±ç»“æŸäº†ã€‚ ç›®æµ‹å¤§æ¦‚100+64+55100+64+55100+64+55ã€‚ å‘ç°åˆæ˜¯äººäººæ¯”æˆ‘é«˜ã€‚ sxd å¥½åƒæƒ³åˆ°äº† T2O(n)\\mathcal{O}(n)O(n)ç„¶åå‘ç°è¢«å¡å†…å­˜äº†ã€‚ ç„¶å zyy ç›´æ¥å†™äº†ä¸ª O(n)\\mathcal{O}(n)O(n) ç‚¸å†…å­˜äº†ã€‚ zyyï¼šå®Œäº†æˆ‘åªæœ‰ 500500500 äº†ã€‚ è‡ªé—­äº†ã€‚ ä¼šå®¶å­¦æ–‡åŒ–è¯¾ã€‚ Day5 å‘ç¨‹åºäº†ã€‚ æ‹¿ zyy çš„æ•°æ®æµ‹äº†ä¸€å‘ï¼š95+100+0+84+64+40=38395+100+0+84+64+40=38395+100+0+84+64+40=383ã€‚ Day1T2 æ²¡æŒ‚ã€‚ å•¥æˆ‘ Day2T1 åªæœ‰ 84ï¼Ÿï¼Ÿï¼Ÿ ä¸è¿‡å¬è¯´æ˜¯è¢«å¡å¸¸ï¼ŒCCF çš„æœºå­æ˜¯èƒ½è¿‡çš„ã€‚ å•¥æˆ‘ Day2T3 é“¾çš„é‚£æ¡£æŒ‚äº†ï¼Ÿï¼Ÿï¼Ÿ å»çœ‹é¢˜æ„ï¼Œå­˜åœ¨ ä¸€ä¸ª 1âˆ¼n1\\sim n1âˆ¼n çš„æ’åˆ—pip_ipiâ€‹ã€‚ æ²¡è¯´æ˜¯ p1 p2,p2 p3p_1\\ p_2,p_2\\ p_3p1â€‹ p2â€‹,p2â€‹ p3â€‹ è¿™æ ·è¯»å…¥çš„å•Šã€‚ å®Œäº†æˆ‘æ²¡äº†ã€‚ ä¸ç”˜å¿ƒå»æ´›è°·äº¤äº†ä¸€å‘ï¼š95+100+25+100+64+55=43995+100+25+100+64+55=43995+100+25+100+64+55=439ã€‚ æ€ä¹ˆä¸¤ä¸ªåˆ†æ•°å·®é‚£ä¹ˆå¤§å•Šâ€¦â€¦ å»ç‰›å®¢ä¸Šå«ä¸€å‘ï¼š95+100+0+100+64+55=41495+100+0+100+64+55=41495+100+0+100+64+55=414ã€‚ ä½†æ„¿ CCF æ•°æ®æ°´ä¸€ç‚¹å•Šâ€¦â€¦ Day8 å‘¨æœ«äº†ï¼Œç”¨ __int128 è¡¥äº†ä¸€ä¸‹ Day2T2ï¼Œç„¶åæ¥å†™æ¸¸è®°ã€‚ æ”¿æ²»è€å¸ˆè¦æˆ‘è¡¥ä½œä¸šï¼Œæ˜æ˜ä¸é€‰æ”¿æ²»ä¸ºå•¥è¿˜æŠ“å¾—è¿™ä¹ˆç‹ å•Šå•Šå•Šå•Šå•Šã€‚ è‡ªé—­äº†ï¼Œæ–‡åŒ–è¯¾çœŸé¦™ã€‚ Day ??? æˆç»©å‡ºæ¥äº†ï¼š95+100+0+84+64+55=39895+100+0+84+64+55=39895+100+0+84+64+55=398ã€‚ Day2T1 æœç„¶è¢«å¡å¸¸äº†ã€‚ å»å­¦æ–‡åŒ–è¯¾å»äº†ã€‚","categories":[{"name":"æ¸¸è®°","slug":"æ¸¸è®°","permalink":"https://pufanyi.github.io/oi-blog/categories/%E6%B8%B8%E8%AE%B0/"}],"tags":[{"name":"æ¸¸è®°","slug":"æ¸¸è®°","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%B8%B8%E8%AE%B0/"}]},{"title":"è¿™ä¸ªæ¯’ç˜¤çš„ live2d","slug":"æ¯’ç˜¤","date":"2019-10-09T16:00:00.000Z","updated":"2023-12-25T16:08:28.082Z","comments":true,"path":"æ¯’ç˜¤/","link":"","permalink":"https://pufanyi.github.io/oi-blog/%E6%AF%92%E7%98%A4/","excerpt":"æ¥ä¸€æ³¢æäº‹ã€‚","text":"æ¥ä¸€æ³¢æäº‹ã€‚ å¤§æ¦‚æ˜¯è¿™é‡Œï¼šhttps://github.com/pufanyi/live","categories":[{"name":"æ¯’ç˜¤","slug":"æ¯’ç˜¤","permalink":"https://pufanyi.github.io/oi-blog/categories/%E6%AF%92%E7%98%A4/"}],"tags":[]},{"title":"CodeForces 1221F Choose a Square","slug":"CF1221F","date":"2019-10-03T16:00:00.000Z","updated":"2023-12-25T16:08:27.873Z","comments":true,"path":"CF1221F/","link":"","permalink":"https://pufanyi.github.io/oi-blog/CF1221F/","excerpt":"é¢˜æ„å¤§æ¦‚å°±æ˜¯æœ‰nnnä¸ªç‚¹ï¼Œæ¯ä¸ªç‚¹å…¶åæ ‡xi,yix_i,y_ixiâ€‹,yiâ€‹ä¸æƒå€¼cic_iciâ€‹ï¼Œå…¶ä¸­1â‰¤nâ‰¤5â‹…105,0â‰¤xi,yiâ‰¤109,âˆ’106â‰¤ciâ‰¤1061\\le n\\le 5\\cdot 10^5,0\\le x_i,y_i\\le 10^9,-10^6\\le c_i\\le 10^61â‰¤nâ‰¤5â‹…105,0â‰¤xiâ€‹,yiâ€‹â‰¤109,âˆ’106â‰¤ciâ€‹â‰¤106ã€‚ è®©ä½ é€‰ä¸€ä¸ªæ­£æ–¹å½¢ï¼Œè¯¥æ­£æ–¹å½¢çš„å·¦ä¸‹è§’åŠå³ä¸Šè§’å¿…é¡»åœ¨y=xy=xy=xè¿™æ¡ç›´çº¿ä¸Šã€‚æ‰€è·å¾—çš„æƒå€¼ä¸ºåœ¨æ­£æ–¹å½¢å†…çš„ç‚¹çš„æƒå€¼å’Œå‡å»æ­£æ–¹å½¢çš„è¾¹æƒã€‚è¾“å‡ºæ‰€è·çš„æœ€å¤§æƒå€¼åŠå…¶é€‰æ‹©æ­£æ–¹å½¢çš„å·¦ä¸‹è§’x1,y1x_1,y_1x1â€‹,y1â€‹åŠå³ä¸Šè§’x2,y2x_2,y_2x2â€‹,y2â€‹ï¼Œè¦æ±‚0â‰¤x1=y1â‰¤x2=y2â‰¤2â‹…1090\\le x_1=y_1\\le x_2=y_2\\le 2\\cdot 10^90â‰¤x1â€‹=y1â€‹â‰¤x2â€‹=y2â€‹â‰¤2â‹…109ã€‚","text":"é¢˜æ„å¤§æ¦‚å°±æ˜¯æœ‰ nnn ä¸ªç‚¹ï¼Œæ¯ä¸ªç‚¹å…¶åæ ‡ xi,yix_i,y_ixiâ€‹,yiâ€‹ ä¸æƒå€¼cic_iciâ€‹ï¼Œå…¶ä¸­1â‰¤nâ‰¤5â‹…105,0â‰¤xi,yiâ‰¤109,âˆ’106â‰¤ciâ‰¤1061\\le n\\le 5\\cdot 10^5,0\\le x_i,y_i\\le 10^9,-10^6\\le c_i\\le 10^61â‰¤nâ‰¤5â‹…105,0â‰¤xiâ€‹,yiâ€‹â‰¤109,âˆ’106â‰¤ciâ€‹â‰¤106ã€‚ è®©ä½ é€‰ä¸€ä¸ªæ­£æ–¹å½¢ï¼Œè¯¥æ­£æ–¹å½¢çš„å·¦ä¸‹è§’åŠå³ä¸Šè§’å¿…é¡»åœ¨ y=xy=xy=x è¿™æ¡ç›´çº¿ä¸Šã€‚æ‰€è·å¾—çš„æƒå€¼ä¸ºåœ¨æ­£æ–¹å½¢å†…çš„ç‚¹çš„æƒå€¼å’Œå‡å»æ­£æ–¹å½¢çš„è¾¹æƒã€‚è¾“å‡ºæ‰€è·çš„æœ€å¤§æƒå€¼åŠå…¶é€‰æ‹©æ­£æ–¹å½¢çš„å·¦ä¸‹è§’ x1,y1x_1,y_1x1â€‹,y1â€‹ åŠå³ä¸Šè§’x2,y2x_2,y_2x2â€‹,y2â€‹ï¼Œè¦æ±‚0â‰¤x1=y1â‰¤x2=y2â‰¤2â‹…1090\\le x_1=y_1\\le x_2=y_2\\le 2\\cdot 10^90â‰¤x1â€‹=y1â€‹â‰¤x2â€‹=y2â€‹â‰¤2â‹…109ã€‚ å…¶å®å°±æ˜¯è®©ä½ é€‰ä¸¤ä¸ªæ•°l,rl,rl,rï¼Œå·¦ä¸‹è§’ä¸º(l,l)(l,l)(l,l)ï¼Œå³ä¸Šè§’ä¸º(r,r)(r,r)(r,r)ã€‚ æˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªç‚¹æ˜¯å¦åœ¨æ­£æ–¹å½¢å†…ã€‚ æˆ‘ä»¬å‘ç°å¯¹äºç¬¬ iii ä¸ªç‚¹ï¼Œè‹¥ lâ‰¤minâ¡{xi,yi}â‰¤maxâ¡{xi,yi}â‰¤rl\\le \\min\\{x_i,y_i\\}\\le \\max\\{x_i,y_i\\}\\le rlâ‰¤min{xiâ€‹,yiâ€‹}â‰¤max{xiâ€‹,yiâ€‹}â‰¤rï¼Œé‚£ä¹ˆ(xi,yi)(x_i,y_i)(xiâ€‹,yiâ€‹) å°±åœ¨æ­£æ–¹å½¢å†…ã€‚ æ‰€ä»¥æˆ‘ä»¬å‘ç°ç­”æ¡ˆå°±æ˜¯ï¼š âˆ‘maxâ¡{xi,yi}â‰¤rciâˆ’âˆ‘minâ¡{xi,yi}&lt;lâ‰¤maxâ¡{xi,yi}â‰¤rciâˆ’(râˆ’l+1)\\sum_{\\max\\{x_i,y_i\\}\\le r} c_i-\\sum_{\\min\\{x_i,y_i\\}&lt; l\\le \\max\\{x_i,y_i\\}\\le r}c_i-(r-l+1) max{xiâ€‹,yiâ€‹}â‰¤râˆ‘â€‹ciâ€‹âˆ’min{xiâ€‹,yiâ€‹}&lt;lâ‰¤max{xiâ€‹,yiâ€‹}â‰¤râˆ‘â€‹ciâ€‹âˆ’(râˆ’l+1) æˆ‘ä»¬è€ƒè™‘æšä¸¾å³ç«¯ç‚¹ rrrï¼Œä¹Ÿå°±æ˜¯æšä¸¾âˆ‘maxâ¡{xi,yi}â‰¤rciâˆ’r\\sum_{\\max\\{x_i,y_i\\}\\le r} c_i-râˆ‘max{xiâ€‹,yiâ€‹}â‰¤râ€‹ciâ€‹âˆ’rï¼ŒåŒæ—¶ç”¨çº¿æ®µæ ‘ç»´æŠ¤âˆ’âˆ‘minâ¡{xi,yi}&lt;lâ‰¤maxâ¡{xi,yi}â‰¤rci+lâˆ’1-\\sum_{\\min\\{x_i,y_i\\}&lt; l\\le \\max\\{x_i,y_i\\}\\le r}c_i+l-1âˆ’âˆ‘min{xiâ€‹,yiâ€‹}&lt;lâ‰¤max{xiâ€‹,yiâ€‹}â‰¤râ€‹ciâ€‹+lâˆ’1 çš„æœ€å°å€¼å³å¯ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256#define _CRT_SECURE_NO_WARNINGS#include &lt;map&gt;#include &lt;set&gt;#include &lt;stack&gt;#include &lt;ctime&gt;#include &lt;cmath&gt;#include &lt;queue&gt;#include &lt;cstdio&gt;#include &lt;cctype&gt;#include &lt;vector&gt;#include &lt;bitset&gt;#include &lt;cstdlib&gt;#include &lt;cstring&gt;#include &lt;cassert&gt;#include &lt;fstream&gt;#include &lt;iostream&gt;#include &lt;algorithm&gt;using namespace std;typedef long long LL;inline char gc() &#123; static const LL L = 233333; static char sxd[L], *sss = sxd, *ttt = sxd; if (sss == ttt) &#123; ttt = (sss = sxd) + fread(sxd, 1, L, stdin); if (sss == ttt) &#123; return EOF; &#125; &#125; return *sss++;&#125;#ifndef dd#define dd c = gc()#endifinline char readalpha() &#123; char dd; for (; !isalpha(c); dd); return c;&#125;inline char readchar() &#123; char dd; for (; c == &#x27; &#x27;; dd); return c;&#125;template &lt;class T&gt;inline bool read(T&amp; x) &#123; bool flg = false; char dd; x = 0; for (; !isdigit(c); dd) &#123; if (c == &#x27;-&#x27;) &#123; flg = true; &#125; else if(c == EOF) &#123; return false; &#125; &#125; for (; isdigit(c); dd) &#123; x = (x &lt;&lt; 1) + (x &lt;&lt; 3) + (c ^ 48); &#125; if (flg) &#123; x = -x; &#125; return true;&#125;#undef ddtemplate &lt;class T&gt;inline void write(T x) &#123; if (x &lt; 0) &#123; putchar(&#x27;-&#x27;); x = -x; &#125; if (x &lt; 10) &#123; putchar(x | 48); return; &#125; write(x / 10); putchar((x % 10) | 48);&#125;typedef long long LL;const LL maxn = 1000005;LL n;LL _cnt = 0;set&lt;LL&gt; mj;#define ls(x) (x &lt;&lt; 1)#define rs(x) (x &lt;&lt; 1 | 1)struct Tree &#123; struct Node &#123; pair&lt;LL, LL&gt; xx; LL lzy; &#125; no[maxn &lt;&lt; 2]; inline void push_up(LL x) &#123; no[x].xx = max(no[ls(x)].xx, no[rs(x)].xx); &#125; inline void build_tree(LL l, LL r, LL k) &#123; static auto x = mj.begin(); if (l == r) &#123; auto tmp = x; ++tmp; if (tmp != mj.end()) &#123; no[k].xx = make_pair(*tmp, *x); &#125; else &#123; no[k].xx = make_pair(-233333, *x); &#125; x++; return; &#125; LL mid = (l + r) &gt;&gt; 1; build_tree(l, mid, ls(k)); build_tree(mid + 1, r, rs(k)); push_up(k); &#125; inline void push_down(LL k) &#123; if (no[k].lzy) &#123; no[ls(k)].xx.first -= no[k].lzy; no[rs(k)].xx.first -= no[k].lzy; no[ls(k)].lzy += no[k].lzy; no[rs(k)].lzy += no[k].lzy; no[k].lzy = 0; &#125; &#125; inline void add(LL l, LL r, LL k, LL L, LL R, LL x) &#123; if (L &lt;= l &amp;&amp; r &lt;= R) &#123; no[k].lzy += x; no[k].xx.first -= x; return; &#125; LL mid = (l + r) &gt;&gt; 1; push_down(k); if (L &lt;= mid) &#123; add(l, mid, ls(k), L, R, x); &#125; if (R &gt; mid) &#123; add(mid + 1, r, rs(k), L, R, x); &#125; push_up(k); &#125; inline pair&lt;LL, LL&gt; query(LL l, LL r, LL k, LL L, LL R) &#123; if (L &lt;= l &amp;&amp; r &lt;= R) &#123; return no[k].xx; &#125; LL mid = (l + r) &gt;&gt; 1; push_down(k); if (R &lt;= mid) &#123; return query(l, mid, ls(k), L, R); &#125; else if (L &gt; mid) &#123; return query(mid + 1, r, rs(k), L, R); &#125; else &#123; return max(query(l, mid, ls(k), L, R), query(mid + 1, r, rs(k), L, R)); &#125; &#125;&#125; tr;struct QJ &#123; LL mn, mx, mnid, mxid, qz; friend bool operator &lt; (QJ a, QJ b) &#123; return a.mx &lt; b.mx; &#125;&#125; qj[maxn];struct LS &#123; LL x, id; friend bool operator &lt; (LS a, LS b) &#123; return a.x &lt; b.x; &#125;&#125; ls[maxn &lt;&lt; 1];map&lt;int, int&gt; anss;int main() &#123; read(n); for (LL i = 1; i &lt;= n; ++i) &#123; LL x, y; read(x), read(y), read(qj[i].qz); if (x == y) &#123; anss[x] += qj[i].qz; &#125; qj[i].mn = min(x, y); qj[i].mx = max(x, y); ls[++_cnt].x = qj[i].mn; ls[_cnt].id = i &lt;&lt; 1; ls[++_cnt].x = qj[i].mx; ls[_cnt].id = i &lt;&lt; 1 | 1; mj.insert(x); mj.insert(y); &#125; sort(ls + 1, ls + _cnt + 1); LL cnt = 0; for (LL i = 1; i &lt;= _cnt; ++i) &#123; if (i == 1 || ls[i].x != ls[i - 1].x) &#123; cnt++; &#125; if (ls[i].id &amp; 1) &#123; qj[ls[i].id &gt;&gt; 1].mxid = cnt; &#125; else &#123; qj[ls[i].id &gt;&gt; 1].mnid = cnt; &#125; &#125; sort(qj + 1, qj + n + 1); LL ansx = 1300000000, ansy = 1300000000, ans = 0; for (auto x : anss) &#123; if (x.second &gt; ans) &#123; ans = x.second; ansx = ansy = x.first; &#125; &#125; tr.build_tree(1, cnt, 1); LL now = 1; LL __cnt = 0; LL sum = 0; int bg = *mj.begin(); for (auto x : mj) &#123; __cnt++; while (now &lt;= n &amp;&amp; qj[now].mx &lt;= x) &#123; tr.add(1, cnt, 1, qj[now].mnid, cnt, qj[now].qz); sum += qj[now].qz; now++; &#125; if (__cnt &gt; 1) &#123; pair&lt;LL, LL&gt; an = tr.query(1, cnt, 1, 1, __cnt - 1); LL Ans = sum + an.first - x; if (Ans &gt; ans) &#123; auto tx = mj.lower_bound(an.second); ansx = *(++tx); ansy = x; ans = Ans; &#125; &#125; int len = x - bg; if (sum - len &gt; ans) &#123; ansx = bg, ansy = x, ans = sum - len; &#125; &#125; printf(&quot;%lld\\n&quot;, ans); printf(&quot;%lld %lld %lld %lld\\n&quot;, ansx, ansx, ansy, ansy); return 0;&#125;","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"CodeForces","slug":"CodeForces","permalink":"https://pufanyi.github.io/oi-blog/tags/CodeForces/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"é€ ä¸€æ£µæ ‘","slug":"é€ ä¸€æ£µæ ‘","date":"2019-09-20T16:00:00.000Z","updated":"2023-12-25T16:08:28.161Z","comments":true,"path":"é€ ä¸€æ£µæ ‘/","link":"","permalink":"https://pufanyi.github.io/oi-blog/%E9%80%A0%E4%B8%80%E6%A3%B5%E6%A0%91/","excerpt":"å¸®äººé€ äº†å‡ ç»„æ•°æ®ã€‚ å…¶å®å°±æ˜¯é€ äº†ä¸€æ£µæ ‘ã€‚ è®°å½•ä¸€ä¸‹ä»¥å¤‡åç”¨ã€‚","text":"å¸®äººé€ äº†å‡ ç»„æ•°æ®ã€‚ å…¶å®å°±æ˜¯é€ äº†ä¸€æ£µæ ‘ã€‚ è®°å½•ä¸€ä¸‹ä»¥å¤‡åç”¨ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061#include &lt;cstdio&gt;#include &lt;vector&gt;#include &lt;utility&gt;#include &lt;cassert&gt;#include &lt;cstdlib&gt;#include &lt;fstream&gt;#include &lt;iostream&gt;#include &lt;algorithm&gt;#define hb bhusing namespace std;const int maxn = 1000000;int n, m, seed;int bh[maxn];vector&lt;pair&lt;int, int&gt; &gt; ve;vector&lt;int&gt; rt;vector&lt;int&gt; ln;int main(int argc, char** argv) &#123; assert(argc == 4); ofstream fout(argv[1]); sscanf(argv[2], &quot;%d&quot;, &amp;n); sscanf(argv[3], &quot;%d&quot;, &amp;seed); srand((unsigned) seed); fout &lt;&lt; n &lt;&lt; &#x27;\\n&#x27;; mt19937 rnd((unsigned) seed); int lim = n / 3; for (int i = 1; i &lt;= n; ++i) &#123; bh[i] = i; &#125; int Lrt = max(1, max(lim - (lim / 10), lim - 10)); random_shuffle(bh + 1, bh + n + 1); rt.push_back(bh[1]); for (int i = 2; i &lt;= lim; ++i) &#123; ve.push_back(make_pair(bh[i], rt[rnd() % rt.size()])); if (i - Lrt &gt; 1) &#123; rt.push_back(hb[i - Lrt]); &#125; &#125; for (int i = lim + 1; i &lt;= n; ++i) &#123; if (ln.empty() || !(rnd() % max(3, lim &gt;&gt; 3))) &#123; ve.push_back(make_pair(hb[i], rt[rnd() % rt.size()])); &#125; else &#123; ve.push_back(make_pair(hb[i], ln[max(0, (int) (ln.size() - (rnd() % 100) - 1))])); &#125; ln.push_back(hb[i]); &#125; random_shuffle(ve.begin(), ve.end()); for (auto x : ve) &#123; if (rnd() &amp; 1) &#123; fout &lt;&lt; x.first &lt;&lt; &#x27; &#x27; &lt;&lt; x.second &lt;&lt; &#x27;\\n&#x27;; &#125; else &#123; fout &lt;&lt; x.second &lt;&lt; &#x27; &#x27; &lt;&lt; x.first &lt;&lt; &#x27;\\n&#x27;; &#125; &#125; fout.close(); return 0;&#125;","categories":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%9A%8F%E7%AC%94/"}],"tags":[{"name":"å‡ºé¢˜","slug":"å‡ºé¢˜","permalink":"https://pufanyi.github.io/oi-blog/tags/%E5%87%BA%E9%A2%98/"}]},{"title":"UVa11600 Masud Rana","slug":"UVa11600","date":"2019-09-07T16:00:00.000Z","updated":"2023-12-25T16:08:27.909Z","comments":true,"path":"UVa11600/","link":"","permalink":"https://pufanyi.github.io/oi-blog/UVa11600/","excerpt":"é¢˜ç›®å¤§æ„å°±æ˜¯æœ‰n (nâ‰¤30)n\\,(n\\le 30)n(nâ‰¤30)ä¸ªç‚¹çš„æ— å‘å®Œå…¨å›¾ï¼Œæœ‰m (mâ‰¤nÃ—(nâˆ’1)2)m\\,\\left(m\\le \\frac{n\\times (n-1)}{2}\\right)m(mâ‰¤2nÃ—(nâˆ’1)â€‹)æ¡é“è·¯ä¸Šæ²¡æœ‰æ€ªå…½ï¼Œå…¶ä»–é“è·¯éƒ½æœ‰æ€ªå…½ã€‚ ä¸€ä¸ªäººä¸€å¼€å§‹åœ¨111å·ç‚¹ï¼Œæ¯æ¬¡ä¼šéšæœºé€‰æ‹©ä¸€æ¡è·¯èµ°å¹¶æŠŠè¿™æ¡è·¯ä¸Šçš„æ€ªå…½å…¨éƒ¨æ€å®Œã€‚ é—®æœŸæœ›èµ°å¤šå°‘æ­¥æ‰èƒ½è®©è¿™nnnä¸ªç‚¹ä¹‹é—´éƒ½å­˜åœ¨æ²¡æœ‰æ€ªå…½çš„è·¯å¾„ã€‚ æŒ‰ç…§å›½é™…æƒ¯ä¾‹ï¼Œå¤šç»„æ•°æ®ï¼ŒTâ‰¤100T\\le 100Tâ‰¤100ã€‚","text":"é¢˜ç›®å¤§æ„å°±æ˜¯æœ‰ n (nâ‰¤30)n\\,(n\\le 30)n(nâ‰¤30) ä¸ªç‚¹çš„æ— å‘å®Œå…¨å›¾ï¼Œæœ‰ m (mâ‰¤nÃ—(nâˆ’1)2)m\\,\\left(m\\le \\frac{n\\times (n-1)}{2}\\right)m(mâ‰¤2nÃ—(nâˆ’1)â€‹) æ¡é“è·¯ä¸Šæ²¡æœ‰æ€ªå…½ï¼Œå…¶ä»–é“è·¯éƒ½æœ‰æ€ªå…½ã€‚ ä¸€ä¸ªäººä¸€å¼€å§‹åœ¨ 111 å·ç‚¹ï¼Œæ¯æ¬¡ä¼šéšæœºé€‰æ‹©ä¸€æ¡è·¯èµ°å¹¶æŠŠè¿™æ¡è·¯ä¸Šçš„æ€ªå…½å…¨éƒ¨æ€å®Œã€‚ é—®æœŸæœ›èµ°å¤šå°‘æ­¥æ‰èƒ½è®©è¿™ nnn ä¸ªç‚¹ä¹‹é—´éƒ½å­˜åœ¨æ²¡æœ‰æ€ªå…½çš„è·¯å¾„ã€‚ æŒ‰ç…§å›½é™…æƒ¯ä¾‹ï¼Œå¤šç»„æ•°æ®ï¼ŒTâ‰¤100T\\le 100Tâ‰¤100ã€‚ ä¸€çœ‹ç½‘ä¸Šçš„é¢˜è§£ï¼Œä¸ºä»€ä¹ˆéƒ½æ˜¯ O(2n)\\mathcal{O}(2^n)O(2n) çš„å•Šï¼Œä¸ºä»€ä¹ˆæš´åŠ›éƒ½èƒ½è¿‡å•Šã€‚ å½“ç„¶å…ˆå£°æ˜ä¸€ä¸‹ï¼Œä¸‹é¢è¯´çš„å¤æ‚åº¦å¤šä¸å¤ªå‡†ç¡®ï¼Œæ¯”å¦‚è¯´ O(2n)\\mathcal{O}(2^n)O(2n)ï¼Œå®é™…ä¸Šå¯èƒ½è¯´çš„æ˜¯O(2nÃ—n)\\mathcal{O}(2^n\\times n)O(2nÃ—n) æˆ–æ˜¯ O(2nÃ—n2)\\mathcal{O}(2^n\\times n^2)O(2nÃ—n2)ï¼Œä½†è€ƒè™‘åˆ°è¿™é“é¢˜å¯¹äºè¿™ç§ç®—æ³•çš„å¤æ‚åº¦æ•°æ®èŒƒå›´æ”¾çš„å¾ˆå®½ï¼Œä¸”nnn å¾ˆå°ï¼Œè¿™é‡Œå°±å¿½ç•¥ä¸è®¡äº†ï¼Œåæ­£è¿™æ˜¯å®ç°çš„é—®é¢˜ã€‚ ç„¶åå¼€å§‹è‡ªé—­ã€‚ ç»“æœå‘ç° udebug ä¸Šé‚£ä»½ std å¥½åƒæ˜¯å¯ä»¥è¿‡ 30 0 è¿™ç»„æ•°æ®çš„ã€‚ äºæ˜¯å°±å¤§æ¦‚æäº†ä¸ªå¤æ‚åº¦ä¼¼ä¹æœ‰ç‚¹çœŸçš„ç®—æ³•ã€‚ å…ˆè¯´ä¸€ä¸‹é‚£ä¸ª O(2n)\\mathcal{O}(2^n)O(2n) çš„åšæ³•å§ï¼Œæˆ‘ä»¬å…ˆè€ƒè™‘æŠŠè”é€šçš„ç‚¹ç¼©èµ·æ¥ï¼Œæˆ‘ä»¬å§‘ä¸”ç§°ä¹‹ä¸ºå›¢ï¼Œè¿™æ ·é—®é¢˜å°±è½¬åŒ–æˆäº†æœŸæœ›éœ€è¦èµ°å¤šå°‘æ¬¡æ‰èƒ½éå†æ‰€æœ‰çš„å›¢ã€‚ ç„¶åè€ƒè™‘ä»¤ fi,jf_{i,j}fi,jâ€‹ è¡¨ç¤ºç°åœ¨åœ¨ç¬¬ iii ä¸ªå›¢ï¼Œé€‰å–å›¢çš„çŠ¶æ€ä¸º jjjï¼Œç›´æ¥dp å³å¯ï¼Œå¦‚æœç›´æ¥è®¡æœç„¶åç”¨ hash æˆ–æ˜¯ map å­˜çŠ¶æ€ï¼Œè¿™é“é¢˜å°±ç›´æ¥è¿‡æ‰äº†ã€‚ ç„¶åæˆ‘ä»¬å‘ç°å…¶å®æˆ‘ä»¬åªå…³å¿ƒæ¯ä¸ªå›¢çš„å¤§å°è€Œä¸å…³å¿ƒæ¯ä¸ªå›¢çš„å…·ä½“æ ‡å·ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥ç”¨ fi,jf_{i,j}fi,jâ€‹ è¡¨ç¤ºå½“å‰åœ¨ç¬¬ iii ä¸ªç‚¹ï¼Œè¿˜æœ‰ jjjï¼ˆjjj æ˜¯ä¸€ä¸ª multisetï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æŠŠè¿™ä¸ªmultiset å“ˆå¸Œæ‰ï¼‰è¿™äº›å›¢çš„æœŸæœ›ï¼Œç„¶åè½¬ç§»ã€‚ è½¬ç§»çš„è¯å¤§æ¦‚å°±æ˜¯æšä¸¾ä¸‹ä¸€æ­¥åˆ°é‚£ä¸ªå›¢ï¼Œç›´æ¥è®¡æœä¸‹å»å³å¯ï¼Œå…·ä½“å¯ä»¥çœ‹ä»£ç ã€‚ å¤æ‚åº¦ï¼Ÿæˆ‘ä»¬å‘ç°çŠ¶æ€å¤§æ¦‚æ˜¯æŠŠ nnn åˆ’åˆ†æˆå¤šä¸ªæ•°å­—ä¹‹å’Œçš„æ–¹æ¡ˆæ•°ï¼Œä¹Ÿå°±æ˜¯ åˆ’åˆ†æ•° ï¼Œn=30n=30n=30 æ—¶æ‰500050005000ã€‚ å¤§æ¦‚è·‘çš„æ˜¯æ¯”è¾ƒå¿«çš„ï¼Œæé™æ•°æ®ï¼ˆ100100100ä¸ª 30 0ï¼‰å¤§æ¦‚åªéœ€è¦è·‘0.30.30.3 ç§’ï¼ˆæœ¬æœºï¼‰ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105#include &lt;bits/stdc++.h&gt;using namespace std;typedef long long LL;// read/write çš„ä»£ç ç•¥å»const int maxn = 305;int n, m;struct ZT &#123; static const int mod = 19260817; multiset&lt;int&gt; st; int hsh, xx; inline void init() &#123; hsh = xx; for (auto x : st) &#123; hsh = ((LL) hsh * hsh % mod * hsh % mod + x) % mod; &#125; &#125; ZT () &#123; hsh = 0, xx = 0; st.clear(); &#125;&#125;;int siz[maxn];int fa[maxn];inline int getfa(int x) &#123; return fa[x] == x ? x : fa[x] = getfa(fa[x]);&#125;inline void merge(int x, int y) &#123; int fax = getfa(x); int fay = getfa(y); if (fax != fay) &#123; if (fax &gt; fay) &#123; swap(fax, fay); &#125; siz[fax] += siz[fay]; fa[fay] = fax; &#125;&#125;map&lt;int, double&gt; mp;inline double dfs(const ZT&amp; now) &#123; if (now.st.empty()) &#123; return 0; &#125; if (mp.count(now.hsh)) &#123; return mp[now.hsh]; &#125; double ans = 0; for (auto x : now.st) &#123; ZT tmp = now; auto it = tmp.st.find(x); tmp.xx += x; tmp.st.erase(it); tmp.init(); ans += dfs(tmp) * x; &#125; ans /= n - 1; ans++; ans /= 1. - (double) (now.xx - 1) / (double) (n - 1); return mp[now.hsh] = ans;&#125;inline double solve() &#123; mp.clear(); read(n), read(m); for (int i = 1; i &lt;= n; ++i) &#123; fa[i] = i; siz[i] = 1; &#125; for (int i = 1; i &lt;= m; ++i) &#123; int x, y; read(x), read(y); merge(x, y); &#125; ZT fir; fir.xx = siz[1]; for (int i = 2; i &lt;= n; ++i) &#123; if (fa[i] == i) &#123; fir.st.insert(siz[i]); &#125; &#125; fir.init(); return dfs(fir);&#125;int main() &#123; int T; read(T); for (int i = 1; i &lt;= T; ++i) &#123; printf(&quot;Case %d: %.10f\\n&quot;, i, solve()); &#125; return 0;&#125;","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"DP","slug":"DP","permalink":"https://pufanyi.github.io/oi-blog/tags/DP/"},{"name":"UVa","slug":"UVa","permalink":"https://pufanyi.github.io/oi-blog/tags/UVa/"}]},{"title":"CodeForces VP è®°å½•","slug":"CodeForcesVP","date":"2019-08-14T16:00:00.000Z","updated":"2023-12-25T16:08:27.886Z","comments":true,"path":"CodeForcesVP/","link":"","permalink":"https://pufanyi.github.io/oi-blog/CodeForcesVP/","excerpt":"æ„Ÿè§‰tfçš„æ—¶å€™è¿˜æ˜¯æ‰“å‡ åœºVPå¥½â€¦â€¦ åŠ *å·çš„æ˜¯å½“åœºè¿‡æ‰çš„ï¼Œè¿™æ ·ä»¥åå¤ä¹ å¯ä»¥ç”¨ã€‚","text":"æ„Ÿè§‰ tf çš„æ—¶å€™è¿˜æ˜¯æ‰“å‡ åœº VP å¥½â€¦â€¦ åŠ  * å·çš„æ˜¯å½“åœºè¿‡æ‰çš„ï¼Œè¿™æ ·ä»¥åå¤ä¹ å¯ä»¥ç”¨ã€‚ Codeforces Round #472 (rated, Div. 1, based on VK Cup 2018 Round 2) *A. Mystical Mosaic é¢˜æ„å¥½éš¾ç¿»è¯‘å•Šï¼Œé‚£å°±ä¸ç¿»è¯‘äº†å§ã€‚ åæ­£ç›´æ¥æ¨¡æ‹Ÿå°±å¯ä»¥äº†ã€‚ ä»£ç ï¼š58555087 *B. Three-level Laser é¢˜ç›®å¤§æ„æ˜¯ç»™ä½ ä¸€ä¸ªé•¿åº¦ä¸º n(nâ‰¤105)n(n\\le 10^5)n(nâ‰¤105) çš„ä¸¥æ ¼é€’å¢çš„æ­£æ•´æ•°åºåˆ— {E}\\{E\\}{E}ï¼Œè®©ä½ æ±‚i&lt;j&lt;ki&lt;j&lt;ki&lt;j&lt;k ä½¿å¾— Ekâˆ’Eiâ‰¤UE_k-E_i\\le UEkâ€‹âˆ’Eiâ€‹â‰¤U ä¸”Î·=Ekâˆ’EjEkâˆ’Ei\\eta=\\frac{E_k-E_j}{E_k-E_i}Î·=Ekâ€‹âˆ’Eiâ€‹Ekâ€‹âˆ’Ejâ€‹â€‹æœ€å¤§ã€‚ è€ƒè™‘åˆ°ä¸¥æ ¼é€’å¢åº”è¯¥æ˜¯å•è°ƒæ€§é—®é¢˜ã€‚ æ˜¾ç„¶å¦‚æœ iii å’Œkkkå›ºå®šï¼Œé‚£ä¹ˆ Î·\\etaÎ· ä¸EjE_jEjâ€‹è´Ÿç›¸å…³ï¼Œäºæ˜¯i=jâˆ’1i=j-1i=jâˆ’1ã€‚ ç„¶åè€ƒè™‘æšä¸¾ iii ç®—kkkï¼Œç›´æ¥æŠŠä¸Šé¢çš„ EkE_kEkâ€‹ å»æ‰å³å¯ï¼šÎ·=Ekâˆ’EjEkâˆ’Ei=Ekâˆ’Ei+Eiâˆ’EjEkâˆ’Ei=1+Eiâˆ’EjEkâˆ’Ei\\eta=\\frac{E_k-E_j}{E_k-E_i}=\\frac{E_k-E_i+E_i-E_j}{E_k-E_i}=1+\\frac{E_i-E_j}{E_k-E_i}Î·=Ekâ€‹âˆ’Eiâ€‹Ekâ€‹âˆ’Ejâ€‹â€‹=Ekâ€‹âˆ’Eiâ€‹Ekâ€‹âˆ’Eiâ€‹+Eiâ€‹âˆ’Ejâ€‹â€‹=1+Ekâ€‹âˆ’Eiâ€‹Eiâ€‹âˆ’Ejâ€‹â€‹ äºŒåˆ†ä¸€ä¸‹å°±å¥½äº†ã€‚ ä»£ç ï¼š58555515 *C. Riverside Curio é¢˜æ„å¤§æ¦‚å°±æ˜¯æœ‰ä¸€ä¸ªäººæ¯å¤©å»çœ‹ä¸€æ¡æ²³çš„æ°´ä½ï¼Œæ¯æ¬¡åœ¨æ°´ä½ä¸Šç”»ä¸€æ¡çº¿ï¼Œå¹¶è®°å½•ä¸‹ä¸¥æ ¼é«˜äºå½“å‰æ°´ä½çš„çº¿æœ‰å‡ æ¡ï¼Œè®°ä¸º mim_imiâ€‹ã€‚ä»¤ç¬¬iii å¤©ä¸¥æ ¼ä½äºå½“å‰æ°´ä½çš„çº¿æœ‰ did_idiâ€‹ æ¡ï¼Œæ±‚ âˆ‘di\\sum d_iâˆ‘diâ€‹ çš„æœ€å°å€¼ï¼Œnâ‰¤105n\\le 10^5nâ‰¤105ã€‚ æ˜¾ç„¶æœ€å°‘æœ‰ maxâ¡{mi}\\max\\{m_i\\}max{miâ€‹} æ¡çº¿ï¼Œç„¶åæˆ‘ä»¬æ‰¾åˆ°è¿™ä¸ªä½ç½®ï¼Œç„¶åå¾€ä¸¤è¾¹è·‘ã€‚å¾€åè·‘å°±ç›´æ¥æ¨¡æ‹Ÿå³å¯ï¼Œå› ä¸ºä¹‹åæ˜¯ä¸ä¼šç”»æ–°çš„çº¿äº†ã€‚å¾€å‰è·‘ç›¸å½“äºæ˜¯åˆ çº¿ï¼Œæ˜¾ç„¶æ˜¯èƒ½åˆ å°±åˆ ï¼Œç»´æŠ¤ä¸€ä¸‹å‰ç¼€ maxâ¡\\maxmax å³å¯ã€‚ ä»£ç ï¼š58556096 D. Contact ATC é¢˜æ„æ˜¯è¯´æœ‰ n(nâ‰¤105)n(n\\le 10^5)n(nâ‰¤105) æ¶é£æœºåœ¨ä¸€æ¡æ•°è½´ä¸Šé£ï¼Œåæ ‡ä¸º xix_ixiâ€‹ï¼Œé€Ÿåº¦ä¸ºviv_iviâ€‹ï¼Œæœ‰xivi&lt;0x_iv_i&lt;0xiâ€‹viâ€‹&lt;0ï¼ˆå¾€åŸç‚¹é£ï¼‰ï¼Œç°åœ¨å¯èƒ½æœ‰ä¸€é€Ÿåº¦ä¸ºvvv çš„é£ï¼Œåªèƒ½é¢„æµ‹å‡ºvâˆˆ[âˆ’w,w]v\\in [-w,w]vâˆˆ[âˆ’w,w]ï¼Œå½“ç„¶ä¿è¯âˆ£viâˆ£&lt;w|v_i|&lt;wâˆ£viâ€‹âˆ£&lt;wã€‚æ±‚æœ‰å¤šå°‘å¯¹é£æœºå¯èƒ½åŒæ—¶åˆ°è¾¾åŸç‚¹ã€‚ æ„Ÿè§‰è‡ªå·±å¥½èœå•Šï¼Œæ¨å¼å­å‘ç°æ˜¯è·Ÿæ–œç‡ç›¸å…³çš„ä¸€ä¸ªä¸œè¥¿ï¼Œç„¶åæƒŠå–œåœ°å‘ç°è¿™å¥½åƒæ˜¯é“è®¡ç®—å‡ ä½•ï¼Œç„¶åç äº†ä¸€å¹´â€¦â€¦ æˆ‘ä»¬è€ƒè™‘è®¡ç®—å‡ºé£æœºåˆ°è¾¾åŸç‚¹çš„æ—¶é—´ tiâˆˆ[li,ri]t_i\\in [l_i,r_i]tiâ€‹âˆˆ[liâ€‹,riâ€‹]ï¼Œè€ƒè™‘åˆ°é£é€Ÿä¸æ—¶é—´æ˜¯å‘ˆä¸€ä¸ªä¸€æ¬¡å‡½æ•°çš„å…³ç³»ï¼Œç”»å›¾ä¾¿å¯çŸ¥é“å¦‚æœæ˜¯ç›¸å‘é£è¡Œçš„é£æœºi,ji,ji,jï¼Œåªè¦[li,ri]âˆ©[lj,rj]â‰ âˆ…[l_i,r_i]\\cap[l_j,r_j]\\neq \\empty[liâ€‹,riâ€‹]âˆ©[ljâ€‹,rjâ€‹]î€ =âˆ… å³å¯ï¼Œå¦‚æœæ˜¯åŒå‘çš„é£æœº i,ji,ji,jï¼Œåªè¦[li,ri]âŠ†[lj,rj][l_i,r_i]\\subseteq[l_j,r_j][liâ€‹,riâ€‹]âŠ†[ljâ€‹,rjâ€‹] æˆ–[li,ri]âŠ‡[lj,rj][l_i,r_i]\\supseteq[l_j,r_j][liâ€‹,riâ€‹]âŠ‡[ljâ€‹,rjâ€‹]å³å¯ã€‚ ç„¶åå°±å˜æˆäº†ä¸€ä¸ªäºŒç»´æ•°ç‚¹é—®é¢˜ã€‚ ä»£ç ï¼š58560521 E. Wardrobe é¢˜è§£å†™åœ¨äº† å¦ä¸€ç¯‡æ–‡ç« é‡Œã€‚ F. Minimal Subset Difference å¤ªèœäº†ï¼Œä¸ä¼šã€‚ Codeforces Round #539 (Div. 1) *A. Sasha and a Bit of Relax é¢˜æ„å¤§æ¦‚å°±æ˜¯ç»™ä½ ä¸€æ®µé•¿åº¦ä¸º n(nâ‰¤3Ã—105)n(n\\le 3\\times 10^5)n(nâ‰¤3Ã—105) åºåˆ— {a}(0â‰¤ai&lt;220)\\{a\\}(0\\le a_i&lt; 2^{20}){a}(0â‰¤aiâ€‹&lt;220)ï¼Œæ±‚æœ‰å¤šå°‘ä¸ªåŒºé—´[l,r][l,r][l,r] ä½¿å¾— râˆ’l+1r-l+1râˆ’l+1 æ˜¯å¶æ•°ä¸” â¨i=lmai=â¨i=m+1rai\\bigoplus_{i=l}^{m}a_i=\\bigoplus_{i=m+1}^{r}a_iâ¨i=lmâ€‹aiâ€‹=â¨i=m+1râ€‹aiâ€‹ï¼Œå…¶ä¸­m=l+râˆ’12m=\\frac{l+r-1}{2}m=2l+râˆ’1â€‹ï¼Œâ¨\\bigoplusâ¨ æ˜¯æŒ‡xorã€‚ æ˜¾ç„¶åªè¦ â¨i=lrai=0\\bigoplus_{i=l}^r a_i=0â¨i=lrâ€‹aiâ€‹=0 å³å¯ï¼Œç„¶åå¼€ä¸ªæ¡¶ç®—ã€‚ ä»£ç ï¼š58788064 *B. Sasha and One More Name é¢˜æ„æ˜¯ç»™ä½ ä¸€ä¸ªå›æ–‡ä¸²s(1â‰¤âˆ£sâˆ£â‰¤5000)s(1\\le |s|\\le 5000)s(1â‰¤âˆ£sâˆ£â‰¤5000)ï¼Œæ±‚æœ€å°å‰²å¤šå°‘åˆ€ç„¶åé‡ç»„å˜æˆä¸€ä¸ªä¸åŒçš„å›æ–‡ä¸²ï¼Œæ— è§£è¾“å‡ºImpossibleã€‚ æ˜¾ç„¶ç­”æ¡ˆåªæœ‰ 111ã€222ã€Impossible ä¸‰ç§ï¼ŒImpossibleç›´æ¥åˆ¤ï¼Œ111ç›´æ¥æš´åŠ›æšä¸¾ï¼Œå‰©ä¸‹æ¥çš„éƒ½æ˜¯222ã€‚ ä»£ç ï¼š58788424 C. Sasha and One More Name æ•°æ®ç»“æ„é¢˜ï¼Œç›´æ¥æŠ„äº† è¿™ç¯‡åšå®¢ çš„ç¿»è¯‘ï¼š ç»´æŠ¤ä»¥ä¸‹ä¸‰ç§æ“ä½œ 1 t sï¼šåœ¨æ—¶åˆ» ttt æ’å…¥å‘½ä»¤sssã€‚ä¿è¯ä»»æ„æ“ä½œåï¼Œä»»æ„æ—¶åˆ»è‡³å¤šåªæœ‰ä¸€ä¸ªå‘½ä»¤ã€‚ 2 tï¼šåˆ é™¤æ—¶åˆ» ttt çš„å‘½ä»¤ã€‚ 3 l r vï¼šæ±‚æœ€å°çš„tâˆˆ[l,r]t\\in [l,r]tâˆˆ[l,r]ï¼Œä½¿å¾—f(t)=0f(t)=0f(t)=0ã€‚ å…¶ä¸­ f(t)=v+âˆ«ltg(x)dxf(t) = v+\\int_l^t g(x) \\mathrm{d} x f(t)=v+âˆ«ltâ€‹g(x)dx å…¶ä¸­è®¾åœ¨ [l,r]\\left[l,r\\right][l,r] æ—¶é—´å†…çš„å‘½ä»¤ä¾æ¬¡ä¸º(t1,s1),â€¦,(tm,sm)(t_1, s_1), \\dots, (t_m, s_m)(t1â€‹,s1â€‹),â€¦,(tmâ€‹,smâ€‹)ï¼Œåˆ™ï¼š g(t)={0lâ‰¤t&lt;t1s1t1â‰¤t&lt;t2â€¦sktkâ‰¤t&lt;tk+1â€¦smtâ‰¥tm.g(t) = \\begin{cases} 0 &amp; l \\leq t &lt; t_1 \\\\ s_1 &amp; t_1 \\leq t &lt; t_2 \\\\ \\dots \\\\ s_k &amp; t_k \\leq t &lt; t_{k+1} \\\\ \\dots \\\\ s_m &amp; t \\geq t_m \\end{cases}. g(t)=â©âªâªâªâªâªâªâªâªâªâ¨âªâªâªâªâªâªâªâªâªâ§â€‹0s1â€‹â€¦skâ€‹â€¦smâ€‹â€‹lâ‰¤t&lt;t1â€‹t1â€‹â‰¤t&lt;t2â€‹tkâ€‹â‰¤t&lt;tk+1â€‹tâ‰¥tmâ€‹â€‹. è‹¥ä¸å­˜åœ¨ï¼Œåˆ™è¿”å›âˆ’1âˆ’1âˆ’1ã€‚ é¢˜è§£ç•™å‘å§â€¦â€¦ Codeforces Round #578 (Div. 2) æ‰“äº†åœº Div. 2 æ„Ÿè§‰è‡ªå·±å¿ƒæƒ…èˆ’ç•…ï¼Œç„¶é¹…è¿˜æ˜¯è‡ªé—­äº†â€¦â€¦ è¯è¯´æˆ‘çš„ hash å¥½èœå•Šï¼Œä¸ºä»€ä¹ˆä¸€å®šè¦æ‰“åŒå“ˆå¸Œå•Šâ€¦â€¦ è‡ªé—­äº†ï¼š *A. Hotelier ç›´æ¥æ¨¡æ‹Ÿå°±å¯ä»¥äº†ã€‚ ä»£ç ï¼š58884080 *B. Block Adventure è¿˜æ˜¯ç›´æ¥æ¨¡æ‹Ÿå°±å¯ä»¥äº†ã€‚ ä»£ç ï¼š58884001 *C. Round Corridor å¤§æ¦‚å°±æ˜¯æœ‰ç±»ä¼¼è¿™æ ·çš„ä¸€ä¸ªåœ†å½¢å±‹å­ï¼Œå†…å±‚æœ‰ nnn æ ¼ï¼Œå¤–å±‚æœ‰ mmm æ ¼ï¼Œæ¯å±‚éƒ½æœ‰ä¸€é¢å¢™åœ¨ 121212 æ—¶çš„ä½ç½®ï¼Œæ¯æ ¼å¤§å°å‡åŒ€ã€‚å†…å¤–å±‚æ²¡æœ‰å¢™ï¼Œä½†æ¯å±‚æ ¼å­ä¸æ ¼å­ä¹‹é—´æœ‰å¢™ã€‚å¤šæ¬¡è¯¢é—® (sx,sy)(s_x,s_y)(sxâ€‹,syâ€‹) å’Œ(ex,ey)(e_x,e_y)(exâ€‹,eyâ€‹)è¯¢é—®ç€ä¸¤ä¸ªæ ¼å­èƒ½å¦ç›¸äº’åˆ°è¾¾ã€‚ n,mâ‰¤1018,qâ‰¤104n,m\\le 10^{18},q\\le 10^4n,mâ‰¤1018,qâ‰¤104ã€‚ æ˜¾ç„¶å¯ä»¥æŠŠè¿™ä¸ªç¯å½¢åˆ†æˆä¸€æ®µä¸€æ®µï¼Œæ¯æ®µéƒ½ç›¸è¿ä¸”ç‹¬ç«‹ï¼ˆä¸å…¶ä»–æ ¼å­ä¸è¿é€šï¼‰ã€‚ å‡è®¾ä¸€æ®µæœ‰ xxx ä¸ªå†…å±‚æ ¼å­ä¸ yyy ä¸ªå¤–å±‚æ ¼å­ï¼Œé‚£æ˜¾ç„¶æœ‰ nx=my\\frac{n}{x}=\\frac{m}{y}xnâ€‹=ymâ€‹ï¼Œå³ny=mxny=mxny=mxï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°æœ€å°çš„x,yx,yx,yï¼Œä¹Ÿå°±æ˜¯ny=mx=lcm(n,m)=nmgcdâ¡(n,m)ny=mx=\\mathrm{lcm}(n,m)=\\frac{nm}{\\gcd(n,m)}ny=mx=lcm(n,m)=gcd(n,m)nmâ€‹ï¼Œä¹Ÿå°±æ˜¯x=ngcdâ¡(n,m),y=mgcdâ¡(n,m)x=\\frac{n}{\\gcd(n,m)},y=\\frac{m}{\\gcd(n,m)}x=gcd(n,m)nâ€‹,y=gcd(n,m)mâ€‹ï¼Œç„¶åæ¯æ¬¡O(1)\\mathcal{O}(1)O(1) åˆ¤æ–­ä¸¤ä¸ªç‚¹æ˜¯å¦åœ¨åŒä¸€è”é€šå—ä¸­å³å¯ã€‚ ä»£ç ï¼š58883764 *D. White Lines é¢˜æ„æ˜¯æœ‰ä¸€å— nÃ—nn\\times nnÃ—n çš„ç”»å¸ƒï¼Œæœ‰ä¸€äº›åƒç´ ç‚¹æ˜¯ Wï¼Œæœ‰ä¸€äº›æ˜¯Bï¼Œä½ å¯ä»¥å°†ä¸€ä¸ªkÃ—kk\\times kkÃ—k çš„å­çŸ©é˜µä¸­æ‰€æœ‰çš„ B å…¨éƒ¨å˜æˆWï¼Œé—®åšå¤šèƒ½æœ‰å¤šå°‘è¡Œåˆ—æ˜¯å…¨ç™½è‰²çš„ï¼Œnâ‰¤2000n\\le 2000nâ‰¤2000ã€‚ æˆ‘ä»¬è€ƒè™‘è¡Œå’Œåˆ—åˆ†å¼€æ¥çœ‹ï¼Œæˆ‘ä»¬ä»¤ fi,jf_{i,j}fi,jâ€‹ è¡¨ç¤ºå·¦ä¸Šè§’åœ¨ç¬¬ iii è¡Œç¬¬ jjj åˆ—ï¼Œä¼šæŠŠå¤šå°‘åŸæ¥ä¸æ˜¯å…¨ç™½çš„è¡Œå˜æˆå…¨ç™½çš„è¡Œï¼ŒåŒç†å¯ä»¥å®šä¹‰ gi,jg_{i,j}gi,jâ€‹ è¡¨ç¤ºä¼šæŠŠå¤šå°‘åŸæ¥ä¸æ˜¯å…¨ç™½çš„åˆ—å˜æˆå…¨ç™½çš„åˆ—ã€‚å½“ç„¶ï¼Œä¸ºäº†å¤åˆ¶ç²˜è´´æ–¹ä¾¿ï¼Œä»£ç ä¸­æŠŠ gi,jg_{i,j}gi,jâ€‹ å®šä¹‰ä¸ºäº†å·¦ä¸Šè§’åœ¨ç¬¬ jjj è¡Œç¬¬ iii åˆ—ã€‚ ç”±äºè½¬ç§»æ˜¯å¯¹ç§°ï¼ˆè¡Œå’Œåˆ—çš„æ–¹ç¨‹ä¸€æ ·ï¼‰çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±ä»…è€ƒè™‘è¡Œã€‚æˆ‘ä»¬è€ƒè™‘è¦æŠŠä¸€è¡Œå˜æˆå…¨ç™½ï¼Œå¿…é¡»æŠŠè¯¥è¡Œä¸Šæœ€å·¦è¾¹çš„é»‘è‰²æ ¼å­å’Œæœ€å³è¾¹çš„é»‘è‰²æ ¼å­å…¨éƒ¨è¦†ç›–åˆ°ï¼Œæ‰€ä»¥å¯¹äºæ¯è¡Œæˆ‘ä»¬å¯ä»¥ O(1)\\mathcal{O}(1)O(1) è®¡ç®—ã€‚ æˆ‘ä»¬è€ƒè™‘å…ˆ O(nk)\\mathcal{O}(nk)O(nk) æš´åŠ›ç®—å‡º f1,jf_{1,j}f1,jâ€‹ï¼Œç„¶åæ¯æ¬¡è®¡ç®—fi,jf_{i,j}fi,jâ€‹ è€ƒè™‘å¢åŠ ç¬¬ i+kâˆ’1i+k-1i+kâˆ’1 è¡Œçš„è´¡çŒ®å¹¶åˆ é™¤ç¬¬ iâˆ’1i-1iâˆ’1 è¡Œçš„è´¡çŒ®å³å¯ã€‚ è¿™æ ·å¤æ‚åº¦å°±æ˜¯ O(n2)\\mathcal{O}(n^2)O(n2) çš„äº†ã€‚ ä»£ç ï¼š58884654 E.Compress Words é¢˜ç›®å¤§æ„æ˜¯æœ‰ nnn ä¸ªå­—ç¬¦ä¸²sis_isiâ€‹ï¼Œä»å·¦å¾€å³ä¾æ¬¡åˆå¹¶æ¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå°±æ˜¯æ‰¾åˆ°ä¹‹å‰åˆå¹¶å®Œçš„ä¸²çš„æœ€é•¿åç¼€ä½¿å…¶æ˜¯è¦åˆå¹¶çš„é‚£ä¸ªä¸²çš„å‰ç¼€ï¼Œè¾“å‡ºæœ€ç»ˆåˆå¹¶å®Œçš„ä¸²ï¼Œnâ‰¤105,âˆ‘âˆ£siâˆ£â‰¤106n\\le 10^5,\\sum|s_i|\\le10^6nâ‰¤105,âˆ‘âˆ£siâ€‹âˆ£â‰¤106ã€‚ ç›´æ¥å“ˆå¸Œå°±å¯ä»¥äº†ï¼Œå¤æ‚åº¦O(n)\\mathcal{O}(n)O(n)â€¦â€¦ å¤§æ¦‚éœ€è¦åŒå“ˆå¸Œï¼Œæˆ‘çš„å•å“ˆå¸Œwa on 66ã€‚ ä»£ç ï¼š58886006 Codeforces Round #589 (Div. 2) åˆæ˜¯ä¸€åœºæ„‰å¿«çš„ Div. 2ã€‚ å¯æƒœçªè¿˜æ˜¯çˆ†è›‹äº†â€¦â€¦ *A. Distinct Digits ç›´æ¥æ¨¡æ‹Ÿå³å¯â€¦â€¦ ä»£ç ï¼š61680483 *B. Filling the Grid ç›´æ¥æ¨¡æ‹Ÿå³å¯â€¦â€¦ ä»£ç ï¼š61680658 *C. Primes and Multiplication é¢˜ç›®å¤§æ„æœ‰ç‚¹å¤æ‚ï¼Œç„¶åæˆ‘å°±çœ‹é”™äº†ä¸€å¹´çš„é¢˜â€¦â€¦ å®šä¹‰ prime(x)\\mathrm{prime}(x)prime(x) è¡¨ç¤º xxx çš„è´¨å› å­é›†åˆï¼Œg(x,p)g(x,p)g(x,p)è¡¨ç¤ºæœ€å¤§çš„pkâˆ£x(kâˆˆN)p^k\\mid x(k\\in \\mathbb{N})pkâˆ£x(kâˆˆN)ï¼Œf(x,y)=âˆkâˆˆprime(x)g(y,k)f(x,y)=\\prod_{k\\in \\mathrm{prime}(x)}g(y,k)f(x,y)=âˆkâˆˆprime(x)â€‹g(y,k)ï¼Œæ±‚âˆi=1nf(x,i)\\prod_{i=1}^nf(x,i)âˆi=1nâ€‹f(x,i)ã€‚ï¼ˆxâ‰¤109,nâ‰¤1018x\\le 10^9,n\\le 10^{18}xâ‰¤109,nâ‰¤1018ï¼‰ è€ƒè™‘åˆ°å…¨æ˜¯ä¹˜æ³•ï¼Œæ˜¾ç„¶æ»¡è¶³äº¤æ¢å¾‹ã€‚ æ‰€ä»¥æˆ‘ä»¬å¯¹æ¯ä¸ªè´¨å› å­åˆ†å¼€æ¥æ±‚ï¼Œæœ€åä¹˜èµ·æ¥å³å¯ã€‚ æˆ‘ä»¬è€ƒè™‘è´¨å› å­ kkkï¼Œæ˜¾ç„¶1âˆ¼kâˆ’11\\sim k-11âˆ¼kâˆ’1 çš„åŒºé—´è´¡çŒ®æ˜¯ 111ï¼Œkâˆ¼k2âˆ’1k\\sim k^2-1kâˆ¼k2âˆ’1 çš„è´¡çŒ®æ˜¯ kkkï¼Œk2âˆ¼k3âˆ’1k^2\\sim k^3-1k2âˆ¼k3âˆ’1 çš„è´¡çŒ®æ˜¯k2k^2k2â€¦â€¦ ç„¶åä¸éš¾å‘ç°åªæœ‰ logâ¡\\loglog ä¸ªè¿™æ ·çš„åŒºé—´ï¼Œæ‰€ä»¥æ€»å¤æ‚åº¦O(x+logâ¡xlogâ¡n)\\mathcal{O}(\\sqrt x + \\log x\\log n)O(xâ€‹+logxlogn)ã€‚ ä»£ç ï¼š61681335 *D. Complete Tripartite æœ‰ n(3â‰¤nâ‰¤105)n(3\\le n\\le 10^5)n(3â‰¤nâ‰¤105) ä¸ªç‚¹ m(0â‰¤mâ‰¤minâ¡(3â‹…105,n(nâˆ’1)2))m(0\\le m\\le \\min(3\\cdot 10^5,\\frac{n(n-1)}{2}))m(0â‰¤mâ‰¤min(3â‹…105,2n(nâˆ’1)â€‹)) æ¡è¾¹çš„æ— å‘æ— è‡ªç¯æ— é‡è¾¹å›¾ï¼Œéœ€è¦å¯¹æ¯æ¡è¾¹æŸ“è‰²ï¼ˆ1,2,31,2,31,2,3ï¼‰ï¼Œä½¿å¾—æ¯ç§é¢œè‰²è‡ªå·±çš„ç‚¹ä¹‹é—´æ²¡æœ‰è¾¹ï¼Œå…¶ä½™çš„å¿…é¡»ä¸¤ä¸¤æœ‰è¾¹ï¼Œæ±‚ä¸€ç§æ–¹æ¡ˆæˆ–æ— è§£ã€‚ ç›´æ¥æ¨¡æ‹Ÿå³å¯â€¦â€¦ ä»£ç ï¼š61681851 *E. Another Filling the Grid æœ‰ä¸€ä¸ª nÃ—nn\\times nnÃ—n çš„çŸ©é˜µï¼Œéœ€è¦å°†æ¯ä¸ªæ ¼å­ç”¨ 1âˆ¼k1\\sim k1âˆ¼k çš„æ•°å­—å¡«å……ï¼Œè¦æ±‚æ¯è¡Œæ¯åˆ—éƒ½æœ‰è‡³å°‘ä¸€ä¸ª111ï¼Œæ±‚æ–¹æ¡ˆæ•°ã€‚nâ‰¤250,kâ‰¤109n\\le 250,k\\le 10^9nâ‰¤250,kâ‰¤109ã€‚ O(n3)\\mathcal{O}(n^3)O(n3)çš„ dp å¾ˆå¥½æƒ³ï¼Œç›´æ¥ä»¤ fi,jf_{i,j}fi,jâ€‹ è¡¨ç¤ºåˆ°ç¬¬ iii è¡Œå·²ç»æœ‰ jjj åˆ—æœ‰111ã€‚ è€ƒè™‘è½¬ç§»ï¼Œæšä¸¾ä¸€ä¸ª ttt è¡¨ç¤ºè¿™ä¸€åˆ—ä¹‹å‰æœ‰å¤šå°‘åˆ—æœ‰ 111ï¼Œé‚£ä¹ˆè¿™äº›æ ¼å­å¯ä»¥ä¹±å¡«ï¼Œä¸ºktk^tktã€‚å…¶ä¸­jâˆ’tj-tjâˆ’t ä¸ªæ ¼å­åªèƒ½å¡«111ï¼Œå…¶ä½™æ ¼å­ä¸èƒ½å¡«111ã€‚è¿™æ ·ç›´æ¥è½¬ç§»è¿‡å»å³å¯ã€‚ ç”±äºæ¯ä¸€è¡Œä¹Ÿè‡³å°‘è¦æœ‰ä¸€ä¸ª 111ï¼Œæ‰€ä»¥è½¬ç§»æ—¶ä¸€è¡Œä¸­æ²¡æœ‰ä¸€ä¸ª111 çš„æ–¹æ¡ˆæ•°å‡æ‰å³å¯ã€‚ ä»£ç ï¼š61682746 ç»“æœä¸€çœ‹é¢˜è§£å‘ç°å¤æ‚åº¦å¯ä»¥æ›´ä¼˜ã€‚ æˆ‘ä»¬è€ƒè™‘å®¹æ–¥ï¼Œæœ‰ iii è¡Œjjjåˆ—æ²¡æœ‰111ï¼Œæ‰€ä»¥ç­”æ¡ˆå°±æ˜¯ï¼š âˆ‘i=0n(âˆ’1)i(ni)âˆ‘j=0n(âˆ’1)j(nj)k(nâˆ’i)(nâˆ’j)(kâˆ’1)ni+njâˆ’ij\\sum_{i=0}^n(-1)^i\\binom{n}{i}\\sum_{j=0}^n(-1)^j\\binom{n}{j}k^{(n-i)(n-j)}(k-1)^{ni+nj-ij} i=0âˆ‘nâ€‹(âˆ’1)i(inâ€‹)j=0âˆ‘nâ€‹(âˆ’1)j(jnâ€‹)k(nâˆ’i)(nâˆ’j)(kâˆ’1)ni+njâˆ’ij å½“ç„¶å†™çš„å¥½çœ‹ä¸€ç‚¹ä¹Ÿå¯ä»¥æ˜¯ï¼š âˆ‘i=0nâˆ‘j=0n(âˆ’1)i+j(ni)(nj)k(nâˆ’i)(nâˆ’j)(kâˆ’1)ni+njâˆ’ij\\sum_{i=0}^n\\sum_{j=0}^n(-1)^{i+j}\\binom{n}{i}\\binom{n}{j}k^{(n-i)(n-j)}(k-1)^{ni+nj-ij} i=0âˆ‘nâ€‹j=0âˆ‘nâ€‹(âˆ’1)i+j(inâ€‹)(jnâ€‹)k(nâˆ’i)(nâˆ’j)(kâˆ’1)ni+njâˆ’ij è¿™æ ·å°±å¯ä»¥ n2logâ¡nn^2\\log nn2logn å•¦ï¼ ç„¶åæˆ‘ä»¬è€ƒè™‘ç»§ç»­ä¼˜åŒ–ã€‚ æˆ‘ä»¬è§‚å¯Ÿåé¢é‚£åªâˆ‘\\sumâˆ‘ï¼š âˆ‘j=0n(âˆ’1)j(nj)k(nâˆ’i)(nâˆ’j)(kâˆ’1)ni+njâˆ’ij\\sum_{j=0}^n(-1)^j\\binom{n}{j}k^{(n-i)(n-j)}(k-1)^{ni+nj-ij} j=0âˆ‘nâ€‹(âˆ’1)j(jnâ€‹)k(nâˆ’i)(nâˆ’j)(kâˆ’1)ni+njâˆ’ij æˆ‘ä»¬å‘ç°å¥¹å¯ä»¥è½¬æ¢æˆä¸€ä¸ªäºŒé¡¹å¼å±•å¼€çš„å½¢å¼ï¼Œä¹Ÿå°±æ˜¯æŠŠåé¢çš„ (kâˆ’1)ni+njâˆ’ij(k-1)^{ni+nj-ij}(kâˆ’1)ni+njâˆ’ij çœ‹æˆæ˜¯(kâˆ’1)i(nâˆ’j)â‹…(kâˆ’1)nj(k-1)^{i(n-j)}\\cdot(k-1)^{nj}(kâˆ’1)i(nâˆ’j)â‹…(kâˆ’1)njï¼š âˆ‘j=0n(nj)(knâˆ’i(kâˆ’1)i)nâˆ’j(âˆ’(kâˆ’1)n)j=(knâˆ’i(kâˆ’1)iâˆ’(kâˆ’1)n)n\\sum_{j=0}^n\\binom{n}{j}\\left(k^{n-i}(k-1)^i\\right)^{n-j}\\left(-(k-1)^n\\right)^j=\\left(k^{n-i}(k-1)^i-(k-1)^n\\right)^n j=0âˆ‘nâ€‹(jnâ€‹)(knâˆ’i(kâˆ’1)i)nâˆ’j(âˆ’(kâˆ’1)n)j=(knâˆ’i(kâˆ’1)iâˆ’(kâˆ’1)n)n äºæ˜¯æœ€ç»ˆç­”æ¡ˆå°±å˜æˆäº†ï¼š âˆ‘i=0n(âˆ’1)i(ni)(knâˆ’i(kâˆ’1)iâˆ’(kâˆ’1)n)n\\sum_{i=0}^n(-1)^i\\binom{n}{i}\\left(k^{n-i}(k-1)^i-(k-1)^n\\right)^n i=0âˆ‘nâ€‹(âˆ’1)i(inâ€‹)(knâˆ’i(kâˆ’1)iâˆ’(kâˆ’1)n)n å¤æ‚åº¦O(nlogâ¡n)\\mathcal{O}(n\\log n)O(nlogn)ã€‚","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"CodeForces","slug":"CodeForces","permalink":"https://pufanyi.github.io/oi-blog/tags/CodeForces/"}]},{"title":"æ–°å‘","slug":"cfdpproblems","date":"2019-08-03T16:00:00.000Z","updated":"2023-12-25T16:08:27.936Z","comments":true,"path":"cfdpproblems/","link":"","permalink":"https://pufanyi.github.io/oi-blog/cfdpproblems/","excerpt":"å†³å®šå¼€ä¸ªæ–°å‘ï¼Œåˆ·ä¸€äº›CFä¸Šçš„dpé¢˜ã€‚ ç°åœ¨åšäº†å‡ é¢˜ï¼š 10","text":"å†³å®šå¼€ä¸ªæ–°å‘ï¼Œåˆ·ä¸€äº› CF ä¸Šçš„ dp é¢˜ã€‚ ç°åœ¨åšäº†å‡ é¢˜ï¼š 10 [2019.8.5]å¿½ç„¶å‘ç° stoxielinhanorz æ€ä¹ˆä»€ä¹ˆé¢˜éƒ½åšè¿‡å•Šï¼Œæœç„¶æ˜¯ç¥ä»™â€¦â€¦ [2019.8.6]å¤§å®¶å¿«çœ‹è¿™é‡Œæœ‰ä¸ªå« pufanyi çš„æ²™é›•è‡ªé—­äº†ï¼š æœç„¶ä»–æ˜¯ä¸ªèœé¸¡â€¦â€¦ [2019.9.21]æ–‡åŒ–è¯¾çœŸé¦™â€¦â€¦æ„Ÿè§‰å¥½ä¹…æ²¡åšé¢˜äº†â€¦â€¦ CodeForces 913F Strongly Connected Tournament æœ‰ nnn ä¸ªå›½é™…è±¡æ£‹æ£‹æ‰‹ï¼Œä»–ä»¬å…ˆä¸¤ä¸¤æ¯”èµ›ï¼Œå®åŠ›å¼ºçš„ä¼šæœ‰ ppp çš„æ¦‚ç‡æ‰“è´¥å®åŠ›å¼±çš„ï¼ˆpppä»å¤´è‡³å°¾éƒ½æ˜¯ç›¸åŒçš„ï¼‰ï¼Œç„¶åèµ¢å¾—æŠŠè¾¹è¿å‘è´¥çš„ã€‚ç„¶åå†æŠŠæ¯ä¸ªå¼ºè¿é€šåˆ†é‡çš„æŠ å‡ºæ¥ç»§ç»­åšï¼ŒçŸ¥é“æ‰€æœ‰äººéƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„æ’åã€‚æ±‚å…±æœŸæœ›ä¸‹æ£‹å¤šå°‘ç›˜ã€‚ æˆ‘ä»¬ä»¤ fif_ifiâ€‹ è¡¨ç¤ºæœ‰ iii åæ£‹æ‰‹çš„ç­”æ¡ˆï¼Œæˆ‘ä»¬è€ƒè™‘è½¬ç§»ã€‚ æˆ‘ä»¬æœ‰ï¼š fi=âˆ‘j=1ngi,jsj(fj+fiâˆ’j+i(iâˆ’j)+j(jâˆ’1)2)f_i=\\sum_{j=1}^{n} g_{i,j}s_{j}\\left(f_j+f_{i-j}+i(i-j)+\\frac{j(j-1)}{2}\\right) fiâ€‹=j=1âˆ‘nâ€‹gi,jâ€‹sjâ€‹(fjâ€‹+fiâˆ’jâ€‹+i(iâˆ’j)+2j(jâˆ’1)â€‹) å…¶ä¸­ gi,jg_{i,j}gi,jâ€‹ è¡¨ç¤ºä» iii ä¸ªç‚¹ä¸­é€‰å‡º jjj ä¸ªç‚¹è€Œè¿™ jjj ä¸ªç‚¹å‡è¢«å¦å¤– iâˆ’ji-jiâˆ’j ä¸ªç‚¹æ‰“è´¥çš„æ¦‚ç‡ï¼Œsis_isiâ€‹è¡¨ç¤º iii ä¸ªç‚¹æ˜¯å¼ºè¿é€šåˆ†é‡çš„æ¦‚ç‡ã€‚ å¤§æ¦‚æ€è·¯å°±æ˜¯æšä¸¾ä¸€ä¸‹ åªè¦æˆ‘ä»¬ç®—å‡º sis_isiâ€‹ å’Œgi,jg_{i,j}gi,jâ€‹ï¼Œå‰©ä¸‹çš„å°±æ˜¯è§£æ–¹ç¨‹çš„é—®é¢˜äº†ã€‚ æˆ‘ä»¬è€ƒè™‘ gi,jg_{i,j}gi,jâ€‹ çš„è½¬ç§»ã€‚ æˆ‘ä»¬è€ƒè™‘æœ€åä¸€ä¸ªèŠ‚ç‚¹æ˜¯å¦é€‰å…¥ jjj ä¸ªçš„è¿™ä¸ªé›†åˆä¸­ï¼š gi,j=piâˆ’jgiâˆ’1,jâˆ’1+(1âˆ’p)jgiâˆ’1,jg_{i,j}=p^{i-j}g_{i-1,j-1}+(1-p)^{j}g_{i-1,j} gi,jâ€‹=piâˆ’jgiâˆ’1,jâˆ’1â€‹+(1âˆ’p)jgiâˆ’1,jâ€‹ ç„¶åæˆ‘ä»¬è€ƒè™‘sis_isiâ€‹ã€‚ æˆ‘ä»¬è€ƒè™‘ç”¨ ggg è½¬ç§»sssï¼š si=1âˆ’âˆ‘j=1iâˆ’1sjgi,js_i=1-\\sum_{j=1}^{i-1} s_jg_{i,j} siâ€‹=1âˆ’j=1âˆ‘iâˆ’1â€‹sjâ€‹gi,jâ€‹ ä»£ç ï¼š58105715 CodeForces 908G New Year and Original Order ç»™ nâ‰¤10700n\\le 10^{700}nâ‰¤10700ï¼Œé—®111 åˆ°nnnä¸­æ¯ä¸ªæ•°åœ¨å„æ•°ä½æ’åºåå¾—åˆ°çš„æ•°çš„å’Œã€‚ç­”æ¡ˆè†œ109+710^9+7109+7ã€‚[1] ä¸€é“æœ‰è¶£çš„æ•°ä½ dpã€‚ æˆ‘ä»¬ä»¤ fi,j,k,[0/1]f_{i,j,k,[0/1]}fi,j,k,[0/1]â€‹ è¡¨ç¤ºä»é«˜åˆ°ä½ç¬¬ iii ä½ï¼Œå…±æœ‰ jjj ä¸ªæ•°è¶…è¿‡kkkï¼Œæ˜¯å¦å¡ä¸Šç•Œï¼ˆ[0/1][0/1][0/1]ï¼‰ã€‚ è½¬ç§»æ¯”è¾ƒç®€å•ï¼š 1f[i + 1][j + (p &gt;= k)][k][K &amp;&amp; (p == d[i + 1])] += f[i][j][k][K]; è€ƒè™‘ç»Ÿè®¡ç­”æ¡ˆï¼Œå†·ï¼ˆdaï¼‰é™ï¼ˆkaiï¼‰æ€ï¼ˆtiï¼‰è€ƒï¼ˆjieï¼‰ä¹‹åå°±ä¼šå‘ç°æ˜¯è¿™ä¸ªï¼š âˆ‘(fn,i,j,0+fn,i,j,1)Ã—11â‹¯111âŸiä¸ª1\\sum \\left(f_{n,i,j,0}+f_{n,i,j,1}\\right)\\times \\underbrace{11\\cdots 111}_{i\\text{ä¸ª}1} âˆ‘(fn,i,j,0â€‹+fn,i,j,1â€‹)Ã—iä¸ª111â‹¯111â€‹â€‹ ä»£ç ï¼š58147084 CodeForces 889E Mod Mod Mod ç»™å‡ºé•¿åº¦ä¸º n(nâ‰¤200000)n(n\\le 200000)n(nâ‰¤200000) çš„åºåˆ— {a}\\{a\\}{a}ï¼Œå®šä¹‰f(x,i)(xâ‰¥0,iâ‰¥1)f(x,i)(x\\ge 0,i\\ge 1)f(x,i)(xâ‰¥0,iâ‰¥1) ä¸ºï¼š f(x,i)={x mod aii=nx mod ai+f(x mod ai,i+1)1â‰¤i&lt;nf(x,i)= \\begin{cases} x\\bmod a_i&amp; i=n\\\\ x\\bmod a_i + f(x\\bmod a_i,i+1)&amp; 1\\le i &lt; n \\end{cases} f(x,i)={xmodaiâ€‹xmodaiâ€‹+f(xmodaiâ€‹,i+1)â€‹i=n1â‰¤i&lt;nâ€‹ æ±‚ f(x,1)f(x,1)f(x,1) çš„æœ€å¤§å€¼ã€‚ ç¥ä»™çš„çŠ¶æ€å®šä¹‰ã€‚ æˆ‘ä»¬è€ƒè™‘æŠŠç­”æ¡ˆåˆ†è§£ä¸º ki+bki+bki+b çš„å½¢å¼ï¼Œiiiè¡¨ç¤ºçš„æ˜¯åšåˆ° aia_iaiâ€‹ çš„æ—¶å€™ã€‚ æˆ‘ä»¬è€ƒè™‘ gi,jg_{i,j}gi,jâ€‹ è¡¨ç¤ºåˆ°ç¬¬ iii ä¸ªæ•°ï¼Œk=jk=jk=jæ—¶æœ€å¤§çš„bbbã€‚è¿™æ ·ç­”æ¡ˆå°±æ˜¯maxâ¡i=0âˆni+gn,i\\max_{i=0}^{\\infty}ni+g_{n,i}maxi=0âˆâ€‹ni+gn,iâ€‹ã€‚ æˆ‘ä»¬è€ƒè™‘ä¼˜åŒ–è¿™ä¸ªæ–¹ç¨‹ã€‚ é¦–å…ˆæˆ‘ä»¬éœ€è¦å‘ç°ä¸€ä¸ªæ€§è´¨ï¼šæœ€ä¼˜æ–¹æ¡ˆä¸€å®šæœ‰æŸä¸ªä½™æ•°ä¸º aiâˆ’1a_i-1aiâ€‹âˆ’1ï¼Œå¦åˆ™æ•´ä½“+1+1+1 å³å¯ã€‚[2] äºæ˜¯æˆ‘ä»¬å‘ç°ï¼Œå…¶å®åªè¦è€ƒè™‘æ˜¯å“ªæ¬¡å–æ¨¡åå˜æˆ aiâˆ’1a_i-1aiâ€‹âˆ’1 å³å¯ã€‚ æˆ‘ä»¬è€ƒè™‘åœ¨ dp ä¸­ä½“ç°ã€‚ æˆ‘ä»¬å‘ç°è®¸å¤šçŠ¶æ€æ˜¯å†—ä½™çš„ï¼Œå› ä¸ºå¯ä»¥ä»ä¸€äº›çŠ¶æ€è®¡ç®—å‡ºå¦ä¸€äº›çŠ¶æ€çš„ç­”æ¡ˆã€‚ äº‹å®ä¸Šå°±æ˜¯æ•´ä½“ä¸Šç§»å’Œæ•´ä½“ä¸‹ç§»ã€‚ äºæ˜¯æˆ‘ä»¬æœ‰è½¬ç§»æ–¹ç¨‹ï¼š {fi+1,x mod aiâ†fi,x+(xâˆ’x mod ai)Ã—(iâˆ’1)ï¼ˆä¹‹å‰å·²ç»æ˜¯å¡ä¸Šç•Œäº†ï¼Œè¿™æ¬¡ç›´æ¥å–æ¨¡ï¼‰fi+1,aiâ†fi,x+ai+1(xâˆ’x mod aiâˆ’ai)Ã—(iâˆ’1)ï¼ˆæ¯”è¾ƒéš¾ç†è§£ï¼Œç”»ä¸ªå›¾ä¼šæ¯”è¾ƒæ¸…æ™°ï¼Œå¤§æ¦‚æ˜¯æ•´ä½“ä¸‹ç§»äº†ä¸€äº›ï¼Œä½¿å¾—x mod ai=aiâˆ’1ï¼‰\\begin{cases} f_{i+1,x\\bmod a_i}\\leftarrow f_{i,x}+(x-x\\bmod a_i)\\times(i-1)&amp;\\text{ï¼ˆä¹‹å‰å·²ç»æ˜¯å¡ä¸Šç•Œäº†ï¼Œè¿™æ¬¡ç›´æ¥å–æ¨¡ï¼‰}\\\\ f_{i+1,a_i}\\leftarrow f_{i,x}+a_{i+1}(x-x\\bmod a_i - a_i)\\times(i-1)&amp;\\text{ï¼ˆæ¯”è¾ƒéš¾ç†è§£ï¼Œç”»ä¸ªå›¾ä¼šæ¯”è¾ƒæ¸…æ™°ï¼Œå¤§æ¦‚æ˜¯æ•´ä½“ä¸‹ç§»äº†ä¸€äº›ï¼Œä½¿å¾— $x\\bmod a_i=a_i-1$ï¼‰} \\end{cases} {fi+1,xmodaiâ€‹â€‹â†fi,xâ€‹+(xâˆ’xmodaiâ€‹)Ã—(iâˆ’1)fi+1,aiâ€‹â€‹â†fi,xâ€‹+ai+1â€‹(xâˆ’xmodaiâ€‹âˆ’aiâ€‹)Ã—(iâˆ’1)â€‹ï¼ˆä¹‹å‰å·²ç»æ˜¯å¡ä¸Šç•Œäº†ï¼Œè¿™æ¬¡ç›´æ¥å–æ¨¡ï¼‰ï¼ˆæ¯”è¾ƒéš¾ç†è§£ï¼Œç”»ä¸ªå›¾ä¼šæ¯”è¾ƒæ¸…æ™°ï¼Œå¤§æ¦‚æ˜¯æ•´ä½“ä¸‹ç§»äº†ä¸€äº›ï¼Œä½¿å¾—xmodaiâ€‹=aiâ€‹âˆ’1ï¼‰â€‹ è¿™ä¸ªä¸œè¥¿ç›´æ¥ç”¨ map ç»´æŠ¤å³å¯ã€‚ ä¸€ä¸ªç»“è®ºæ˜¯å¦‚æœ x&gt;yx&gt;yx&gt;yï¼Œåˆ™x mod yâ‰¤x2x\\bmod y\\le \\frac{x}{2}xmodyâ‰¤2xâ€‹ã€‚è¿™ä¸ªä¸œè¥¿å¥½åƒæ›¾ç» cf æœ‰é“æ•°æ®ç»“æ„é¢˜å°±ç”¨çš„æ˜¯è¿™ä¸ªç»“è®ºã€‚å¤§æ¦‚å°±æ˜¯è€ƒè™‘yâ‰¤x2y\\le \\frac{x}{2}yâ‰¤2xâ€‹ å’Œy&gt;x2y&gt;\\frac{x}{2}y&gt;2xâ€‹è®¨è®ºå³å¯ã€‚æ‰€ä»¥å¤æ‚åº¦æ˜¯O(nlogâ¡nlogâ¡a1)\\mathcal{O}(n\\log n\\log a_1)O(nlognloga1â€‹) ä»£ç ï¼š58244734 CodeForces 886E Maximum Element é¢˜æ„å°±æ˜¯æœ‰ä¸€ä¸ªè€å“¥å‘æ˜äº†ä¸€ç§ ç¥å¥‡çš„ æ±‚åºåˆ—æœ€å¤§å€¼çš„ç®—æ³•ï¼š 12345678910111213141516int fast_max(int n, int a[]) &#123; int ans = 0; int offset = 0; for (int i = 0; i &lt; n; ++i) &#123; if (ans &lt; a[i]) &#123; ans = a[i]; offset = 0; &#125; else &#123; offset = offset + 1; if (offset == k) &#123; return ans; &#125; &#125; &#125; return ans;&#125; çœ‹èµ·æ¥æŒºç‰›çš®ï¼Œä½†æ˜¯æœ‰ä¸€å®šé”™è¯¯ç‡ã€‚ç»™å‡º n,kn,kn,kï¼Œæ±‚æœ‰å¤šå°‘ä¸ª1âˆ¼n1\\sim n1âˆ¼n çš„æ’åˆ—èƒ½æŠŠè¿™ä½è€å“¥ç»™å¡æ‰ï¼Œç­”æ¡ˆå¯¹ 109+710^9+7109+7 å–æ¨¡ã€‚ æˆ‘ä»¬ä»¤ fif_ifiâ€‹ è¡¨ç¤ºé•¿åº¦ä¸º iii çš„æ’åˆ—æ—¶ï¼Œä¸” iii åœ¨ç¬¬ iii ä¸ªæ•°çš„ç­”æ¡ˆã€‚ è½¬ç§»æ—¶æˆ‘ä»¬è€ƒè™‘ç¬¬ iâˆ’1i-1iâˆ’1 ä¸ªæ•°æ”¾åœ¨å“ªå„¿ï¼š å¦‚æœæ”¾åœ¨å‰ iâˆ’kâˆ’1i-k-1iâˆ’kâˆ’1 ä½ï¼Œå› ä¸ºäºŒå…ƒç»„ (iâˆ’1,i)(i-1,i)(iâˆ’1,i) æ˜¯ä¸åˆæ³•çš„ï¼Œæ‰€ä»¥å¦å¤–çš„å¯ä»¥ä¹±æ”¾ï¼Œå³(iâˆ’kâˆ’1)â‹…(iâˆ’2)!(i-k-1)\\cdot (i-2)!(iâˆ’kâˆ’1)â‹…(iâˆ’2)!ã€‚ å¦‚æœæ”¾åœ¨æœ€å kkk ä½ï¼ˆå½“ç„¶æœ€åä¸€ä½æ˜¯ iiiï¼‰ï¼Œé‚£ä¹ˆå‡è®¾å®ƒæ”¾åœ¨äº†ç¬¬jjj ä½ï¼Œåˆ™ jâˆ¼ij\\sim ijâˆ¼i è¿™ä¸€æ®µè‚¯å®šæ˜¯åˆæ³•çš„ï¼Œæ‰€ä»¥æœ‰ Piâˆ’2iâˆ’jâˆ’1=(iâˆ’2)!(jâˆ’1)!P_{i-2}^{i-j-1}=\\frac{(i-2)!}{(j-1)!}Piâˆ’2iâˆ’jâˆ’1â€‹=(jâˆ’1)!(iâˆ’2)!â€‹ ç§æ–¹æ¡ˆï¼Œåˆå› ä¸ºå‰ jjj ä¸ªå¿…é¡»ä¸åˆæ³•ï¼Œæ‰€ä»¥æœ‰ fjf_jfjâ€‹ ç§æ–¹æ¡ˆã€‚ç»¼ä¸Šï¼Œæœ‰ fjâ‹…(iâˆ’2)(jâˆ’1)!f_j\\cdot \\frac{(i-2)}{(j-1)!}fjâ€‹â‹…(jâˆ’1)!(iâˆ’2)â€‹ ç§æ–¹æ¡ˆã€‚ ç»¼ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°æ–¹ç¨‹ï¼š fi=(iâˆ’kâˆ’1)â‹…(nâˆ’2)!+âˆ‘j=iâˆ’kiâˆ’1fjâ‹…(iâˆ’2)!(jâˆ’1)!f_i=(i-k-1)\\cdot(n-2)!+\\sum_{j=i-k}^{i-1}f_j\\cdot \\frac{(i-2)!}{(j-1)!} fiâ€‹=(iâˆ’kâˆ’1)â‹…(nâˆ’2)!+j=iâˆ’kâˆ‘iâˆ’1â€‹fjâ€‹â‹…(jâˆ’1)!(iâˆ’2)!â€‹ å‘ç°è¿™ä¸ª âˆ‘\\sumâˆ‘ å¯ä»¥å‰ç¼€å’Œï¼Œç»´æŠ¤ä¸€ä¸‹å°±å˜æˆ O(n)\\mathcal{O}(n)O(n) çš„äº†ã€‚ ä»£ç ï¼š58319515 CodeForces 878E Numbers on the blackboard æœ‰ä¸€ä¸ªé•¿åº¦ä¸º nnn çš„åºåˆ— {a}\\{a\\}{a}ï¼Œæ¯æ¬¡è¯¢é—®å…¶ä¸­ä¸€æ®µåŒºé—´[l,r][l,r][l,r]ï¼Œå¯¹è¿™ä¸ªåŒºé—´å†…éƒ¨çš„ç‚¹è¿›è¡Œæ“ä½œï¼Œæ¯æ¬¡æ“ä½œå¯ä»¥æ‰¾åˆ°ä¸¤ä¸ªç›¸é‚»çš„æ•°x,yx,yx,y å°†å…¶åˆå¹¶æˆ x+2yx+2yx+2yï¼Œè¯¢é—®æŠŠè¿™ä¸ªåŒºé—´ç¼©æˆä¸€ä¸ªæ•°æ˜¯ï¼Œè¿™ä¸ªæ•°æœ€å¤§å¯èƒ½æ˜¯å¤šå°‘ï¼Œæ¯ä¸ªè¯¢é—®ç‹¬ç«‹ï¼Œç­”æ¡ˆå¯¹109+710^9+7109+7 å–æ¨¡ã€‚ ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œäº¤äº† 60 å¤šå‘è¿˜æ˜¯T on 40ï¼Œç„¶åå°±å»è†œæ‹œåˆ«äººä»£ç äº†â€¦â€¦ æˆ‘ä»¬å‘ç°å…¶å®å°±æ˜¯æ±‚âˆ‘i=lr2kiai\\sum_{i=l}^r 2^{k_i}a_iâˆ‘i=lrâ€‹2kiâ€‹aiâ€‹ï¼Œå…¶ä¸­kl=0k_l=0klâ€‹=0ï¼Œå…¶ä½™çš„kiâˆˆ[1,kiâˆ’1+1]k_i\\in [1, k_{i-1}+1]kiâ€‹âˆˆ[1,kiâˆ’1â€‹+1]ã€‚ é‚£ä¹ˆæˆ‘ä»¬å‘ç°ï¼Œå¯¹äºæ¯ä¸€ä¸ªè¯¢é—®ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥æŠŠ kkk åˆ†æˆè‹¥å¹²æ®µåŒºé—´ï¼Œæ¯ä¸€æ®µåŒºé—´ [s,t][s, t][s,t] è¡¨ç¤ºks=1k_s=1ksâ€‹=1ï¼Œki=kiâˆ’1+1(iâˆˆ(s,t])k_i=k_{i-1}+1(i\\in \\left(s, t\\right])kiâ€‹=kiâˆ’1â€‹+1(iâˆˆ(s,t])ï¼Œå½“ç„¶ï¼Œç¬¬ä¸€æ®µks=0k_s=0ksâ€‹=0ã€‚ æˆ‘ä»¬è€ƒè™‘ç¦»çº¿æšä¸¾å³ç«¯ç‚¹ rrrï¼Œæ˜¾ç„¶ï¼Œå¦‚æœar&lt;0a_r&lt;0arâ€‹&lt;0ï¼Œé‚£ä¹ˆara_rarâ€‹ å•ç‹¬æˆä¸€æ®µï¼Œå¦åˆ™ä¸å‰ä¸€æ®µåˆå¹¶ï¼ŒçŸ¥é“è¯¥æ®µçš„å€¼å°äº 000ï¼Œæˆ‘ä»¬å‘ç°åˆå¹¶æ˜¯O(1)\\mathcal{O}(1)O(1) çš„ï¼ˆç„¶è€Œä¸€å¼€å§‹çš„æ—¶å€™æˆ‘ç¡¬ç”Ÿç”Ÿåœ°å†™æˆäº†logâ¡\\loglogï¼‰ã€‚ æˆ‘ä»¬è€ƒè™‘ç”¨å¹¶æŸ¥é›†ç»´æŠ¤æ¯ä¸€æ®µï¼Œæ¯æ¬¡æŸ¥è¯¢å³å¯ã€‚ ä¸è¿‡è®²é“ç†è¿™è·Ÿ dp æœ‰å…³ç³»å—ï¼Ÿä¸ç®¡åæ­£æ ‡ç­¾æœ‰dpã€‚ ä»£ç ï¼š58520589 CodeForces 924E Wardrobe æœ‰ n(nâ‰¤104)n(n\\le 10^4)n(nâ‰¤104) ä¸ªç®±å­ï¼Œæ¯ä¸ªç®±å­æœ‰ä¸€ä¸ªé«˜åº¦hi(âˆ‘hiâ‰¤104)h_i(\\sum h_i\\le 10^4)hiâ€‹(âˆ‘hiâ€‹â‰¤104)ï¼Œä¸€äº›ç®±å­æ˜¯é‡è¦çš„ã€‚ç°åœ¨è¦æŠŠæ‰€æœ‰ç®±å­å æ”¾åœ¨ä¸€èµ·ã€‚é—®æœ‰å¤šå°‘ä¸ªç®±å­åº•éƒ¨çš„é«˜åº¦ä½äº[l,r][l,r][l,r]ã€‚ ä¸€é“æœ‰è¶£çš„èƒŒåŒ…é—®é¢˜ï¼Œæ„Ÿè§‰è·Ÿé‚£é“ å°çŸ®äºº å·®ä¸å¤šã€‚ é¦–å…ˆæˆ‘ä¹ˆéœ€è¦å‘ç°ä¸€ä¸ªæ€§è´¨ï¼Œé‚£å°±æ˜¯æœ€ä¼˜è§£è‚¯å®šæ˜¯å…ˆä¸€æ®µä¸é‡è¦çš„ï¼Œåœ¨ä¸€æ®µé‡è¦çš„ï¼Œæœ€åä¸€æ®µä¸é‡è¦çš„ã€‚æ­£ç¡®æ€§æ˜¾ç„¶ã€‚ æˆ‘ä»¬è€ƒè™‘åˆ°ç®±å­åº•éƒ¨æ¯”è¾ƒéš¾å—ï¼Œäºæ˜¯æˆ‘ä»¬æƒ³åˆ°ç”¨æŠŠæ•´ä¸ªç³»ç»Ÿå€’è¿‡æ¥ï¼Œè¿™æ ·æˆ‘ä»¬å°±ç›¸å½“äºæ˜¯åœ¨è€ƒè™‘ç®±å­é¡¶éƒ¨äº†ã€‚ æˆ‘ä»¬å‘ç°æˆ‘ä»¬éœ€è¦çŸ¥é“è¿™æ ·ä¸€äº›ä¸œè¥¿ï¼šæœ€ä½ç«¯é‚£äº›ä¸é‡è¦çš„ç®±å­æ˜¯é‚£äº›ï¼ˆå› ä¸ºé¡ºåºæ— å…³ï¼‰ï¼Œå½“ç„¶è¿™æ ·å…¶å®ä¹ŸçŸ¥é“äº†æœ€é¡¶ç«¯çš„æƒ…å†µã€‚ æˆ‘ä»¬è¿˜éœ€è¦çŸ¥é“é‡è¦ç®±å­çš„æ’åˆ—æƒ…å†µã€‚ å…ˆè€ƒè™‘ä¸é‡è¦çš„ç®±å­ï¼Œæˆ‘ä»¬å‘ç°è¿™äº›ç®±å­åªæ˜¯ç»™æˆ‘ä»¬æ‰“ä¸€ä¸ªâ€œåº•åº§â€ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥ dp å‡ºæ¥ï¼Œå…¶å®å°±æ˜¯ä¸ªèƒŒåŒ…ã€‚ ç„¶åæˆ‘ä»¬è€ƒè™‘é‡è¦çš„ç®±å­ã€‚ æœ‰ä¸€ä¸ªç»“è®ºæ˜¯æŠŠè¿™äº›é‡è¦çš„ç®±å­ä»å¤§åˆ°å°æ’åºï¼Œç„¶åç›´æ¥åšä¸€éèƒŒåŒ…ï¼ˆåœ¨ä¹‹å‰ä¸é‡è¦çš„ç®±å­çš„é‚£ä¸ª dp æ•°ç»„ä¹‹ä¸Šç›´æ¥åšå°±å¯ä»¥äº†ï¼‰å°±æ˜¯å¯¹çš„ã€‚ é‚£ä¸ºä»€ä¹ˆè¦ä»å¤§åˆ°å°æ’åºå‘¢ï¼Ÿ æˆ‘ä»¬è€ƒè™‘è¿™ä¸ªèƒŒåŒ…çš„æœ¬è´¨å…¶å®å°±æ˜¯å…ˆæŠŠè¿™äº›ç®±å­æŒ‰ç…§ä¸€å®šé¡ºåºä»ä¸‹å¾€ä¸Šæ’ï¼Œæˆ‘ä»¬å¯ä»¥åˆ æ‰ä»»æ„å¤šçš„ç®±å­ä½¿å¾— [l,r][l,r][l,r] å†…é‡è¦çš„ç®±å­é¡¶æœ€å¤šã€‚ æˆ‘ä»¬å¤§æ¦‚è€ƒè™‘æ˜¯æŠŠæœ€å°çš„é‚£äº›æ”¾åœ¨ [l,r][l,r][l,r] å†…ï¼Œè€Œä¸€äº›å¤§çš„è¦ä¹ˆåˆ æ‰ï¼Œè¦ä¹ˆå’Œä¸é‡è¦çš„ç®±å­ä¸€èµ·å½“â€œåº•åº§â€ã€‚ æ‰€ä»¥æˆ‘ä»¬è€ƒè™‘ä»å¤§åˆ°å°æ’åºï¼Œå¦‚æœä¸åˆ ï¼Œå°±æ˜¯å½“â€œåº•åº§â€ï¼Œå¦åˆ™å°±æ˜¯æŠŠå®ƒåˆ æ‰ã€‚ ä»£ç ï¼š58638973 CodeForces 1218A BubbleReactor ç»™ä½  n(3â‰¤nâ‰¤15000)n(3\\le n\\le 15000)n(3â‰¤nâ‰¤15000) ä¸€æ£µç¯å¥—æ ‘ï¼Œä¸€å¼€å§‹å…¨æ˜¯ç™½ç‚¹ã€‚å…ˆç»™ä¸€ä¸ªç‚¹æŸ“æˆé»‘è‰²ï¼Œè·å¾— nnn çš„æ”¶ç›Šã€‚ç„¶åæ¯æ¬¡å¯ä»¥é€‰æ‹©ä¸€ä¸ªä¸é»‘è‰²ç‚¹ç›¸é‚»çš„ç™½ç‚¹å¹¶å°†å…¶æŸ“æˆé»‘è‰²ï¼Œè·å¾—æ”¶ç›Šæ˜¯å…¶æ‰€åœ¨è¿é€šå—çš„å¤§å°ã€‚æ±‚æœ€å¤§æ”¶ç›Šã€‚ O(n2)\\mathcal{O}(n^2)O(n2)å±…ç„¶è¿‡äº†ï¼Œç„¶åå»å›´è§‚äº†ä¸€ä¸‹æ ‡ç®—å‘ç°ä¹Ÿæ˜¯ O(n2)\\mathcal{O}(n^2)O(n2) çš„ã€‚ CF æœºå­çœŸå¿«ã€‚ æŠŠç¯ä¸Šçš„è¾¹å…¨éƒ¨åˆ é™¤ï¼Œä»¥æ¢ä¸Šç‚¹ä¸ºæ ¹ï¼Œå¯ä»¥å¾—åˆ°ä¸€ä¸ªæ£®æ—ã€‚ å…ˆä»¤ fif_ifiâ€‹ è¡¨ç¤ºä» iii å¼€å§‹æŠŠ iii çš„æ‰€æœ‰å­æ ‘å…¨éƒ¨æŸ“é»‘æ‰€èƒ½è·å¾—çš„ä»£ä»·ï¼Œè¿™ä¸ªå¾ˆå¥½dpã€‚ ç„¶åä»¤ gig_igiâ€‹ è¡¨ç¤ºä» iii ç‚¹å¼€å§‹å¾€å­æ ‘å¤–æŠŠ iii çš„æ‰€æœ‰å­æ ‘å…¨éƒ¨æŸ“é»‘æ‰€è·å¾—çš„ä»£ä»·ã€‚ç‰¹æ®Šåœ°ï¼Œç¬¬ä¸€æ¬¡ä¹Ÿå°±æ˜¯æŸ“ç¬¬ iii ä¸ªç‚¹æ—¶çš„è´¡çŒ®ä¸º nâˆ’sin-s_inâˆ’siâ€‹ è€Œä¸æ˜¯ nâˆ’si+1n-s_i+1nâˆ’siâ€‹+1ï¼Œå…¶ä¸­sis_isiâ€‹ è¡¨ç¤º iii çš„å­æ ‘å¤§å°ã€‚å› ä¸ºè¿™æ ·æ‰èƒ½è®© fi+gif_i+g_ifiâ€‹+giâ€‹ ç›´æ¥è¡¨ç¤ºä» iii ç‚¹å¼€å§‹æŸ“è‰²çš„ç­”æ¡ˆã€‚ æˆ‘ä»¬è€ƒè™‘å…ˆ dp å‡ºç¯ä¸Šçš„ ggg æ•°ç»„ï¼Œç„¶åå¾€å„¿å­dpã€‚ æˆ‘ä»¬ä»¤ hl,rh_{l,r}hl,râ€‹ è¡¨ç¤ºç¯ä¸Šå°† [l,r][l,r][l,r] è¿™äº›ç‚¹æŸ“é»‘å¹¶å°†å…¶å­æ ‘æŸ“é»‘çš„ç­”æ¡ˆï¼Œæ˜¾ç„¶hi,i=fih_{i,i}=f_ihi,iâ€‹=fiâ€‹ã€‚ æˆ‘ä»¬ä»¤ pre(i)pre(i)pre(i) è¡¨ç¤ºç¯ä¸Š iii çš„ä¸Šä¸€ä¸ªï¼Œnxt(i)nxt(i)nxt(i)è¡¨ç¤º iii çš„ä¸‹ä¸€ä¸ªï¼Œæ¯”å¦‚å¦‚æœç¯å¤§å°ä¸ºmmmï¼Œåˆ™nxt(m)=1,pre(1)=mnxt(m)=1,pre(1)=mnxt(m)=1,pre(1)=mã€‚ å¦‚æœ l&gt;rl&gt;rl&gt;rï¼Œé‚£å…¶å®å°±æ˜¯è¶Šè¿‡äº†mmm ç‚¹ï¼Œé‡æ–°å›åˆ°äº† 111 ç‚¹ã€‚ æˆ‘ä»¬æœ‰è½¬ç§»ï¼š hl,r=maxâ¡{hnxt(l),r+fl+âˆ‘kâˆˆ[nxt(l),r]sk,hl,pre(r)+fr+âˆ‘kâˆˆ[l,pre(r)]sk}h_{l,r}=\\max\\left\\{h_{nxt(l),r}+f_l+\\sum_{k\\in [nxt(l),r]}s_k,h_{l,pre(r)}+f_r+\\sum_{k\\in[l,pre(r)]}s_k\\right\\} hl,râ€‹=maxâ©âªâ¨âªâ§â€‹hnxt(l),râ€‹+flâ€‹+kâˆˆ[nxt(l),r]âˆ‘â€‹skâ€‹,hl,pre(r)â€‹+frâ€‹+kâˆˆ[l,pre(r)]âˆ‘â€‹skâ€‹â­âªâ¬âªâ«â€‹ äºæ˜¯æœ€ç»ˆç­”æ¡ˆ gi=hnxt(iåœ¨ç¯ä¸Šçš„ä½ç½® ),pre(i åœ¨ç¯ä¸Šçš„ä½ç½®)g_{i}=h_{nxt(\\text{$i$ åœ¨ç¯ä¸Šçš„ä½ç½®}),pre(\\text{$i$ åœ¨ç¯ä¸Šçš„ä½ç½®})} giâ€‹=hnxt(iåœ¨ç¯ä¸Šçš„ä½ç½® ),pre(i åœ¨ç¯ä¸Šçš„ä½ç½®)â€‹ æˆ‘ä»¬è€ƒè™‘å¯¹ hhh æ•°ç»„å‹ä½ã€‚ è€ƒè™‘åˆ° dp ç¬¬ä¸€å±‚å¾ªç¯æ˜¯æšä¸¾ lenlenlenï¼ˆå³râˆ’l+1r-l+1râˆ’l+1ï¼‰ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥ç›´æ¥ä»¤çŠ¶æ€ä¸ºhlen,lh_{len,l}hlen,lâ€‹ï¼Œç„¶åå°±å¯ä»¥æŠŠlenlenlen å‹æ‰äº†ã€‚ æœ€åä½™ä¸‹çš„ç‚¹ç›´æ¥ä»ä¸Šå¾€ä¸‹ dp å³å¯ã€‚ ä»£ç ï¼š60925813 CodeForces 1203F2 Complete the Projects (hard version) Div. 3 çš„é¢˜å¥½éš¾å•Šâ€¦â€¦ æœ‰ n(nâ‰¤100)n(n\\le 100)n(nâ‰¤100) ä¸ªä»»åŠ¡ï¼Œåˆå§‹æœ‰ä¸€ä¸ªåˆ†æ•° r(râ‰¤30000)r(r\\le 30000)r(râ‰¤30000)ï¼Œåšç¬¬iii ä¸ªä»»åŠ¡éœ€è¦è¾¾åˆ° ai(1â‰¤aiâ‰¤30000)a_i(1\\le a_i\\le 30000)aiâ€‹(1â‰¤aiâ€‹â‰¤30000) çš„åˆ†æ•°ï¼Œå®Œæˆååˆ†æ•°ä¼šå¢åŠ bi(âˆ’300â‰¤biâ‰¤300)b_i(-300\\le b_i\\le 300)biâ€‹(âˆ’300â‰¤biâ€‹â‰¤300)ã€‚æ¯ä¸€æ—¶åˆ»åˆ†æ•°éƒ½éœ€è¦å¤§äºç­‰äº000ï¼Œæ±‚æœ€å¤šèƒ½å®Œæˆçš„ä»»åŠ¡æ•°é‡ã€‚ é¦–å…ˆè‚¯å®šæƒ³åˆ°çš„æ˜¯èƒŒåŒ…ï¼Œå’Œ å°çŸ®äºº ï¼ˆå®Œäº†å»çœ‹é¢˜ç›®çš„æ—¶å€™å‘ç°ä¸ºä»€ä¹ˆç°åœ¨å°çŸ®äººå˜æˆnlogâ¡nn\\log nnlogn çš„äº†ï¼Œä¸ç®¡äº†ï¼Œå…ˆè®°å½•ä¸€ä¸‹ï¼Œå†™å®Œè¿™ç¯‡é¢˜è§£å†è¯´ï¼‰å·®ä¸å¤šï¼Œæˆ‘ä»¬è€ƒè™‘èƒŒåŒ…çš„é¡ºåºã€‚ æ˜¾ç„¶ biâ‰¥0b_i\\ge0biâ€‹â‰¥0 å’Œbi&lt;0b_i&lt;0biâ€‹&lt;0æ˜¯è¦åˆ†ç±»çš„ï¼Œå…ˆåš biâ‰¥0b_i\\ge 0biâ€‹â‰¥0 çš„ï¼Œå› ä¸º bi&lt;0b_i&lt;0biâ€‹&lt;0 çš„åªèƒ½è®©åˆ†æ•°ä¸‹é™ï¼Œåœ¨æœ€å‰é¢è‚¯å®šä¸ä¼˜ã€‚ æ˜¾ç„¶å¯¹äº biâ‰¥0b_i\\ge0biâ€‹â‰¥0 çš„ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹äº aia_iaiâ€‹ ä»å°åˆ°å¤§æ’åºã€‚ æˆ‘ä»¬è€ƒè™‘å¦‚ä½•å¯¹ bi&lt;0b_i&lt;0biâ€‹&lt;0 çš„è¿›è¡Œæ’åºã€‚ æˆ‘ä»¬å‡è®¾æœ‰ i,ji,ji,jï¼Œiii æ”¾åœ¨ jjj å‰é¢æ›´ä¼˜ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä¼˜ï¼Œé‚£åªèƒ½æ˜¯å¦‚æœå–å®Œ jjjï¼Œå°±ä¸èƒ½å†å–iii äº†ã€‚ æˆ‘ä»¬å‡è®¾å¼€å§‹æœ‰ rrr çš„ç§¯åˆ†ï¼Œæˆ‘ä»¬æœ‰ï¼š {râ‰¥maxâ¡(ai,aj)r+biâ‰¥ajr+bj&lt;ai\\begin{cases} r\\ge \\max(a_i,a_j)\\\\ r+b_i\\ge a_j\\\\ r+b_j&lt; a_i \\end{cases} â©âªâªâ¨âªâªâ§â€‹râ‰¥max(aiâ€‹,ajâ€‹)r+biâ€‹â‰¥ajâ€‹r+bjâ€‹&lt;aiâ€‹â€‹ äºæ˜¯æˆ‘ä»¬æœ‰ï¼š ajâˆ’biâ‰¤r&lt;aiâˆ’bja_j-b_i\\le r&lt;a_i-b_j ajâ€‹âˆ’biâ€‹â‰¤r&lt;aiâ€‹âˆ’bjâ€‹ å³ï¼š ai+bi&gt;aj+bja_i+b_i&gt;a_j+b_j aiâ€‹+biâ€‹&gt;ajâ€‹+bjâ€‹ äºæ˜¯æˆ‘ä»¬æŒ‰ ai+bia_i+b_iaiâ€‹+biâ€‹ ä»å¤§åˆ°å°æ’åºå³å¯ã€‚ ä»£ç ï¼š61593790 CodeForces 1234F One Node is Gone æ„Ÿè§‰ç°åœ¨æ²‰è¿·äº Div. 3 äº†â€¦â€¦ é¢˜ç›®å¤§æ„æ˜¯ç»™ä½ ä¸€ä¸ªå­—ç¬¦é›†ä¸º 202020ï¼Œé•¿åº¦ä¸º10610^6106 çš„å­—ç¬¦ä¸²ï¼Œä½ å¯ä»¥ç¿»è½¬å…¶ä¸­çš„ä¸€ä¸ªå­ä¸²ï¼Œä½¿æ“ä½œåçš„ä¸²æœ€å¤§å®Œç¾å­ä¸²æœ€é•¿ã€‚å®Œç¾å­ä¸²å°±æ˜¯è¯¥å­ä¸²ä¸­æ²¡æœ‰å­—ç¬¦æ˜¯ç›¸åŒçš„ã€‚ æ˜¾ç„¶å°±æ˜¯è®©ä½ æ‰¾ä¸¤ä¸ªä¸ç›¸äº¤çš„å­—ç¬¦ä¸²ä»–ä»¬æ‹¼èµ·æ¥æ˜¯å®Œç¾çš„ã€‚ ç„¶åæˆ‘ä»¬å‘ç°æˆ‘ä»¬ä¸ç”¨è€ƒè™‘ç›¸äº¤ï¼Œå› ä¸ºä¸¤ä¸ªå­ä¸²ç›¸äº¤å°±è‚¯å®šæ˜¯ä¸å®Œç¾çš„äº†ã€‚ è€ƒè™‘åˆ°æ‰¾åˆ°çš„ä¸¤ä¸ªä¸²é¦–å…ˆè‚¯å®šåˆ†åˆ«éƒ½æ˜¯å®Œç¾å­ä¸²ï¼Œæˆ‘ä»¬è€ƒè™‘æŠŠæ‰€æœ‰å®Œç¾å­ä¸²éƒ½æ‰¾å‡ºæ¥ã€‚ ä¸éš¾è¯æ˜æš´åŠ›æ‰¾å­ä¸²çš„å¤æ‚åº¦æ˜¯ O(nâˆ£âˆ‘âˆ£)\\mathcal O(n\\left|\\sum\\right|)O(nâˆ£âˆ‘âˆ£)ï¼Œå› ä¸ºå¯¹äºæ¯ä¸ªå­—ç¬¦ï¼Œä»¥ä»–ä»¬ä¸ºç»“å°¾çš„å®Œç¾å­ä¸²æœ€å¤šä¸è¿‡nnn ä¸ªã€‚ ç„¶åæˆ‘ä»¬ç›´æ¥ç±»ä¼¼é«˜ç»´å‰ç¼€å’Œä¸€æ ·é¢„å¤„ç†ä¸€ä¸‹é«˜ç»´å‰ç¼€maxâ¡\\maxmaxï¼Œæœ€åç»Ÿè®¡ä¸€ä¸‹ç­”æ¡ˆå³å¯ã€‚ ä»£ç ï¼š61748541 CodeForces 1218H Function Composition é¢˜ç›®å¤§æ„æ˜¯ç»™ä½ ä¸€ä¸ªé•¿åº¦ä¸º nnn çš„æ•°åˆ— aaaï¼Œå®šä¹‰f(x,y)={xy=0af(x,yâˆ’1)y&gt;0f(x,y)=\\begin{cases}x&amp;y=0\\\\a_{f(x,y-1)}&amp;y&gt;0\\end{cases}f(x,y)={xaf(x,yâˆ’1)â€‹â€‹y=0y&gt;0â€‹ï¼Œè®©ä½ æ±‚åœ¨1âˆ¼n1\\sim n1âˆ¼n ä¸­ï¼Œæœ‰å¤šå°‘ä¸ª xxx æ»¡è¶³ f(x,m)=yf(x,m)=yf(x,m)=yï¼Œqqq æ¬¡è¯¢é—®ï¼Œ1â‰¤nâ‰¤2â‹…105,1â‰¤aiâ‰¤n,1â‰¤qâ‰¤105,1â‰¤mâ‰¤1018,1â‰¤yâ‰¤n1\\le n\\le 2\\cdot 10^5,1\\le a_i\\le n,1\\le q\\le 10^5,1\\le m\\le {10}^{18},1\\le y\\le n1â‰¤nâ‰¤2â‹…105,1â‰¤aiâ€‹â‰¤n,1â‰¤qâ‰¤105,1â‰¤mâ‰¤1018,1â‰¤yâ‰¤nã€‚ æˆ‘ä»¬è€ƒè™‘ iii å‘aia_iaiâ€‹è¿ä¸€æ¡æœ‰å‘è¾¹ï¼Œä¸éš¾å‘ç°è¿™å¼ å›¾å˜æˆäº†ç¯å¥—å†…å‘æ£®æ—ã€‚ æˆ‘ä»¬è€ƒè™‘å°†è¯¢é—®ç¦»çº¿ã€‚ é¦–å…ˆè€ƒè™‘ yyy ä¸ºä¸åœ¨ç¯ä¸Šç‚¹çš„è¯¢é—®ã€‚è¿™ä¸ªæ˜¾ç„¶åªè¦ dp ä¸€ä¸‹å³å¯ï¼Œå°±æ˜¯è®° fi,jf_{i,j}fi,jâ€‹ è¡¨ç¤ºåˆ°ç¬¬ iii ä¸ªç‚¹éœ€è¦ jjj æ­¥çš„ç­”æ¡ˆï¼Œå‘ä¸Šè½¬ç§»çš„æ—¶å€™å¯å‘å¼åˆå¹¶ä¸€ä¸‹å³å¯ã€‚å½“ç„¶ç”¨ dfs åºæ˜¯å¯ä»¥ O(n)\\mathcal{O}(n)O(n) åšçš„ã€‚ è€ƒè™‘ yyy åœ¨ç¯ä¸Šçš„è¯¢é—®ã€‚æˆ‘ä»¬å¯¹æ¯ä¸ªç¯æ‰¾åˆ°ç¯ä¸Šä¸€æ¡è¾¹ï¼Œå°†è¿™æ¡è¾¹æ–­å¼€ï¼Œåˆ†åˆ«å¤„ç†è·¯å¾„ç»è¿‡è¿™æ¡è¾¹çš„ç­”æ¡ˆå’Œä¸ç»è¿‡è¿™æ¡è¾¹çš„ç­”æ¡ˆï¼Œè¿™ä¸¤ä¸ªéƒ½å¯ä»¥ç±»ä¼¼ä¸Šé¢çš„ dp åšï¼Œæœ€åå¯¹åŠ ä¸€ä¸‹å³å¯ã€‚ ä»£ç ï¼š61582213 ç¿»è¯‘æ¥è‡ªluogu.org â†©ï¸ æ‘˜è‡ªzory.ink â†©ï¸","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"CodeForces","slug":"CodeForces","permalink":"https://pufanyi.github.io/oi-blog/tags/CodeForces/"},{"name":"DP","slug":"DP","permalink":"https://pufanyi.github.io/oi-blog/tags/DP/"}]},{"title":"AGC006F Blackout","slug":"agc006_f","date":"2019-04-20T16:00:00.000Z","updated":"2023-12-25T16:08:27.922Z","comments":true,"path":"agc006_f/","link":"","permalink":"https://pufanyi.github.io/oi-blog/agc006_f/","excerpt":"æˆ‘ä»¬æœ‰ä¸€ä¸ªNNNè¡ŒNNNåˆ—çš„çŸ©é˜µã€‚ç¬¬iiiè¡Œç¬¬jjjåˆ—çš„æ ¼å­è¡¨ç¤ºä¸º(i,j)(i,j)(i,j)ã€‚ å¼€å§‹æ—¶ï¼Œæœ‰MMMä¸ªæ ¼å­æ˜¯é»‘è‰²ï¼Œå…¶ä»–æ ¼å­éƒ½æ˜¯ç™½è‰²ã€‚ç‰¹åˆ«åœ°ï¼Œå¼€å§‹æ—¶æ ¼å­(a1,b1),(a2,b2),â‹¯ ,(aM,bM)(a_1,b_1),(a_2,b_2),\\cdots,(a_M,b_M)(a1â€‹,b1â€‹),(a2â€‹,b2â€‹),â‹¯,(aMâ€‹,bMâ€‹)æ˜¯é»‘è‰²ã€‚ ã‚¹ãƒŒã‚±å›ä¼šæŒ‰ç…§ä»¥ä¸‹çš„è§„åˆ™å°½å¯èƒ½å¤šçš„å°†ç™½è‰²æ ¼å­æ¶‚æˆé»‘è‰²ï¼š å¯¹äºæ•´æ•°1â‰¤x,y,zâ‰¤N1\\le x,y,z\\le N1â‰¤x,y,zâ‰¤Nï¼Œå¦‚æœ(x,y)(x,y)(x,y)å’Œ(y,z)(y,z)(y,z)éƒ½æ˜¯é»‘è‰²ï¼Œé‚£ä¹ˆå°±æŠŠ(z,x)(z,x)(z,x)æ¶‚é»‘ã€‚ è¯·è®¡ç®—å‡ºå½“å†ä¹Ÿæ²¡æœ‰ç™½è‰²æ ¼å­èƒ½è¢«æ¶‚é»‘æ—¶ï¼Œé»‘è‰²æ ¼å­çš„ä¸ªæ•°ã€‚ 1â‰¤N,Mâ‰¤105;1â‰¤ai,biâ‰¤N1\\le N,M\\le 10^5;1\\le a_i,b_i\\le N1â‰¤N,Mâ‰¤105;1â‰¤aiâ€‹,biâ€‹â‰¤Nã€‚[1]","text":"æˆ‘ä»¬æœ‰ä¸€ä¸ª NNN è¡ŒNNNåˆ—çš„çŸ©é˜µã€‚ç¬¬ iii è¡Œç¬¬ jjj åˆ—çš„æ ¼å­è¡¨ç¤ºä¸º(i,j)(i,j)(i,j)ã€‚ å¼€å§‹æ—¶ï¼Œæœ‰ MMM ä¸ªæ ¼å­æ˜¯é»‘è‰²ï¼Œå…¶ä»–æ ¼å­éƒ½æ˜¯ç™½è‰²ã€‚ç‰¹åˆ«åœ°ï¼Œå¼€å§‹æ—¶æ ¼å­ (a1,b1),(a2,b2),â‹¯ ,(aM,bM)(a_1,b_1),(a_2,b_2),\\cdots,(a_M,b_M)(a1â€‹,b1â€‹),(a2â€‹,b2â€‹),â‹¯,(aMâ€‹,bMâ€‹) æ˜¯é»‘è‰²ã€‚ ã‚¹ãƒŒã‚±å›ä¼šæŒ‰ç…§ä»¥ä¸‹çš„è§„åˆ™å°½å¯èƒ½å¤šçš„å°†ç™½è‰²æ ¼å­æ¶‚æˆé»‘è‰²ï¼š å¯¹äºæ•´æ•° 1â‰¤x,y,zâ‰¤N1\\le x,y,z\\le N1â‰¤x,y,zâ‰¤Nï¼Œå¦‚æœ(x,y)(x,y)(x,y) å’Œ(y,z)(y,z)(y,z)éƒ½æ˜¯é»‘è‰²ï¼Œé‚£ä¹ˆå°±æŠŠ (z,x)(z,x)(z,x) æ¶‚é»‘ã€‚ è¯·è®¡ç®—å‡ºå½“å†ä¹Ÿæ²¡æœ‰ç™½è‰²æ ¼å­èƒ½è¢«æ¶‚é»‘æ—¶ï¼Œé»‘è‰²æ ¼å­çš„ä¸ªæ•°ã€‚ 1â‰¤N,Mâ‰¤105;1â‰¤ai,biâ‰¤N1\\le N,M\\le 10^5;1\\le a_i,b_i\\le N1â‰¤N,Mâ‰¤105;1â‰¤aiâ€‹,biâ€‹â‰¤Nã€‚[1] é¢˜è§£ æŒ‰ç…§å¥—è·¯ï¼Œæˆ‘ä»¬åº”è¯¥æŠŠè¡Œå’Œåˆ—çœ‹æˆç‚¹ï¼Œå³æœ‰ 1âˆ¼N1\\sim N1âˆ¼N ä¸ªç‚¹ï¼Œæ¯ä¸ªæ ¼å­ (x,y)(x,y)(x,y) å¯ä»¥çœ‹æˆæ˜¯ xâ†’yx\\to yxâ†’y çš„ä¸€æ¡æœ‰å‘è¾¹ã€‚å¦‚æœå­˜åœ¨è¾¹ (x,y)(x,y)(x,y) ä¸è¾¹(y,z)(y,z)(y,z)ï¼Œå°±è¿è¾¹(z,x)(z,x)(z,x)ï¼Œè¯¢é—®æœ€ç»ˆæœ‰å‡ æ¡è¾¹ã€‚ æˆ‘ä»¬å°†æ¯ä¸ªå¼±è¿é€šåˆ†é‡åˆ†å¼€è€ƒè™‘ã€‚ æˆ‘ä»¬è€ƒè™‘ä»€ä¹ˆæ—¶å€™ä¸èƒ½åŠ è¾¹äº†ï¼Œå¤§æ¦‚æ˜¯è¿™ 222 ä¸­æƒ…å†µï¼š å·²ç»æ˜¯å®Œå…¨å›¾äº†ï¼Œè¾¹æ•°ä¸ºnÃ—(nâˆ’1)n\\times (n - 1)nÃ—(nâˆ’1)ã€‚ å›¾è¢«åˆ’åˆ†ä¸º 333 ä¸ªé›†åˆï¼ˆå¯ä»¥æ˜¯ç©ºé›†ï¼‰A,B,CA,B,CA,B,Cï¼ŒAAAçš„æ‰€æœ‰ç‚¹å‘ BBB çš„æ‰€æœ‰ç‚¹è¿è¾¹ï¼ŒBBBçš„æ‰€æœ‰ç‚¹å‘ CCC è¿è¾¹ï¼ŒCCCçš„æ‰€æœ‰ç‚¹å‘ AAA è¿è¾¹ï¼Œè¾¹æ•°ä¸ºâˆ£Aâˆ£Ã—âˆ£Bâˆ£+âˆ£Bâˆ£Ã—âˆ£Câˆ£+âˆ£Câˆ£Ã—âˆ£Aâˆ£|A|\\times |B| + |B|\\times |C| + |C|\\times |A|âˆ£Aâˆ£Ã—âˆ£Bâˆ£+âˆ£Bâˆ£Ã—âˆ£Câˆ£+âˆ£Câˆ£Ã—âˆ£Aâˆ£ã€‚ æˆ‘ä»¬å‘ç°ä¸€ä¸ªç‚¹é›†å¦‚æœä¼šåˆ°æƒ…å†µ222ï¼Œé‚£å°±åˆ°æƒ…å†µ222ï¼Œå¦åˆ™å°±æ˜¯æƒ…å†µ111ã€‚ äºæ˜¯æˆ‘ä»¬å°è¯•åˆ’åˆ†é›†åˆï¼Œå°†å¼±è¿é€šå—ä¸­æ¯ä¸ªç‚¹ä¸€é dfs æŸ“è‰²ï¼Œå¦‚æœæŸ“è‰²æˆåŠŸï¼Œé‚£å°±æ˜¯æƒ…å†µ222ï¼Œå¦åˆ™å°±æ˜¯æƒ…å†µ111ã€‚ ç¿»è¯‘æ¥è‡ªluogu â†©ï¸","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"AtCoder","slug":"AtCoder","permalink":"https://pufanyi.github.io/oi-blog/tags/AtCoder/"}]},{"title":"ARC068F Solitaire","slug":"arc068_d","date":"2019-04-20T16:00:00.000Z","updated":"2023-12-25T16:08:27.925Z","comments":true,"path":"arc068_d/","link":"","permalink":"https://pufanyi.github.io/oi-blog/arc068_d/","excerpt":"å°†1âˆ¼n1\\sim n1âˆ¼né¡ºåºåŠ å…¥åŒç«¯é˜Ÿåˆ—ï¼ˆæ¯æ¬¡å¯åŠ å¤´å¯åŠ å°¾ï¼‰ï¼Œå†åˆ é™¤ï¼ˆæ¯æ¬¡å¯åˆ å¤´å¯åˆ å°¾ï¼‰ï¼Œæ±‚æœ‰å¤šå°‘ç§åˆ é™¤åºåˆ—ï¼Œä½¿å¾—111æ˜¯ç¬¬kkkä¸ªè¢«åˆ çš„ã€‚[1] kâ‰¤nâ‰¤2000k\\le n\\le 2000kâ‰¤nâ‰¤2000","text":"å°† 1âˆ¼n1\\sim n1âˆ¼n é¡ºåºåŠ å…¥åŒç«¯é˜Ÿåˆ—ï¼ˆæ¯æ¬¡å¯åŠ å¤´å¯åŠ å°¾ï¼‰ï¼Œå†åˆ é™¤ï¼ˆæ¯æ¬¡å¯åˆ å¤´å¯åˆ å°¾ï¼‰ï¼Œæ±‚æœ‰å¤šå°‘ç§åˆ é™¤åºåˆ—ï¼Œä½¿å¾— 111 æ˜¯ç¬¬ kkk ä¸ªè¢«åˆ çš„ã€‚[1] kâ‰¤nâ‰¤2000k\\le n\\le 2000kâ‰¤nâ‰¤2000 é¢˜è§£ æ ¹æ®å¥—è·¯è¿™ç§è®¡æ•°ç±»é¢˜æˆ‘ä»¬åº”è¯¥è€ƒè™‘ä»€ä¹ˆæ ·çš„åºåˆ—æ»¡è¶³æ€§è´¨ã€‚ æˆ‘ä»¬è€ƒè™‘æˆ‘ä»¬æ˜¯å¦‚ä½•æ„é€ è¿™æ®µåºåˆ—çš„ã€‚ ä¸€å¼€å§‹ï¼Œæˆ‘ä»¬å°† 1âˆ¼n1\\sim n1âˆ¼n çš„æ’åˆ—æ”¾å…¥åŒç«¯é˜Ÿåˆ—ä¸­ï¼Œé‚£åº”è¯¥æ˜¯è¿™æ ·çš„ï¼š ç„¶åæˆ‘ä»¬è€ƒè™‘å–å‡ºåå“ªäº›æ•°æ˜¯å¯ä»¥æ”¾åœ¨ 111 å‰é¢çš„ï¼š å¤§æ¦‚å°±åº”è¯¥æ˜¯ä¸Šå›¾çº¢è‰²å’Œè“è‰²çš„ï¼ˆå½“ç„¶åˆ†æˆä¸¤æ®µçš„å¯èƒ½æ˜¯çº¢è‰²è€Œä¸æ˜¯ç»¿è‰²ï¼‰ã€‚ äºæ˜¯æˆ‘ä»¬å‘ç° 111 å‰é¢çš„åºåˆ—ï¼ˆåŒ…æ‹¬ 111ï¼‰å¯ä»¥åˆ’åˆ†ä¸ºä¸¤ä¸ªå•è°ƒé€’å‡çš„å­åºåˆ—ï¼ˆ111 åˆ’ç»™ä¸ä»–ç›¸é‚»çš„é‚£ä¸ªåºåˆ—ï¼Œåæ­£ä»–æ˜¯æœ€å°çš„ï¼‰ï¼š æˆ‘ä»¬å‘ç°å¦‚æœæ˜¯è¿™æ ·çš„è¯ï¼Œä¸ 111 ç›¸é‚»é¢œè‰²åºåˆ—çš„æœ«å°¾ä¸€å®šæ˜¯111ï¼Œå¦ä¸€ä¸ªå­åºåˆ—çš„æœ«å°¾ï¼ˆå³æœ€å°å€¼ï¼‰ä¸€å®šæ¯”ç»¿è‰²åºåˆ—ä¸­çš„æœ€å¤§å€¼è¦å¤§ã€‚ äºæ˜¯æˆ‘ä»¬å°±å¯ä»¥æ„‰å¿«åœ° dp è¾£ï¼ æ˜¾ç„¶åé¢é‚£æ®µç»¿è‰²çš„æˆ‘ä»¬æ˜¯å¯ä»¥éšä¾¿é€‰çš„ï¼Œå³æ¯æ¬¡é€‰å·¦è¾¹å’Œé€‰å³è¾¹éƒ½å¯ä»¥ï¼Œä¹Ÿå°±æ˜¯2nâˆ’kâˆ’12^{n-k-1}2nâˆ’kâˆ’1ã€‚ æˆ‘ä»¬è€ƒè™‘å¦‚ä½• dp å‡ºå‰é¢çš„åºåˆ—ã€‚ ä¸€ä¸ªéå¸¸ simple çš„æƒ³æ³•æ˜¯ä»¤ fi,j,kf_{i,j,k}fi,j,kâ€‹ è¡¨ç¤ºåˆ°ç¬¬ iii ä½ï¼Œçº¢è‰²åºåˆ—ï¼ˆç»“å°¾ä¸º 111 çš„åºåˆ—ï¼Œä¸‹åŒï¼‰çš„æœ€å°å€¼ä¸ºjjjï¼Œè“è‰²åºåˆ—çš„æœ€å°å€¼ä¸ºkkkã€‚å¦‚æœæˆ‘ä»¬åŠ è¿›å»ä¸€ä¸ªæ•°å­—xxxï¼Œæˆ‘ä»¬è€ƒè™‘åŠ å…¥å“ªä¸€æ®µåºåˆ—ã€‚ æˆ‘ä»¬æœ‰å¦‚ä¸‹è´ªå¿ƒï¼šæˆ‘ä»¬å°½é‡æŠŠå°çš„æ•°æ‰”ç»™çº¢è‰²åºåˆ—ï¼ˆå› ä¸ºè“è‰²åºåˆ—çš„æœ€å°å€¼è¶Šå¤§è¶Šå¯èƒ½ç¬¦åˆæ¡ä»¶ï¼‰ã€‚å¦‚æœx&lt;jx&lt;jx&lt;jï¼Œé‚£æˆ‘ä»¬å°±ä¸¢ç»™çº¢è‰²åºåˆ—ï¼Œå¦åˆ™åªèƒ½ä¸¢ç»™è“è‰²åºåˆ—ã€‚ ä½†ç”±äºæˆ‘ä»¬æ— æ³•æšä¸¾ xxxï¼Œæ‰€ä»¥ä¸Šé¢çš„dp è¡Œä¸é€šï¼Œä½†æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªæœ‰è¶£çš„è´ªå¿ƒç­–ç•¥ã€‚ æœ‰ä¸Šé¢çš„è´ªå¿ƒç­–ç•¥ï¼Œæˆ‘ä»¬å‘ç°åªè¦æˆ‘ä»¬èƒ½çŸ¥é“æ‰€æœ‰åˆæ³•çš„ xxxï¼Œæˆ‘ä»¬å°±ä¸å¿…å…³å¿ƒkkk æ˜¯å¤šå°‘ã€‚æ‰€ä»¥æˆ‘ä»¬è€ƒè™‘ä»¤ fi,j,kf_{i,j,k}fi,j,kâ€‹ è¡¨ç¤ºçº¢è‰²åºåˆ—æœ‰ iii ä¸ªæ•°ï¼Œè“è‰²åºåˆ—æœ‰ jjj ä¸ªæ•°ï¼Œçº¢è‰²åºåˆ—çš„æœ€å°å€¼ä¸º kkk çš„æ–¹æ¡ˆæ•°ã€‚ æˆ‘ä»¬è€ƒè™‘å¯¹äºä¸€ä¸ªçŠ¶æ€fi,j,kf_{i,j,k}fi,j,kâ€‹ï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§æ–¹æ¡ˆè¿›è¡Œè½¬ç§»ï¼š é€‰æ‹©ä¸€ä¸ªæœ€å¤§çš„æ•°æ”¾å…¥è“è‰²åºåˆ—ï¼Œå½“ç„¶å‰ææ¡ä»¶æ˜¯å­˜åœ¨è¿™ä¸ªå¤§äº kkk çš„æ•°ã€‚ç”±äºè¿™ä¸ªæ•°ä¸å¯èƒ½æ”¾åœ¨çº¢è‰²åºåˆ—é‡Œäº†ï¼Œä¸”å¦‚æœä¸é€‰æœ€å¤§çš„é‚£ä¸ªè€Œå»é€‰å…¶ä»–å¤§äº kkk çš„æ•°ï¼Œé‚£ä¹Ÿå°±æ„å‘³ç€è¿™ä¸ªæœ€å¤§çš„æ•°è¦ç»™ç»¿è‰²åºåˆ—ã€‚è€Œè¿™æ ·ä¸€æ¥ç»¿è‰²åºåˆ—å°±ä¼šæœ‰ä¸€ä¸ªæ•°æ¯”è“è‰²åºåˆ—å¤§ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸åˆæ³•çš„ã€‚ä¹Ÿå°±æ˜¯fi,j,kâ†’fi,j+1,kf_{i,j,k} \\to f_{i,j+1,k}fi,j,kâ€‹â†’fi,j+1,kâ€‹ã€‚ é€‰æ‹©ä¸€ä¸ªæ¯” kkk å°çš„æ•°ç»™çº¢è‰²åºåˆ—ã€‚ä¹Ÿå°±æ˜¯fi,j,kâ†’fi+1,j,1âˆ¼kâˆ’1f_{i,j,k} \\to f_{i+1,j,1\\sim k-1}fi,j,kâ€‹â†’fi+1,j,1âˆ¼kâˆ’1â€‹ è¿™æ ·åšå¤æ‚åº¦O(n4)\\mathcal{O}(n^4)O(n4)ï¼Œå‰ç¼€å’Œä¼˜åŒ–ä¸€ä¸‹å¤æ‚åº¦å°±å˜æˆäº†O(n3)\\mathcal{O}(n^3)O(n3) æˆ‘ä»¬å‘ç°æˆ‘ä»¬å¹¶ä¸å¿…å…³å¿ƒ iii å’Œjjjï¼Œå› ä¸ºæ ¹æ®ä¸Šé¢çš„è´ªå¿ƒç­–ç•¥ï¼Œæˆ‘ä»¬åªè¦çŸ¥é“æœ€å°çš„ä¸€ä¸ªï¼ˆçº¢è‰²åºåˆ—çš„æœ€å°å€¼æ˜¾ç„¶æ¯”è“è‰²çš„æœ€å°å€¼å°ï¼Œå› ä¸ºæ¯”çº¢è‰²åºåˆ—æœ€å°å€¼å°çš„æ•°åªä¼šè¢«æ”¾å…¥çº¢è‰²åºåˆ—ï¼‰å°±å¯ä»¥è½¬ç§»äº†ã€‚ æˆ‘ä»¬ä»¤ fi,jf_{i,j}fi,jâ€‹ è¡¨ç¤ºåˆ°ç¬¬ iii ä½ï¼Œæœ€å°çš„ä¸€ä½ä¸ºjjjï¼Œæˆ‘ä»¬å‘ç°è½¬ç§»æ–¹å¼å’Œä¸Šé¢æ²¡æœ‰æœ¬è´¨åŒºåˆ«ï¼š é€‰æ‹©ä¸€ä¸ªæœ€å¤§çš„æ•°æ”¾å…¥è“è‰²åºåˆ—ã€‚fi,jâ†’fi+1,jf_{i,j}\\to f_{i+1,j}fi,jâ€‹â†’fi+1,jâ€‹ã€‚ é€‰æ‹©ä¸€ä¸ªæ¯” kkk å°çš„æ•°ç»™çº¢è‰²åºåˆ—ã€‚fi,jâ†’fi+1,1âˆ¼kâˆ’1f_{i,j}\\to f_{i+1,1\\sim k-1}fi,jâ€‹â†’fi+1,1âˆ¼kâˆ’1â€‹ã€‚ å‘ç°ç¬¬ä¸€ç»´å¯ä»¥ç›´æ¥å‹æ‰ï¼Œç„¶åç›´æ¥ dp å³å¯ã€‚ ä»£ç  1234567891011121314151617181920212223242526272829303132333435363738394041424344#include &lt;iostream&gt;using namespace std;typedef long long LL;const int maxn = 2005;const int mod = 1000000007;inline int pow(int a, int b)&#123; if (b &lt; 0) return 1; int ans = 1; for (; b; b &gt;&gt;= 1, a = (LL) a * a % mod) if (b &amp; 1) ans = (LL) ans * a % mod; return ans;&#125;int dp[maxn];int main()&#123; int n, k; cin &gt;&gt; n &gt;&gt; k; dp[n + 1] = 1; for (int i = 1; i &lt;= k; ++i) &#123; for (int j = n; j; --j) &#123; if (n - j + 1 &lt; i) dp[j] = 0; else &#123; dp[j] = dp[j + 1] + dp[j]; if (dp[j] &gt;= mod) dp[j] -= mod; &#125; &#125; &#125; cout &lt;&lt; (LL) dp[1] * pow(2, n - k - 1) % mod; return 0;&#125; ç¿»è¯‘æ¥è‡ªluogu â†©ï¸","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"DP","slug":"DP","permalink":"https://pufanyi.github.io/oi-blog/tags/DP/"},{"name":"AtCoder","slug":"AtCoder","permalink":"https://pufanyi.github.io/oi-blog/tags/AtCoder/"}]},{"title":"AGC005C Tree Restoring","slug":"agc005_c","date":"2019-04-13T16:00:00.000Z","updated":"2023-12-25T16:08:27.922Z","comments":true,"path":"agc005_c/","link":"","permalink":"https://pufanyi.github.io/oi-blog/agc005_c/","excerpt":"é’æœ¨å›ç‰¹åˆ«å–œæ¬¢æ•°åˆ—å’Œæ ‘ï¼Œä»–è§‰å¾—å®ƒä»¬æ˜¯ä¸–ç•Œä¸Šæœ€ç¾å¦™çš„äº‹ç‰©ã€‚ æœ‰ä¸€å¤©ï¼Œç¥ä»™ç»™äº†é’æœ¨å›ä¸€ä¸ªé•¿åº¦ä¸ºnnnçš„æ•´æ•°æ•°åˆ—aaaã€‚è¿™è®©é’æœ¨å›ç‰¹åˆ«æƒ³æ„é€ ä¸€æ£µç¾å¦™æ ‘ã€‚ ç¾å¦™æ ‘çš„æ¯æ¡è¾¹é•¿åº¦éƒ½ä¸º111ã€‚è€Œä¸”ç¾å¦™æ ‘æœ‰ä¸€ä¸ªæœ€é‡è¦çš„æ€§è´¨ï¼šå¯¹äºæ¯ä¸€ä¸ªç‚¹i(1â‰¤iâ‰¤n)i(1\\le i\\le n)i(1â‰¤iâ‰¤n)ï¼Œåœ¨æ ‘ä¸­ç¦»å®ƒè·ç¦»æœ€è¿œçš„ç‚¹ä¸å®ƒçš„è·ç¦»åº”æ°å¥½ç­‰äºaia_iaiâ€‹ã€‚ é’æœ¨å›æƒ³äº†æƒ³å°±ç§’æ‰äº†è¿™é¢˜ï¼Œä»–å†³å®šè€ƒè€ƒä½ ï¼šå¯¹äºä¸€ä¸ªç»™å®šçš„åºåˆ—ï¼Œæ˜¯å¦å­˜åœ¨ä¸€æ£µç¾å¦™æ ‘ï¼Ÿ[1] 2â‰¤nâ‰¤100,1â‰¤aiâ‰¤nâˆ’12\\le n\\le 100,1\\le a_i\\le nâˆ’12â‰¤nâ‰¤100,1â‰¤aiâ€‹â‰¤nâˆ’1","text":"é’æœ¨å›ç‰¹åˆ«å–œæ¬¢æ•°åˆ—å’Œæ ‘ï¼Œä»–è§‰å¾—å®ƒä»¬æ˜¯ä¸–ç•Œä¸Šæœ€ç¾å¦™çš„äº‹ç‰©ã€‚ æœ‰ä¸€å¤©ï¼Œç¥ä»™ç»™äº†é’æœ¨å›ä¸€ä¸ªé•¿åº¦ä¸º nnn çš„æ•´æ•°æ•°åˆ—aaaã€‚è¿™è®©é’æœ¨å›ç‰¹åˆ«æƒ³æ„é€ ä¸€æ£µç¾å¦™æ ‘ã€‚ ç¾å¦™æ ‘çš„æ¯æ¡è¾¹é•¿åº¦éƒ½ä¸º111ã€‚è€Œä¸”ç¾å¦™æ ‘æœ‰ä¸€ä¸ªæœ€é‡è¦çš„æ€§è´¨ï¼šå¯¹äºæ¯ä¸€ä¸ªç‚¹i(1â‰¤iâ‰¤n)i(1\\le i\\le n)i(1â‰¤iâ‰¤n)ï¼Œåœ¨æ ‘ä¸­ç¦»å®ƒè·ç¦»æœ€è¿œçš„ç‚¹ä¸å®ƒçš„è·ç¦»åº”æ°å¥½ç­‰äºaia_iaiâ€‹ã€‚ é’æœ¨å›æƒ³äº†æƒ³å°±ç§’æ‰äº†è¿™é¢˜ï¼Œä»–å†³å®šè€ƒè€ƒä½ ï¼šå¯¹äºä¸€ä¸ªç»™å®šçš„åºåˆ—ï¼Œæ˜¯å¦å­˜åœ¨ä¸€æ£µç¾å¦™æ ‘ï¼Ÿ[1] 2â‰¤nâ‰¤100,1â‰¤aiâ‰¤nâˆ’12\\le n\\le 100,1\\le a_i\\le nâˆ’12â‰¤nâ‰¤100,1â‰¤aiâ€‹â‰¤nâˆ’1 é¢˜è§£ é¦–å…ˆæ ¹æ®è¿™ä¸ªåºåˆ—æˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿åœ°æ±‚å‡ºç›´å¾„ã€‚ ç„¶åæˆ‘ä»¬æŠŠæ ‘çš„ç›´å¾„ä¸Šçš„ç‚¹åˆ æ‰ï¼Œå³l,lâˆ’1,lâˆ’2,â‹¯ ,mid,mid+1,â‹¯ ,lâˆ’1,ll, l-1, l-2, \\cdots, mid, mid + 1, \\cdots, l - 1, ll,lâˆ’1,lâˆ’2,â‹¯,mid,mid+1,â‹¯,lâˆ’1,lï¼Œå¦‚æœä¸å­˜åœ¨é‚£ä¹ˆä¸€å®šæ˜¯impossibleã€‚ ç„¶åè¿˜æœ‰å°±æ˜¯ä¸å¯èƒ½å‡ºç° aaa æ¯”ç›´å¾„ä¸­ç‚¹å°çš„ç‚¹ï¼ŒæŠŠå®ƒåˆ¤æ‰å°±è¿‡äº†æ­¤é¢˜ã€‚ ä»£ç  123456789101112131415161718192021222324252627282930313233343536373839404142434445#include &lt;cstdio&gt;#include &lt;cctype&gt;#include &lt;set&gt;#include &lt;iostream&gt;using namespace std;// è¯»ä¼˜ç•¥å»const int maxn = 105;const int inf = 0x3f3f3f3f;int tong[maxn];int main()&#123; int n, zj = 0; read(n); for (int i = 1, a; i &lt;= n; ++i) &#123; read(a); tong[a]++; zj = max(a, zj); &#125; for (int i = 0; i &lt;= zj; ++i) &#123; int noww = max(i, zj - i); if (!tong[noww]) &#123; puts(&quot;Impossible&quot;); return 0; &#125; tong[noww]--; &#125; for (int i = 1; i &lt;= ((zj + 1) &gt;&gt; 1); ++i) &#123; if (tong[i]) &#123; puts(&quot;Impossible&quot;); return 0; &#125; &#125; puts(&quot;Possible&quot;); return 0;&#125; ç¿»è¯‘æ¥è‡ªluogu â†©ï¸","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"AtCoder","slug":"AtCoder","permalink":"https://pufanyi.github.io/oi-blog/tags/AtCoder/"}]},{"title":"ARC068E Snuke Line","slug":"arc068_c","date":"2019-04-13T16:00:00.000Z","updated":"2023-12-25T16:08:27.925Z","comments":true,"path":"arc068_c/","link":"","permalink":"https://pufanyi.github.io/oi-blog/arc068_c/","excerpt":"åŸé¢˜é“¾æ¥ æœ‰ä¸€è¶Ÿåˆ—è½¦æœ‰M+1M+1M+1ä¸ªè½¦ç«™ï¼Œä»000åˆ°MMMç¼–å·ã€‚æœ‰NNNç§å•†å“ï¼Œç¬¬iiiç§åªåœ¨ç¼–å·[li,ri][l_i,r_i][liâ€‹,riâ€‹]çš„è½¦ç«™å‡ºå”®ã€‚ä¸€è¾†åˆ—è½¦æœ‰ä¸€ä¸ªé¢„è®¾å¥½çš„ç³»æ•°dddï¼Œä»000å‡ºå‘ï¼Œåªä¼šåœ¨dddçš„å€æ•°è½¦ç«™åœè½¦ã€‚å¯¹äºdddä»111åˆ°MMMçš„åˆ—è½¦ï¼Œæ±‚æœ€å¤šèƒ½ä¹°åˆ°å¤šå°‘ç§å•†å“ã€‚ 1â‰¤Nâ‰¤3Ã—105;1â‰¤Mâ‰¤105;1â‰¤liâ‰¤riâ‰¤M1\\le N \\le 3\\times 10^5;1\\le M\\le 10^5;1\\le l_i\\le r_i\\le M1â‰¤Nâ‰¤3Ã—105;1â‰¤Mâ‰¤105;1â‰¤liâ€‹â‰¤riâ€‹â‰¤Mã€‚","text":"åŸé¢˜é“¾æ¥ æœ‰ä¸€è¶Ÿåˆ—è½¦æœ‰ M+1M+1M+1 ä¸ªè½¦ç«™ï¼Œä» 000 åˆ°MMMç¼–å·ã€‚æœ‰ NNN ç§å•†å“ï¼Œç¬¬ iii ç§åªåœ¨ç¼–å· [li,ri][l_i,r_i][liâ€‹,riâ€‹] çš„è½¦ç«™å‡ºå”®ã€‚ä¸€è¾†åˆ—è½¦æœ‰ä¸€ä¸ªé¢„è®¾å¥½çš„ç³»æ•° dddï¼Œä»000 å‡ºå‘ï¼Œåªä¼šåœ¨ ddd çš„å€æ•°è½¦ç«™åœè½¦ã€‚å¯¹äº ddd ä»111åˆ° MMM çš„åˆ—è½¦ï¼Œæ±‚æœ€å¤šèƒ½ä¹°åˆ°å¤šå°‘ç§å•†å“ã€‚ 1â‰¤Nâ‰¤3Ã—105;1â‰¤Mâ‰¤105;1â‰¤liâ‰¤riâ‰¤M1\\le N \\le 3\\times 10^5;1\\le M\\le 10^5;1\\le l_i\\le r_i\\le M1â‰¤Nâ‰¤3Ã—105;1â‰¤Mâ‰¤105;1â‰¤liâ€‹â‰¤riâ€‹â‰¤Mã€‚ é¢˜è§£ æˆ‘ä»¬è€ƒè™‘å¯¹äºæ¯ä¸ª dddï¼Œå¦‚æœåŒºé—´[li,ri][l_i,r_i][liâ€‹,riâ€‹] æœ‰riâˆ’li+1â‰¥dr_i-l_i+1\\ge driâ€‹âˆ’liâ€‹+1â‰¥dï¼Œé‚£ä¹ˆæ˜¾ç„¶å®ƒä¸€å®šä¼šè¢«è¦†ç›–ï¼Œæˆ‘ä»¬ç›´æ¥ç»Ÿè®¡ç­”æ¡ˆã€‚ æˆ‘ä»¬è€ƒè™‘ riâˆ’li+1&lt;dr_i-l_i+1&lt;driâ€‹âˆ’liâ€‹+1&lt;d çš„æƒ…å†µï¼Œæ˜¾ç„¶å®ƒåªä¼šè¢«è¦†ç›–ä¸€æ¬¡ï¼Œæ‰€ä»¥æˆ‘ä»¬åªè¦æ±‚è¿™äº›åŒºé—´ä¸è¿™äº›ç‚¹çš„äº¤ç‚¹ä¸ªæ•°å³å¯ã€‚ äºæ˜¯æˆ‘ä»¬ç”±é•¿åº¦ä»å°åˆ°å¤§æšä¸¾åŒºé—´ï¼Œæ”¾å…¥çº¿æ®µæ ‘ä¸­ã€‚å¯¹äºæ¯ä¸ª ddd æšä¸¾ç‚¹ã€‚ç”±äºç‚¹çš„æ€»æ•°æ˜¯T(n)=âˆ‘i=1nni=O(nlnâ¡n)T(n)=\\sum_{i=1}^n\\frac{n}{i}=\\mathcal{O}(n\\ln n)T(n)=âˆ‘i=1nâ€‹inâ€‹=O(nlnn)ï¼Œæ‰€ä»¥å¤æ‚åº¦ä¸ºO(nlogâ¡2n)\\mathcal{O}(n\\log ^ 2 n)O(nlog2n)ã€‚ ä»£ç  12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667#include &lt;cstdio&gt;#include &lt;iostream&gt;#include &lt;algorithm&gt;using namespace std;const int maxn = 300005;int n, m;#define lowbit(x) (x &amp; (-x))struct Tree&#123; int no[maxn]; inline void add(int pla, int x) &#123; for (; pla &lt;= m; pla += lowbit(pla)) no[pla] += x; &#125; inline void add_qj(int l, int r) &#123; add(l, 1); if (r &lt; m) add(r + 1, -1); &#125; inline int query(int pla) &#123; int ans = 0; for (; pla; pla -= lowbit(pla)) ans += no[pla]; return ans; &#125;&#125; tr;struct QJ&#123; int l, r; inline int len() &#123; return r - l + 1; &#125; friend bool operator &lt; (QJ a, QJ b) &#123; return a.r - a.l &lt; b.r - b.l; &#125;&#125; qj[maxn];int main()&#123; scanf(&quot;%d%d&quot;, &amp;n, &amp;m); for (int i = 1; i &lt;= n; ++i) scanf(&quot;%d%d&quot;, &amp;qj[i].l, &amp;qj[i].r); sort(qj + 1, qj + n + 1); int now = 1; for (int i = 1; i &lt;= m; ++i) &#123; while (now &lt;= n &amp;&amp; qj[now].len() &lt; i) &#123; tr.add_qj(qj[now].l, qj[now].r); now++; &#125; int ans = n - now + 1; for (int j = 0; j &lt;= m; j += i) ans += tr.query(j); printf(&quot;%d\\n&quot;, ans); &#125; return 0;&#125;","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"},{"name":"AtCoder","slug":"AtCoder","permalink":"https://pufanyi.github.io/oi-blog/tags/AtCoder/"}]},{"title":"ARC080E Young Maids","slug":"arc080_c","date":"2019-04-13T16:00:00.000Z","updated":"2023-12-25T16:08:27.935Z","comments":true,"path":"arc080_c/","link":"","permalink":"https://pufanyi.github.io/oi-blog/arc080_c/","excerpt":"åŸé¢˜é“¾æ¥ é¢˜æ„å¤§æ¦‚å°±æ˜¯ç»™ä½ ä¸€ä¸ªæ’åˆ—pppï¼Œä½ æ¯æ¬¡å¯ä»¥æ‰¾åˆ°pppä¸­ç›¸é‚»ä¸¤ä¸ªæ•°å¹¶å°†å…¶ç§»è‡³å¦ä¸€ä¸ªåˆå§‹ä¸ºç©ºçš„é˜Ÿåˆ—çš„å¼€å¤´ï¼Œè®©æœ€ç»ˆpppçš„å­—å…¸åºå°½é‡å°ã€‚ è¿‡ç¨‹å¤§æ¦‚å°±æ˜¯è¿™æ ·ï¼š","text":"åŸé¢˜é“¾æ¥ é¢˜æ„å¤§æ¦‚å°±æ˜¯ç»™ä½ ä¸€ä¸ªæ’åˆ— pppï¼Œä½ æ¯æ¬¡å¯ä»¥æ‰¾åˆ°ppp ä¸­ç›¸é‚»ä¸¤ä¸ªæ•°å¹¶å°†å…¶ç§»è‡³å¦ä¸€ä¸ªåˆå§‹ä¸ºç©ºçš„é˜Ÿåˆ—çš„å¼€å¤´ï¼Œè®©æœ€ç»ˆ ppp çš„å­—å…¸åºå°½é‡å°ã€‚ è¿‡ç¨‹å¤§æ¦‚å°±æ˜¯è¿™æ ·ï¼š é¢˜è§£ ç”±äºå­—å…¸åºå¤§å°æ˜¯ä»å‰å¾€åå†³å®šçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è€ƒè™‘ä»å‰å¾€åç¡®å®šè¿™ä¸ªåºåˆ—ï¼Œä¹Ÿå°±æ˜¯å°†é¢˜æ„ä¸­çš„è¿‡ç¨‹å€’ç€åšã€‚ æˆ‘ä»¬è€ƒè™‘åœ¨æŸä¸€çŠ¶æ€ä¸‹ï¼Œé€‰æ‹©çš„ä¸¤ä¸ªæ•°åœ¨åŸåºåˆ—ä¸­æ˜¯ pl,prp_l,p_rplâ€‹,prâ€‹ï¼Œé‚£ä¹ˆå†æ¬¡ä¹‹å‰çš„é€‰æ‹©ä¸­ï¼Œä¸å¯èƒ½å‡ºç°é€‰æ‹©çš„æ•°ä¸ºpal,parp_{a_l},p_{a_r}palâ€‹â€‹,parâ€‹â€‹ ä½¿å¾— al&lt;l&lt;ara_l&lt;l&lt;a_ralâ€‹&lt;l&lt;arâ€‹ æˆ–al&lt;r&lt;ara_l&lt;r&lt;a_ralâ€‹&lt;r&lt;arâ€‹ã€‚ äºæ˜¯æˆ‘ä»¬å‘ç°å€’ç€è€ƒè™‘æ˜¯ï¼Œé€‰æ‹© pl,prp_l,p_rplâ€‹,prâ€‹ æ—¶å°±æ˜¯æŠŠåºåˆ—åˆ†æˆäº† [1,lâˆ’1],[l+1,râˆ’1],[r+1,n][1,l-1],[l+1,r-1],[r+1,n][1,lâˆ’1],[l+1,râˆ’1],[r+1,n] è¿™333æ®µï¼Œè¿™ 333 æ®µç›¸äº’ç‹¬ç«‹ã€‚ æˆ‘ä»¬è€ƒè™‘æ€æ ·çš„ &lt;l,r&gt;&lt;l,r&gt;&lt;l,r&gt; æ˜¯åˆæ³•çš„ã€‚æ˜¾ç„¶å°±æ˜¯ [1,lâˆ’1],[l+1,râˆ’1],[r+1,n][1,l-1],[l+1,r-1],[r+1,n][1,lâˆ’1],[l+1,râˆ’1],[r+1,n] é•¿åº¦å‡ä¸ºå¶æ•°æ—¶ï¼ˆå¯èƒ½ä¸ºç©ºï¼‰ã€‚ æ‰€ä»¥ lll ä¸€å®šä¸ºå¥‡æ•°ï¼Œrrrä¸€å®šä¸ºå¶æ•°ã€‚ æˆ‘ä»¬å¯ä»¥ç»´æŠ¤å‡º ppp ä¸­å¥‡æ•°ä½äºå¶æ•°ä½çš„æœ€å°å€¼ï¼Œå¹¶ç”¨ä¸€ä¸ªå°æ ¹å †ç»´æŠ¤æ¯ä¸€ä¸ª [l,r][l,r][l,r] çš„æœ€å°å€¼å³å¯ï¼Œæ¯æ¬¡é€‰æ‹©åå°† [l,r][l,r][l,r] åˆ†æˆ 333 æ®µé‡æ–°æ”¾å…¥å †ä¸­ã€‚ ä»£ç  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108#include &lt;bits/stdc++.h&gt;using namespace std;// è¯»å…¥è¾“å‡ºä¼˜åŒ–ç•¥å» const int maxn = 200005;const int inf = 0x3f3f3f3f;int n;int xx[maxn]; // é¢˜æ„ä¸­çš„ p#define ls(x) (x &lt;&lt; 1)#define rs(x) (x &lt;&lt; 1 | 1)struct Tree&#123; struct Node &#123; int jx, ox; // å¥‡æ•°ä½çš„æœ€å°å€¼ä¸å¶æ•°ä½çš„æœ€å°å€¼ &#125; no[maxn &lt;&lt; 2]; int k; inline int minn(int a, int b) &#123; if (!a || !b) return a | b; else return xx[a] &lt; xx[b] ? a : b; &#125; inline void push_up(int k) &#123; no[k].jx = minn(no[ls(k)].jx, no[rs(k)].jx); no[k].ox = minn(no[ls(k)].ox, no[rs(k)].ox); &#125; inline void build_tree(int n) &#123; for (k = 1; k &lt;= n; k &lt;&lt;= 1); for (int i = 1; i &lt;= n; ++i) &#123; if (i &amp; 1) no[i + k].jx = i; else no[i + k].ox = i; &#125; for (int i = k; i; --i) push_up(i); &#125; inline int query(int l, int r, int kk) &#123; int ans = 0; for (l += k - 1, r += k + 1; l ^ r ^ 1; l &gt;&gt;= 1, r &gt;&gt;= 1) &#123; if (~l &amp; 1) ans = minn(kk ? no[l ^ 1].jx : no[l ^ 1].ox, ans); if (r &amp; 1) ans = minn(kk ? no[r ^ 1].jx : no[r ^ 1].ox, ans); &#125; return ans; &#125;&#125; tr;struct QJ&#123; int l, r, ansl, ansr; // ç°åœ¨å¯é€‰åŒºé—´ä¸º[l,r]ï¼Œæœ€ä¼˜æ˜¯é€‰æ‹© p[l] å’Œ p[r] friend bool operator &lt; (QJ a, QJ b) &#123; return xx[a.ansl] &gt; xx[b.ansl]; &#125; QJ (int l, int r) &#123; this-&gt;l = l; this-&gt;r = r; this-&gt;ansl = tr.query(l, r, 1); this-&gt;ansr = tr.query(ansl + 1, r, 0); &#125;&#125;;priority_queue&lt;QJ&gt; q;int main()&#123; read(n); for (int i = 1; i &lt;= n; ++i) read(xx[i]); tr.build_tree(n); q.push(QJ(1, n)); while (!q.empty()) &#123; QJ now = q.top(); q.pop(); writesp(xx[now.ansl]); writesp(xx[now.ansr]); if (now.ansl + 1 &lt; now.ansr - 1) q.push(QJ(now.ansl + 1, now.ansr - 1)); if (now.l &lt; now.ansl - 1) q.push(QJ(now.l, now.ansl - 1)); if (now.ansr + 1 &lt; now.r) q.push(QJ(now.ansr + 1, now.r)); &#125; return 0;&#125;","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"è´ªå¿ƒ","slug":"è´ªå¿ƒ","permalink":"https://pufanyi.github.io/oi-blog/tags/%E8%B4%AA%E5%BF%83/"},{"name":"AtCoder","slug":"AtCoder","permalink":"https://pufanyi.github.io/oi-blog/tags/AtCoder/"}]},{"title":"ä¸€é“æœ‰è¶£çš„æ¨¡æ‹Ÿèµ›é¢˜","slug":"20190409æ¨¡æ‹Ÿèµ›T1","date":"2019-04-12T16:00:00.000Z","updated":"2023-12-25T16:08:27.857Z","comments":true,"path":"20190409æ¨¡æ‹Ÿèµ›T1/","link":"","permalink":"https://pufanyi.github.io/oi-blog/20190409%E6%A8%A1%E6%8B%9F%E8%B5%9BT1/","excerpt":"ä¸€é“æœ‰è¶£çš„é¢˜ã€‚","text":"ä¸€é“æœ‰è¶£çš„é¢˜ã€‚ 3s+O2 åŸé¢˜å¤§æ¦‚æ˜¯ è¿™é“ã€‚ çœ‹åˆ°æ¨¡ 333 æ˜¾ç„¶æ˜¯å‡ºé¢˜äººç²¾å¿ƒæ„é€ çš„ã€‚ äºæ˜¯æˆ‘ä»¬æ‰“å‡ºä¸€å¼ ç»„åˆæ•°æ¨¡ 333 çš„è¡¨ã€‚ å¥½å¤š 000 å•Šï½ äºæ˜¯æˆ‘ä»¬è€ƒè™‘å¦‚ä½•å¿«é€Ÿæ±‚å‡ºç»„åˆæ•°ä¸æ˜¯ 000 çš„ä½ç½®ã€‚ å…ˆè¯´ä¸€ä¸‹æˆ‘è€ƒåœºä¸Šæƒ³åˆ°çš„ logâ¡\\loglog åšæ³•ï¼š æˆ‘ä»¬è€ƒè™‘ lucasï¼Œå¯¹äºç»„åˆæ•°(mn)\\binom{m}{n}(nmâ€‹)ï¼Œå…¶å®å°±æ˜¯(MiNi)\\binom{M_i}{N_i}(Niâ€‹Miâ€‹â€‹) çš„ä¹˜ç§¯ï¼Œå…¶ä¸­ Mi,NiM_i,N_iMiâ€‹,Niâ€‹ è¡¨ç¤º m,nm,nm,n åœ¨333è¿›åˆ¶ä¸‹çš„ç¬¬ iii ä½ã€‚ æˆ‘ä»¬å‘ç° (MiNi)\\binom{M_i}{N_i}(Niâ€‹Miâ€‹â€‹) åªè¦æœ‰ä¸€ä½æ˜¯ 000ï¼Œæœ€ç»ˆç»“æœå°±æ˜¯000ï¼Œæ‰€ä»¥æˆ‘ä»¬åªè¦æšä¸¾mmm åæšä¸¾ä¸‰è¿›åˆ¶ä¸‹æ¯ä¸€ä½æ˜¯æ¯” mmm å°çš„ nnn å°±è¡Œäº†ï¼Œè¿™æ ·æ¯æ¬¡æ‰¾æ˜¯ logâ¡\\loglog çš„ï¼Œæ‰€ä»¥å¤æ‚åº¦æ˜¯ O(0 çš„ä¸ªæ•°Ã—logâ¡n)\\mathcal{O}(\\text{0 çš„ä¸ªæ•°}\\times\\log n)O(0 çš„ä¸ªæ•° Ã—logn)ï¼Œhdu ä¸Šè¿‡äº†ï¼Œå¯æƒœæ¨¡æ‹Ÿèµ›çš„æ—¶å€™è¢«å¡æ‰äº†â€¦â€¦ æˆ‘ä»¬è€ƒè™‘ Lucas æ˜¯æ€ä¹ˆé€’å½’ä¸‹æ¥çš„ã€‚å¯¹äºæ¯ä¸€å±‚ï¼Œæˆ‘ä»¬åªæœ‰ 666 ç§æ–¹æ¡ˆä½¿å¾— (mn)&gt;0\\binom{m}{n}&gt;0(nmâ€‹)&gt;0ï¼Œæˆ‘ä»¬ç›´æ¥åå‘é€’å½’ä¸Šå»ï¼Œè¿™æ ·å°±èƒ½æ¯æ¬¡O(1)\\mathcal{O}(1)O(1) æœå‡ºæ‰€æœ‰ç»“æœäº†ã€‚ å…³äº 000 çš„ä¸ªæ•°ä¸ºä»€ä¹ˆè¿™ä¹ˆå¤šï¼ˆæ‰“è¡¨å¯å¾— ï¼‰ï¼Œæˆ‘ä»¬å‘ç°æ¯æ¬¡é€’å½’ä¸‹å»çš„æ—¶å€™ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥æŠŠåºåˆ—æ ¹æ® mod 3\\bmod 3mod3 åˆ†æˆ 333 æ®µï¼š0,1,20,1,20,1,2ï¼Œè€Œæ¯ä¸€å±‚åªæœ‰ 666 ä¸ªç»„åˆæ•°å¤§äº000ï¼Œè¿™æ ·æˆ‘ä»¬æœ‰T(n)=6T(n/3)+O(n)\\mathcal{T}(n)=6\\mathcal{T}(n/3)+\\mathcal{O}(n)T(n)=6T(n/3)+O(n)ã€‚ ä¸‹å›¾æˆªè‡ªå‡ºé¢˜äººçš„solutionï¼š é‚£å°±å‡è£…èƒ½è¿‡å§~~ï¼ˆåæ­£æ¯”æˆ‘çš„å¤æ‚åº¦ä¼˜ï¼‰~~ã€‚ æˆ‘è¢«å¡çš„ä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148#include &lt;bits/stdc++.h&gt;using namespace std;const int maxn = 100005;#define LL long long#define inf 0x3f3f3f3f#define put putchar(&#x27;\\n&#x27;)#define sqr(x) ((x)*(x))#define re register#define ret return puts(&quot;-1&quot;),0;inline char gc()&#123; static char buf[100000],*p1=buf,*p2=buf; return p1==p2&amp;&amp;(p2=(p1=buf)+fread(buf,1,100000,stdin),p1==p2)?EOF:*p1++;&#125;#define gc getcharinline int read()&#123; char c=getchar(); int tot=1; while ((c&lt;&#x27;0&#x27;|| c&gt;&#x27;9&#x27;)&amp;&amp;c!=&#x27;-&#x27;) c=getchar(); if (c==&#x27;-&#x27;) &#123; tot=-1; c=getchar(); &#125; int sum=0; while (c&gt;=&#x27;0&#x27;&amp;&amp;c&lt;=&#x27;9&#x27;) &#123; sum=sum*10+c-&#x27;0&#x27;; c=getchar(); &#125; return sum*tot;&#125;inline void wr(int x)&#123; if (x&lt;0) &#123; putchar(&#x27;-&#x27;); wr(-x); return; &#125; if(x&gt;=10)wr(x/10); putchar(x%10+&#x27;0&#x27;);&#125;inline void wri(int x)&#123; wr(x); putchar(&#x27; &#x27;);&#125;int a[maxn], b[maxn];int C[3333][3333];inline int Lucas(int n, int m)&#123; if (!n) return 1; if (n &lt;= 3000 &amp;&amp; m &lt;= 3000) return C[m][n]; return Lucas(n / 3, m / 3) * C[m % 3][n % 3] % 3;&#125;int topp;int bit[20];int jbit[20];inline void pre(int x)&#123; memset(bit, 0, sizeof(bit)); memset(jbit, 0, sizeof(jbit)); topp = 0; if (!x) &#123; topp = 1; return; &#125; while (x) &#123; bit[++topp] = x % 3; x /= 3; &#125;&#125;inline int nxt()&#123; jbit[1]++; for (register int i = 1; i &lt; topp; ++i) &#123; if (jbit[i] &lt;= bit[i]) break; jbit[i] = 0; jbit[i + 1]++; &#125; if (jbit[topp] &gt; bit[topp]) return -1; register int ans = 0; for (register int i = topp; i; --i) &#123; ans *= 3; ans += jbit[i]; &#125; return ans;&#125;inline void solve()&#123; int cnt = 0; register int n = read(); for (register int i = 0; i &lt; n; ++i) a[i] = read(); for (register int i = 0; i &lt; n; ++i) b[i] = read(); for (register int i = 0, c, j; i &lt; (n &lt;&lt; 1) - 1; ++i) &#123; c = 0; pre(i); for (j = 0; ~j &amp;&amp; j &lt; n; j = nxt()) &#123; cnt++; if (i - j &lt; n &amp;&amp; a[j] &amp;&amp; b[i - j]) (c += Lucas(j, i) * a[j] * b[i - j]) %= 3; &#125; wri(c); &#125; puts(&quot;&quot;);&#125;int main()&#123; freopen(&quot;cal.in&quot;, &quot;r&quot;, stdin); freopen(&quot;cal.out&quot;, &quot;w&quot;, stdout); for (register int i = 0; i &lt;= 3000; ++i) &#123; C[i][0] = 1; for (register int j = 1; j &lt;= i; ++j) C[i][j] = (C[i - 1][j - 1] + C[i - 1][j]) % 3; &#125; register int T = read(); while (T--) solve(); fclose(stdin); fclose(stdout); return 0;&#125; æ­£è§£ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105#include &lt;bits/stdc++.h&gt;using namespace std;inline char gc()&#123; static const int L = 23333; static char sxd[L], *sss = sxd, *ttt = sxd; if (sss == ttt) &#123; ttt = (sss = sxd) + fread(sxd, 1, L, stdin); if (sss == ttt) return EOF; &#125; return *sss++;&#125;#define dd c = gc()template &lt;class T&gt;inline bool read(T&amp; x)&#123; x = 0; register char dd; register bool flag = false; for (; !isdigit(c); dd) &#123; if(c == &#x27;-&#x27;) flag = true; else if(c == EOF) return false; &#125; for (; isdigit(c); dd) x = (x &lt;&lt; 1) + (x &lt;&lt; 3) + (c ^ 48); if (flag) x = -x; return true;&#125;#undef ddtemplate &lt;class T&gt;inline void write(T x)&#123; if(!x) &#123; putchar(&#x27;0&#x27;); return; &#125; if (x &lt; 0) putchar(&#x27;-&#x27;), x = -x; int buf[20]; *buf = 0; while (x) &#123; buf[++(*buf)] = x % 10; x /= 10; &#125; while (*buf) putchar(buf[(*buf)--] | 48);&#125;template &lt;class T&gt;inline void writesp(T x)&#123; write(x); putchar(&#x27; &#x27;);&#125;const int maxn = 100005;int a[maxn], b[maxn], c[maxn &lt;&lt; 1], n;const int x[] = &#123;0, 0, 1, 0, 1, 2&#125;;const int y[] = &#123;0, 1, 1, 2, 2, 2&#125;;const int z[] = &#123;1, 1, 1, 1, 2, 1&#125;;inline void dfs(const register int xx, const register int yy, const register int zz)&#123; for (register int i = 0, xxx, yyy; i &lt; 6; ++i) &#123; xxx = xx + x[i], yyy = yy + y[i]; if (yyy - xxx &lt; n &amp;&amp; xxx &lt; n) c[yyy] += zz * z[i] * a[xxx] * b[yyy - xxx]; if ((xxx || yyy) &amp;&amp; (xxx * 3 &lt; n) &amp;&amp; (yyy * 3 &lt; ((n &lt;&lt; 1) - 1)) &amp;&amp; ((yyy - xxx) * 3 &lt; n)) dfs(xxx * 3, yyy * 3, zz * z[i]); &#125;&#125;int main()&#123; freopen(&quot;cal.in&quot;, &quot;r&quot;, stdin); freopen(&quot;cal.out&quot;, &quot;w&quot;, stdout); int T; read(T); while (T--) &#123; memset(c, 0, sizeof(c)); read(n); for (register int i = 0; i &lt; n; ++i) read(a[i]); for (register int i = 0; i &lt; n; ++i) read(b[i]); dfs(0, 0, 1); for (register int i = 0; i &lt; (n &lt;&lt; 1) - 1; ++i) writesp(c[i] % 3); puts(&quot;&quot;); &#125; fclose(stdin); fclose(stdout); return 0;&#125;","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"æ•°å­¦","slug":"æ•°å­¦","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%95%B0%E5%AD%A6/"},{"name":"æ¨¡æ‹Ÿèµ›","slug":"æ¨¡æ‹Ÿèµ›","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%A8%A1%E6%8B%9F%E8%B5%9B/"},{"name":"Lucas","slug":"Lucas","permalink":"https://pufanyi.github.io/oi-blog/tags/Lucas/"}]},{"title":"åŒ—äº¬çœé€‰é›†è®­ 2019 å›¾çš„éš¾é¢˜","slug":"[åŒ—äº¬çœé€‰é›†è®­2019]å›¾çš„éš¾é¢˜","date":"2019-04-12T16:00:00.000Z","updated":"2023-12-25T16:08:27.922Z","comments":true,"path":"[åŒ—äº¬çœé€‰é›†è®­2019]å›¾çš„éš¾é¢˜/","link":"","permalink":"https://pufanyi.github.io/oi-blog/[%E5%8C%97%E4%BA%AC%E7%9C%81%E9%80%89%E9%9B%86%E8%AE%AD2019]%E5%9B%BE%E7%9A%84%E9%9A%BE%E9%A2%98/","excerpt":"é¢˜ç›®å¤§æ„ ç»™å®šä¸€å¼ æ— å‘å›¾ï¼Œè¦æ±‚æŠŠè¾¹æŸ“æˆé»‘ç™½ä¸¤è‰²ï¼Œè¦æ±‚æ‰€æœ‰ç™½è‰²è¾¹æ„æˆçš„å­å›¾æ²¡æœ‰ç¯ï¼Œä¸”æ‰€æœ‰é»‘è‰²è¾¹æ„æˆçš„å­å›¾æ²¡æœ‰ç¯ã€‚ å¤šç»„è¯¢é—®ï¼Œè¾“å‡ºæ˜¯å¦æœ‰è§£ã€‚ nâ‰¤500,mâ‰¤2n,Tâ‰¤10n\\le 500,m\\le 2n,T\\le 10nâ‰¤500,mâ‰¤2n,Tâ‰¤10ã€‚","text":"é¢˜ç›®å¤§æ„ ç»™å®šä¸€å¼ æ— å‘å›¾ï¼Œè¦æ±‚æŠŠè¾¹æŸ“æˆé»‘ç™½ä¸¤è‰²ï¼Œè¦æ±‚æ‰€æœ‰ç™½è‰²è¾¹æ„æˆçš„å­å›¾æ²¡æœ‰ç¯ï¼Œä¸”æ‰€æœ‰é»‘è‰²è¾¹æ„æˆçš„å­å›¾æ²¡æœ‰ç¯ã€‚ å¤šç»„è¯¢é—®ï¼Œè¾“å‡ºæ˜¯å¦æœ‰è§£ã€‚ nâ‰¤500,mâ‰¤2n,Tâ‰¤10n\\le 500,m\\le 2n,T\\le 10nâ‰¤500,mâ‰¤2n,Tâ‰¤10ã€‚ é¢˜è§£ æ˜¾ç„¶ï¼Œç”±ç™½è¾¹æ„æˆçš„å›¾æ˜¯ä¸€ä¸ªæ£®æ—ï¼Œé»‘è¾¹æ„æˆçš„å›¾ä¹Ÿæ˜¯ä¸ªæ£®æ—ã€‚ æ˜¾ç„¶æ£®æ—æ‰€æœ‰çš„å¯¼å‡ºå­å›¾ä¹Ÿæ˜¯æ£®æ—ã€‚ é‚£ä¹ˆæ˜¾ç„¶å›¾æ˜¯ä¸€ä¸ªæ£®æ—çš„å……è¦æ¡ä»¶ä¸ºå…¶æœ€å¤§å¯¼å‡ºå­å›¾çš„âˆ£Eâˆ£âˆ’âˆ£Vâˆ£â‰¤âˆ’1|E|-|V|\\le -1âˆ£Eâˆ£âˆ’âˆ£Vâˆ£â‰¤âˆ’1ã€‚ æˆ‘ä»¬è€ƒè™‘åŸé—®é¢˜ï¼Œå¦‚æœä¸€å¼ å›¾ GGG è¦æœ‰è§£ï¼Œé‚£ä¹ˆ GGG çš„æ‰€æœ‰å¯¼å‡ºå­å›¾éƒ½è¦æœ‰è§£ï¼Œä¸”è¯¥å›¾çš„âˆ£Eâˆ£â‰¤2(âˆ£Vâˆ£âˆ’1)|E|\\le 2(|V|-1)âˆ£Eâˆ£â‰¤2(âˆ£Vâˆ£âˆ’1)ï¼Œä¹Ÿå°±æ˜¯è®©é»‘ç™½ä¸¤ç§é¢œè‰²éƒ½èƒ½æ˜¯ä¸€ç‰‡æ£®æ—ã€‚ æœ‰äº†è¿™ä¸ª æœ‰ç†æœ‰æ®çš„ æ€§è´¨ï¼Œæˆ‘ä»¬å°±æŠŠé—®é¢˜è½¬åŒ–æˆäº†ï¼šå¯¹äºå›¾ GGGï¼Œå®šä¹‰ÏG=âˆ£Eâˆ£âˆ’2âˆ£Vâˆ£+2\\rho_G=|E|-2|V|+2ÏGâ€‹=âˆ£Eâˆ£âˆ’2âˆ£Vâˆ£+2ï¼Œæ±‚å‡ºä¸€å¼ å›¾æ‰€æœ‰å¯¼å‡ºå­å›¾Ï?\\rho?Ï? çš„æœ€å¤§å€¼ã€‚ æˆ‘ä»¬è€ƒè™‘ç½‘ç»œæµï¼ŒS?S?S?å‘æ‰€æœ‰åŸå›¾çš„è¾¹ï¼ˆçœ‹ä½œç‚¹ï¼‰è¿è¾¹ï¼Œå®¹é‡ä¸º 1?1?1?ï¼ŒåŸå›¾ä¸­æ¯æ¡è¾¹å‘ä¸ä¹‹ç›¸è¿çš„ç‚¹è¿è¾¹ï¼Œå®¹é‡âˆ?\\infty?âˆ?ï¼ŒåŸå›¾ä¸­ç‚¹å‘T?T?T? è¿è¾¹ï¼Œå®¹é‡ä¸º2?2?2?ã€‚ è€ƒè™‘æœ€å°å‰²ï¼ŒæŠŠå‰² Sâ†’ åŸå›¾ä¸­è¾¹ S\\to \\text{åŸå›¾ä¸­è¾¹}Sâ†’ åŸå›¾ä¸­è¾¹ çš„è¾¹çœ‹æˆæ˜¯ä¸é€‰è¯¥è¾¹ï¼ŒæŠŠ åŸå›¾ä¸­ç‚¹ â†’T åŸå›¾ä¸­ç‚¹ \\to TåŸ å›¾ä¸­ ç‚¹â†’Tçš„è¾¹çœ‹æˆæ˜¯é€‰è¯¥ç‚¹ï¼Œè¿™æ · ÏG=âˆ£Eâˆ£âˆ’ ä¸è¢«é€‰çš„è¾¹ + è¢«é€‰çš„ç‚¹ +2=âˆ£Eâˆ£âˆ’ æœ€å°å‰² +2\\rho_G=|E|-\\text{ä¸è¢«é€‰çš„è¾¹}+\\text{è¢«é€‰çš„ç‚¹}+2=|E|-\\text{æœ€å°å‰²}+2ÏGâ€‹=âˆ£Eâˆ£âˆ’ ä¸è¢«é€‰çš„è¾¹ + è¢«é€‰çš„ç‚¹ +2=âˆ£Eâˆ£âˆ’ æœ€å°å‰²+2ã€‚ ç„¶åå‘ç°è¾“å‡º&quot;NO&quot;Ã—âˆ\\times \\inftyÃ—âˆï¼Œå› ä¸ºå®ƒæŠŠæ‰€æœ‰è¾¹å…¨å‰²äº†ï¼Œè¿™æ ·å…¶å®å°±æ˜¯é€‰äº†ä¸€ä¸ªç©ºé›†ï¼ŒÏ=2\\rho=2Ï=2ï¼ŒGGã€‚ æˆ‘ä»¬å¼ºåˆ¶é€‰ä¸€ä¸ªç‚¹ï¼Œæšä¸¾ä¸€ä¸ªç‚¹å¼ºè¡Œå‰²æ‰ï¼Œå‘ç°è¿™æ ·å‰²ä½¿ç”¨äº† 2?2?2?ï¼Œæ­£å¥½ç­”æ¡ˆå°±æ˜¯ÏG=âˆ£Eâˆ£âˆ’ æœ€å°å‰² ?\\rho_G=|E|-\\text{æœ€å°å‰²}?ÏGâ€‹=âˆ£Eâˆ£âˆ’ æœ€å°å‰²?ã€‚ ç›´æ¥åˆ¤æ–­æ­£è´Ÿå³å¯ã€‚ å¤æ‚åº¦ O( èƒ½è¿‡ )?\\mathcal{O}(\\text{èƒ½è¿‡})?O( èƒ½è¿‡)?ã€‚ ä»£ç  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134#include &lt;bits/stdc++.h&gt;using namespace std;// è¯»å…¥è¾“å‡ºä¼˜åŒ–ç›´æ¥åˆ äº†const int maxN = 505;const int maxn = maxN &lt;&lt; 2;const int maxm = maxn &lt;&lt; 3;const int inf = 0x3f3f3f3f;struct Edge&#123; int to, nxt, cap;&#125; e[maxm &lt;&lt; 1];int first[maxn], fb[maxn];int cnt;inline void add_edge(int from, int to, int cap)&#123; e[++cnt].nxt = fb[from]; fb[from] = cnt; e[cnt].to = to; e[cnt].cap = cap; e[++cnt].nxt = fb[to]; fb[to] = cnt; e[cnt].to = from; e[cnt].cap = 0;&#125;int n, m, S, T;struct EDGE&#123; int from, to;&#125; ee[maxn];inline void jiantu(int k)&#123; memset(fb, 0xff, sizeof(fb)); cnt = -1; for (int i = 1; i &lt;= n; ++i) if (i != k) add_edge(i, T, 2); for (int i = 1; i &lt;= m; ++i) &#123; add_edge(i + n, ee[i].from, inf); add_edge(i + n, ee[i].to, inf); add_edge(S, i + n, 1); &#125;&#125;int dep[maxn];inline bool bfs()&#123; memset(dep, 0x3f, sizeof(dep)); for (int i = S; i &lt;= T; ++i) first[i] = fb[i]; queue&lt;int&gt; q; q.push(S); dep[S] = 0; while (!q.empty()) &#123; int now = q.front(); q.pop(); for (int i = first[now]; ~i; i = e[i].nxt) &#123; int to = e[i].to; if (dep[to] &gt;= inf &amp;&amp; e[i].cap &gt; 0) &#123; q.push(to); dep[to] = dep[now] + 1; &#125; &#125; &#125; return dep[T] &lt; inf;&#125;inline int dfs(int now, int limit)&#123; if (now == T || !limit) return limit; int flow = 0; for (int i = first[now]; ~i; i = e[i].nxt) &#123; first[now] = i; int to = e[i].to, f; if (dep[to] == dep[now] + 1 &amp;&amp; (f = dfs(to, min(limit, e[i].cap)))) &#123; e[i].cap -= f; e[i ^ 1].cap += f; limit -= f; flow += f; if (!limit) break; &#125; &#125; return flow;&#125;inline int Dinic()&#123; int ans = 0; while (bfs()) ans += dfs(S, inf); return ans;&#125;inline void solve()&#123; read(n), read(m); S = 0; T = n + m + 1; for (int i = 1; i &lt;= m; ++i) read(ee[i].from), read(ee[i].to); int ans = 0; for (int i = 1; i &lt;= n; ++i) &#123; jiantu(i); ans = max(ans, m - Dinic()); &#125; puts(ans &gt; 0 ? &quot;No&quot; : &quot;Yes&quot;);&#125;int main()&#123; int TT; read(TT); while (TT--) solve(); return 0;&#125;","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"ç½‘ç»œæµ","slug":"ç½‘ç»œæµ","permalink":"https://pufanyi.github.io/oi-blog/tags/%E7%BD%91%E7%BB%9C%E6%B5%81/"},{"name":"å›¾è®º","slug":"å›¾è®º","permalink":"https://pufanyi.github.io/oi-blog/tags/%E5%9B%BE%E8%AE%BA/"}]},{"title":"WF2019A Azulejos","slug":"WF2019A","date":"2019-04-04T16:00:00.000Z","updated":"2023-12-25T16:08:27.910Z","comments":true,"path":"WF2019A/","link":"","permalink":"https://pufanyi.github.io/oi-blog/WF2019A/","excerpt":"ä¸€é“æœ‰è¶£çš„è´ªå¿ƒé¢˜ã€‚","text":"ä¸€é“æœ‰è¶£çš„è´ªå¿ƒé¢˜ã€‚ é¢˜ç›®å¤§æ„ ç»™ä½ ä¸¤ç§ç“·ç – a,ba,ba,bï¼Œæ¯ç§ç“·ç –æœ‰nnn å—ï¼Œæ¯å—ç“·ç –æœ‰ä¸¤ä¸ªå±æ€§ï¼šé«˜åº¦ hhh å’Œä»·å€¼pppã€‚ ç°åœ¨è¦æ±‚ä½ æŠŠè¿™äº›ç“·ç –é‡æ–°æ’æˆä¸¤è¡Œï¼ˆ2Ã—n2\\times n2Ã—nï¼‰ã€‚å‰ä¸€è¡Œæ”¾ç“·ç –bbbï¼Œåä¸€è¡Œæ”¾ç“·ç –aaaã€‚ è¦æ±‚ä»å·¦åˆ°å³ ppp é€’å¢ï¼ˆå•è°ƒä¸å‡ï¼‰ï¼Œå¯¹äºä»»æ„ä¸€ä¸ªä½ç½®iiiï¼Œåé¢çš„ç“·ç –è¦æ¯”å‰é¢çš„ç“·ç –é«˜ã€‚ æ±‚ä¸€ç§æ–¹æ¡ˆæˆ–è¾“å‡ºæ— è§£ã€‚ nâ‰¤5Ã—105n\\le 5\\times 10^5nâ‰¤5Ã—105 é¢˜è§£ å¯¹äºä¸€æ®µ ppp ç›¸åŒçš„åŒºé—´ï¼Œæˆ‘ä»¬å¯ä»¥å°†é‡Œé¢çš„ç“·ç –éšæ„è°ƒæ¢ã€‚ è€ƒè™‘å¦‚ä½•è´ªå¿ƒã€‚ æˆ‘ä»¬å‘ç°æœ‰ä¸¤ç§ä¸åŒçš„æƒ…å†µï¼Œæˆ‘ä»¬çš„ç›®çš„ä¸åŒï¼š æ­¤æ—¶æˆ‘ä»¬æ˜¯æƒ³è®©åŒ¹é…å®Œ aaa ä¸­p=2p=2p=2æƒ…å†µåï¼Œbbbä¸­å‰©ä½™çš„ p=3p=3p=3 çš„ç“·ç –çš„ hhh å°½é‡å°ã€‚ æˆ‘ä»¬å¯ä»¥å°† aaa ä¸­p=2p=2p=2çš„æ¯å—ç“·ç –éƒ½æ‰¾åˆ° bbb ä¸­ä¸€ä¸ªæ°å¥½æ¯”å®ƒå°çš„ç“·ç –è¿›è¡ŒåŒ¹é…ã€‚ æ­¤æ—¶æˆ‘ä»¬æ˜¯æƒ³è®©åŒ¹é…å®Œ bbb ä¸­p=2p=2p=2çš„æƒ…å†µå aaa ä¸­å‰©ä½™çš„ p=3p=3p=3 çš„ç“·ç –çš„ hhh å°½é‡å¤§ã€‚ æˆ‘ä»¬å¯ä»¥å°† bbb ä¸­p=2p=2p=2çš„æ¯å—ç“·ç –éƒ½æ‰¾åˆ° aaa ä¸­ä¸€ä¸ªæ°å¥½æ¯”å®ƒå¤§çš„ç“·ç –è¿›è¡ŒåŒ¹é…ã€‚ æˆ‘ä»¬ç»´æŠ¤ç›®å‰ç¬¬ iii ä¸ªä½ç½®å¯ä»¥å¡«å“ªäº›æ•°ï¼Œå¦‚æœ aaa ä¸­å¯å¡«çš„æ•°æ¯” bbb ä¸­å°‘ï¼Œé‚£ä¹ˆæ˜¯æƒ…å†µä¸€ï¼Œå¦åˆ™å°±æ˜¯æƒ…å†µäºŒã€‚ ä»£ç  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109#include &lt;cstdio&gt;#include &lt;set&gt;#include &lt;iostream&gt;#include &lt;algorithm&gt;using namespace std;const int inf = 0x3f3f3f3f;const int maxn = 500005;struct sxd&#123; int p, h, id; friend bool operator &lt; (sxd a, sxd b) &#123; return a.p &lt; b.p; &#125;&#125;;struct pii&#123; int x, y; friend bool operator &lt; (pii a, pii b) &#123; return a.x &lt; b.x; &#125; pii (int x = 0, int y = 0) &#123; this-&gt;x = x, this-&gt;y = y; &#125;&#125;;multiset&lt;pii&gt; sta, stb;int n;sxd aa[maxn];sxd bb[maxn];int ansa[maxn];int ansb[maxn];int main()&#123; scanf(&quot;%d&quot;, &amp;n); for(int i = 1; i &lt;= n; ++i) &#123; scanf(&quot;%d&quot;, &amp;aa[i].p); aa[i].id = i; &#125; for(int i = 1; i &lt;= n; ++i) scanf(&quot;%d&quot;, &amp;aa[i].h); for(int i = 1; i &lt;= n; ++i) &#123; scanf(&quot;%d&quot;, &amp;bb[i].p); bb[i].id = i; &#125; for(int i = 1; i &lt;= n; ++i) scanf(&quot;%d&quot;, &amp;bb[i].h); sort(aa + 1, aa + n + 1); sort(bb + 1, bb + n + 1); for(int i = 1, nowa = 0, nowb = 0; i &lt;= n; ++i) &#123; if(sta.empty()) &#123; nowa++; sta.insert(pii(aa[nowa].h, aa[nowa].id)); while(nowa + 1 &lt;= n &amp;&amp; aa[nowa].p == aa[nowa + 1].p) &#123; nowa++; sta.insert(pii(aa[nowa].h, aa[nowa].id)); &#125; &#125; if(stb.empty()) &#123; nowb++; stb.insert(pii(bb[nowb].h, bb[nowb].id)); while(nowb + 1 &lt;= n &amp;&amp; bb[nowb].p == bb[nowb + 1].p) &#123; nowb++; stb.insert(pii(bb[nowb].h, bb[nowb].id)); &#125; &#125; if(sta.size() &lt; stb.size()) &#123; set&lt;pii&gt;::iterator it = stb.lower_bound(pii((sta.rbegin())-&gt;x, 0)); if(it == stb.begin()) &#123; puts(&quot;impossible&quot;); return 0; &#125; --it; ansa[i] = (sta.rbegin())-&gt;y; ansb[i] = it-&gt;y; sta.erase(--sta.end()); stb.erase(it); &#125; else &#123; set&lt;pii&gt;::iterator it = sta.upper_bound(pii((stb.begin())-&gt;x, 0)); if(it == sta.end()) &#123; puts(&quot;impossible&quot;); return 0; &#125; ansa[i] = it-&gt;y; ansb[i] = (stb.begin())-&gt;y; sta.erase(it); stb.erase(stb.begin()); &#125; &#125; for(int i = 1; i &lt;= n; ++i) printf(&quot;%d &quot;, ansa[i]); puts(&quot;&quot;); for(int i = 1; i &lt;= n; ++i) printf(&quot;%d &quot;, ansb[i]); return 0;&#125;","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"è´ªå¿ƒ","slug":"è´ªå¿ƒ","permalink":"https://pufanyi.github.io/oi-blog/tags/%E8%B4%AA%E5%BF%83/"}]},{"title":"AGC013C Ants on a Circle","slug":"agc013_c","date":"2019-03-30T16:00:00.000Z","updated":"2023-12-25T16:08:27.922Z","comments":true,"path":"agc013_c/","link":"","permalink":"https://pufanyi.github.io/oi-blog/agc013_c/","excerpt":"é¢˜ç›®é“¾æ¥ æœ‰ä¸€ä¸ªé•¿åº¦ä¸ºLLLçš„åœ†ç¯, ä¸Šé¢æœ‰nnnä¸ªèš‚èš, ä½ç½®åˆ†åˆ«ä¸ºxix_ixiâ€‹ï¼Œè¿åŠ¨æ–¹å‘ä¸ºdid_idiâ€‹ï¼Œ111è¡¨ç¤ºé¡ºæ—¶é’ˆï¼Œ222è¡¨ç¤ºé€†æ—¶é’ˆã€‚æ¯åªèš‚èšå°†ä¼šåŒæ—¶å¼€å§‹ä»¥å•ä½é€Ÿåº¦è¿åŠ¨ï¼Œå¦‚æœä¸¤åªèš‚èšç›¸é‡ï¼Œé‚£ä¹ˆå®ƒä»¬ä¼šæ”¹å˜è‡ªå·±çš„æ–¹å‘ç»§ç»­è¿åŠ¨ã€‚æ±‚TTTç§’ä¹‹åæ¯åªèš‚èšçš„ä½ç½®ã€‚[1] 1â‰¤nâ‰¤105;1â‰¤L,Tâ‰¤109;0â‰¤x1&lt;x2&lt;â‹¯&lt;xnâ‰¤Lâˆ’11\\le n\\le 10^5;1\\le L,T\\le 10^9;0\\le x_1&lt;x_2&lt;\\cdots&lt;x_n\\le L - 11â‰¤nâ‰¤105;1â‰¤L,Tâ‰¤109;0â‰¤x1â€‹&lt;x2â€‹&lt;â‹¯&lt;xnâ€‹â‰¤Lâˆ’1ã€‚","text":"é¢˜ç›®é“¾æ¥ æœ‰ä¸€ä¸ªé•¿åº¦ä¸º LLL çš„åœ†ç¯, ä¸Šé¢æœ‰ nnn ä¸ªèš‚èš, ä½ç½®åˆ†åˆ«ä¸º xix_ixiâ€‹ï¼Œè¿åŠ¨æ–¹å‘ä¸ºdid_idiâ€‹ï¼Œ111 è¡¨ç¤ºé¡ºæ—¶é’ˆï¼Œ222è¡¨ç¤ºé€†æ—¶é’ˆã€‚æ¯åªèš‚èšå°†ä¼šåŒæ—¶å¼€å§‹ä»¥å•ä½é€Ÿåº¦è¿åŠ¨ï¼Œå¦‚æœä¸¤åªèš‚èšç›¸é‡ï¼Œé‚£ä¹ˆå®ƒä»¬ä¼šæ”¹å˜è‡ªå·±çš„æ–¹å‘ç»§ç»­è¿åŠ¨ã€‚æ±‚ TTT ç§’ä¹‹åæ¯åªèš‚èšçš„ä½ç½®ã€‚[1] 1â‰¤nâ‰¤105;1â‰¤L,Tâ‰¤109;0â‰¤x1&lt;x2&lt;â‹¯&lt;xnâ‰¤Lâˆ’11\\le n\\le 10^5;1\\le L,T\\le 10^9;0\\le x_1&lt;x_2&lt;\\cdots&lt;x_n\\le L - 11â‰¤nâ‰¤105;1â‰¤L,Tâ‰¤109;0â‰¤x1â€‹&lt;x2â€‹&lt;â‹¯&lt;xnâ€‹â‰¤Lâˆ’1ã€‚ é¢˜è§£ æ˜¾ç„¶æˆ‘ä»¬å…ˆæ¥çœ‹å¦‚æœæ²¡æœ‰æ ‡å·ï¼Œé‚£ä¹ˆå¯ä»¥æŠŠä¸¤åªèš‚èšçš„â€œæ‰å¤´â€æ— è§†æ‰ï¼Œè¿™æ ·æˆ‘ä»¬å°±å·²ç»çŸ¥é“äº†èš‚èšçš„ä½ç½®ã€‚ ä¸éš¾å‘ç°æ¯åªèš‚èšçš„ç›¸å¯¹ä½ç½®ä¸å˜ï¼Œå³å®ƒå·¦è¾¹å’Œå³è¾¹çš„èš‚èšæ˜¯ä¸ä¼šå˜çš„ã€‚ äºæ˜¯æˆ‘ä»¬åªè¦ç¡®å®šå…¶ä¸­ä¸€åªèš‚èšå³å¯ã€‚ æˆ‘ä»¬å¯ä»¥è®°å½•ä¸€ä¸‹åæ ‡æœ€å°çš„èš‚èšæ˜¯é‚£åªï¼Œå³è¶Šè¿‡ 000 åæ ‡çš„èš‚èšæœ‰å‡ åªï¼Œè¿™æ ·å°±ç¡®å®šäº†ä¸€åªèš‚èšã€‚ ä»£ç  1234567891011121314151617181920212223242526272829303132333435363738394041#include &lt;cstdio&gt;#include &lt;iostream&gt;#include &lt;algorithm&gt;using namespace std;const int maxn = 100005;int n, t, l;int hou[maxn];int main()&#123; scanf(&quot;%d%d%d&quot;, &amp;n, &amp;l, &amp;t); int fromm = 0; for (int i = 1, x, fx; i &lt;= n; ++i) &#123; scanf(&quot;%d%d&quot;, &amp;x, &amp;fx); if (fx == 2) &#123; hou[i] = x - t; (fromm -= (l - hou[i] - 1) / l) %= n; ((hou[i] %= l) += l) %= l; &#125; else &#123; hou[i] = x + t; (fromm += hou[i] / l) %= n; hou[i] %= l; &#125; &#125; (fromm += n) %= n; sort(hou + 1, hou + n + 1); for (int i = fromm + 1; i &lt;= n; ++i) printf(&quot;%d\\n&quot;, hou[i]); for (int i = 1; i &lt;= fromm; ++i) printf(&quot;%d\\n&quot;, hou[i]); return 0;&#125; ç¿»è¯‘æ¥è‡ªluoguã€‚ â†©ï¸","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"AtCoder","slug":"AtCoder","permalink":"https://pufanyi.github.io/oi-blog/tags/AtCoder/"}]},{"title":"AGC014D Black and White Tree","slug":"agc014_d","date":"2019-03-30T16:00:00.000Z","updated":"2023-12-25T16:08:27.922Z","comments":true,"path":"agc014_d/","link":"","permalink":"https://pufanyi.github.io/oi-blog/agc014_d/","excerpt":"é¢˜ç›®é“¾æ¥ ç»™å‡ºä¸€é¢—n(nâ‰¤105)n(n\\le 10^5)n(nâ‰¤105)ä¸ªèŠ‚ç‚¹ç»„æˆçš„æ ‘ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½å¯ä»¥è¢«æŸ“æˆç™½è‰²æˆ–è€…é»‘è‰²ã€‚ æœ‰é«˜æ¡¥ï¼ˆå…ˆæ‰‹ï¼‰å’Œé’æœ¨ï¼ˆåæ‰‹ï¼‰ä¸¤ä¸ªäººï¼Œé«˜æ¡¥å¯ä»¥æŠŠä»»æ„æŸä¸ªç‚¹æŸ“æˆç™½è‰²ï¼Œé’æœ¨åˆ™å¯ä»¥æŠŠä»»æ„ä¸€ä¸ªç‚¹æŸ“æˆé»‘è‰²ï¼Œæ¯ä¸ªç‚¹åªå¯æŸ“è‰²ä¸€æ¬¡ã€‚ å½“æ‰€æœ‰ç‚¹éƒ½è¢«æŸ“è‰²åï¼Œåªæ‰§è¡Œä¸€æ¬¡æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š æŠŠæ‰€æœ‰é’æœ¨æŸ“æˆé»‘è‰²çš„èŠ‚ç‚¹çš„ç›¸é‚»çš„ç™½ç‚¹æ„ŸæŸ“æˆâ€œæ¬¡é»‘è‰²â€ï¼› æ¬¡é»‘è‰²ä¸èƒ½ç»§ç»­æ„ŸæŸ“ç™½ç‚¹ã€‚ è‹¥æ“ä½œå®Œæ¯•åä»è¿˜æœ‰ç™½ç‚¹å­˜åœ¨ï¼Œå³é«˜æ¡¥ï¼ˆå…ˆæ‰‹ï¼‰èƒœï¼Œåä¹‹åˆ™é’æœ¨ï¼ˆåæ‰‹ï¼‰èƒœã€‚ ç°åœ¨ç»™å‡ºè¿™æ£µæ ‘ï¼Œé—®å½“å‰æ­¤æ ‘æ˜¯å…ˆæ‰‹å¿…èƒœoråæ‰‹å¿…èƒœã€‚[1]","text":"é¢˜ç›®é“¾æ¥ ç»™å‡ºä¸€é¢— n(nâ‰¤105)n(n\\le 10^5)n(nâ‰¤105) ä¸ªèŠ‚ç‚¹ç»„æˆçš„æ ‘ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½å¯ä»¥è¢«æŸ“æˆç™½è‰²æˆ–è€…é»‘è‰²ã€‚ æœ‰é«˜æ¡¥ï¼ˆå…ˆæ‰‹ï¼‰å’Œé’æœ¨ï¼ˆåæ‰‹ï¼‰ä¸¤ä¸ªäººï¼Œé«˜æ¡¥å¯ä»¥æŠŠä»»æ„æŸä¸ªç‚¹æŸ“æˆç™½è‰²ï¼Œé’æœ¨åˆ™å¯ä»¥æŠŠä»»æ„ä¸€ä¸ªç‚¹æŸ“æˆé»‘è‰²ï¼Œæ¯ä¸ªç‚¹åªå¯æŸ“è‰²ä¸€æ¬¡ã€‚ å½“æ‰€æœ‰ç‚¹éƒ½è¢«æŸ“è‰²åï¼Œåªæ‰§è¡Œä¸€æ¬¡æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š æŠŠæ‰€æœ‰é’æœ¨æŸ“æˆé»‘è‰²çš„èŠ‚ç‚¹çš„ç›¸é‚»çš„ç™½ç‚¹æ„ŸæŸ“æˆâ€œæ¬¡é»‘è‰²â€ï¼› æ¬¡é»‘è‰²ä¸èƒ½ç»§ç»­æ„ŸæŸ“ç™½ç‚¹ã€‚ è‹¥æ“ä½œå®Œæ¯•åä»è¿˜æœ‰ç™½ç‚¹å­˜åœ¨ï¼Œå³é«˜æ¡¥ï¼ˆå…ˆæ‰‹ï¼‰èƒœï¼Œåä¹‹åˆ™é’æœ¨ï¼ˆåæ‰‹ï¼‰èƒœã€‚ ç°åœ¨ç»™å‡ºè¿™æ£µæ ‘ï¼Œé—®å½“å‰æ­¤æ ‘æ˜¯å…ˆæ‰‹å¿…èƒœ or åæ‰‹å¿…èƒœã€‚[1] é¢˜è§£ é—®é¢˜æ˜¾ç„¶å°±æ˜¯é’æœ¨ä¸èƒ½è®©ä»»æ„ä¸€ä¸ªç™½ç‚¹æ—è¾¹æ²¡æœ‰é»‘ç‚¹ã€‚ å¦‚æœè¯¥æ ‘æœ‰å®Œç¾åŒ¹é…ï¼Œé‚£ä¹ˆæ˜¾ç„¶æ˜¯åæ‰‹èµ¢ã€‚å› ä¸ºä¸ç®¡å…ˆæ‰‹é€‰ä»€ä¹ˆï¼Œåæ‰‹åªè¦é€‰å…ˆæ‰‹å¯¹åº”çš„ç‚¹å°±å¯ä»¥ã€‚ äºæ˜¯æˆ‘ä»¬å°±æ¥è€ƒè™‘æ²¡æœ‰å®Œç¾åŒ¹é…çš„æƒ…å†µã€‚ æœ€ç‰¹æ®Šçš„åº”è¯¥æ˜¯å¶å­èŠ‚ç‚¹ï¼Œå› ä¸ºåªæœ‰ä¸€ä¸ªç‚¹ä¸å®ƒç›¸é‚»ã€‚å¦‚æœå¶å­èŠ‚ç‚¹æ˜¯ç™½ç‚¹ï¼Œé‚£ä¹ˆå¶å­èŠ‚ç‚¹çš„â€œçˆ¶äº²â€å¿…é¡»æ˜¯é»‘ç‚¹ï¼›è€Œå¦‚æœå¶å­æ˜¯é»‘ç‚¹ï¼Œé‚£ä¹ˆå¶å­èŠ‚ç‚¹çš„â€œçˆ¶äº²â€å¿…é¡»æ˜¯ç™½ç‚¹ã€‚è¿™é‡Œçš„â€œçˆ¶äº²â€æ˜¯æŒ‡å®ƒç›¸é‚»çš„ç‚¹ã€‚ æˆ‘ä»¬è€ƒè™‘å…ˆæ‰‹å…ˆä»»æ„ä¸€ä¸ªå¶å­èŠ‚ç‚¹çš„â€œçˆ¶äº²â€ï¼Œé‚£åæ‰‹å¿…é¡»è·Ÿç€é€‰å¶å­ã€‚ç„¶åæˆ‘ä»¬å‘ç°æˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸¤ä¸ªç‚¹åˆ æ‰ï¼Œå¹¶ä¸ä¼šå½±å“ç»“æœã€‚ äºæ˜¯æˆ‘ä»¬å¯ä»¥æ¯æ¬¡è¿™æ ·åˆ ä¸‹å»ã€‚ç”±äºè¿™æ£µæ ‘æ²¡æœ‰å®Œç¾åŒ¹é…ï¼Œæœ€åè‚¯å®šæ˜¯ä¸€äº›é›¶æ•£çš„ç‚¹ã€‚è€Œæ­¤æ—¶å…ˆæ‰‹é€‰æ‹©å…¶ä¸­çš„ä»»æ„ä¸€ä¸ªç‚¹å³å¯ã€‚ æˆ‘ä»¬è€ƒè™‘å¦‚ä½•æ±‚å‡ºæ˜¯å¦å­˜åœ¨å®Œç¾åŒ¹é…ã€‚ æˆ‘ä»¬å¯ä»¥è€ƒè™‘ç›´æ¥æ¨¡æ‹Ÿä¸Šé¢çš„æ¸¸æˆè¿‡ç¨‹ï¼Œå› ä¸ºå¦‚æœå…ˆæ‰‹æŒ‰è¿™ä¸ªç­–ç•¥æ²¡æœ‰èµ¢ï¼Œé‚£ä¹ˆè‚¯å®šæ²¡æœ‰å®Œç¾åŒ¹é…ã€‚ æˆ‘ä»¬ä»»é€‰ä¸€ä¸ªèŠ‚ç‚¹ä¸ºæ ¹è¿›è¡Œdfsï¼Œå°†å„¿å­å¤„ç†å®Œåå¦‚æœè¿™ä¸ªç‚¹è¿˜æ²¡è¢«åˆ ï¼Œé‚£ä¹ˆæŠŠå®ƒå°±å·²ç»å˜æˆå¶å­èŠ‚ç‚¹äº†ï¼ŒæŠŠå®ƒå’Œå®ƒçˆ¶äº²ä¸€èµ·åˆ æ‰ã€‚ ä»£ç  12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061#include &lt;cstdio&gt;#include &lt;cstdlib&gt;#include &lt;algorithm&gt;using namespace std;const int maxn = 100005;struct Edge&#123; int to, nxt;&#125; e[maxn &lt;&lt; 1];int first[maxn];inline void add_edge(int from, int to)&#123; static int cnt = 0; e[++cnt].nxt = first[from]; first[from] = cnt; e[cnt].to = to; e[++cnt].nxt = first[to]; first[to] = cnt; e[cnt].to = from;&#125;bool shan[maxn];int n;inline void dfs(int now, int fa)&#123; for(int i = first[now]; i; i = e[i].nxt) &#123; register int to = e[i].to; if(to != fa) dfs(to, now); &#125; if(!shan[now]) &#123; if(shan[fa]) &#123; puts(&quot;First&quot;); exit(0); &#125; shan[now] = shan[fa] = true; &#125;&#125;int main()&#123; shan[0] = true; scanf(&quot;%d&quot;, &amp;n); for(int i = 1, f, t; i &lt; n; ++i) &#123; scanf(&quot;%d%d&quot;, &amp;f, &amp;t); add_edge(f, t); &#125; dfs(1, 0); puts(&quot;Second&quot;); return 0;&#125; ç¿»è¯‘æ¥è‡ªluoguã€‚ â†©ï¸","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"AtCoder","slug":"AtCoder","permalink":"https://pufanyi.github.io/oi-blog/tags/AtCoder/"},{"name":"åšå¼ˆ","slug":"åšå¼ˆ","permalink":"https://pufanyi.github.io/oi-blog/tags/%E5%8D%9A%E5%BC%88/"}]},{"title":"AGC012D Colorful Balls","slug":"agc012_d","date":"2019-03-30T16:00:00.000Z","updated":"2023-12-25T16:08:27.922Z","comments":true,"path":"agc012_d/","link":"","permalink":"https://pufanyi.github.io/oi-blog/agc012_d/","excerpt":"åŸé¢˜é“¾æ¥ n(nâ‰¤105)n(n\\le 10^5)n(nâ‰¤105)ä¸ªçƒæ’æˆä¸€æ’ï¼Œç¬¬iiiä¸ªçƒæœ‰é¢œè‰²ci(ciâ‰¤n)c_i(c_i\\le n)ciâ€‹(ciâ€‹â‰¤n)å’Œé‡é‡wi(wiâ‰¤109)w_i(w_i\\le 10^9)wiâ€‹(wiâ€‹â‰¤109)ã€‚ Snukeæ¯æ¬¡å¯ä»¥é€‰æ‹©ä¸¤ä¸ªé¢œè‰²ç›¸åŒï¼Œä¸”é‡é‡ä¹‹å’Œä¸è¶…è¿‡xxxçš„çƒï¼Œäº¤æ¢ä»–ä»¬çš„ä½ç½®ã€‚ Snukeæ¯æ¬¡å¯ä»¥é€‰æ‹©ä¸¤ä¸ªé¢œè‰²ä¸åŒï¼Œä¸”é‡é‡ä¹‹å’Œä¸è¶…è¿‡yyyçš„çƒï¼Œäº¤æ¢ä»–ä»¬çš„ä½ç½®ã€‚ é—®å¯ä»¥å¾—åˆ°å¤šå°‘ç§ä¸åŒçš„é¢œè‰²åºåˆ—ã€‚1â‰¤x,yâ‰¤1091\\le x,y\\le 10^91â‰¤x,yâ‰¤109ï¼Œç­”æ¡ˆå¯¹109+710^9+7109+7å–æ¨¡ã€‚[1]","text":"åŸé¢˜é“¾æ¥ n(nâ‰¤105)n(n\\le 10^5)n(nâ‰¤105)ä¸ªçƒæ’æˆä¸€æ’ï¼Œç¬¬ iii ä¸ªçƒæœ‰é¢œè‰² ci(ciâ‰¤n)c_i(c_i\\le n)ciâ€‹(ciâ€‹â‰¤n) å’Œé‡é‡ wi(wiâ‰¤109)w_i(w_i\\le 10^9)wiâ€‹(wiâ€‹â‰¤109)ã€‚ Snuke æ¯æ¬¡å¯ä»¥é€‰æ‹©ä¸¤ä¸ªé¢œè‰²ç›¸åŒï¼Œä¸”é‡é‡ä¹‹å’Œä¸è¶…è¿‡xxx çš„çƒï¼Œäº¤æ¢ä»–ä»¬çš„ä½ç½®ã€‚ Snuke æ¯æ¬¡å¯ä»¥é€‰æ‹©ä¸¤ä¸ªé¢œè‰²ä¸åŒï¼Œä¸”é‡é‡ä¹‹å’Œä¸è¶…è¿‡ yyy çš„çƒï¼Œäº¤æ¢ä»–ä»¬çš„ä½ç½®ã€‚ é—®å¯ä»¥å¾—åˆ°å¤šå°‘ç§ä¸åŒçš„é¢œè‰²åºåˆ—ã€‚1â‰¤x,yâ‰¤1091\\le x,y\\le 10^91â‰¤x,yâ‰¤109ï¼Œç­”æ¡ˆå¯¹ 109+710^9+7109+7 å–æ¨¡ã€‚[1] é¢˜è§£ æˆ‘ä»¬è€ƒè™‘ä»€ä¹ˆæ—¶å€™è¿ä¸ªçƒèƒ½è¿›è¡Œäº¤æ¢ã€‚ æ˜¾ç„¶å¦‚æœæœ‰ä¸‰ä¸ªçƒ a,b,ca,b,ca,b,cï¼Œå¦‚æœaaa ä¸bbbèƒ½äº¤æ¢ï¼Œbbbä¸ ccc èƒ½äº¤æ¢ï¼Œé‚£ aaa ä¸cccä¸€å®šèƒ½é€šè¿‡ bbb çš„â€œåª’ä»‹â€äº¤æ¢ï¼ˆaaaå…ˆäº bbb äº¤æ¢ï¼Œbbbä¸ ccc äº¤æ¢ï¼Œaaaä¸ bbb äº¤æ¢ï¼‰ã€‚ äºæ˜¯æˆ‘ä»¬å¯ä»¥æŠŠ a,b,ca,b,ca,b,c ç¼©åœ¨åŒä¸€ä¸ªè¿é€šå—é‡Œã€‚ ç”±äºä¸åŒé¢œè‰²ä¸ç›¸åŒé¢œè‰²äº¤æ¢æ¡ä»¶æ˜¯ä¸ä¸€æ ·çš„ï¼Œæˆ‘ä»¬å…ˆè€ƒè™‘ç›¸åŒé¢œè‰²ã€‚ æ˜¾ç„¶åªéœ€è¦ç”¨æœ€å°å€¼åšâ€œåª’ä»‹â€å³å¯ã€‚ ç„¶åæˆ‘ä»¬è€ƒè™‘è·¨é¢œè‰²äº¤æ¢ã€‚æˆ‘ä»¬å‘ç°åªéœ€è¦ç”¨å…¨å±€æœ€å°å€¼åšâ€œåª’ä»‹â€ï¼Œä¹Ÿå°±æ˜¯è¯´å¯¹äºæŸä¸ªç‚¹ï¼Œå…ˆé€šè¿‡è¯¥é¢œè‰²æœ€å°å€¼æ¢åˆ°å…¨å±€æœ€å°å€¼ï¼Œå†é€šè¿‡å…¨å±€æœ€å°å€¼æ¢åˆ°å…¶ä»–ç‚¹ã€‚å¦‚æœä¸å…¨å±€æœ€å°å€¼é¢œè‰²ç›¸åŒï¼Œé‚£æˆ‘ä»¬å°±åªèƒ½ç”¨æ¬¡å°å€¼åšåª’ä»‹ã€‚ è¿™æ ·æˆ‘ä»¬åªéœ€è¦è®°å½•æŸç§é¢œè‰²çš„æœ€å°å€¼ã€å…¨å±€æœ€å°å€¼ã€å…¨å±€æ¬¡å°å€¼å³å¯ã€‚ ç„¶åæˆ‘ä»¬ä¸éš¾å‘ç°å«æœ‰ä¸åŒé¢œè‰²çš„è¿é€šå—åªæœ‰ä¸€ä¸ªï¼Œé‚£å°±æ˜¯å…¨å±€æœ€å°å€¼æ‰€åœ¨çš„è¿é€šå—ã€‚ è€Œåªæœ‰ä¸€ç§é¢œè‰²çš„è¿é€šå—å¯¹ç­”æ¡ˆæ²¡æœ‰å½±å“ã€‚ äºæ˜¯æˆ‘ä»¬åªè€ƒè™‘æœ€å°å€¼æ‰€åœ¨çš„è¿é€šå—ã€‚é¦–å…ˆæˆ‘ä»¬æ‰¾åˆ°å…¨å±€æœ€å°å€¼ã€å…¨å±€æ¬¡å°å€¼ä¸æ¯ç§é¢œè‰²çš„æœ€å°å€¼ã€‚å¦‚æœä»–ä»¬éƒ½ä¸èƒ½äº¤æ¢ï¼Œé‚£æ˜¾ç„¶æ˜¯å‡‰äº†ï¼ˆç­”æ¡ˆä¸º111ï¼‰ã€‚æˆ‘ä»¬å¯¹æ¯ç§é¢œè‰²æ•°å‡ºèƒ½ä¸è¯¥ç§é¢œè‰²æœ€å°å€¼äº¤æ¢çš„ç‚¹æ•°ï¼Œç„¶åç”¨æ¯ç§è¿é€šå—çš„æœ€å°å€¼ä¸å…¨å±€æœ€å°å€¼ï¼ˆå…¨å±€æ¬¡å°å€¼ï¼‰æ¯”è¾ƒï¼Œæ±‚å‡ºè¿™ä¸ªè”é€šå—ã€‚æˆ‘ä»¬å‘ç°å°±æ˜¯æ±‚è¿™ä¸ªè”é€šå—æ’åˆ—æ–¹æ¡ˆæ•°ï¼Œå…¶å®å°±æ˜¯å¯é‡é›†åˆæ’åˆ—ã€‚ ä»£ç  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990#include &lt;cstdio&gt;#include &lt;cstring&gt;#include &lt;iostream&gt;#include &lt;algorithm&gt;using namespace std;typedef long long LL;const int maxn = 1000005;const int inf = 0x3f3f3f3f;const int mod = 1000000007;int n, A, B;int fac[maxn], inv[maxn];int c[maxn], w[maxn], minci[maxn];int Gs[maxn];inline int pow(int a, int b)&#123; int ans = 1; for(; b; b &gt;&gt;= 1, a = (LL) a * a % mod) if(b &amp; 1) ans = (LL) ans * a % mod; return ans;&#125;inline int C(int n, int m)&#123; if(!n) return 1; if(m &lt; n) return 0; return (LL) fac[m] * (LL) inv[m - n] % mod * (LL) inv[n] % mod;&#125;int main()&#123; scanf(&quot;%d%d%d&quot;, &amp;n, &amp;A, &amp;B); memset(minci, 0x3f, sizeof(minci)); for(int i = 1; i &lt;= n; ++i) &#123; scanf(&quot;%d%d&quot;, &amp;c[i], &amp;w[i]); minci[c[i]] = min(minci[c[i]], w[i]); &#125; int minn = 0, minnn = 0; for(int i = 1; i &lt;= n; ++i) &#123; if(minci[i] &lt; minci[minn]) &#123; minnn = minn; minn = i; &#125; else if(minci[i] &lt; minci[minnn]) minnn = i; &#125; int gss = 0; for(int i = 1; i &lt;= n; ++i) &#123; if(w[i] + minci[c[i]] &lt;= A) w[i] = minci[c[i]]; if(c[i] == minn &amp;&amp; minci[minnn] + w[i] &lt;= B) &#123; Gs[c[i]]++; gss++; &#125; if(c[i] != minn &amp;&amp; minci[minn] + w[i] &lt;= B) &#123; Gs[c[i]]++; gss++; &#125; &#125; int ans = 1; fac[0] = 1; for(int i = 1; i &lt;= n; ++i) fac[i] = (LL) i * fac[i - 1] % mod; inv[n] = pow(fac[n], mod - 2); for(int i = n - 1; ~i; --i) inv[i] = (LL) inv[i + 1] * (i + 1) % mod; for(int i = 1; i &lt;= n; ++i) &#123; if(Gs[i]) &#123; ans = (LL) ans * (LL) C(Gs[i], gss) % mod; gss -= Gs[i]; &#125; &#125; printf(&quot;%d\\n&quot;, ans); return 0;&#125; ç¿»è¯‘æ¥è‡ªluoguï¼Œæœ‰åˆ æ”¹ â†©ï¸","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"æ•°å­¦","slug":"æ•°å­¦","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%95%B0%E5%AD%A6/"},{"name":"AtCoder","slug":"AtCoder","permalink":"https://pufanyi.github.io/oi-blog/tags/AtCoder/"}]},{"title":"ARC078F Mole and Abandoned Mine","slug":"arc078_d","date":"2019-03-30T16:00:00.000Z","updated":"2023-12-25T16:08:27.934Z","comments":true,"path":"arc078_d/","link":"","permalink":"https://pufanyi.github.io/oi-blog/arc078_d/","excerpt":"é¢˜ç›®é“¾æ¥ ç»™ä¸€ä¸ªn(nâ‰¤15)n(n\\le 15)n(nâ‰¤15)ä¸ªç‚¹mmmæ¡è¾¹çš„æ— å‘è¿é€šå›¾ï¼ˆä¸å­˜åœ¨è‡ªç¯æˆ–é‡è¾¹ï¼‰ï¼Œæ¯æ¡è¾¹æœ‰ä¸€ä¸ªè¾¹æƒï¼Œè¦æ±‚å‰²æ‰è‹¥å¹²æ¡è¾¹ï¼Œä½¿111åˆ°nnnåªæœ‰111æ¡è·¯å¾„ï¼ˆä¸ç»è¿‡é‡å¤ç‚¹ï¼‰ï¼Œé—®å‰²æ‰çš„è¾¹æƒå’Œæœ€å°æ˜¯å¤šå°‘ã€‚[1]","text":"é¢˜ç›®é“¾æ¥ ç»™ä¸€ä¸ª n(nâ‰¤15)n(n\\le 15)n(nâ‰¤15) ä¸ªç‚¹ mmm æ¡è¾¹çš„æ— å‘è¿é€šå›¾ï¼ˆä¸å­˜åœ¨è‡ªç¯æˆ–é‡è¾¹ï¼‰ï¼Œæ¯æ¡è¾¹æœ‰ä¸€ä¸ªè¾¹æƒï¼Œè¦æ±‚å‰²æ‰è‹¥å¹²æ¡è¾¹ï¼Œä½¿ 111 åˆ°nnnåªæœ‰ 111 æ¡è·¯å¾„ï¼ˆä¸ç»è¿‡é‡å¤ç‚¹ï¼‰ï¼Œé—®å‰²æ‰çš„è¾¹æƒå’Œæœ€å°æ˜¯å¤šå°‘ã€‚[1] é¢˜è§£ é—®é¢˜å…¶å®å°±æ˜¯éœ€è¦ä¿ç•™çš„è¾¹æƒå’Œæœ€å¤§ã€‚ é—®é¢˜æ˜¯æœ‰å…³ç‚¹é›† + è·¯å¾„çš„ï¼Œä¸éš¾æƒ³åˆ°çŠ¶æ€ï¼šfi,jâ€‹f_{i,j}â€‹fi,jâ€‹â€‹è¡¨ç¤ºéå†äº†é›†åˆ iâ€‹iâ€‹iâ€‹ï¼Œè¿™æ¡å”¯ä¸€çš„è·¯å¾„çš„å·²ç»æ˜¯ä»1â€‹1â€‹1â€‹ åˆ°jâ€‹jâ€‹jâ€‹çš„ç­”æ¡ˆã€‚ æˆ‘ä»¬è€ƒè™‘é€‰æ‹©è·¯å¾„çš„å½¢çŠ¶ï¼Œå¤§æ¦‚åº”è¯¥åº”è¯¥æ˜¯è¿™æ ·çš„ï¼š å°±æ˜¯ 1âˆ¼n1\\sim n1âˆ¼n çš„ä¸€æ¡ï¼Œç„¶åä¸­é—´è®¸å¤šåˆ†å‰ï¼Œè¿å‘ä¸€äº›è¿é€šå—ï¼Œè€Œè¿™äº›è”é€šå—ä¸­æ‰€æœ‰çš„è¾¹éƒ½è¿ä¸Šã€‚ äºæ˜¯æˆ‘ä»¬è€ƒè™‘è½¬ç§»ã€‚ å½“ j=1j=1j=1 æ—¶ï¼Œfi,j=Eif_{i,j}=E_ifi,jâ€‹=Eiâ€‹ï¼Œå…¶ä¸­ EiE_iEiâ€‹ è¡¨ç¤º iâ€‹iâ€‹iâ€‹ é›†åˆä¸­æ‰€æœ‰è¾¹çš„æƒå€¼å’Œã€‚ å¯ä»¥è¿ä¸‹ä¸€ä¸ªé“¾ä¸Šçš„ç‚¹ï¼šfiâˆ–{j},k+dk,jâ†’fi,jf_{i\\setminus \\{j\\},k}+d_{k,j}\\to f_{i,j}fiâˆ–{j},kâ€‹+dk,jâ€‹â†’fi,jâ€‹ï¼Œå°±æ˜¯åœ¨ kkk åé¢æ–°å¢ä¸€ä¸ªç‚¹ jjjï¼Œå½“ç„¶è¿™ä¸ªè½¬ç§»çš„æ—¶å€™dk,jd_{k,j}dk,jâ€‹ åº”å¤§äº000ã€‚ è¿˜å¯ä»¥ä» jjj å‘ä¸€ä¸ªä¼¸å‡ºå»ä¸€ä¸ªè¿é€šå—ï¼šfiâˆ–k,j+Ekâ‹ƒ{j}â†’fi,jf_{i\\setminus k,j}+E_{k\\bigcup\\{j\\}}\\to f_{i,j}fiâˆ–k,jâ€‹+Ekâ‹ƒ{j}â€‹â†’fi,jâ€‹ï¼Œå½“ç„¶å…¶ä¸­jâˆ‰kâ€‹j\\notin kâ€‹jâˆˆ/kâ€‹ã€‚ ä»£ç  12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758#include &lt;cstdio&gt;#include &lt;bitset&gt;#include &lt;cstring&gt;#include &lt;iostream&gt;#include &lt;algorithm&gt;using namespace std;typedef long long LL;const int maxn = 15;const int inf = 0x3f3f3f3f;int mmap[maxn][maxn];LL in[1 &lt;&lt; maxn];LL dp[1 &lt;&lt; maxn][maxn];int n, m;int main()&#123; scanf(&quot;%d%d&quot;, &amp;n, &amp;m); for (int i = 0, f, t, d; i &lt; m; ++i) &#123; scanf(&quot;%d%d%d&quot;, &amp;f, &amp;t, &amp;d); mmap[t - 1][f - 1] = mmap[f - 1][t - 1] = d; &#125; for (int i = 0; i &lt; (1 &lt;&lt; n); ++i) for (int j = 0; j &lt; n; ++j) if (i &amp; (1 &lt;&lt; j)) for (int k = j + 1; k &lt; n; ++k) if (i &amp; (1 &lt;&lt; k)) in[i] += mmap[j][k]; for (int i = 0; i &lt; (1 &lt;&lt; n); ++i) for (int j = 0; j &lt; n; ++j) dp[i][j] = -inf; for (int i = 0; i &lt; (1 &lt;&lt; n); ++i) &#123; for (int j = 0; j &lt; n; ++j) &#123; if (i &amp; (1 &lt;&lt; j)) &#123; if (!j) dp[i][j] = in[i]; else &#123; for (int k = 0; k &lt; n; ++k) if (j != k &amp;&amp; (i &amp; (1 &lt;&lt; k)) &amp;&amp; mmap[k][j]) dp[i][j] = max(dp[i][j], dp[i ^ (1 &lt;&lt; j)][k] + mmap[k][j]); for (int tmp = (i ^ (1 &lt;&lt; j)), k = tmp; k; k = (k - 1) &amp; tmp) dp[i][j] = max(dp[i][j], dp[i ^ k][j] + in[k | (1 &lt;&lt; j)]); &#125; &#125; &#125; &#125; printf(&quot;%lld\\n&quot;, in[(1 &lt;&lt; n) - 1] - dp[(1 &lt;&lt; n) - 1][n - 1]); return 0;&#125; ç¿»è¯‘æ¥è‡ªluoguã€‚ â†©ï¸","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"DP","slug":"DP","permalink":"https://pufanyi.github.io/oi-blog/tags/DP/"},{"name":"AtCoder","slug":"AtCoder","permalink":"https://pufanyi.github.io/oi-blog/tags/AtCoder/"}]},{"title":"CodeForces 1137F Matches Are Not a Child's Play","slug":"CF1137F","date":"2019-03-26T16:00:00.000Z","updated":"2023-12-25T16:08:27.871Z","comments":true,"path":"CF1137F/","link":"","permalink":"https://pufanyi.github.io/oi-blog/CF1137F/","excerpt":"é¢˜ç›®å¤§æ„ æˆ‘ä»¬å®šä¹‰ä¸€æ£µæ ‘çš„åˆ é™¤åºåˆ—ä¸ºï¼šæ¯ä¸€æ¬¡å°†æ ‘ä¸­ç¼–å·æœ€å°çš„å¶å­åˆ æ‰ï¼Œå°†è¯¥èŠ‚ç‚¹ç¼–å·åŠ å…¥åˆ°å½“å‰åºåˆ—çš„æœ€æœ«ç«¯ï¼Œæœ€ååªå‰©ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æ—¶å°†è¯¥èŠ‚ç‚¹çš„ç¼–å·åŠ å…¥åˆ°ç»“å°¾ã€‚ ä¾‹å¦‚å¯¹äºä¸Šå›¾ä¸­çš„æ ‘ï¼Œå®ƒçš„åˆ é™¤åºåˆ—ä¸ºï¼š2 4 3 1 5ã€‚ ç°åœ¨ç»™å‡ºä¸€æ£µnnnä¸ªèŠ‚ç‚¹çš„æ ‘ï¼Œæœ‰mmmæ¬¡æ“ä½œï¼š up vï¼šå°†vvvå·èŠ‚ç‚¹çš„ç¼–å·å˜ä¸ºå½“å‰æ‰€æœ‰èŠ‚ç‚¹ç¼–å·çš„maxâ¡+1\\max + 1max+1ï¼› when vï¼šæŸ¥è¯¢vvvåœ¨å½“å‰æ ‘çš„åˆ é™¤åºåˆ—ä¸­æ˜¯ç¬¬å‡ å·å…ƒç´ ï¼› compare u vï¼šæŸ¥è¯¢uuuå’Œvvvåœ¨å½“å‰æ ‘çš„åˆ é™¤åºåˆ—ä¸­è°æ›´é å‰ã€‚","text":"é¢˜ç›®å¤§æ„ æˆ‘ä»¬å®šä¹‰ä¸€æ£µæ ‘çš„åˆ é™¤åºåˆ—ä¸ºï¼šæ¯ä¸€æ¬¡å°†æ ‘ä¸­ç¼–å·æœ€å°çš„å¶å­åˆ æ‰ï¼Œå°†è¯¥èŠ‚ç‚¹ç¼–å·åŠ å…¥åˆ°å½“å‰åºåˆ—çš„æœ€æœ«ç«¯ï¼Œæœ€ååªå‰©ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æ—¶å°†è¯¥èŠ‚ç‚¹çš„ç¼–å·åŠ å…¥åˆ°ç»“å°¾ã€‚ ä¾‹å¦‚å¯¹äºä¸Šå›¾ä¸­çš„æ ‘ï¼Œå®ƒçš„åˆ é™¤åºåˆ—ä¸ºï¼š2 4 3 1 5ã€‚ ç°åœ¨ç»™å‡ºä¸€æ£µ nnn ä¸ªèŠ‚ç‚¹çš„æ ‘ï¼Œæœ‰ mmm æ¬¡æ“ä½œï¼š up vï¼šå°† vvv å·èŠ‚ç‚¹çš„ç¼–å·å˜ä¸ºå½“å‰æ‰€æœ‰èŠ‚ç‚¹ç¼–å·çš„maxâ¡+1\\max + 1max+1ï¼› when vï¼šæŸ¥è¯¢ vvv åœ¨å½“å‰æ ‘çš„åˆ é™¤åºåˆ—ä¸­æ˜¯ç¬¬å‡ å·å…ƒç´ ï¼› compare u vï¼šæŸ¥è¯¢ uuu å’Œvvvåœ¨å½“å‰æ ‘çš„åˆ é™¤åºåˆ—ä¸­è°æ›´é å‰ã€‚ è¾“å…¥æ ¼å¼ ç¬¬ä¸€è¡Œä¸¤ä¸ªæ­£æ•´æ•° n,q(1â‰¤n,qâ‰¤200000)n,q(1 \\leq n , q \\leq 200000)n,q(1â‰¤n,qâ‰¤200000) è¡¨ç¤ºæ ‘çš„ç‚¹æ•°å’Œæ“ä½œæ•°ã€‚ æ¥ä¸‹æ¥ nâˆ’1n-1nâˆ’1 è¡Œæ¯è¡Œ 222 ä¸ªæ­£æ•´æ•° u,v(1â‰¤u,vâ‰¤n)u,v(1 \\leq u,v \\leq n)u,v(1â‰¤u,vâ‰¤n) è¡¨ç¤ºæ ‘ä¸Šçš„ä¸€æ¡è¾¹ã€‚ æ¥ä¸‹æ¥ qqq è¡Œæ¯è¡Œæè¿°ä¸€ä¸ªæ“ä½œã€‚ è¾“å‡ºæ ¼å¼ æ¯ä¸€ä¸ªè¯¢é—®è¾“å‡ºä¸€è¡Œã€‚ å¯¹äº when v è¯¢é—®ï¼Œè¾“å‡ºä¸€ä¸ªæ­£æ•´æ•°è¡¨ç¤º vvv æ˜¯å½“å‰åˆ é™¤åºåˆ—çš„å“ªä¸€ä¸ªå…ƒç´ ã€‚ å¯¹äº compare u v è¯¢é—®ï¼Œå¦‚æœ uuu åœ¨åˆ é™¤åºåˆ—ä¸­æ›´é å‰åˆ™è¾“å‡ºuuuï¼Œå¦åˆ™è¾“å‡ºvvvã€‚[1] é¢˜è§£ æ˜¾ç„¶åœ¨ä»»æ„æ—¶åˆ»æœ€å¤§çš„é‚£ä¸ªèŠ‚ç‚¹ä¸€å®šæ˜¯åœ¨æœ€åè¢«åˆ çš„ã€‚ äºæ˜¯æˆ‘ä»¬è€ƒè™‘ up æ“ä½œå¸¦æ¥çš„å½±å“ã€‚ å‡è®¾ up äº†xxxï¼Œä¸Šä¸€æ¬¡ï¼ˆupå‰ï¼‰æœ€å¤§çš„é‚£ä¸ªç‚¹æ˜¯yyyã€‚ æˆ‘ä»¬å‘ç°æœ€ååˆ ç€åˆ ç€ä¸€å®šåªå‰©ä¸‹äº† xxx åˆ°yyyè·¯å¾„ä¸Šçš„è¿™å‡ ä¸ªç‚¹ã€‚ ç„¶åä» yyy å¼€å§‹ä¸€ä¸ªä¸€ä¸ªå¾€ xxx é‚£è¾¹åˆ ã€‚ äºæ˜¯ yâˆ¼xy\\sim xyâˆ¼x è¿™æ¡é“¾ä¸Šçš„ç‚¹ç§»åˆ°äº†åˆ é™¤åºåˆ—çš„æœ«å°¾ã€‚ æˆ‘ä»¬å¯ä»¥æŠŠ yâˆ¼xy\\sim xyâˆ¼x çœ‹æˆä¸€ä¸ªç¼©èµ·æ¥çš„ç‚¹ï¼Œæˆ‘ä»¬å‘ç°å…¶å®ƒç‚¹çš„ç›¸å¯¹ä½ç½®ä¸å˜ã€‚ æ¥ä¸‹æ¥çš„æ€è·¯æ„Ÿè§‰è·Ÿ è¿™é¢˜ å¾ˆåƒã€‚ æˆ‘ä»¬è€ƒè™‘ç”¨ LCT ç»´æŠ¤è¿™æ£µæ ‘ï¼ŒLCTä¸­çš„æ¯æ£µ splay è¡¨ç¤ºä¸€æ®µè¿ç»­çš„åˆ é™¤åŒºé—´ã€‚ å¼€å§‹æ—¶æ ¹å½“ç„¶æ˜¯æœ€å¤§çš„ã€‚ æ ·ä¾‹å¤§æ¦‚æ˜¯è¿™æ ·ä¸€å¹…å›¾ï¼š åˆ é™¤åºåˆ—åº”è¯¥æ˜¯2 4 3 1 5ã€‚ æ ¹å½“ç„¶å°±æ˜¯æœ€å¤§çš„é‚£ä¸ªç‚¹ã€‚ ç”±äºä¸€ä¸ª splay æ˜¯è¿ç»­åˆ çš„ã€‚æ‰€ä»¥æˆ‘ä»¬ç»™æ¯ä¸ª splay ä¸€ä¸ªæ ‡å·ï¼ˆå…·ä½“åˆ°å®ç°å°±æ˜¯ç»™ splay ä¸Šæ¯ä¸ªç‚¹æŸ“è‰²ï¼Œå¯ä»¥å‚è€ƒä¸‹é¢çš„ä»£ç ï¼‰ï¼ŒæŠŠå®ƒæ”¾åœ¨æ ‘çŠ¶æ•°ç»„ä¸Šï¼Œå³åœ¨è¯¥ splay çš„colorä¸ŠåŠ ä¸Šè¯¥ splay çš„sizeã€‚ 12345678910111213141516171819inline void dfs(int now)&#123; col[now] = now, siz[now] = 1; for(int i = first[now]; i; i = e[i].nxt) &#123; register int to = e[i].to; if(to != fa[now]) &#123; fa[to] = now; dfs(to); if(col[to] &gt; col[now]) // å¦‚æœå®ƒåä»£æœ‰æ¯”å®ƒå¤§çš„èŠ‚ç‚¹ï¼Œé‚£ä¹ˆä¸€å®šä¼šå½±å“ä»–å®ƒ &#123; col[now] = col[to]; s[now][1] = to; siz[now] = siz[to] + 1; &#125; &#125; &#125; tr.add(col[now], 1); // æ ‘çŠ¶æ•°ç»„åœ¨è¯¥ color ä¸ŠåŠ  1&#125; æˆ‘ä»¬è€ƒè™‘æŸ¥è¯¢ï¼Œå°±æ˜¯è¯¥ç‚¹æ‰€åœ¨ splay ä¹‹å‰çš„æ‰€æœ‰ç‚¹æ•°åŠ ä¸Šè¯¥ splay ä¸Šæ‰€æœ‰è¯¥ç»“ç‚¹åé¢çš„ç‚¹æ•°ã€‚ å¤§æ¦‚å°±æ˜¯ æ ‘çŠ¶æ•°ç»„.query(col[x] - 1) + splay.query(åœ¨ x ä¹‹å‰çš„èŠ‚ç‚¹ä¸ªæ•°)ã€‚ å½“ç„¶ä¹Ÿå¯ä»¥å†™æˆï¼š 12345inline int query(int x)&#123; splay(x); return tr.query(col[x]) - siz[s[x][0]];&#125; æœ€åè€ƒè™‘ä¿®æ”¹ã€‚ æˆ‘ä»¬å‘ç°ä¿®æ”¹å°±æ˜¯ make_rootï¼Œå½“ç„¶å› ä¸ºmake_root é‡Œå·²ç»æœ‰ access äº†ã€‚ è‡³äºè½»é‡é“¾åˆ‡æ¢çš„æ—¶å€™ï¼Œåªè¦åœ¨æ ‘çŠ¶æ•°ç»„é‡ŒæŠŠåŸæœ‰çš„ splay åˆ æ‰ï¼Œæ–°å¢çš„ splay åŠ ä¸Šå°±å¯ä»¥äº†ï¼Œå…·ä½“å¯ä»¥è§ä»£ç ã€‚ 12345678910111213141516171819202122inline void access(int x)&#123; for(int y = 0; x; x = fa[y = x]) &#123; splay(x); s[x][1] = 0; // å‡è£…å®ƒå³è¾¹ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œè¿™æ ·å°±å¯ä»¥æŠŠéœ€è¦æ–°å¢çš„ splay æ•´ä¸ªæå–å‡ºæ¥äº† push_up(x); tr.add(col[x], -siz[x]); tr.add(nowcol, siz[x]); s[x][1] = y; // ç„¶ååœ¨æ¥ä¸Š y push_up(x); &#125;&#125;inline void make_root(int x)&#123; nowcol++; access(x); splay(x); fan(x); // ç¿»è½¬ col[x] = nowcol; // æœ€åå†æŠŠæ•´ä¸ª splay çš„ color æ ‡è®°æ‰“ä¸Š&#125; ä»£ç  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216#include &lt;cstdio&gt;#include &lt;iostream&gt;#include &lt;algorithm&gt;using namespace std;const int maxn = 200005;const int maxq = 200005;int n, q;struct Edge&#123; int to, nxt;&#125; e[maxn &lt;&lt; 1];int first[maxn];inline void add_edge(int from, int to)&#123; static int cnt = 0; e[++cnt].nxt = first[from]; e[cnt].to = to; first[from] = cnt; e[++cnt].nxt = first[to]; e[cnt].to = from; first[to] = cnt;&#125;#define lowbit(x) (x &amp; -x)struct BIT&#123; int xx[maxn &lt;&lt; 1]; inline void add(int pla, int x) &#123; for(; pla &lt;= n + q; pla += lowbit(pla)) xx[pla] += x; &#125; inline int query(int pla) &#123; int ans = 0; for(; pla; pla -= lowbit(pla)) ans += xx[pla]; return ans; &#125;&#125; tr;int fa[maxn];int s[maxn][2];int siz[maxn];int col[maxn];int lzy[maxn];inline void dfs(int now)&#123; col[now] = now; siz[now] = 1; for(int i = first[now]; i; i = e[i].nxt) &#123; register int to = e[i].to; if(to != fa[now]) &#123; fa[to] = now; dfs(to); if(col[to] &gt; col[now]) &#123; col[now] = col[to]; s[now][1] = to; siz[now] = siz[to] + 1; &#125; &#125; &#125; tr.add(col[now], 1);&#125;inline bool nroot(int x)&#123; return s[fa[x]][0] == x || s[fa[x]][1] == x;&#125;inline void push_up(int x)&#123; siz[x] = siz[s[x][0]] + siz[s[x][1]] + 1;&#125;inline void fan(int x)&#123; lzy[x] ^= 1; swap(s[x][0], s[x][1]);&#125;inline void push_down(int x)&#123; if(lzy[x]) &#123; lzy[x] = 0; if(s[x][0]) fan(s[x][0]); if(s[x][1]) fan(s[x][1]); &#125; if(s[x][0]) col[s[x][0]] = col[x]; if(s[x][1]) col[s[x][1]] = col[x];&#125;inline void rotate(int x)&#123; int y = fa[x], z = fa[y]; int d = s[y][1] == x, k = s[x][!d]; if(nroot(y)) s[z][s[z][1] == y] = x; fa[x] = z; s[x][!d] = y; fa[y] = x; s[y][d] = k; if(k) fa[k] = y; push_up(y); push_up(x);&#125;int sta[maxn];inline void splay(int x)&#123; int tx = x; int top = 0; sta[++top] = tx; while(nroot(tx)) sta[++top] = (tx = fa[tx]); while(top) push_down(sta[top--]); while(nroot(x)) &#123; register int y = fa[x]; if(nroot(y)) &#123; register int z = fa[y]; rotate(((s[z][1] == y) ^ (s[y][1] == x)) ? x : y); &#125; rotate(x); &#125;&#125;int nowcol;inline void access(int x)&#123; for(int y = 0; x; x = fa[y = x]) &#123; splay(x); s[x][1] = 0; push_up(x); tr.add(col[x], -siz[x]); tr.add(nowcol, siz[x]); s[x][1] = y; push_up(x); &#125;&#125;inline void make_root(int x)&#123; nowcol++; access(x); splay(x); fan(x); col[x] = nowcol;&#125;char opt[23];inline int query(int x)&#123; splay(x); return tr.query(col[x]) - siz[s[x][0]];&#125;int main()&#123; scanf(&quot;%d%d&quot;, &amp;n, &amp;q); nowcol = n; for(int i = 1, f, t; i &lt; n; ++i) &#123; scanf(&quot;%d%d&quot;, &amp;f, &amp;t); add_edge(f, t); &#125; dfs(n); int _u, _v; for(int i = 1; i &lt;= q; ++i) &#123; scanf(&quot;%s&quot;, opt); if(opt[0] == &#x27;u&#x27;) &#123; scanf(&quot;%d&quot;, &amp;_v); make_root(_v); &#125; else if(opt[0] == &#x27;w&#x27;) &#123; scanf(&quot;%d&quot;, &amp;_v); printf(&quot;%d\\n&quot;, query(_v)); &#125; else &#123; scanf(&quot;%d%d&quot;, &amp;_u, &amp;_v); int ans1 = query(_u); int ans2 = query(_v); printf(&quot;%d\\n&quot;, ans1 &lt; ans2 ? _u : _v); &#125; &#125; return 0;&#125; ç¿»è¯‘æ¥è‡ªluogu â†©ï¸","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"CodeForces","slug":"CodeForces","permalink":"https://pufanyi.github.io/oi-blog/tags/CodeForces/"},{"name":"LCT","slug":"LCT","permalink":"https://pufanyi.github.io/oi-blog/tags/LCT/"}]},{"title":"CodeForces 434D Nanami's Power Plant","slug":"CF434D","date":"2019-03-16T16:00:00.000Z","updated":"2023-12-25T16:08:27.876Z","comments":true,"path":"CF434D/","link":"","permalink":"https://pufanyi.github.io/oi-blog/CF434D/","excerpt":"åŸé¢˜é“¾æ¥ æœ‰nnnä¸ªäºŒæ¬¡å‡½æ•°ï¼Œç¬¬iiiä¸ªå½¢å¦‚fi(x)=aix2+bix+cif_i(x)=a_ix^2+b_ix+c_ifiâ€‹(x)=aiâ€‹x2+biâ€‹x+ciâ€‹ ä½ çš„æ€»æ”¶ç›Šæ˜¯âˆ‘i=1nfi(xi)\\sum_{i=1}^nf_i(x_i)âˆ‘i=1nâ€‹fiâ€‹(xiâ€‹)ï¼Œä½†æ˜¯æœ‰å‡ ä¸ªé™åˆ¶ï¼š xiâ€‹x_iâ€‹xiâ€‹â€‹æ˜¯[li,ri]â€‹[l_i,r_i]â€‹[liâ€‹,riâ€‹]â€‹ä¸­çš„ä¸€ä¸ªæ•´æ•° è¿˜ç»™äº†mmmæ¡é¢å¤–çš„é™åˆ¶ï¼Œæ¯æ¡å½¢å¦‚u v dï¼Œè¡¨ç¤ºçš„æ˜¯xuâ‰¤xv+dx_u\\leq x_v+dxuâ€‹â‰¤xvâ€‹+d æ±‚æœ€å¤§çš„æ€»æ”¶ç›Šã€‚ nâ‰¤50;mâ‰¤100;âˆ£aiâˆ£â‰¤10;âˆ£biâˆ£,âˆ£ciâˆ£â‰¤1000;âˆ’100â‰¤liâ‰¤riâ‰¤100;âˆ£diâˆ£â‰¤200n\\le 50; m\\le 100; |a_i|\\le 10;|b_i|,|c_i|\\le1000;-100\\le l_i\\le r_i\\le 100;|d_i|\\le 200nâ‰¤50;mâ‰¤100;âˆ£aiâ€‹âˆ£â‰¤10;âˆ£biâ€‹âˆ£,âˆ£ciâ€‹âˆ£â‰¤1000;âˆ’100â‰¤liâ€‹â‰¤riâ€‹â‰¤100;âˆ£diâ€‹âˆ£â‰¤200ã€‚[1]","text":"åŸé¢˜é“¾æ¥ æœ‰ nnn ä¸ªäºŒæ¬¡å‡½æ•°ï¼Œç¬¬ iii ä¸ªå½¢å¦‚fi(x)=aix2+bix+cif_i(x)=a_ix^2+b_ix+c_ifiâ€‹(x)=aiâ€‹x2+biâ€‹x+ciâ€‹ ä½ çš„æ€»æ”¶ç›Šæ˜¯âˆ‘i=1nfi(xi)\\sum_{i=1}^nf_i(x_i)âˆ‘i=1nâ€‹fiâ€‹(xiâ€‹)ï¼Œä½†æ˜¯æœ‰å‡ ä¸ªé™åˆ¶ï¼š xiâ€‹x_iâ€‹xiâ€‹â€‹æ˜¯ [li,ri]â€‹[l_i,r_i]â€‹[liâ€‹,riâ€‹]â€‹ ä¸­çš„ä¸€ä¸ªæ•´æ•° è¿˜ç»™äº† mmm æ¡é¢å¤–çš„é™åˆ¶ï¼Œæ¯æ¡å½¢å¦‚u v dï¼Œè¡¨ç¤ºçš„æ˜¯xuâ‰¤xv+dx_u\\leq x_v+dxuâ€‹â‰¤xvâ€‹+d æ±‚æœ€å¤§çš„æ€»æ”¶ç›Šã€‚ nâ‰¤50;mâ‰¤100;âˆ£aiâˆ£â‰¤10;âˆ£biâˆ£,âˆ£ciâˆ£â‰¤1000;âˆ’100â‰¤liâ‰¤riâ‰¤100;âˆ£diâˆ£â‰¤200n\\le 50; m\\le 100; |a_i|\\le 10;|b_i|,|c_i|\\le1000;-100\\le l_i\\le r_i\\le 100;|d_i|\\le 200nâ‰¤50;mâ‰¤100;âˆ£aiâ€‹âˆ£â‰¤10;âˆ£biâ€‹âˆ£,âˆ£ciâ€‹âˆ£â‰¤1000;âˆ’100â‰¤liâ€‹â‰¤riâ€‹â‰¤100;âˆ£diâ€‹âˆ£â‰¤200ã€‚[1] é¢˜è§£ æ„Ÿè§‰å’Œåˆšåˆšåšè¿‡ä¸€åœºæ¨¡æ‹Ÿèµ›çš„ä¸€é“é¢˜å¾ˆç±»ä¼¼â€¦â€¦ è€ƒè™‘ç½‘ç»œæµï¼Œå¯¹æ¯ä¸ªå‡½æ•°éƒ½å»ºç«‹ [li,ri]â€‹[l_i,r_i]â€‹[liâ€‹,riâ€‹]â€‹ çš„ç‚¹ï¼Œç‚¹ (i,j)â€‹(i,j)â€‹(i,j)â€‹ è¡¨ç¤ºå‡½æ•° fiâ€‹f_iâ€‹fiâ€‹â€‹ å½“xi=jâ€‹x_i=jâ€‹xiâ€‹=jâ€‹æ—¶çš„ç‚¹ã€‚ æˆ‘ä»¬è€ƒè™‘æœ€å°æŸå¤±ã€‚è®¾ä¸€ä¸ªæå¤§å€¼ limlimlimï¼ˆå¤§äºæ‰€æœ‰çš„fi(x)f_i(x)fiâ€‹(x)ï¼‰ï¼Œå°†ä¹Ÿå°±æ˜¯è¦æ±‚limâˆ’fi(x)lim-f_i(x)limâˆ’fiâ€‹(x) çš„æœ€å°å€¼ã€‚ æˆ‘ä»¬ä»ç‚¹ (i,j)(i,j)(i,j) å‘ç‚¹ (i,j+1)(i,j+1)(i,j+1)ï¼ˆå¦‚æœj=rij=r_ij=riâ€‹ é‚£å°±æ˜¯è¶…æ±‡ TTTï¼‰æµlimâˆ’fi(j)lim - f_i(j)limâˆ’fiâ€‹(j)ï¼Œä»è¶…æºSSS å‘ç‚¹ (i,li)(i,l_i)(i,liâ€‹) æµâˆ\\inftyâˆã€‚ å¤§æ¦‚å°±æ˜¯è¿™æ ·ä¸€å¼ å›¾ï¼š å¦‚æœè¿™äº›å‡½æ•°çš„å–å€¼äº’è¡¥å¹²æ¶‰ï¼Œé‚£ä¹ˆ nÃ—limâˆ’ æœ€å°å‰² n\\times lim-\\text{æœ€å°å‰²}nÃ—limâˆ’ æœ€å°å‰² å°±æ˜¯ç­”æ¡ˆã€‚ æˆ‘ä»¬è€ƒè™‘å¦‚ä½•åŠ å…¥è¿™äº›é™åˆ¶ã€‚ å¦‚æœç°åœ¨æœ‰é™åˆ¶ xuâ‰¤xv+dx_u\\le x_v+dxuâ€‹â‰¤xvâ€‹+dï¼Œä¹Ÿå°±æ˜¯xvâ‰¥xuâˆ’dx_v\\ge x_u-dxvâ€‹â‰¥xuâ€‹âˆ’dã€‚å¦‚æœæˆ‘ä»¬å‰²äº†xux_uxuâ€‹ è¿™æ¡è¾¹ï¼Œåœ¨ vvv è¿™æ¡é“¾ä¸Šæˆ‘ä»¬åªèƒ½å‰² xuâˆ’dx_u-dxuâ€‹âˆ’d ä»¥åçš„è¾¹ã€‚é‚£å°±ä¸å¦¨ä» uuu è¿™æ¡è¡¨ä¸Šæ‰€æœ‰çš„ xxx å‘vvvè¿™æ¡è¾¹ä¸Šæ‰€æœ‰çš„ xâˆ’dx-dxâˆ’d è¿ä¸€æ¡ âˆâ€‹\\inftyâ€‹âˆâ€‹ çš„è¾¹ã€‚ å¦‚æœå‰²ç»¿è‰²çš„é‚£ä¸¤æ¡è¾¹ï¼š å¾ˆå¼€å¿ƒåœ°æµ‹ä¸€ä¸‹æ ·ä¾‹ï¼Œç‚¸äº†â€¦â€¦ æˆ‘ä»¬æ¥çœ‹è¿™ç§æƒ…å½¢ï¼ˆå¯¹æ ·ä¾‹ 1 ç•¥æœ‰æ”¹åŠ¨ï¼‰ï¼š 12345672 20 1 00 1 12 31 21 2 02 1 0 å»ºå‡ºæ¥çš„å›¾å¤§æ¦‚æ˜¯é•¿è¿™æ ·çš„ï¼š æœ€å°å‰²æ˜¯é€‰ (1,3)â†’T(1,3)\\to T(1,3)â†’T å’Œ(2,3)â†’T(2,3)\\to T(2,3)â†’Tã€‚ ä½†æ˜¾ç„¶ (1,3)â†’Tâ€‹(1,3)\\to Tâ€‹(1,3)â†’Tâ€‹ æ˜¯ä¸èƒ½é€‰çš„ã€‚å› ä¸ºç”± x1â‰¤x2â€‹x_1\\le x_2â€‹x1â€‹â‰¤x2â€‹â€‹ å’Œx2â‰¤x1â€‹x_2\\le x_1â€‹x2â€‹â‰¤x1â€‹â€‹å¯çŸ¥x1=x2â€‹x_1=x_2â€‹x1â€‹=x2â€‹â€‹ã€‚ äºæ˜¯æˆ‘ä»¬åªå¾—å†å»ºä¸€ä¸ª (i,ri+1)(i,r_i+1)(i,riâ€‹+1) ç‚¹ï¼Œ(i,ri)â†’(i,ri+1)(i,r_i)\\to (i,r_i+1)(i,riâ€‹)â†’(i,riâ€‹+1)æµ fi(ri)f_i(r_i)fiâ€‹(riâ€‹)ï¼Œ(i,ri+1)â†’T(i,r_i+1)\\to T(i,riâ€‹+1)â†’T æµâˆ\\inftyâˆã€‚ è¿™æ ·å°±å®Œç¾äº†ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135#include &lt;cstdio&gt;#include &lt;cstring&gt;#include &lt;queue&gt;#include &lt;iostream&gt;#include &lt;algorithm&gt;using namespace std;typedef long long LL;const LL maxn = 10005;const LL maxm = 5000005;const LL inf = 0x3f3f3f3f3f3f3f3f;const LL lim = 1000000000000;struct Edge&#123; LL to, nxt, cap;&#125; e[maxm &lt;&lt; 1];LL first[maxn], first_bak[maxn];inline void add_edge(LL from, LL to, LL cap)&#123; static LL cnt = -1; e[++cnt].nxt = first[from]; first[from] = cnt; e[cnt].to = to; e[cnt].cap = cap; e[++cnt].nxt = first[to]; first[to] = cnt; e[cnt].to = from; e[cnt].cap = 0;&#125;LL n, m, S, T;LL bh[105][205];LL a[maxn], b[maxn], c[maxn];LL ll[maxn];LL rr[maxn];LL dep[maxn];inline LL getans(LL I, LL x)&#123; return a[I] * x * x + b[I] * x + c[I];&#125;inline bool bfs()&#123; memset(dep, 0x3f, sizeof(dep)); queue&lt;LL&gt; q; q.push(S); dep[S] = 0; for(int i = S; i &lt;= T; ++i) first[i] = first_bak[i]; while(!q.empty()) &#123; LL now = q.front(); q.pop(); for(int i = first[now]; ~i; i = e[i].nxt) &#123; LL to = e[i].to; if(dep[to] &gt;= inf &amp;&amp; e[i].cap &gt; 0) &#123; dep[to] = dep[now] + 1; q.push(to); &#125; &#125; &#125; return dep[T] &lt; inf;&#125;inline LL dfs(LL now, LL lim)&#123; if(!lim || now == T) return lim; LL flow = 0; for(int i = first[now]; ~i; i = e[i].nxt) &#123; first[now] = i; register LL to = e[i].to, f; if(dep[to] == dep[now] + 1 &amp;&amp; (f = dfs(to, min(lim, e[i].cap))) &gt; 0) &#123; lim -= f; flow += f; e[i].cap -= f; e[i ^ 1].cap += f; if(lim &lt;= 0) break; &#125; &#125; return flow;&#125;inline LL dinic()&#123; LL flow = 0; while(bfs()) flow += dfs(S, inf); return flow;&#125;int main()&#123; memset(first, 0xff, sizeof(first)); scanf(&quot;%lld%lld&quot;, &amp;n, &amp;m); for(int i = 1; i &lt;= n; ++i) scanf(&quot;%lld%lld%lld&quot;, &amp;a[i], &amp;b[i], &amp;c[i]); for(int i = 1; i &lt;= n; ++i) &#123; scanf(&quot;%lld%lld&quot;, &amp;ll[i], &amp;rr[i]); add_edge(S, T + 1, inf); for(LL j = ll[i] + 100; j &lt;= rr[i] + 101; ++j) &#123; bh[i][j] = ++T; if(j != ll[i] + 100) add_edge(bh[i][j - 1], bh[i][j], lim - getans(i, j - 1 - 100)); &#125; &#125; T++; for(LL i = 1; i &lt;= n; ++i) add_edge(bh[i][rr[i] + 101], T, inf); for(int i = 1, u, v, d; i &lt;= m; ++i) &#123; scanf(&quot;%d%d%d&quot;, &amp;u, &amp;v, &amp;d); for(int j = ll[u]; j &lt;= rr[u] + 1; ++j) if(ll[v] &lt;= j - d &amp;&amp; j - d &lt;= rr[v] + 1) add_edge(bh[u][j + 100], bh[v][j - d + 100], inf); &#125; for(int i = S; i &lt;= T; ++i) first_bak[i] = first[i]; printf(&quot;%lld\\n&quot;, n * lim - dinic()); return 0;&#125; ç¿»è¯‘æ¥è‡ªluoguï¼Œç•¥æœ‰æ”¹åŠ¨ã€‚ â†©ï¸","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"CodeForces","slug":"CodeForces","permalink":"https://pufanyi.github.io/oi-blog/tags/CodeForces/"},{"name":"ç½‘ç»œæµ","slug":"ç½‘ç»œæµ","permalink":"https://pufanyi.github.io/oi-blog/tags/%E7%BD%91%E7%BB%9C%E6%B5%81/"}]},{"title":"SPOJ4063 Sell Pigs","slug":"SP4063","date":"2019-03-10T16:00:00.000Z","updated":"2023-12-25T16:08:27.909Z","comments":true,"path":"SP4063/","link":"","permalink":"https://pufanyi.github.io/oi-blog/SP4063/","excerpt":"åŸé¢˜é“¾æ¥ æœ‰mâ€‹mâ€‹mâ€‹ä¸ªçŒªåœˆï¼Œå¼€å§‹æ—¶ç¬¬iâ€‹iâ€‹iâ€‹ä¸ªçŒªåœˆæœ‰aiâ€‹a_iâ€‹aiâ€‹â€‹å¤´çŒªï¼Œæ¯ä¸ªçŒªåœˆéƒ½æ˜¯é”é—¨çš„ï¼Œè¦æ˜¯ä¸ç›¸åŒã€‚ç®¡ç†å‘˜æ²¡æœ‰çŒªåœˆçš„é’¥åŒ™ã€‚ä¾æ¬¡æ¥äº†mâ€‹mâ€‹mâ€‹ä¸ªé¡¾å®¢ï¼Œç¬¬iâ€‹iâ€‹iâ€‹ä¸ªé¡¾å®¢æœ‰Aiâ€‹A_iâ€‹Aiâ€‹â€‹æŠŠçŒªåœˆé’¥åŒ™ï¼ˆå“ªå‡ ä¸ªéƒ½å‘Šè¯‰ä½ ï¼‰è¯è¯´ä¸ºä»€ä¹ˆé’¥åŒ™ä¼šåœ¨é¡¾å®¢æ‰‹ä¸­å•Šï¼Œéœ€è¦è‡³å¤šBiâ€‹B_iâ€‹Biâ€‹â€‹å¤´çŒªã€‚æ¯ä¸ªé¡¾å®¢æ‰“å¼€è¿™å‡ ä¸ªçŒªåœˆï¼Œç„¶åç®¡ç†å‘˜å¯ä»¥æŠŠæ‰“å¼€é—¨çš„å‡ ä¸ªçŒªåœˆé‡Œçš„çŒªè¿›è¡Œè°ƒæ•´ï¼ˆæ¯”å¦‚æŠŠAâ€‹\\text{A}â€‹Aâ€‹çŒªåœˆçš„å…¶ä¸­ä¸€å¤´çŒªå¸¦åˆ°Bâ€‹\\text{B}â€‹Bâ€‹çŒªåœˆï¼‰ã€‚è¦æ±‚çš„æ˜¯ç®¡ç†å‘˜æœ€å¤šèƒ½å–å‡ºå¤šå°‘çŒªã€‚ nâ‰¤100,mâ‰¤1000n\\le 100,m\\le 1000nâ‰¤100,mâ‰¤1000ã€‚","text":"åŸé¢˜é“¾æ¥ æœ‰ mâ€‹mâ€‹mâ€‹ ä¸ªçŒªåœˆï¼Œå¼€å§‹æ—¶ç¬¬ iâ€‹iâ€‹iâ€‹ ä¸ªçŒªåœˆæœ‰ aiâ€‹a_iâ€‹aiâ€‹â€‹ å¤´çŒªï¼Œæ¯ä¸ªçŒªåœˆéƒ½æ˜¯é”é—¨çš„ï¼Œè¦æ˜¯ä¸ç›¸åŒã€‚ç®¡ç†å‘˜æ²¡æœ‰çŒªåœˆçš„é’¥åŒ™ã€‚ä¾æ¬¡æ¥äº† mâ€‹mâ€‹mâ€‹ ä¸ªé¡¾å®¢ï¼Œç¬¬ iâ€‹iâ€‹iâ€‹ ä¸ªé¡¾å®¢æœ‰ Aiâ€‹A_iâ€‹Aiâ€‹â€‹ æŠŠçŒªåœˆé’¥åŒ™ï¼ˆå“ªå‡ ä¸ªéƒ½å‘Šè¯‰ä½ ï¼‰è¯è¯´ä¸ºä»€ä¹ˆé’¥åŒ™ä¼šåœ¨é¡¾å®¢æ‰‹ä¸­å•Š ï¼Œéœ€è¦è‡³å¤šBiâ€‹B_iâ€‹Biâ€‹â€‹ å¤´çŒªã€‚æ¯ä¸ªé¡¾å®¢æ‰“å¼€è¿™å‡ ä¸ªçŒªåœˆï¼Œç„¶åç®¡ç†å‘˜å¯ä»¥æŠŠæ‰“å¼€é—¨çš„å‡ ä¸ªçŒªåœˆé‡Œçš„çŒªè¿›è¡Œè°ƒæ•´ï¼ˆæ¯”å¦‚æŠŠ Aâ€‹\\text{A}â€‹Aâ€‹ çŒªåœˆçš„å…¶ä¸­ä¸€å¤´çŒªå¸¦åˆ° Bâ€‹\\text{B}â€‹Bâ€‹ çŒªåœˆï¼‰ã€‚è¦æ±‚çš„æ˜¯ç®¡ç†å‘˜æœ€å¤šèƒ½å–å‡ºå¤šå°‘çŒªã€‚ nâ‰¤100,mâ‰¤1000n\\le 100,m\\le 1000nâ‰¤100,mâ‰¤1000ã€‚ é¢˜è§£ ä¸€é“æœ‰è¶£çš„ç½‘ç»œæµå»ºæ¨¡é¢˜â€¦â€¦ é¦–å…ˆå½“ç„¶è¦å»ºè¶…æºï¼ˆSSSï¼‰å’Œè¶…æ±‡ï¼ˆTTTï¼‰ã€‚ æŠŠæ¯ä¸ªé¡¾å®¢éƒ½çœ‹æˆä¸€ä¸ªç‚¹ã€‚ æ¯ä¸ªé¡¾å®¢å‘ TTT è¿ä¸€æ¡å®¹é‡ä¸º BiB_iBiâ€‹ çš„è¾¹ï¼Œè¡¨ç¤ºæ¯ä¸ªé¡¾å®¢æœ€å¤šä¹° BiB_iBiâ€‹ å¤´çŒªã€‚ é¦–å…ˆæ˜¯ SSS å‘æ¯ä¸ªçŒªåœˆç¬¬ä¸€ä¸ªæ‰“å¼€é—¨çš„é¡¾å®¢è¿è¾¹ï¼Œè¾¹æƒä¸ºaia_iaiâ€‹ï¼Œå³çŒªåœˆå†…çŒªçš„æ•°é‡ï¼Œè¡¨ç¤ºçŒªåœˆä¸€å¼€å§‹èƒ½ä¾›åº”ç»™é¡¾å®¢çš„çŒªã€‚ å¦‚æœæŸä¸ªé¡¾å®¢æ‰“å¼€äº†çŒªåœˆ Xâ€‹\\text{X}â€‹Xâ€‹ï¼ˆå³æœ‰çŒªåœˆXâ€‹\\text{X}â€‹Xâ€‹ çš„é’¥åŒ™ï¼‰ï¼Œé‚£ä¹ˆä»–æ‰€èƒ½â€œçœ‹â€åˆ°çš„çŒªï¼ˆå³å¦‚æœ Bi=âˆâ€‹B_i=\\inftyâ€‹Biâ€‹=âˆâ€‹ æ—¶ä»–æ‰€èƒ½ä¹°åˆ°çš„çŒªï¼‰ä¸‹ä¸€ä¸ªæ‰“å¼€ Xâ€‹\\text{X}â€‹Xâ€‹ çš„é¡¾å®¢ä¹Ÿèƒ½ä¹°åˆ°ï¼Œæ‰€ä»¥æ¯ä¸ªé¡¾å®¢éƒ½åƒä¸‹ä¸€ä¸ªæ‰“å¼€è¿™äº›é—¨çš„é¡¾å®¢è¿è¾¹ï¼Œè¾¹æƒä¸º $\\infty$ã€‚ å»ºå›¾ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627inline int solve()&#123; memset(first, 0xff, sizeof(first)); scanf(&quot;%d%d&quot;, &amp;m, &amp;n); for(int i = 1; i &lt;= m; ++i) scanf(&quot;%d&quot;, &amp;yuan[i]); // åŸæ¥çŒªåœˆé‡Œçš„çŒª for(int i = 1; i &lt;= n; ++i) &#123; int tn; scanf(&quot;%d&quot;, &amp;tn); for(int j = 1, x; j &lt;= tn; ++j) &#123; scanf(&quot;%d&quot;, &amp;x); mmap[lst[x]][i] = lst[x] ? inf : mmap[lst[x]][i] + yuan[x]; // lst æ•°ç»„ä¸€å¼€å§‹æ˜¯ 0 lst[x] = i; // æœ€è¿‘é‚£æ¬¡æ‰“å¼€çŒªåœˆçš„äººæ˜¯ i &#125; scanf(&quot;%d&quot;, &amp;tn); add_edge(i, n + 1, tn); // å‘æœ€åçš„ &#125; for(int i = 0; i &lt;= n; ++i) for(int j = 0; j &lt;= n; ++j) if(mmap[i][j]) add_edge(i, j, mmap[i][j]); // ç”±äºå¯èƒ½æœ‰é‡è¾¹æ‰€ä»¥å…ˆç”¨é‚»æ¥çŸ©é˜µæš‚å­˜ä¸€ä¸‹ï¼Œç„¶åç»Ÿä¸€åŠ å…¥ for(register int i = 0; i &lt;= n + 1; ++i) first_bak[i] = first[i]; // dinic å½“å‰å¼§ä¼˜åŒ–æ˜¯ç”¨ï¼Œä¸ç”¨ç†ä»– return Dinic();&#125;","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"ç½‘ç»œæµ","slug":"ç½‘ç»œæµ","permalink":"https://pufanyi.github.io/oi-blog/tags/%E7%BD%91%E7%BB%9C%E6%B5%81/"},{"name":"SPOJ","slug":"SPOJ","permalink":"https://pufanyi.github.io/oi-blog/tags/SPOJ/"}]},{"title":"HEOI2015 å…¬çº¦æ•°æ•°åˆ—","slug":"[HEOI2015]å…¬çº¦æ•°æ•°åˆ—","date":"2019-03-09T16:00:00.000Z","updated":"2023-12-25T16:08:27.921Z","comments":true,"path":"[HEOI2015]å…¬çº¦æ•°æ•°åˆ—/","link":"","permalink":"https://pufanyi.github.io/oi-blog/[HEOI2015]%E5%85%AC%E7%BA%A6%E6%95%B0%E6%95%B0%E5%88%97/","excerpt":"è®¾è®¡ä¸€ä¸ªæ•°æ®ç»“æ„. ç»™å®šä¸€ä¸ªæ­£æ•´æ•°æ•°åˆ—a0,a1,...,anâˆ’1a_0, a_1, ..., a_{n - 1}a0â€‹,a1â€‹,...,anâˆ’1â€‹ï¼Œä½ éœ€è¦æ”¯æŒä»¥ä¸‹ä¸¤ç§æ“ä½œï¼š MODIFY id xï¼šå°†aida_{id}aidâ€‹ä¿®æ”¹ä¸ºxxxã€‚ QUERY xï¼šæ±‚æœ€å°çš„æ•´æ•°p(0â‰¤p&lt;n)p (0 \\le p &lt; n)p(0â‰¤p&lt;n)ï¼Œä½¿å¾—gcdâ¡i=0paiÃ—â¨‚i=0pai=x\\gcd_{i=0}^pa_i\\times \\bigotimes_{i=0}^p a_i= xgcdi=0pâ€‹aiâ€‹Ã—â¨‚i=0pâ€‹aiâ€‹=xã€‚æ— è§£è¾“å‡ºnoã€‚ nâ‰¤100000n \\le 100000nâ‰¤100000ï¼Œqâ‰¤10000q \\le 10000qâ‰¤10000ï¼Œaiâ‰¤109(0â‰¤i&lt;n)a_i \\le 10^9 (0 \\le i &lt; n)aiâ€‹â‰¤109(0â‰¤i&lt;n)ï¼ŒQUERY x ä¸­çš„xâ‰¤1018x \\le 10^{18}xâ‰¤1018ï¼ŒMODIFY id xä¸­çš„ 0â‰¤id&lt;n0 \\le id &lt; n0â‰¤id&lt;nï¼Œ1â‰¤xâ‰¤1091 \\le x \\le 10^91â‰¤xâ‰¤109ã€‚","text":"è®¾è®¡ä¸€ä¸ªæ•°æ®ç»“æ„. ç»™å®šä¸€ä¸ªæ­£æ•´æ•°æ•°åˆ—a0,a1,...,anâˆ’1a_0, a_1, ..., a_{n - 1}a0â€‹,a1â€‹,...,anâˆ’1â€‹ï¼Œä½ éœ€è¦æ”¯æŒä»¥ä¸‹ä¸¤ç§æ“ä½œï¼š MODIFY id xï¼šå°† aida_{id}aidâ€‹ ä¿®æ”¹ä¸ºxxxã€‚ QUERY xï¼šæ±‚æœ€å°çš„æ•´æ•°p(0â‰¤p&lt;n)p (0 \\le p &lt; n)p(0â‰¤p&lt;n)ï¼Œä½¿å¾—gcdâ¡i=0paiÃ—â¨‚i=0pai=x\\gcd_{i=0}^pa_i\\times \\bigotimes_{i=0}^p a_i= xgcdi=0pâ€‹aiâ€‹Ã—â¨‚i=0pâ€‹aiâ€‹=xã€‚æ— è§£è¾“å‡ºnoã€‚ nâ‰¤100000n \\le 100000nâ‰¤100000ï¼Œqâ‰¤10000q \\le 10000qâ‰¤10000ï¼Œaiâ‰¤109(0â‰¤i&lt;n)a_i \\le 10^9 (0 \\le i &lt; n)aiâ€‹â‰¤109(0â‰¤i&lt;n)ï¼ŒQUERY x ä¸­çš„ xâ‰¤1018x \\le 10^{18}xâ‰¤1018ï¼ŒMODIFY id x ä¸­çš„ 0â‰¤id&lt;n0 \\le id &lt; n0â‰¤id&lt;nï¼Œ1â‰¤xâ‰¤1091 \\le x \\le 10^91â‰¤xâ‰¤109ã€‚ é¢˜è§£ å‰ç¼€ gcdâ¡\\gcdgcd åºåˆ—æœ‰ä¸€ä¸ªæœ‰è¶£çš„æ€§è´¨ï¼Œé‚£å°±æ˜¯åä¸€ä¸ªæ•°ä¸€å®šæ˜¯å‰ä¸€ä¸ªæ•°çš„å› æ•°ï¼Œæ‰€ä»¥è‡³å°‘ä¼šé™¤222ã€‚ äºæ˜¯æˆ‘ä»¬å‘ç°å‰ç¼€ gcdâ¡\\gcdgcd åºåˆ—ä¹‹å¤šåªä¼šæœ‰ logâ¡\\loglog ä¸ªä¸åŒçš„æ•°ã€‚ è€ƒè™‘åˆ° gcdâ¡\\gcdgcd ä¸â¨‚\\bigotimesâ¨‚æ²¡æœ‰ä»€ä¹ˆå¤ªå¤§çš„è”ç³»ï¼Œæˆ‘ä»¬è€ƒè™‘æšä¸¾gcdâ¡\\gcdgcdï¼Œç„¶åæ‰¾å‡ºâ¨‚i=0pai=xgcdâ¡i=0pai\\bigotimes_{i=0}^p a_i=\\frac{x}{\\gcd_{i=0}^pa_i}â¨‚i=0pâ€‹aiâ€‹=gcdi=0pâ€‹aiâ€‹xâ€‹ã€‚ å‘ç°ä»ç„¶å¾ˆéš¾ç»´æŠ¤ï¼Œäºæ˜¯æˆ‘ä»¬è€ƒè™‘åˆ†å—ã€‚ å¯¹äºæ¯ä¸ªå—ç»´æŠ¤å—å†…æœ€åä¸€ä¸ªå…ƒç´ çš„å‰ç¼€gcdâ¡\\gcdgcdï¼Œå—å†…gcdâ¡\\gcdgcdï¼Œä»¥åŠæ¯ä¸ªå…ƒç´ çš„å‰ç¼€å¼‚æˆ–å’Œã€‚ é¦–å…ˆæ˜¯ä¿®æ”¹å¼‚æˆ–å’Œã€‚ä¿®æ”¹å•ç‚¹åï¼Œè¦å°†åé¢æ‰€æœ‰çš„ xor\\text{xor}xor å€¼å…¨éƒ¨ä¿®æ”¹ã€‚ç›´æ¥å¯¹æ¯ä¸ªå—æ‰“ä¸€ä¸ªæ ‡è®°å³å¯ã€‚ ä¿®æ”¹ gcdâ¡\\gcdgcd ä¹Ÿå¾ˆæ–¹ä¾¿ï¼Œå—å†… gcdâ¡\\gcdgcd ä¸å‰ç¼€ gcdâ¡\\gcdgcd å‡å¯æš´åŠ›ç»´æŠ¤ã€‚ æŸ¥è¯¢æŸå—æ—¶ï¼Œå¦‚æœå…¶ç¬¬ä¸€ä¸ªæ•°çš„å‰ç¼€ gcdâ¡\\gcdgcdï¼ˆä¸Šä¸€ä¸ªå—æœ€åä¸€ä¸ªæ•°çš„å‰ç¼€gcdâ¡\\gcdgcd ä¸è¿™ä¸€ä¸ªå—çš„ç¬¬ä¸€ä¸ªæ•°çš„ gcdâ¡\\gcdgcdï¼‰ä¸å…¶æœ€åä¸€ä¸ªæ•°çš„å‰ç¼€gcdâ¡\\gcdgcd ä¸ç›¸ç­‰ï¼Œç›´æ¥æš´åŠ›ä¿®æ”¹ã€‚ç”±äºå‰ç¼€ gcdâ¡\\gcdgcd åºåˆ—åªæœ‰ logâ¡\\loglog ä¸ªä¸åŒçš„æ•°ã€‚å•æ¬¡å¤æ‚åº¦æ˜¯O(nlogâ¡n)\\mathcal{O}(\\sqrt n\\log n)O(nâ€‹logn)ã€‚ å¦‚æœç›¸ç­‰ï¼Œé‚£ä¹Ÿå°±æ„å‘³ç€å—å†…æ‰€æœ‰æ•°çš„å‰ç¼€ gcdâ¡\\gcdgcd å‡ç›¸ç­‰ã€‚åªè¦æŸ¥è¯¢å‰ç¼€ xor\\text{xor}xor å³å¯ã€‚å¯¹æ¯ä¸ªå—å¼€ä¸€ä¸ª map/hash æŸ¥ä¸€ä¸‹å°±å¯ä»¥äº†ã€‚å•æ¬¡æ“ä½œå¤æ‚åº¦O(nlogâ¡n)\\mathcal{O}(\\sqrt n\\log n)O(nâ€‹logn)ã€‚ æ‰€ä»¥æ€»å¤æ‚åº¦æ˜¯O(qnlogâ¡n)\\mathcal{O}(q\\sqrt n\\log n)O(qnâ€‹logn)ï¼Œéœ€è¦å¡å¸¸ã€‚ åšä¸»å¤ªèœ luogu è¿‡äº† bzoj æ²¡å¡è¿‡å»ï¼Œå‡è£…è¿‡äº†çš„æ ·å­ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175#include &lt;cstdio&gt;#include &lt;cmath&gt;#include &lt;map&gt;#include &lt;iostream&gt;#include &lt;algorithm&gt;using namespace std;const int maxn = 100005;typedef long long LL;template &lt;class T&gt;inline void writeln(T x)&#123; if(!x) &#123; puts(&quot;0&quot;); return; &#125; if(x &lt; 0) &#123; putchar(&#x27;-&#x27;); x = -x; &#125; int bit[20] = &#123;0&#125;; while(x) &#123; bit[++(*bit)] = (x % 10) | 48; x /= 10; &#125; do putchar(bit[*bit]); while(--(*bit)); puts(&quot;&quot;);&#125;inline int gcd(int a, int b)&#123; int t; while (b) &#123; t = a % b; a = b; b = t; &#125; return a;&#125;int n;int kc, ds;int hgcd[maxn]; // å—åçš„å‰ç¼€ gcdint kgcd[maxn]; // å—å†… gcdint belong[maxn];int ll[maxn], rr[maxn];map&lt;int, int&gt; mp[maxn];int yuan[maxn];int qz_xor[maxn];int lzy_xor[maxn];inline void modify(int id, int x)&#123; int tx = x; // å…ˆæ”¹ xor x ^= yuan[id]; for (register int i = id; i &lt;= rr[belong[id]]; ++i) qz_xor[i] ^= x; mp[belong[id]].clear(); for (register int i = ll[belong[id]]; i &lt;= rr[belong[id]]; ++i) &#123; qz_xor[i] ^= lzy_xor[belong[i]]; if (!mp[belong[id]][qz_xor[i]]) mp[belong[id]][qz_xor[i]] = i; &#125; lzy_xor[belong[id]] = 0; if (rr[belong[id]] != n) for (register int i = belong[id] + 1; i &lt;= ds; ++i) lzy_xor[i] ^= x; // ç„¶åæ˜¯ gcd yuan[id] = tx; kgcd[belong[id]] = 0; for (register int i = ll[belong[id]]; i &lt;= rr[belong[id]]; ++i) kgcd[belong[id]] = gcd(kgcd[belong[id]], yuan[i]); for (register int i = belong[id]; i &lt;= ds; ++i) &#123; int tmp = gcd(hgcd[i - 1], kgcd[i]); if (tmp == hgcd[i]) break; else hgcd[i] = tmp; &#125;&#125;inline int query(LL x)&#123; for (int i = 1; i &lt;= ds; ++i) &#123; if (!(x % (LL) hgcd[i])) &#123; int qiangcd = gcd(hgcd[i - 1], yuan[i]); if (qiangcd != hgcd[i]) &#123; for(int j = ll[i], nowg = hgcd[i - 1]; j &lt;= rr[i]; ++j) &#123; nowg = gcd(nowg, yuan[j]); if(nowg * (LL) (qz_xor[j] ^ lzy_xor[i]) == x) return j; &#125; &#125; else &#123; LL xx = (x / (LL) hgcd[i]) ^ lzy_xor[i]; if(mp[i][xx]) return mp[i][xx]; &#125; &#125; &#125; return -1;&#125;inline void pre()&#123; scanf(&quot;%d&quot;, &amp;n); kc = sqrt(n); ds = n / kc; if (n % kc) ds++; for (int i = 1; i &lt;= ds; ++i) &#123; ll[i] = rr[i - 1] + 1; rr[i] = min(ll[i] + kc - 1, n); for (int j = ll[i]; j &lt;= rr[i]; ++j) &#123; scanf(&quot;%d&quot;, &amp;yuan[j]); kgcd[i] = gcd(yuan[j], kgcd[i]); qz_xor[j] = qz_xor[j - 1] ^ yuan[j]; if (!mp[i][qz_xor[j]]) mp[i][qz_xor[j]] = j; belong[j] = i; hgcd[i] = gcd(hgcd[i - 1], kgcd[i]); &#125; &#125;&#125;int main()&#123; pre(); char s[233]; int Q; scanf(&quot;%d&quot;, &amp;Q); while(Q--) &#123; scanf(&quot;%s&quot;, s); if(s[0] == &#x27;M&#x27;) &#123; int id, x; scanf(&quot;%d%d&quot;, &amp;id, &amp;x); modify(id + 1, x); &#125; else &#123; LL x; scanf(&quot;%lld&quot;, &amp;x); int ans = query(x); if(~ans) writeln(ans - 1); else puts(&quot;no&quot;); &#125; &#125; return 0;&#125;","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"},{"name":"åˆ†å—","slug":"åˆ†å—","permalink":"https://pufanyi.github.io/oi-blog/tags/%E5%88%86%E5%9D%97/"},{"name":"å¡å¸¸","slug":"å¡å¸¸","permalink":"https://pufanyi.github.io/oi-blog/tags/%E5%8D%A1%E5%B8%B8/"}]},{"title":"å››é“å¤§æ°´é¢˜","slug":"ç¬¬äºŒæ¬¡å‡ºæ¨¡æ‹Ÿèµ›","date":"2019-03-09T16:00:00.000Z","updated":"2023-12-25T16:08:28.131Z","comments":true,"path":"ç¬¬äºŒæ¬¡å‡ºæ¨¡æ‹Ÿèµ›/","link":"","permalink":"https://pufanyi.github.io/oi-blog/%E7%AC%AC%E4%BA%8C%E6%AC%A1%E5%87%BA%E6%A8%A1%E6%8B%9F%E8%B5%9B/","excerpt":"ç»™ä¸‹ä¸€å±Šå‡ºé¢˜ï¼Œè‡ªç„¶æ˜¯å‡ºå¾—æ°´ä¸€ç‚¹æ¯”è¾ƒå¥½å’¯ï½","text":"ç»™ä¸‹ä¸€å±Šå‡ºé¢˜ï¼Œè‡ªç„¶æ˜¯å‡ºå¾—æ°´ä¸€ç‚¹æ¯”è¾ƒå¥½å’¯ï½ é¢˜é¢ å®Œæ•´çš„é€‰æ‰‹æ–‡ä»¶å¤¹ æˆ³è¿™é‡Œä¸‹è½½ é¢˜è§£ æ•°æ® ç”±äºæ•°æ®å¤ªå¤§ï¼Œæ”¾ç™¾åº¦ç½‘ç›˜ä¸Šå»äº†ï¼Œæˆ³è¿™é‡Œä¸‹è½½ æå–ç ï¼šxc6z æ ‡ç¨‹ æˆ³è¿™é‡Œä¸‹è½½ï¼ŒåŒ…æ‹¬ä¸€äº›æš´åŠ›","categories":[{"name":"å‡ºé¢˜","slug":"å‡ºé¢˜","permalink":"https://pufanyi.github.io/oi-blog/categories/%E5%87%BA%E9%A2%98/"}],"tags":[{"name":"æ•°å­¦","slug":"æ•°å­¦","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%95%B0%E5%AD%A6/"},{"name":"æ¨¡æ‹Ÿèµ›","slug":"æ¨¡æ‹Ÿèµ›","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%A8%A1%E6%8B%9F%E8%B5%9B/"},{"name":"æ•°è®º","slug":"æ•°è®º","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%95%B0%E8%AE%BA/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"},{"name":"DP","slug":"DP","permalink":"https://pufanyi.github.io/oi-blog/tags/DP/"},{"name":"æ ‘çŠ¶æ•°ç»„/çº¿æ®µæ ‘","slug":"æ ‘çŠ¶æ•°ç»„-çº¿æ®µæ ‘","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84-%E7%BA%BF%E6%AE%B5%E6%A0%91/"},{"name":"æœ€çŸ­è·¯","slug":"æœ€çŸ­è·¯","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%9C%80%E7%9F%AD%E8%B7%AF/"},{"name":"å‡ºé¢˜","slug":"å‡ºé¢˜","permalink":"https://pufanyi.github.io/oi-blog/tags/%E5%87%BA%E9%A2%98/"}]},{"title":"ä¸€é“æœ‰è¶£çš„è®¡æ•°é—®é¢˜","slug":"ä¸€é“æœ‰è¶£çš„è®¡æ•°é—®é¢˜bywzp","date":"2019-02-22T16:00:00.000Z","updated":"2023-12-25T16:08:27.954Z","comments":true,"path":"ä¸€é“æœ‰è¶£çš„è®¡æ•°é—®é¢˜bywzp/","link":"","permalink":"https://pufanyi.github.io/oi-blog/%E4%B8%80%E9%81%93%E6%9C%89%E8%B6%A3%E7%9A%84%E8%AE%A1%E6%95%B0%E9%97%AE%E9%A2%98bywzp/","excerpt":"ç»™ä½ ä¸€å—å·§å…‹åŠ›ï¼Œæ¨ªç€æœ€å¤šåˆ‡aaaåˆ€ï¼Œç«–ç€æœ€å¤šåˆ‡bbbåˆ€ï¼Œå®šä¹‰æ¯åˆ‡ä¸€åˆ€çš„æ”¶ç›Šä¸ºåˆ‡å®Œåæ‰€æœ‰å·§å…‹åŠ›çš„å’Œï¼Œæ¯æ¬¡éšæœºåœ¨èƒ½åˆ‡çš„æ‰€æœ‰åœ°æ–¹ç­‰æ¦‚ç‡éšæœºåˆ‡ä¸€åˆ€ï¼Œæ±‚åˆ‡k(kâ‰¤a+b)k(k\\le a + b)k(kâ‰¤a+b)åˆ°åˆ€å¾—åˆ°æ”¶ç›Šçš„æœŸæœ›ã€‚ç­”æ¡ˆå¯¹998244353998244353998244353å–æ¨¡ã€‚ a,bâ‰¤1018a, b\\le 10^{18}a,bâ‰¤1018ã€‚","text":"ç»™ä½ ä¸€å—å·§å…‹åŠ›ï¼Œæ¨ªç€æœ€å¤šåˆ‡ aaa åˆ€ï¼Œç«–ç€æœ€å¤šåˆ‡ bbb åˆ€ï¼Œå®šä¹‰æ¯åˆ‡ä¸€åˆ€çš„æ”¶ç›Šä¸ºåˆ‡å®Œåæ‰€æœ‰å·§å…‹åŠ›çš„å’Œï¼Œæ¯æ¬¡éšæœºåœ¨èƒ½åˆ‡çš„æ‰€æœ‰åœ°æ–¹ç­‰æ¦‚ç‡éšæœºåˆ‡ä¸€åˆ€ï¼Œæ±‚åˆ‡ k(kâ‰¤a+b)k(k\\le a + b)k(kâ‰¤a+b) åˆ°åˆ€å¾—åˆ°æ”¶ç›Šçš„æœŸæœ›ã€‚ç­”æ¡ˆå¯¹ 998244353998244353998244353 å–æ¨¡ã€‚ a,bâ‰¤1018a, b\\le 10^{18}a,bâ‰¤1018ã€‚ æˆ‘ä»¬è€ƒè™‘æ¯ä¸ªæ­£æ–¹å½¢å·¦ä¸‹è§’ï¼ˆå¦‚ä¸‹å›¾ï¼‰ä¸ºè´¡çŒ®ï¼Œå¦‚é»„è‰²æ ¼å­çš„è´¡çŒ®æˆ‘ä»¬çœ‹æˆæ˜¯ç‚¹ PPP çš„è´¡çŒ®ï¼Œé‚£æˆ‘ä»¬å¯ä»¥æŠŠç‚¹åˆ†æˆä¸‰ç±»ï¼šä¸­é—´çš„ï¼ˆçº¢è‰²ç‚¹ï¼‰ï¼Œè¾¹ç¼˜çš„ï¼ˆè“è‰²ç‚¹ï¼‰ï¼Œå·¦ä¸‹è§’çš„ï¼ˆç»¿è‰²ç‚¹ï¼‰ã€‚ å¦‚æœä¸€ä¸ªç‚¹â€œæš´éœ²åœ¨äº†å¤–é¢â€ï¼Œå³è¯¥ç‚¹å¯¹åº”çš„æ–¹å—æˆä¸ºäº†æ•´ä¸ªæ–¹å—çš„å·¦ä¸‹è§’ï¼Œé‚£ä¹ˆä¹‹åæ¯åˆ‡ä¸€æ¬¡å®ƒå°±ä¼šå¯¹ç­”æ¡ˆæœ‰ 111 çš„è´¡çŒ®ã€‚ é¦–å…ˆæˆ‘ä»¬æ¥çœ‹ä¸­é—´çš„ç‚¹ï¼ˆçº¢ç‚¹ï¼‰ã€‚ å¯¹äºæ¯ä¸ªç‚¹ï¼Œå¦‚æœç¬¬ iii æ¬¡åˆ‡å‰²åå®ƒæš´éœ²åœ¨å¤–é¢ï¼Œé‚£ä¹ˆå‰ iii æ¬¡åˆ‡å‰²å¿…å®šæœ‰ä¸€æ¬¡åˆ‡äº†å®ƒæ‰€åœ¨ç«–åˆ—ï¼Œè¿˜æœ‰ä¸€æ¬¡ä¸”äº†å®ƒæ‰€åœ¨æ¨ªè¡Œã€‚æ‰€ä»¥æœ‰ (i2)\\binom{i}{2}(2iâ€‹) ä¸­æ’åˆ—æ–¹æ¡ˆã€‚è€Œä»è¿™ä¹ˆå¤šæ¨ªè¡Œäºçºµåˆ—ä¸­é€‰ 222 æ¡çº¿çš„æ–¹æ¡ˆæ•°ä¸º (a+b2)\\binom{a+b}{2}(2a+bâ€‹)ï¼Œæ‰€ä»¥ç¬¬iii æ¬¡åˆ‡å®Œåè¯¥ç‚¹æš´éœ²åœ¨å¤–é¢çš„æ¦‚ç‡ä¸ºï¼š E(i)=(i2)(a+b2)E(i)=\\frac{\\binom{i}{2}}{\\binom{a+b}{2}} E(i)=(2a+bâ€‹)(2iâ€‹)â€‹ ç”±äºåˆ‡äº† kkk æ¬¡ï¼Œæ‰€ä»¥æ¯ä¸ªç‚¹è´¡çŒ®çš„æœŸæœ›ä¸ºï¼š âˆ‘i=1kE(i)=âˆ‘i=1k(i2)(a+b2)=âˆ‘i=1k(i2)(a+b2)=(k+13)(a+b2)=(k+1)â‹…kâ‹…(kâˆ’1)6(a+b)(a+bâˆ’1)2=(k+1)â‹…kâ‹…(kâˆ’1)3â‹…(a+b)â‹…(a+bâˆ’1)\\sum_{i=1}^k E(i)=\\sum_{i=1}^k\\frac{\\binom{i}{2}}{\\binom{a+b}{2}}=\\frac{\\sum_{i=1}^k\\binom{i}{2}}{\\binom{a+b}{2}}=\\frac{\\binom{k+1}{3}}{\\binom{a+b}{2}}=\\frac{\\frac{(k+1)\\cdot k\\cdot(k-1)}{6}}{\\frac{(a+b)(a+b-1)}{2}}=\\frac{(k+1)\\cdot k\\cdot(k-1)}{3\\cdot(a+b)\\cdot(a+b-1)} i=1âˆ‘kâ€‹E(i)=i=1âˆ‘kâ€‹(2a+bâ€‹)(2iâ€‹)â€‹=(2a+bâ€‹)âˆ‘i=1kâ€‹(2iâ€‹)â€‹=(2a+bâ€‹)(3k+1â€‹)â€‹=2(a+b)(a+bâˆ’1)â€‹6(k+1)â‹…kâ‹…(kâˆ’1)â€‹â€‹=3â‹…(a+b)â‹…(a+bâˆ’1)(k+1)â‹…kâ‹…(kâˆ’1)â€‹ æ€»å…±æœ‰ ababab ä¸ªçº¢ç‚¹ï¼Œæ‰€ä»¥æ€»çš„æœŸæœ›ä¸ºï¼š (k+1)â‹…kâ‹…(kâˆ’1)3â‹…(a+b)â‹…(a+bâˆ’1)â‹…ab\\frac{(k+1)\\cdot k\\cdot(k-1)}{3\\cdot(a+b)\\cdot(a+b-1)}\\cdot ab 3â‹…(a+b)â‹…(a+bâˆ’1)(k+1)â‹…kâ‹…(kâˆ’1)â€‹â‹…ab ç„¶åæ˜¯è¾¹ä¸Šçš„ç‚¹ï¼ˆè“ç‚¹ï¼‰ã€‚ æ¯æ¬¡åˆ‡éƒ½ä¼šå¤šä¸€ä¸ªè“ç‚¹ï¼Œæ‰€ä»¥è´¡çŒ®ä¸€å®šä¸ºï¼š âˆ‘i=1ki=k(k+1)2\\sum_{i=1}^k i=\\frac{k(k+1)}{2} i=1âˆ‘kâ€‹i=2k(k+1)â€‹ æœ€åæ˜¯å·¦ä¸‹è§’çš„ç»¿ç‚¹ï¼Œæ¯æ¬¡åˆ‡éƒ½ä¼šå®ƒéƒ½ä¼šæœ‰ 111 çš„è´¡çŒ®ï¼Œæ‰€ä»¥æ˜¯kkkã€‚ æ‰€ä»¥æ€»çš„è´¡çŒ®ä¸ºï¼š (k+1)â‹…kâ‹…(kâˆ’1)â‹…ab3â‹…(a+b)â‹…(a+bâˆ’1)+kâ‹…(k+1)2+k\\frac{(k+1)\\cdot k\\cdot(k-1)\\cdot ab}{3\\cdot(a+b)\\cdot(a+b-1)}+\\frac{k\\cdot(k+1)}{2}+k 3â‹…(a+b)â‹…(a+bâˆ’1)(k+1)â‹…kâ‹…(kâˆ’1)â‹…abâ€‹+2kâ‹…(k+1)â€‹+k ä¼˜ç§€çš„ O(1)\\mathcal{O}(1)O(1) ç®—æ³•ã€‚","categories":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%9A%8F%E7%AC%94/"}],"tags":[{"name":"æ•°å­¦","slug":"æ•°å­¦","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%95%B0%E5%AD%A6/"},{"name":"æ¨¡æ‹Ÿèµ›","slug":"æ¨¡æ‹Ÿèµ›","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%A8%A1%E6%8B%9F%E8%B5%9B/"}]},{"title":"æµ®ç‚¹æ•°å¼€æ ¹","slug":"æµ®ç‚¹æ•°å¼€æ ¹","date":"2019-02-22T16:00:00.000Z","updated":"2023-12-25T16:08:28.082Z","comments":true,"path":"æµ®ç‚¹æ•°å¼€æ ¹/","link":"","permalink":"https://pufanyi.github.io/oi-blog/%E6%B5%AE%E7%82%B9%E6%95%B0%E5%BC%80%E6%A0%B9/","excerpt":"ç»™ä½ è®²ä¸ªé¬¼æ•…äº‹ã€‚ æœ‰ä¸€åªç¥çŠ‡å«Wzpï¼Œæ¨¡æ‹Ÿèµ›æ—¶å‡ºäº†ä¸€é“è®¡ç®—å‡ ä½•é¢˜ï¼Œç²¾åº¦å¼€åˆ°äº†1e-13ã€‚","text":"ç»™ä½ è®²ä¸ªé¬¼æ•…äº‹ã€‚ æœ‰ä¸€åª ç¥çŠ‡ å« Wzpï¼Œæ¨¡æ‹Ÿèµ›æ—¶å‡ºäº†ä¸€é“ è®¡ç®—å‡ ä½•é¢˜ ï¼Œ ç²¾åº¦å¼€åˆ°äº† 1e-13ã€‚ é¢˜ç›®å¤§æ„å°±æ˜¯ç»™ä½ ä¸€ä¸ª Î”ABC\\Delta ABCÎ”ABC å’Œn(nâ‰¤1000)n(n\\le 1000)n(nâ‰¤1000)ä¸ªå‘é‡ï¼Œä½ å¯ä»¥åœ¨å…¶ä¸­é€‰è‡³å¤š kkk ä¸ªä½œç”¨åœ¨ AAA ä¸Šï¼Œä½¿æœ€ç»ˆå¾—åˆ°çš„ä¸‰è§’å½¢å‘¨é•¿æœ€é•¿ã€‚ç‰¹åˆ«çš„ï¼Œè¿™ä¸ªä¸‰è§’å½¢å¯ä»¥é€€åŒ–æˆä¸€æ¡çº¿ï¼Œå…¶å®åªè¦ç®— AB+BC+ACAB+BC+ACAB+BC+AC å°±å¯ä»¥äº†ã€‚ å…¶ä¸­æ‰€æœ‰ç»™å‡ºçš„æ•°æ®ï¼ˆåŒ…æ‹¬å‘é‡çš„x,yx, yx,yï¼‰éƒ½æ˜¯æ•´æ•°ã€‚ æ­£è§£åœ¨è¿™é‡Œå°±ä¸è¯´äº† æˆ‘æ‰ä¸ä¼šå‘Šè¯‰ä½ æ˜¯å› ä¸ºæˆ‘ä¸ä¼šåšè¿™é“é¢˜ ï¼Œé‡ç‚¹æ˜¯é‚£ä¸ªç»†èŠ‚ï¼Œä¹Ÿå°±æ˜¯1e-13 çš„ç²¾åº¦åº”è¯¥æ€ä¹ˆæ•´ã€‚ é‡ç‚¹å°±æ˜¯é‚£ä¸ªsqrtï¼Œè¿™ç©æ„è€ƒåœºä¸Šæµ‹äº†ä¸€ä¸‹ï¼ˆç”¨long doubleï¼‰ç²¾åº¦å¤§æ¦‚åªæœ‰10âˆ’8âˆ¼10âˆ’910^{-8}\\sim 10^{-9}10âˆ’8âˆ¼10âˆ’9ï¼Œç›´æ¥æ‚²æƒ¨çˆ† 0â€¦â€¦ æœ‰ä¸€ä¸ªå¾ˆå¦™çš„trickï¼Œæˆ‘ä»¬è®¾éœ€è¦è®¡ç®—s=xs=\\sqrt{x}s=xâ€‹ï¼Œæˆ‘ä»¬è®¾ sss çš„æ•´æ•°éƒ¨åˆ†æ˜¯aaaï¼Œå°æ•°éƒ¨åˆ†æ˜¯bbbï¼Œæˆ‘ä»¬æœ‰ï¼š x=(a+b)2=a2+b2+2ab=a2+b(a+b)+ab=a2+bs+ab=a2+b(s+a)\\begin{aligned} x&amp;=(a+b)^2\\\\ &amp;=a^2+b^2+2ab\\\\ &amp;=a^2+b(a+b)+ab\\\\ &amp;=a^2+bs+ab\\\\ &amp;=a^2+b(s+a) \\end{aligned} xâ€‹=(a+b)2=a2+b2+2ab=a2+b(a+b)+ab=a2+bs+ab=a2+b(s+a)â€‹ æ‰€ä»¥ï¼š b=xâˆ’a2s+a\\begin{aligned} b=\\frac{x-a^2}{s+a} \\end{aligned} b=s+axâˆ’a2â€‹â€‹ å…¶ä¸­çš„ s ç›´æ¥è°ƒç”¨ sqrt() å³å¯ã€‚ è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç”¨ä¸€ä¸ª long long å’Œä¸€ä¸ªdoubleï¼ˆç”šè‡³ä¸ç”¨long doubleï¼‰æ¥è¡¨ç¤ºæµ®ç‚¹æ•°ï¼Œç²¾åº¦ä¹Ÿä¼šé«˜å¾ˆå¤šã€‚","categories":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%9A%8F%E7%AC%94/"}],"tags":[{"name":"æ•°å­¦","slug":"æ•°å­¦","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%95%B0%E5%AD%A6/"},{"name":"æ¨¡æ‹Ÿèµ›","slug":"æ¨¡æ‹Ÿèµ›","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%A8%A1%E6%8B%9F%E8%B5%9B/"}]},{"title":"NOI2010 èˆªç©ºç®¡åˆ¶","slug":"èˆªç©ºç®¡åˆ¶","date":"2019-02-16T16:00:00.000Z","updated":"2023-12-25T16:08:28.160Z","comments":true,"path":"èˆªç©ºç®¡åˆ¶/","link":"","permalink":"https://pufanyi.github.io/oi-blog/%E8%88%AA%E7%A9%BA%E7%AE%A1%E5%88%B6/","excerpt":"æˆåŠŸæŠ¢åˆ°luoguæœ€åŠ£è§£+bzojæœ€åŠ£è§£ï¼ˆè‡³å°‘æˆ‘æäº¤çš„æ—¶å€™æ˜¯è¿™æ ·ï¼‰â€¦â€¦ é¢˜æ„æ˜¯ç»™ä½ ä¸€å¼ æ‹“æ‰‘å›¾ï¼Œæ±‚å‡ºä¸€ä¸ªæ‹“æ‰‘åºä½¿å¾—ç¬¬iiiä¸ªç‚¹åœ¨ç¬¬kik_ikiâ€‹ä¸ªä½ç½®ä¹‹å‰ã€‚å…ˆæ„é€ ä¸€ç»„è§£ï¼Œç„¶åè¾“å‡ºæ¯ä¸ªç‚¹å¯ä»¥åˆ°çš„æœ€å°çš„ä½ç½®ã€‚","text":"æˆåŠŸæŠ¢åˆ° luogu æœ€åŠ£è§£ +bzojæœ€åŠ£è§£ï¼ˆè‡³å°‘æˆ‘æäº¤çš„æ—¶å€™æ˜¯è¿™æ ·ï¼‰â€¦â€¦ é¢˜æ„æ˜¯ç»™ä½ ä¸€å¼ æ‹“æ‰‘å›¾ï¼Œæ±‚å‡ºä¸€ä¸ªæ‹“æ‰‘åºä½¿å¾—ç¬¬ iii ä¸ªç‚¹åœ¨ç¬¬ kik_ikiâ€‹ ä¸ªä½ç½®ä¹‹å‰ã€‚å…ˆæ„é€ ä¸€ç»„è§£ï¼Œç„¶åè¾“å‡ºæ¯ä¸ªç‚¹å¯ä»¥åˆ°çš„æœ€å°çš„ä½ç½®ã€‚ æ„é€ ä¸€ç»„è§£å¾ˆç®€å•ï¼Œå»ºä¸ªåå›¾ä¹‹åæŒ‰ kik_ikiâ€‹ ä¸ºå…³é”®å­—æ’åºä¸€ä¸‹ï¼Œä»å°åˆ°å¤§ä¸€ä¸ªä¸€ä¸ªéå†å³å¯ã€‚å› ä¸ºå¦‚æœ kik_ikiâ€‹ å°çš„èˆªç­éƒ½æ²¡æœ‰å¼€å‡ºï¼Œå¼€ kik_ikiâ€‹ å¤§çš„æ˜¾ç„¶æ²¡æœ‰æ„ä¹‰ã€‚ 123456789101112131415161718192021inline void shan(int now) // éå† now ç‚¹ï¼Œä½†åœ¨éå† now ç‚¹æ—¶æ˜¾ç„¶å…ˆè¦éå† now ä¹‹å‰ï¼ˆå³åå›¾ä¹‹åï¼‰çš„ç‚¹&#123; for(int i = ff[now]; i; i = ee[i].nxt) &#123; int to = ee[i].to; // ee æ˜¯åå›¾ä¸­çš„è¾¹ if(!vis[to]) shan(to); &#125; printf(&quot;%d &quot;, now); vis[now] = true;&#125;int main()&#123; for(int i = 1; i &lt;= n; ++i) kkk[i] = mp(k[i], i); // #define mp make_pair sort(kkk + 1, kkk + n + 1); for(int i = 1; i &lt;= n; ++i) if(!vis[kkk[i].second]) shan(kkk[i].second);&#125; ç„¶åæˆ‘ä»¬å‘ç°å¦‚æœç»™å‡ºçš„ kkk åºåˆ—æ— è§£ï¼Œé‚£ä¹ˆè¾“å‡ºçš„åºåˆ—ä¸€å®šä¸åˆæ³•ï¼ˆæ€ä¹ˆå¯èƒ½åˆæ³•ï¼Ÿï¼‰ï¼Œç„¶åæˆ‘ä»¬å‘ç°å¯ä»¥äºŒåˆ†ã€‚ å¤æ‚åº¦ï¼ŸO(nmlogâ¡n)\\mathcal{O}(nm\\log n)O(nmlogn)â€¦â€¦æ˜¾ç„¶ Tï¼ŒT äº† 4 ä¸ªç‚¹ã€‚ ç„¶åå¼€å§‹ O( æ¾)\\mathcal{O}(\\text{æ¾})O(æ¾ ) å¡å¸¸ã€‚ ç„¶åå‘ç°å®ƒè¿‡äº†ã€‚ è™½ç„¶æˆ‘å¡äº†ä¸€å¹´â€¦â€¦ ä¸‹é¢æ˜¯å¡å®Œçš„ä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194// luogu-judger-enable-o2 å¼€ O2 è¿˜æ˜¯æœ€åŠ£è§£â€¦â€¦#include &lt;cstdio&gt;#include &lt;cstring&gt;#include &lt;queue&gt;#include &lt;iostream&gt;#include &lt;algorithm&gt;using namespace std;const int maxn = 2005;const int maxm = 10005;int n, m;// å¿«è¯»å¿«è¾“æ˜¾ç„¶å¾—åŠ inline char gc()&#123; static char sxd[1 &lt;&lt; 16], *sss = sxd, *ttt = sxd; return (sss == ttt) &amp;&amp; (ttt = (sss = sxd) + fread(sxd, 1, 1 &lt;&lt; 16, stdin), sss == ttt) ? EOF : *sss++;&#125;#define dd c = gc()inline int read(int &amp;x)&#123; char dd; x = 0; bool f = false; for(; !isdigit(c); dd) &#123; if(c == &#x27;-&#x27;) f = true; if(c == EOF) return -1; &#125; for(; isdigit(c); dd) x = (x &lt;&lt; 1) + (x &lt;&lt; 3) + (c ^ 48); if(f) x = -x; return 1;&#125;#undef ddinline void write(register int x)&#123; int c[10]; *c = 0; while(x) &#123; c[++(*c)] = x % 10; x /= 10; &#125; if(!(*c)) x = 1; while(*c) putchar(c[(*c)--] | 48); putchar(&#x27; &#x27;);&#125;struct pii // å¹¶ä¸çŸ¥é“æ‰‹æ‰“ pair ä¼šä¸ä¼šå¿«ä¸€ç‚¹&#123; int first, second; inline bool operator &lt; (const pii&amp; other) const &#123; return this-&gt;first &lt; other.first; &#125;&#125;;pii kkk[maxn];struct EDGE&#123; int to, nxt;&#125; ee[maxm]; // æ³¨æ„æ˜¯åå›¾çš„è¾¹ï¼ŒåŸå›¾çš„è¾¹ä¼¼ä¹ä¸ç”¨å»ºint du[maxn];int first[maxn];int ff[maxn];int dz[maxn];inline void add_edge(register int from, register int to)&#123; static int cnt = 0; ee[++cnt].nxt = ff[to]; ff[to] = cnt; ee[cnt].to = from;&#125;int k[maxn];int top;int vis[maxn];inline void shan(register int now) // å›ç­”ç¬¬ä¸€ä¸ªé—®é¢˜ &#123; for(register int i = ff[now]; i; i = ee[i].nxt) if(!vis[ee[i].to]) shan(ee[i].to); write(now); dz[now] = ++top; // è®°å½•ä¸€ä¸‹æ¯ä¸ªç‚¹è‡³å°‘å¯ä»¥åœ¨é‚£ä¸ªæ—¶åˆ»è¢«éå†ï¼Œè¿™æ ·ç¼©å°çš„äºŒåˆ†çš„èŒƒå›´ vis[now] = true;&#125;pii kx[maxn];bool viss[maxn];int X, KK;inline bool shann(register int now)&#123; for(register int i = ff[now]; i; i = ee[i].nxt) if(!viss[ee[i].to]) if(!shann(ee[i].to)) return false; if(++top &gt; ((now != X) ? k[now] : KK)) // ç›´æ¥è¾¹è·‘è¾¹åˆ¤æ–­ï¼Œå¸¸æ•°åº”è¯¥ä¼šå°ä¸€ç‚¹ return false; return viss[now] = true;&#125;inline bool pan(register int x, register int kk)&#123; KK = kk; register int now = 0; for(register int i = 1; i &lt;= n; ++i) &#123; kx[i] = kkk[i]; if(kx[i].second == x) &#123; kx[i].first = kk; now = i; &#125; &#125; pii T; // æœ¬æ¥ä¸‹é¢ä¸€æ®µåªæ˜¯ä¸€å¥ sortï¼Œä½†é‚£ä¸ªå¸¸æ•°æ˜¯åœ¨å¤ªå¤§äº†ï¼Œåªèƒ½æ’æ’ while(now &gt; 1 &amp;&amp; kx[now].first &lt; kx[now - 1].first) &#123; T = kx[now]; kx[now] = kx[now - 1]; kx[now - 1] = T; now--; &#125; while(now &lt;= n &amp;&amp; kx[now].first &gt; kx[now + 1].first) &#123; T = kx[now]; kx[now] = kx[now + 1]; kx[now + 1] = T; now++; &#125; memset(viss, 0, sizeof(viss)); top = 0; for(register int i = 1; i &lt;= n; ++i) if(!viss[kx[i].second]) if(!shann(kx[i].second)) return false; return true;&#125;inline int solve(const register int x)&#123; X = x; register int l = 1, r = dz[x], mid; // äºŒåˆ†ï¼Œr ç›´æ¥å°±æ˜¯ä¸Šé¢çš„ dz äº†ï¼Œå³ç¬¬ä¸€ä¸ªé—®é¢˜ x åœ¨é‚£ä¸ªä½ç½® while(l &lt; r) &#123; mid = (l + r) &gt;&gt; 1; if(!pan(x, mid)) l = mid + 1; else r = mid; &#125; return r;&#125;int main()&#123; read(n), read(m); for(register int i = 1; i &lt;= n; ++i) &#123; read(k[i]); kkk[i].first = k[i]; kkk[i].second = i; &#125; sort(kkk + 1, kkk + n + 1); int f, t; for(register int i = 1; i &lt;= m; ++i) &#123; read(f), read(t); add_edge(f, t); &#125; for(register int i = 1; i &lt;= n; ++i) if(!vis[kkk[i].second]) shan(kkk[i].second); puts(&quot;&quot;); for(register int i = 1; i &lt;= n; ++i) write(solve(i)); return 0;&#125;","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"äºŒåˆ†","slug":"äºŒåˆ†","permalink":"https://pufanyi.github.io/oi-blog/tags/%E4%BA%8C%E5%88%86/"},{"name":"å¡å¸¸","slug":"å¡å¸¸","permalink":"https://pufanyi.github.io/oi-blog/tags/%E5%8D%A1%E5%B8%B8/"}]},{"title":"ä¸€ä¸ªæœ‰è¶£çš„é—®é¢˜","slug":"æ•´æ•°åˆ†è§£æ±‚ä¹˜ç§¯æœ€å¤§","date":"2019-02-05T16:00:00.000Z","updated":"2023-12-25T16:08:28.082Z","comments":true,"path":"æ•´æ•°åˆ†è§£æ±‚ä¹˜ç§¯æœ€å¤§/","link":"","permalink":"https://pufanyi.github.io/oi-blog/%E6%95%B4%E6%95%B0%E5%88%86%E8%A7%A3%E6%B1%82%E4%B9%98%E7%A7%AF%E6%9C%80%E5%A4%A7/","excerpt":"æŠŠæ­£æ•´æ•°nnnåˆ†è§£æˆå‡ ä¸ªæ­£æ•´æ•°çš„å’Œï¼Œæ˜¯å®ƒä»¬çš„ä¹˜ç§¯æœ€å¤§ã€‚","text":"æŠŠæ­£æ•´æ•° nnn åˆ†è§£æˆå‡ ä¸ªæ­£æ•´æ•°çš„å’Œï¼Œæ˜¯å®ƒä»¬çš„ä¹˜ç§¯æœ€å¤§ã€‚ ä»¥ä¸‹çº¯å£èƒ¡ï¼Œå¦‚æœæœ‰é—®é¢˜æ±‚åœ¨ä¸‹é¢ç•™è¨€ã€‚ æ ¹æ®å‡å€¼ä¸ç­‰å¼ï¼ˆè¯æ˜åœ¨æœ€ä¸‹é¢ï¼‰ï¼š âˆi=1nxiâ‰¤(âˆ‘i=1nxin)n\\prod_{i=1}^n x_i\\le \\left(\\frac{\\sum_{i=1}^nx_i}{n}\\right)^n i=1âˆnâ€‹xiâ€‹â‰¤(nâˆ‘i=1nâ€‹xiâ€‹â€‹)n å…ˆä¸è€ƒè™‘æ•´æ•°çš„é™åˆ¶ï¼Œæˆ‘ä»¬åº”å°†ä¸€ä¸ªæ•°å‡åŒ€åœ°åˆ†æˆ kkk ä»½ï¼Œæ¯ä¸ªæ•°ä¸ºxxxï¼Œé‚£ä¹ˆæœ‰ï¼š n=kxn=kx n=kx å¦ä¹˜ç§¯ä¸ºyyyï¼Œæœ‰ï¼š y=xk=xnx=(x1x)ny=x^k=x^{\\frac{n}{x}}=(x^{\\frac{1}{x}})^n y=xk=xxnâ€‹=(xx1â€‹)n äºæ˜¯é—®é¢˜å°±å˜æˆäº†æ±‚ y=x1xâ€‹y=x^{\\frac{1}{x}}â€‹y=xx1â€‹â€‹ åœ¨x&gt;0â€‹x&gt;0â€‹x&gt;0â€‹ä¸Šçš„æå€¼ã€‚ ä¸¤è¾¹åŒå–å¯¹æ•°ï¼š lnâ¡y=1xlnâ¡x\\ln y = \\frac{1}{x}\\ln x lny=x1â€‹lnx ä¸¤è¾¹åŒæ—¶å…³äº xxx æ±‚å¯¼ï¼š yâ€²y=âˆ’1x2lnâ¡x+1x2=1âˆ’lnâ¡xx2\\frac{y&#x27;}{y}=-\\frac{1}{x^2}\\ln x+\\frac{1}{x^2}=\\frac{1-\\ln x}{x^2} yyâ€²â€‹=âˆ’x21â€‹lnx+x21â€‹=x21âˆ’lnxâ€‹ å³è¾¹åº”è¯¥æ²¡é—®é¢˜ï¼Œé‚£å·¦è¾¹ä¸ºä»€ä¹ˆä¸æ˜¯ 1yâ€‹\\frac{1}{y}â€‹y1â€‹â€‹ å‘¢ï¼Ÿ å› ä¸º yyy æ˜¯ä¸ªå› å˜é‡ï¼Œå…¶å¯¼æ•°ä¸ä¸€å®šå°±æ˜¯ 111ï¼Œå³xxx å¢åŠ  dx\\mathrm{d}xdxï¼Œyyy ä¸ä¸€å®šå¢åŠ dx\\mathrm{d}xdxã€‚ ä½†æˆ‘ä»¬æœ‰ï¼š f[g(x)]=fâ€²(x)gâ€²(x)f[g(x)]=f&#x27;(x)g&#x27;(x) f[g(x)]=fâ€²(x)gâ€²(x) äºæ˜¯ï¼š yâ€²=1âˆ’lnâ¡xx2y=1âˆ’lnâ¡xx2x1xy&#x27;=\\frac{1-\\ln x}{x^2}y=\\frac{1-\\ln x}{x^2}x^{\\frac{1}{x}} yâ€²=x21âˆ’lnxâ€‹y=x21âˆ’lnxâ€‹xx1â€‹ å½“ yâ€²=0y&#x27;=0yâ€²=0 æ—¶ï¼š 1âˆ’lnâ¡xx2x1x=0\\frac{1-\\ln x}{x^2}x^{\\frac{1}{x}}=0 x21âˆ’lnxâ€‹xx1â€‹=0 ç”±äºx&gt;0x&gt;0x&gt;0ï¼š 1âˆ’lnâ¡x=01-\\ln x=0 1âˆ’lnx=0 å³ï¼š x=ex=e x=e ä½† eee ä¸æ˜¯æ•´æ•°ï¼Œç”±äºâŒŠeâŒ‹=2,âŒˆeâŒ‰=3\\lfloor e\\rfloor=2,\\lceil e\\rceil=3âŒŠeâŒ‹=2,âŒˆeâŒ‰=3ï¼Œä¸” 212â‰ˆ1.4142135623730950488016887242097313â‰ˆ1.44224957030740838232163831078012^{\\frac{1}{2}}\\approx1.4142135623730950488016887242097\\\\ 3^{\\frac{1}{3}}\\approx1.4422495703074083823216383107801 221â€‹â‰ˆ1.4142135623730950488016887242097331â€‹â‰ˆ1.4422495703074083823216383107801 æ‰€ä»¥ 212&lt;3132^{\\frac{1}{2}}&lt;3^{\\frac{1}{3}} 221â€‹&lt;331â€‹ å› æ­¤åº”è¯¥å°½é‡å–333ï¼Œå¤šå‡ºæ¥çš„å–222ã€‚ ä¸‹é¢ç»™å‡ºå‡å€¼ä¸ç­‰å¼çš„ä¸€ç§è¯æ³•ï¼š æœ‰ä¸€ç§å«â€œåå‘å½’çº³æ³•â€çš„ä¸œè¥¿ï¼Œå®ƒæ˜¯ä» nnn åˆ°nâˆ’1n-1nâˆ’1æ¥è¯æ˜å‘½é¢˜ã€‚ æˆ‘ä»¬ä»¤åŸå‘½é¢˜ä¸ºP(n)â€‹P(n)â€‹P(n)â€‹ã€‚ é¦–å…ˆï¼Œn=2â€‹n=2â€‹n=2â€‹æ—¶æ˜¾ç„¶ä¸ºçœŸï¼š abâ‰¤a+b2\\sqrt{ab}\\le \\frac{a+b}{2} abâ€‹â‰¤2a+bâ€‹ ç„¶åè¯æ˜ P(n)P(n)P(n) å’ŒP(2)P(2)P(2)è•´æ¶µç€P(2n)P(2n)P(2n)ï¼š å› ä¸ºï¼š âˆi=1nxiâ‰¤(âˆ‘i=1nxin)nâˆi=n+12nxiâ‰¤(âˆ‘i=n+12nxin)n\\prod_{i=1}^n x_i\\le \\left(\\frac{\\sum_{i=1}^nx_i}{n}\\right)^n\\\\ \\prod_{i=n+1}^{2n} x_i\\le \\left(\\frac{\\sum_{i=n+1}^{2n}x_i}{n}\\right)^n i=1âˆnâ€‹xiâ€‹â‰¤(nâˆ‘i=1nâ€‹xiâ€‹â€‹)ni=n+1âˆ2nâ€‹xiâ€‹â‰¤(nâˆ‘i=n+12nâ€‹xiâ€‹â€‹)n ä¸¤å¼ç›¸ä¹˜ï¼š âˆi=12nxiâ‰¤(âˆ‘i=1nxin)nÃ—(âˆ‘i=n+12nxin)nâ‰¤(âˆ‘i=12nxi2n)2n\\prod_{i=1}^{2n} x_i\\le \\left(\\frac{\\sum_{i=1}^{n}x_i}{n}\\right)^n\\times\\left(\\frac{\\sum_{i=n+1}^{2n}x_i}{n}\\right)^n\\le \\left(\\frac{\\sum_{i=1}^{2n}x_i}{2n}\\right)^{2n} i=1âˆ2nâ€‹xiâ€‹â‰¤(nâˆ‘i=1nâ€‹xiâ€‹â€‹)nÃ—(nâˆ‘i=n+12nâ€‹xiâ€‹â€‹)nâ‰¤(2nâˆ‘i=12nâ€‹xiâ€‹â€‹)2n æœ€åè¯æ˜ P(n)P(n)P(n) è•´æ¶µç€P(nâˆ’1)P(n-1)P(nâˆ’1)ï¼š ä»¤ xn=âˆ‘i=1nâˆ’1xinâˆ’1â€‹x_n=\\frac{\\sum_{i=1}^{n-1}x_i}{n-1}â€‹xnâ€‹=nâˆ’1âˆ‘i=1nâˆ’1â€‹xiâ€‹â€‹â€‹ å³xnâ€‹x_nâ€‹xnâ€‹â€‹ä¸ºå‰ nâˆ’1â€‹n-1â€‹nâˆ’1â€‹ é¡¹çš„å¹³å‡å€¼ï¼Œæˆ‘ä»¬å‘ç°è¿™ nâ€‹nâ€‹nâ€‹ é¡¹çš„å¹³å‡å€¼ä¸ºå‰ nâˆ’1â€‹n-1â€‹nâˆ’1â€‹ é¡¹çš„å¹³å‡å€¼ï¼Œå³ï¼š âˆi=1nâˆ’1xiÃ—âˆ‘i=1nâˆ’1xinâˆ’1â‰¤(âˆ‘i=1nâˆ’1xinâˆ’1)n\\prod_{i=1}^{n-1} x_i\\times\\frac{\\sum_{i=1}^{n-1}x_i}{n-1}\\le \\left(\\frac{\\sum_{i=1}^{n-1}x_i}{n-1}\\right)^n i=1âˆnâˆ’1â€‹xiâ€‹Ã—nâˆ’1âˆ‘i=1nâˆ’1â€‹xiâ€‹â€‹â‰¤(nâˆ’1âˆ‘i=1nâˆ’1â€‹xiâ€‹â€‹)n ä¸¤è¾¹åŒé™¤âˆ‘i=1nâˆ’1xinâˆ’1\\frac{\\sum_{i=1}^{n-1}x_i}{n-1}nâˆ’1âˆ‘i=1nâˆ’1â€‹xiâ€‹â€‹ï¼š âˆi=1nâˆ’1xiâ‰¤(âˆ‘i=1nâˆ’1xinâˆ’1)nâˆ’1\\prod_{i=1}^{n-1} x_i \\le \\left(\\frac{\\sum_{i=1}^{n-1}x_i}{n-1}\\right)^{n-1} i=1âˆnâˆ’1â€‹xiâ€‹â‰¤(nâˆ’1âˆ‘i=1nâˆ’1â€‹xiâ€‹â€‹)nâˆ’1","categories":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%9A%8F%E7%AC%94/"}],"tags":[{"name":"æ•°å­¦","slug":"æ•°å­¦","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%95%B0%E5%AD%A6/"}]},{"title":"è‡ªé€‚åº”è¾›æ™®æ£®æ³•","slug":"simpson","date":"2019-02-03T16:00:00.000Z","updated":"2023-12-25T16:08:27.954Z","comments":true,"path":"simpson/","link":"","permalink":"https://pufanyi.github.io/oi-blog/simpson/","excerpt":"å¹¶æ²¡æƒ³æ‰“ç®—å¼€ç¯‡å°å°ç»“ï¼Œåªæ˜¯éšä¾¿å†™å†™ï¼ˆæ„Ÿè§‰å¼€å°å°ç»“çš„æˆæœ¬å¤ªé«˜äº†å•Šâ€¦â€¦ï¼‰","text":"å¹¶æ²¡æƒ³æ‰“ç®—å¼€ç¯‡å°å°ç»“ï¼Œåªæ˜¯éšä¾¿å†™å†™ï¼ˆæ„Ÿè§‰å¼€å°å°ç»“çš„æˆæœ¬å¤ªé«˜äº†å•Šâ€¦â€¦ï¼‰ æ„Ÿè§‰è¿˜æ˜¯æŒºå¦™çš„ã€‚ä»¥å‰å¬ zyy å¤§ä½¬ è®²è¯¾çš„æ—¶å€™è¯´è¿‡ï¼Œå‡½æ•°çš„ç§¯åˆ†ç”¨äºŒæ¬¡å‡½æ•°æ‹Ÿåˆä¸€ä¸‹ã€‚ åŠ å…¥æˆ‘ä»¬è¦ç®— âˆ«lrF(x)dx\\int_l^r F(x)\\mathrm{d}xâˆ«lrâ€‹F(x)dxï¼Œæˆ‘ä»¬ç”¨äºŒæ¬¡å‡½æ•°f(x)=ax2+bx+cf(x)=ax^2+bx+cf(x)=ax2+bx+c æ¥æ‹Ÿåˆã€‚ æˆ‘ä»¬å‘ç°ï¼š âˆ«lrf(x)dx=a3r3+b2r2+crâˆ’a3l3âˆ’b2l2âˆ’cl=a3(râˆ’l)(r2+l2+lr)+b2(râˆ’l)(r+l)+c(râˆ’l)=râˆ’l6(2ar2+2al2+2alr+3br+3bl+6c)=râˆ’l6(ar2+br+c+al2+bl+c+ar2+al2+2alr+2br+2bl+4c)=râˆ’l6(f(l)+f(r)+a(l+r)2+2b(l+r)+4c)=râˆ’l6(f(l)+f(r)+4(a(l+r2)2+b(l+r2)+c))=râˆ’l6(f(l)+f(r)+4f(l+r2))\\begin{aligned} \\int_l^r f(x)\\mathrm{d}x&amp;=\\frac{a}{3}r^3+\\frac{b}{2}r^2+cr-\\frac{a}{3}l^3-\\frac{b}{2}l^2-cl\\\\ &amp;=\\frac{a}{3}\\left(r-l\\right)\\left(r^2+l^2+lr\\right)+\\frac{b}{2}\\left(r-l\\right)\\left(r+l\\right)+c\\left(r-l\\right)\\\\ &amp;=\\frac{r-l}{6}\\left(2ar^2+2al^2+2alr+3br+3bl+6c\\right)\\\\ &amp;=\\frac{r-l}{6}\\left(ar^2+br+c+al^2+bl+c+ar^2+al^2+2alr+2br+2bl+4c\\right)\\\\ &amp;=\\frac{r-l}{6}\\left(f(l)+f(r)+a(l+r)^2+2b(l+r)+4c\\right)\\\\ &amp;=\\frac{r-l}{6}\\left(f(l)+f(r)+4\\left(a\\left(\\frac{l+r}{2}\\right)^2+b\\left(\\frac{l+r}{2}\\right)+c\\right)\\right)\\\\ &amp;=\\frac{r-l}{6}\\left(f(l)+f(r)+4f\\left(\\frac{l+r}{2}\\right)\\right) \\end{aligned} âˆ«lrâ€‹f(x)dxâ€‹=3aâ€‹r3+2bâ€‹r2+crâˆ’3aâ€‹l3âˆ’2bâ€‹l2âˆ’cl=3aâ€‹(râˆ’l)(r2+l2+lr)+2bâ€‹(râˆ’l)(r+l)+c(râˆ’l)=6râˆ’lâ€‹(2ar2+2al2+2alr+3br+3bl+6c)=6râˆ’lâ€‹(ar2+br+c+al2+bl+c+ar2+al2+2alr+2br+2bl+4c)=6râˆ’lâ€‹(f(l)+f(r)+a(l+r)2+2b(l+r)+4c)=6râˆ’lâ€‹(f(l)+f(r)+4(a(2l+râ€‹)2+b(2l+râ€‹)+c))=6râˆ’lâ€‹(f(l)+f(r)+4f(2l+râ€‹))â€‹ äºæ˜¯æˆ‘ä»¬æœ‰ï¼š âˆ«lrF(x)dxâ‰ˆrâˆ’l6(F(l)+F(r)+4F(l+r2))\\int_l^r F(x)\\mathrm{d}x\\approx\\frac{r-l}{6}\\left(F(l)+F(r)+4F\\left(\\frac{l+r}{2}\\right)\\right) âˆ«lrâ€‹F(x)dxâ‰ˆ6râˆ’lâ€‹(F(l)+F(r)+4F(2l+râ€‹)) ç„¶åå°±å¯ä»¥æ‹Ÿåˆè¾£ï¼ 1234inline double simpson(double l, double r)&#123; return (F(l) + F(r) + 4 * F((l + r) / 2)) * (r - l) / 6;&#125; ç„¶è€Œå°±æ˜¯è¦ä¹ˆ WAï¼ˆç‚¸ç²¾åº¦ï¼‰è¦ä¹ˆ Tâ€¦â€¦ æœ‰ä¸€ç§å«è‡ªé€‚åº”è¾›æ™®æ£®çš„æ–¹æ³•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ç”¨è¾›æ™®æ£®è®¡ç®— âˆ«lrF(x)dx\\int_l^rF(x)\\mathrm{d}xâˆ«lrâ€‹F(x)dxï¼Œâˆ«l(l+r)/2F(x)dx\\int_l^{(l+r)/2}F(x)\\mathrm{d}xâˆ«l(l+r)/2â€‹F(x)dxï¼Œâˆ«(l+r)/2rF(x)dx\\int_{(l+r)/2}^rF(x)\\mathrm{d}xâˆ«(l+r)/2râ€‹F(x)dx çš„å€¼ï¼Œå¦‚æœâˆ£âˆ«lrF(x)dxâˆ’(âˆ«l(l+r)/2F(x)dx+âˆ«(l+r)/2rF(x)dx)âˆ£â‰¤eps\\left|\\int_l^rF(x)\\mathrm{d}x-\\left(\\int_l^{(l+r)/2}F(x)\\mathrm{d}x+\\int_{(l+r)/2}^rF(x)\\mathrm{d}x\\right)\\right|\\le \\mathrm{eps}âˆ£âˆ£âˆ£âˆ£â€‹âˆ«lrâ€‹F(x)dxâˆ’(âˆ«l(l+r)/2â€‹F(x)dx+âˆ«(l+r)/2râ€‹F(x)dx)âˆ£âˆ£âˆ£âˆ£â€‹â‰¤epsï¼Œé‚£ä¹ˆç›´æ¥è¿”å›å€¼ï¼Œå¦åˆ™é€’å½’ä¸‹å»ç®—ã€‚ updï¼šå¿½ç„¶å‘ç°æˆ‘å­¦äº†ä¸ªå‡çš„ simpsonã€‚å…¶å®eps åº”è¯¥æ˜¯ç›¸å¯¹è¯¯å·®ï¼Œæ‰€ä»¥æ¯æ¬¡é€’å½’ä¸‹å»æ—¶ eps\\mathrm{eps}eps éƒ½åº”è¯¥é™¤ 222ã€‚å¬è¯´æœ€ååˆ¤å®šæ—¶åº”è¯¥æ˜¯â‰¤15â‹…eps\\le 15\\cdot \\mathrm{eps}â‰¤15â‹…epsï¼Œè™½ç„¶æˆ‘å¹¶ä¸çŸ¥é“æ˜¯ä¸ºä»€ä¹ˆã€‚ è¯è¯´è¿™å’Œ eps ä¹˜ä¸Š 15 æœ‰ä»€ä¹ˆåŒºåˆ«å— è¿™æ ·å¤æ‚åº¦å°±æ˜¯ O( ç„å­¦ )\\mathcal{O}\\left(\\text{ç„å­¦}\\right)O( ç„å­¦)ï¼Œäº¤ä¹‹å‰æ´—æŠŠè„¸å°±è¡Œäº†ã€‚ 12345678inline double asr(double l, double r, double ans, double eps)&#123; double mid = (l + r) * .5; double ll = simpson(l, mid), rr = simpson(mid, r); if(fabs(ll + rr - ans) &lt; 15 * eps) return ll + rr; return asr(l, mid, ll, eps * .5) + asr(mid, r, rr, eps * .5);&#125;","categories":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%9A%8F%E7%AC%94/"}],"tags":[{"name":"æ•°å­¦","slug":"æ•°å­¦","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%95%B0%E5%AD%A6/"}]},{"title":"Uva12421 (Jiandan) Mua (I) - Lexical Analyzer","slug":"UVa12421","date":"2019-01-31T16:00:00.000Z","updated":"2023-12-25T16:08:27.909Z","comments":true,"path":"UVa12421/","link":"","permalink":"https://pufanyi.github.io/oi-blog/UVa12421/","excerpt":"ä¸€é“æ¯’ç˜¤çš„å¤§æ¨¡æ‹Ÿã€‚","text":"ä¸€é“æ¯’ç˜¤çš„å¤§æ¨¡æ‹Ÿã€‚ é¢˜ç›®å¤§æ„ é¢˜ç›®å¤§æ¦‚å°±æ˜¯è®©ä½ å†™ä¸€ä¸ªå«â€œMuaè¯­è¨€â€è§£é‡Šå™¨ï¼Œè¿™æ˜¯ç¬¬ä¸€æ­¥ï¼Œå°±æ˜¯æŠŠè¾“å…¥ä»£ç ä¸­çš„æ¯ä¸ªâ€œtokenâ€ï¼ˆè¯æ³•å•å…ƒï¼‰éƒ½åˆ†å¼€æ¥ã€‚ ä¸€å…±æœ‰å…­ç§ tokenï¼ˆMuaè¯­è¨€ä¸¥æ ¼åŒºåˆ†å¤§å°å†™ï¼‰ï¼š RESERVEDï¼ˆä¿ç•™å­—ï¼‰ï¼š ä¸‹é¢åˆ—å‡ºæ‰€æœ‰ä¿ç•™å­—ï¼ˆç¦åˆ©ï¼šé™„èµ  c++ ä»£ç ï¼‰ï¼š 1234567string all[21] =&#123; &quot;and&quot;, &quot;break&quot;, &quot;do&quot;, &quot;else&quot;, &quot;elseif&quot;, &quot;end&quot;, &quot;false&quot;, &quot;for&quot;, &quot;function&quot;, &quot;if&quot;, &quot;in&quot;, &quot;local&quot;, &quot;nil&quot;, &quot;not&quot;, &quot;or&quot;, &quot;repeat&quot;, &quot;return&quot;, &quot;then&quot;, &quot;true&quot;, &quot;until&quot;, &quot;while&quot;&#125;; NUMBERï¼ˆæ•°å­—å¸¸é‡ï¼‰ï¼š åè¿›åˆ¶æ•´æ•°ï¼šåŒ…å« 0âˆ¼90\\sim 90âˆ¼9 çš„æ•°å­—ï¼Œå¦‚233333ï¼Œå¯ä»¥æœ‰å‰å¯¼000ã€‚ åå…­è¿›åˆ¶æ•´æ•°ï¼šä»¥ 0x æˆ–0Xå¼€å¤´ï¼Œç„¶åæ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªåå…­è¿›åˆ¶æ•°å­—ï¼ˆ0âˆ¼90\\sim 90âˆ¼9ï¼Œaâˆ¼fa\\sim faâˆ¼fï¼ŒAâˆ¼FA\\sim FAâˆ¼Fï¼‰ï¼Œå¯ä»¥æœ‰å‰å¯¼000ã€‚å¦‚0X3F3a3f3F æµ®ç‚¹æ•°ï¼šæµ®ç‚¹æ•°æ€»æ˜¯åè¿›åˆ¶çš„ï¼Œå¦‚ 1.23ï¼Œå¯ä»¥ç”¨ç§‘å­¦è®°æ•°æ³•è¡¨ç¤ºï¼Œæ–¹æ³•æ˜¯åœ¨åé¢åŠ ä¸Šå­—ç¬¦e æˆ–è€… Eï¼Œç„¶åæ˜¯åè¿›åˆ¶æ•´æ•°ï¼ˆå¦‚1.23e2ï¼Œå®ƒç­‰äº1.230ï¼‰ï¼Œå°æ•°ç‚¹å’ŒæŒ‡æ•°ä¸èƒ½åŒæ—¶çœç•¥ï¼Œä½†æ•´æ•°éƒ¨åˆ†å¯ä»¥çœç•¥ï¼ˆå¦‚.2e3 æ˜¯åˆæ³•çš„ï¼‰ã€‚å¦‚æœçœç•¥å¯æ•´æ•°éƒ¨åˆ†ï¼Œåˆ™å¿…é¡»è¦æœ‰å°æ•°ç‚¹å’Œè‡³å°‘ä¸€ä½å°æ•°ï¼ˆå› æ­¤ .e2 æ˜¯éæ³•çš„ï¼‰ã€‚ä¸æ”¯æŒåå…­è¿›åˆ¶æµ®ç‚¹å°æ•°ã€‚æ³¨æ„æŒ‡æ•°çš„å‰é¢å¯ä»¥æœ‰ä¸€ä¸ªå‰ç¼€ + æˆ–è€… -ï¼Œå¦‚1e+10 å’Œ4e-3éƒ½æ˜¯åˆæ³•çš„ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯è´Ÿæ•°åŒ…å«ä¸¤ä¸ª tokenï¼Œâ€œ-â€æ˜¯å•ç‹¬çš„ä¸€ä¸ª tokenï¼Œä¸‹é¢ä¼šè¯´ã€‚ STRINGï¼ˆå­—ç¬¦ä¸²ï¼‰ï¼š ç”±åŒå¼•å· &quot;&quot; æˆ–å•å¼•å· '' åŒ…å›´çš„å­—ç¬¦ä¸²å¸¸é‡ï¼Œåªæ”¯æŒå››ç§è½¬ä¹‰å­—ç¬¦ï¼š\\&quot;ï¼Œ\\'ï¼Œ\\\\ï¼Œ\\nã€‚å­—ç¬¦ä¸²å†…éƒ¨ä¸èƒ½æœ‰ç‰©ç†æ¢è¡Œç¬¦ã€‚ SYMBOLï¼ˆç¬¦å·ï¼‰ï¼š è‹±æ–‡ pdf å‡æ‰äº†ï¼Œæœ‰å‡ ä¸ª SYMBOL æ²¡æœ‰å®Œå…¨æ˜¾ç¤ºã€‚ ç›´æ¥èµ é€ c++ ä»£ç ï¼š 1234567string all[26] =&#123; &quot;+&quot;, &quot;-&quot;, &quot;*&quot;, &quot;/&quot;, &quot;%&quot;, &quot;^&quot;, &quot;#&quot;, &quot;==&quot;, &quot;~=&quot;, &quot;&lt;=&quot;, &quot;&gt;=&quot;, &quot;&lt;&quot;, &quot;&gt;&quot;, &quot;=&quot;, &quot;(&quot;, &quot;)&quot;, &quot;&#123;&quot;, &quot;&#125;&quot;, &quot;[&quot;, &quot;]&quot;, &quot;;&quot;, &quot;:&quot;, &quot;,&quot;, &quot;.&quot;, &quot;..&quot;, &quot;...&quot;&#125;; NAMEï¼ˆæ ‡è¯†ç¬¦ï¼‰ï¼š å¿…é¡»ä»¥å­—æ¯å¼€å¤´ï¼Œåè·Ÿè‹¥å¹²ä¸ªå­—æ¯ã€æ•°å­—æˆ–è€…ä¸‹åˆ’çº¿ã€‚æ³¨æ„ï¼Œä¿ç•™å­—ä¸èƒ½ä½œä¸ºæ ‡è¯†ç¬¦ã€‚ EOLï¼ˆç‰©ç†æ¢è¡Œç¬¦ï¼‰ï¼š ä¸å¤šè¯´ï¼Œéƒ½æ‡‚ã€‚ COMMENTï¼ˆæ³¨é‡Šï¼‰ï¼š ä»¥ -- å¼€å¤´ï¼Œæ¢è¡Œç¬¦ç»“æŸã€‚æ³¨æ„æ¢è¡Œç¬¦ä¸æ˜¯æ³¨é‡Šä¸­çš„ä¸€éƒ¨åˆ†ï¼Œè€Œæ˜¯å•ç‹¬çš„EOLã€‚ æ³¨æ„ï¼Œå­—ç¬¦ä¸²å¸¸é‡å¤–çš„æ‰€æœ‰ç©ºç™½å­—ç¬¦éƒ½åº”å¿½ç•¥ï¼Œå› æ­¤ 1+1 å’Œ1 + 1å¯¹äºè¯æ³•åˆ†æå™¨æ¥è¯´æ²¡æœ‰ä»»ä½•åŒºåˆ«ã€‚å¦å¤–ï¼Œè¯æ³•åˆ†æå™¨åº”å½“æ˜¯è´ªå¿ƒçš„ï¼Œå³æ€»æ˜¯è®©ç¬¬ä¸€ä¸ª token å°½é‡é•¿ï¼Œåœ¨æ­¤å‰æä¸‹è®©ç¬¬äºŒä¸ªå°½é‡é•¿ï¼Œä¾æ­¤ç±»æ¨ã€‚æ¯”å¦‚ï¼Œabc123&lt;=123åº”åˆ†æˆ abc123ï¼Œ&lt;= å’Œ123ã€‚ æ­¤å¤–ï¼Œåœ¨è¾“å‡ºæ—¶ï¼Œæ³¨é‡Šåº”å½“ç›´æ¥å¿½ç•¥ï¼Œä¸ç”¨è¾“å‡ºã€‚ ï¼ˆæ„Ÿè§‰æˆ‘çš„ç¿»è¯‘å‡ ä¹å°±æ˜¯æŠ„ã€Šè®­ç»ƒæŒ‡å—ã€‹çš„â€¦â€¦ï¼‰ é¢˜è§£ æ„Ÿè§‰è¿‘æœŸå¥½ tf äºæ˜¯é€¼è‡ªå·±åˆ·äº†é“æ¨¡æ‹Ÿé¢˜ï¼ˆè™½ç„¶æ²¡çŒªå›½æ€é‚£ä¹ˆå·¨å¤§ï¼‰ã€‚ å…¶å®æ„Ÿè§‰å¦‚æœèƒ½è€å¿ƒæ‰“ä¸‹å»å¹¶ä¸ä¼šæ„Ÿè§‰å¾ˆçƒ¦ã€‚ ä¸‹é¢å¤§è‡´æ•´ç†ä¸€ä¸‹æ€è·¯ã€‚ ä¸ºäº†æ–¹ä¾¿ï¼Œå…ˆæŠŠå‡ ä¸ª Token ç±»å‹å˜æˆæ•°å­—ï¼š 12345678910string TYPE[] =&#123; &quot;RESERVED&quot;, // ä¿ç•™å­— 1 &quot;NUMBER&quot;, // æ•°å­— 2 &quot;STRING&quot;, // å­—ç¬¦ä¸² 3 &quot;SYMBOL&quot;, // ç¬¦å· 4 &quot;NAME&quot;, // å˜é‡å 5 &quot;EOL&quot;, // æ¢è¡Œç¬¦ 6 &quot;COMMENT&quot; // æ³¨é‡Š 7&#125;; è¿˜æœ‰æŠŠ SYMBOL å’ŒRESERVEDçš„å‡ ä¸ªå­—ç¬¦ä¸²å…¨å¡ set é‡Œï¼ˆç”±äºç›´æ¥åœ¨ struct é‡Œå®šä¹‰åˆå§‹åŒ–å˜é‡å€¼ï¼Œæ‰€ä»¥éœ€è¦c++11ï¼‰ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849struct SYMBOL&#123; string all[26] = // -std=c++11 &#123; &quot;+&quot;, &quot;-&quot;, &quot;*&quot;, &quot;/&quot;, &quot;%&quot;, &quot;^&quot;, &quot;#&quot;, &quot;==&quot;, &quot;~=&quot;, &quot;&lt;=&quot;, &quot;&gt;=&quot;, &quot;&lt;&quot;, &quot;&gt;&quot;, &quot;=&quot;, &quot;(&quot;, &quot;)&quot;, &quot;&#123;&quot;, &quot;&#125;&quot;, &quot;[&quot;, &quot;]&quot;, &quot;;&quot;, &quot;:&quot;, &quot;,&quot;, &quot;.&quot;, &quot;..&quot;, &quot;...&quot; &#125;; set&lt;string&gt; all_symbol; SYMBOL () &#123; all_symbol.clear(); for(int i = 0; i &lt; 26; ++i) all_symbol.insert(all[i]); &#125; inline bool is_symbol(string s) &#123; return all_symbol.count(s); &#125;&#125; symb;struct RESERVED&#123; string all[21] = // -std=c++11 &#123; &quot;and&quot;, &quot;break&quot;, &quot;do&quot;, &quot;else&quot;, &quot;elseif&quot;, &quot;end&quot;, &quot;false&quot;, &quot;for&quot;, &quot;function&quot;, &quot;if&quot;, &quot;in&quot;, &quot;local&quot;, &quot;nil&quot;, &quot;not&quot;, &quot;or&quot;, &quot;repeat&quot;, &quot;return&quot;, &quot;then&quot;, &quot;true&quot;, &quot;until&quot;, &quot;while&quot; &#125;; set&lt;string&gt; all_reserved; RESERVED () &#123; all_reserved.clear(); for(int i = 0; i &lt; 21; ++i) all_reserved.insert(all[i]); &#125; inline bool is_reserved(string s) &#123; return all_reserved.count(s); &#125;&#125; rese; å®šä¹‰ä¸€ä¸ª Token ç±»å‹ï¼š 12345678struct Token&#123; int typ; string s; Token (int tp = 6, string ss = &quot;&quot;) // é»˜è®¤æ¢è¡Œç¬¦ &#123; typ = tp, s = ss; &#125;&#125;; å½“ç„¶å…ˆè¦è¯»å…¥ï¼š 123456789if(nowl == s.length())&#123; if(!getline(cin, s)) return Token(-1); nowl = 0; s.push_back(&#x27;\\n&#x27;);&#125;while(s[nowl] == &#x27; &#x27;) nowl++; ç„¶åæœ€å…ˆåˆ¤æ–­æ¢è¡Œç¬¦å’Œæ³¨é‡Šï¼š 12345678910if(s[nowl] == &#x27;\\n&#x27;)&#123; nowl++; return ans; // ans æ˜¯ä¸ª Token ç±»å‹ï¼Œåˆå§‹åŒ–å°±æ˜¯æ¢è¡Œç¬¦ï¼Œä¸‹åŒ&#125;if(s[nowl] == &#x27;-&#x27; &amp;&amp; s[nowl + 1] == &#x27;-&#x27;)&#123; nowl = s.length(); return ans;&#125; å­—ç¬¦ä¸²ç›´æ¥åˆ†æˆå•å¼•å·å’ŒåŒå¼•å·ä¸¤ç§ï¼Œå¤åˆ¶ä¸€ä¸‹å°±å¯ä»¥äº†ï¼š 12345678910111213141516171819202122232425262728293031if(s[nowl] == &#x27;&quot;&#x27;) // ç”¨åŒå¼•å·åŒ…è£¹çš„å­—ç¬¦ä¸²&#123; bool zy = false; ans.s.push_back(s[nowl++]); while(zy || s[nowl] != &#x27;&quot;&#x27;) &#123; if(!zy &amp;&amp; s[nowl] == &#x27;\\\\&#x27;) zy = true; else zy = false; ans.s.push_back(s[nowl++]); &#125; ans.s.push_back(s[nowl++]); ans.typ = 3; return ans;&#125;if(s[nowl] == &#x27;\\&#x27;&#x27;) // ç”¨å•å¼•å·åŒ…è£¹çš„å­—ç¬¦ä¸²&#123; bool zy = false; ans.s.push_back(s[nowl++]); while(zy || s[nowl] != &#x27;\\&#x27;&#x27;) &#123; if(!zy &amp;&amp; s[nowl] == &#x27;\\\\&#x27;) zy = true; else zy = false; ans.s.push_back(s[nowl++]); &#125; ans.typ = 3; return ans;&#125; æ¥ä¸‹æ¥æ˜¯åˆ¤æ–­ NAME å’ŒRESERVEDï¼š 12345678910if(isalpha(s[nowl]))&#123; while(can_be_a_name(s[nowl])) ans.s.push_back(s[nowl++]); if(rese.is_reserved(ans.s)) ans.typ = 1; else ans.typ = 5; return ans;&#125; å…³äº can_be_a_name å’Œcan_be_a_numberï¼š 123456789101112inline bool can_be_a_name(char c)&#123; return isalpha(c) || c == &#x27;_&#x27; || isdigit(c);&#125;inline bool can_be_a_number(char c)&#123; return isdigit(c) || c == &#x27;.&#x27; || c == &#x27;-&#x27; || c == &#x27;+&#x27; || c == &#x27;E&#x27; || c == &#x27;e&#x27; || c == &#x27;x&#x27; || c == &#x27;X&#x27; || (&#x27;a&#x27; &lt;= c &amp;&amp; c &lt;= &#x27;f&#x27;) || (&#x27;A&#x27; &lt;= c &amp;&amp; c &lt;= &#x27;F&#x27;);&#125; æœ€ååˆ¤æ–­æ•°å­—äº†ï¼Œæœæ–­é€‰æ‹©å…ˆå†™å¥½ä¸€ä¸ªåˆ¤æ–­ä¸€ä¸ª string æ˜¯ä¸æ˜¯ NUMBER çš„å‡½æ•°ï¼Œç„¶å O(n3)\\mathcal{O}(n^3)O(n3) åˆ¤æ–­ï¼ˆæ„Ÿè§‰æ–¹æ³•å¾ˆ zzï¼Œä½†è°ƒèµ·æ¥å¾ˆçˆ½ï¼Œè¿˜é¡ºä¾¿æŠŠ SYMBOL ç»™åˆ¤æ‰äº†ï¼‰ã€‚ è¿™é‡Œæ˜¯åˆ¤æ–­ NUMBER çš„ä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104struct NUMBER&#123; inline bool is_zf(char c) &#123; return c == &#x27;+&#x27; || c == &#x27;-&#x27;; &#125; inline bool is_10_int(const register string&amp; s) // æ˜¯åè¿›åˆ¶æ•´å‹ &#123; unsigned l = 0; while(l &lt; s.length() &amp;&amp; is_zf(s[l])) l++; if(l &gt;= s.length()) return false; while(l &lt; s.length() &amp;&amp; isdigit(s[l])) l++; return l == s.length(); &#125; inline bool is_0x_char(char c) &#123; return isdigit(c) || (&#x27;a&#x27; &lt;= c &amp;&amp; c &lt;= &#x27;f&#x27;) || (&#x27;A&#x27; &lt;= c &amp;&amp; c &lt;= &#x27;F&#x27;); &#125; inline bool is_0x_int(const register string&amp; s) // æ˜¯åå…­è¿›åˆ¶æ•´å‹ &#123; unsigned l = 0; while(l &lt; s.length() &amp;&amp; is_zf(s[l])) l++; if(l + 1 &gt;= s.length()) return false; if(s[l] != &#x27;0&#x27; || (s[l + 1] != &#x27;x&#x27; &amp;&amp; s[l + 1] != &#x27;X&#x27;)) return false; l += 2; while(l &lt; s.length() &amp;&amp; is_0x_char(s[l])) l++; return l == s.length(); &#125; inline bool is_float(const register string&amp; s) // æ˜¯æµ®ç‚¹å‹ &#123; unsigned l = 0; while(l &lt; s.length() &amp;&amp; is_zf(s[l])) l++; if(l + 1 &gt;= s.length()) return false; int hav_e = -1, hav_d = -1; // hav_e è®°å½• e çš„ä½ç½®ï¼Œhav_d è®°å½•. çš„ä½ç½® for(unsigned i = l; i &lt; s.length(); ++i) &#123; if(s[i] == &#x27;.&#x27;) &#123; if(~hav_d) return false; else hav_d = i + 1; &#125; else if(s[i] == &#x27;E&#x27; || s[i] == &#x27;e&#x27;) &#123; if(~hav_e) return false; else hav_e = i + 1; &#125; else if(s[i] != &#x27;-&#x27; &amp;&amp; s[i] != &#x27;+&#x27; &amp;&amp; !isdigit(s[i])) return false; &#125; // æŠŠå¼€å§‹åˆ°å°æ•°ç‚¹ã€å°æ•°ç‚¹åˆ° eã€e åˆ°ç»“å°¾åˆ†å¼€æ¥çœ‹ if((~hav_e) &amp;&amp; (~hav_d)) &#123; if(hav_e &lt; hav_d || (hav_d == 1 &amp;&amp; hav_e - hav_d == 1)) return false; return ((hav_d == 1) || is_10_int(s.substr(0, hav_d - 1))) &amp;&amp; (is_10_int(s.substr(hav_d, hav_e - hav_d - 1)) ||(hav_e - hav_d == 1)) &amp;&amp; is_10_int(s.substr(hav_e)); &#125; else if(~hav_e) &#123; return is_10_int(s.substr(0, hav_e - 1)) &amp;&amp; is_10_int(s.substr(hav_e)); &#125; else if(~hav_d) &#123; return ((hav_d == 1) || is_10_int(s.substr(0, hav_d - 1))) &amp;&amp; is_10_int(s.substr(hav_d)); &#125; else return false; &#125; inline int is_number(const register string&amp; s) // åˆå¹¶èµ·æ¥ &#123; if(s[0] == &#x27;+&#x27; || s[0] == &#x27;-&#x27;) return 0; if(is_10_int(s)) return 1; else if(is_0x_int(s)) return 2; else if(is_float(s)) return 3; else return 0; &#125;&#125; numb; ç„¶åæŠŠ NUMBER è¯»å‡ºæ¥ï¼Œé¡ºä¾¿æŠŠ SYMBOL ä¹Ÿç»™åˆ¤æ‰ï¼š 123456789101112131415161718192021222324252627int r = 0;if(s[nowl] != &#x27;+&#x27; &amp;&amp; s[nowl] != &#x27;-&#x27;)&#123; while(can_be_a_number(s[nowl + r])) r++; while(r &amp;&amp; !numb.is_number(s.substr(nowl, r))) r--;&#125;if(r)&#123; ans.s = s.substr(nowl, r); nowl += r; ans.typ = 2;&#125;else // å¦‚æœä¸å¯èƒ½æ˜¯æ•°å­—ï¼Œé‚£å°±åªèƒ½æ˜¯ SYMBOL äº†&#123; string lst = ans.s = &quot;&quot;; lst.push_back(s[nowl++]); while(symb.is_symbol(lst)) &#123; ans.s.push_back(s[nowl - 1]); lst.push_back(s[nowl++]); &#125; nowl--; ans.typ = 4;&#125;return ans; å®Œç»“æ’’èŠ±ã€‚ æœ€åæŠŠå®Œæ•´çš„ä»£ç è´´ä¸€ä¸‹ï¼Œæ¯•ç«Ÿæ˜¯ä¸€é“ç»†èŠ‚é¢˜ï¼Œå†åŠ ä¸Šæ•°æ®æ°´ï¼ˆäº¤å®Œå°±æŠŠè‡ªå·± hack æ‰äº†ï¼Œç„¶åå‘ç°è¿‡äº†ï¼‰ï¼Œå¦‚æœæŠŠæˆ‘çš„ä»£ç  hack æ‰äº†æ±‚åœ¨ä¸‹é¢ç•™è¨€ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321#include &lt;cstdio&gt;#include &lt;cctype&gt;#include &lt;set&gt;#include &lt;string&gt;#include &lt;vector&gt;#include &lt;iostream&gt;#include &lt;algorithm&gt;using namespace std;string TYPE[] =&#123; &quot;RESERVED&quot;, // ä¿ç•™å­— 1 &quot;NUMBER&quot;, // æ•°å­— 2 &quot;STRING&quot;, // å­—ç¬¦ä¸² 3 &quot;SYMBOL&quot;, // ç¬¦å· 4 &quot;NAME&quot;, // å˜é‡å 5 &quot;EOL&quot;, // æ¢è¡Œç¬¦ 6 &quot;COMMENT&quot; // æ³¨é‡Š 7&#125;;struct SYMBOL&#123; string all[26] = &#123; &quot;+&quot;, &quot;-&quot;, &quot;*&quot;, &quot;/&quot;, &quot;%&quot;, &quot;^&quot;, &quot;#&quot;, &quot;==&quot;, &quot;~=&quot;, &quot;&lt;=&quot;, &quot;&gt;=&quot;, &quot;&lt;&quot;, &quot;&gt;&quot;, &quot;=&quot;, &quot;(&quot;, &quot;)&quot;, &quot;&#123;&quot;, &quot;&#125;&quot;, &quot;[&quot;, &quot;]&quot;, &quot;;&quot;, &quot;:&quot;, &quot;,&quot;, &quot;.&quot;, &quot;..&quot;, &quot;...&quot; &#125;; set&lt;string&gt; all_symbol; SYMBOL () &#123; all_symbol.clear(); for(int i = 0; i &lt; 26; ++i) all_symbol.insert(all[i]); &#125; inline bool is_symbol(string s) &#123; return all_symbol.count(s); &#125;&#125; symb;struct RESERVED&#123; string all[21] = &#123; &quot;and&quot;, &quot;break&quot;, &quot;do&quot;, &quot;else&quot;, &quot;elseif&quot;, &quot;end&quot;, &quot;false&quot;, &quot;for&quot;, &quot;function&quot;, &quot;if&quot;, &quot;in&quot;, &quot;local&quot;, &quot;nil&quot;, &quot;not&quot;, &quot;or&quot;, &quot;repeat&quot;, &quot;return&quot;, &quot;then&quot;, &quot;true&quot;, &quot;until&quot;, &quot;while&quot; &#125;; set&lt;string&gt; all_reserved; RESERVED () &#123; all_reserved.clear(); for(int i = 0; i &lt; 21; ++i) all_reserved.insert(all[i]); &#125; inline bool is_reserved(string s) &#123; return all_reserved.count(s); &#125;&#125; rese;struct Token&#123; int typ; string s; Token (int tp = 6, string ss = &quot;&quot;) &#123; typ = tp, s = ss; &#125;&#125;;struct NUMBER&#123; inline bool is_zf(char c) &#123; return c == &#x27;+&#x27; || c == &#x27;-&#x27;; &#125; inline bool is_10_int(const register string&amp; s) &#123; unsigned l = 0; while(l &lt; s.length() &amp;&amp; is_zf(s[l])) l++; if(l &gt;= s.length()) return false; while(l &lt; s.length() &amp;&amp; isdigit(s[l])) l++; return l == s.length(); &#125; inline bool is_0x_char(char c) &#123; return isdigit(c) || (&#x27;a&#x27; &lt;= c &amp;&amp; c &lt;= &#x27;f&#x27;) || (&#x27;A&#x27; &lt;= c &amp;&amp; c &lt;= &#x27;F&#x27;); &#125; inline bool is_0x_int(const register string&amp; s) &#123; unsigned l = 0; while(l &lt; s.length() &amp;&amp; is_zf(s[l])) l++; if(l + 1 &gt;= s.length()) return false; if(s[l] != &#x27;0&#x27; || (s[l + 1] != &#x27;x&#x27; &amp;&amp; s[l + 1] != &#x27;X&#x27;)) return false; l += 2; while(l &lt; s.length() &amp;&amp; is_0x_char(s[l])) l++; return l == s.length(); &#125; inline bool is_float(const register string&amp; s) &#123; unsigned l = 0; while(l &lt; s.length() &amp;&amp; is_zf(s[l])) l++; if(l + 1 &gt;= s.length()) return false; int hav_e = -1, hav_d = -1; for(unsigned i = l; i &lt; s.length(); ++i) &#123; if(s[i] == &#x27;.&#x27;) &#123; if(~hav_d) return false; else hav_d = i + 1; &#125; else if(s[i] == &#x27;E&#x27; || s[i] == &#x27;e&#x27;) &#123; if(~hav_e) return false; else hav_e = i + 1; &#125; else if(s[i] != &#x27;-&#x27; &amp;&amp; s[i] != &#x27;+&#x27; &amp;&amp; !isdigit(s[i])) return false; &#125; if((~hav_e) &amp;&amp; (~hav_d)) &#123; if(hav_e &lt; hav_d || (hav_d == 1 &amp;&amp; hav_e - hav_d == 1)) return false; return ((hav_d == 1) || is_10_int(s.substr(0, hav_d - 1))) &amp;&amp; (is_10_int(s.substr(hav_d, hav_e - hav_d - 1)) ||(hav_e - hav_d == 1)) &amp;&amp; is_10_int(s.substr(hav_e)); &#125; else if(~hav_e) &#123; return is_10_int(s.substr(0, hav_e - 1)) &amp;&amp; is_10_int(s.substr(hav_e)); &#125; else if(~hav_d) &#123; return ((hav_d == 1) || is_10_int(s.substr(0, hav_d - 1))) &amp;&amp; is_10_int(s.substr(hav_d)); &#125; else return false; &#125; inline int is_number(const register string&amp; s) &#123; if(s[0] == &#x27;+&#x27; || s[0] == &#x27;-&#x27;) return 0; if(is_10_int(s)) return 1; else if(is_0x_int(s)) return 2; else if(is_float(s)) return 3; else return 0; &#125;&#125; numb;class BUF&#123; private: string s; unsigned nowl; inline bool can_be_a_name(char c) &#123; return isalpha(c) || c == &#x27;_&#x27; || isdigit(c); &#125; inline bool can_be_a_number(char c) &#123; return isdigit(c) || c == &#x27;.&#x27; || c == &#x27;-&#x27; || c == &#x27;+&#x27; || c == &#x27;E&#x27; || c == &#x27;e&#x27; || c == &#x27;x&#x27; || c == &#x27;X&#x27; || (&#x27;a&#x27; &lt;= c &amp;&amp; c &lt;= &#x27;f&#x27;) || (&#x27;A&#x27; &lt;= c &amp;&amp; c &lt;= &#x27;F&#x27;); &#125; public: BUF() &#123; nowl = 0; s = &quot;&quot;; &#125; inline Token read() &#123; Token ans; if(nowl == s.length()) &#123; if(!getline(cin, s)) return Token(-1); nowl = 0; s.push_back(&#x27;\\n&#x27;); &#125; while(s[nowl] == &#x27; &#x27;) nowl++; if(s[nowl] == &#x27;\\n&#x27;) &#123; nowl++; return ans; &#125; if(s[nowl] == &#x27;-&#x27; &amp;&amp; s[nowl + 1] == &#x27;-&#x27;) &#123; nowl = s.length(); return ans; &#125; if(s[nowl] == &#x27;&quot;&#x27;) &#123; bool zy = false; ans.s.push_back(s[nowl++]); while(zy || s[nowl] != &#x27;&quot;&#x27;) &#123; if(!zy &amp;&amp; s[nowl] == &#x27;\\\\&#x27;) zy = true; else zy = false; ans.s.push_back(s[nowl++]); &#125; ans.s.push_back(s[nowl++]); ans.typ = 3; return ans; &#125; if(s[nowl] == &#x27;\\&#x27;&#x27;) &#123; bool zy = false; ans.s.push_back(s[nowl++]); while(zy || s[nowl] != &#x27;\\&#x27;&#x27;) &#123; if(!zy &amp;&amp; s[nowl] == &#x27;\\\\&#x27;) zy = true; else zy = false; ans.s.push_back(s[nowl++]); &#125; ans.typ = 3; return ans; &#125; if(isalpha(s[nowl])) &#123; while(can_be_a_name(s[nowl])) ans.s.push_back(s[nowl++]); if(rese.is_reserved(ans.s)) ans.typ = 1; else ans.typ = 5; return ans; &#125; else &#123; int r = 0; if(s[nowl] != &#x27;+&#x27; &amp;&amp; s[nowl] != &#x27;-&#x27;) &#123; while(can_be_a_number(s[nowl + r])) r++; while(r &amp;&amp; !numb.is_number(s.substr(nowl, r))) r--; &#125; if(r) &#123; ans.s = s.substr(nowl, r); nowl += r; ans.typ = 2; &#125; else &#123; string lst = ans.s = &quot;&quot;; lst.push_back(s[nowl++]); while(symb.is_symbol(lst)) &#123; ans.s.push_back(s[nowl - 1]); lst.push_back(s[nowl++]); &#125; nowl--; ans.typ = 4; &#125; return ans; &#125; &#125;&#125; buf;int main()&#123; Token s; while(s = buf.read(), ~s.typ) &#123; s.typ--; if(s.typ == 5) cout &lt;&lt; &#x27;[&#x27; &lt;&lt; TYPE[s.typ] &lt;&lt; &#x27;]&#x27; &lt;&lt; &#x27;\\n&#x27;; else cout &lt;&lt; &#x27;[&#x27; &lt;&lt; TYPE[s.typ] &lt;&lt; &#x27;]&#x27; &lt;&lt; &#x27; &#x27; &lt;&lt; s.s &lt;&lt; &#x27;\\n&#x27;; &#125; return 0;&#125;","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"UVa","slug":"UVa","permalink":"https://pufanyi.github.io/oi-blog/tags/UVa/"},{"name":"æ¨¡æ‹Ÿ","slug":"æ¨¡æ‹Ÿ","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%A8%A1%E6%8B%9F/"}]},{"title":"CodeForces 875E Delivery Club","slug":"CF875E","date":"2019-01-11T16:00:00.000Z","updated":"2023-12-25T16:08:27.883Z","comments":true,"path":"CF875E/","link":"","permalink":"https://pufanyi.github.io/oi-blog/CF875E/","excerpt":"æœ‰ä¸¤ä¸ªå¿«é€’å‘˜ï¼Œåˆ†åˆ«åœ¨s1,s2(0â‰¤s1,s2â‰¤109)s_1, s_2(0\\le s_1,s_2\\le 10^9)s1â€‹,s2â€‹(0â‰¤s1â€‹,s2â€‹â‰¤109)ï¼Œç°åœ¨æœ‰n(1â‰¤nâ‰¤100000)n(1\\le n\\le 100000)n(1â‰¤nâ‰¤100000)ä¸ªä»»åŠ¡ï¼Œæ¯ä¸ªä»»åŠ¡xix_ixiâ€‹è¡¨ç¤ºè¦å°†è´§ç‰©é€åˆ°xix_ixiâ€‹ï¼Œè®©ä»»ä½•ä¸€ä¸ªå¿«é€’å‘˜åˆ°xix_ixiâ€‹éƒ½å¯ä»¥ã€‚ç”±äºå¿«é€’å‘˜ä¹‹é—´éœ€è¦æœ‰å¯¹è®²æœºè”ç³»ï¼Œè¯·ä½ è®¾è®¡ä¸€ç§æ–¹æ¡ˆä½¿å¾—ä¸¤ä¸ªå¿«é€’å‘˜ä¹‹é—´çš„æœ€é•¿è·ç¦»æœ€çŸ­ã€‚","text":"æœ‰ä¸¤ä¸ªå¿«é€’å‘˜ï¼Œåˆ†åˆ«åœ¨ s1,s2(0â‰¤s1,s2â‰¤109)s_1, s_2(0\\le s_1,s_2\\le 10^9)s1â€‹,s2â€‹(0â‰¤s1â€‹,s2â€‹â‰¤109)ï¼Œç°åœ¨æœ‰n(1â‰¤nâ‰¤100000)n(1\\le n\\le 100000)n(1â‰¤nâ‰¤100000) ä¸ªä»»åŠ¡ï¼Œæ¯ä¸ªä»»åŠ¡ xix_ixiâ€‹ è¡¨ç¤ºè¦å°†è´§ç‰©é€åˆ° xix_ixiâ€‹ï¼Œè®©ä»»ä½•ä¸€ä¸ªå¿«é€’å‘˜åˆ°xix_ixiâ€‹ éƒ½å¯ä»¥ã€‚ç”±äºå¿«é€’å‘˜ä¹‹é—´éœ€è¦æœ‰å¯¹è®²æœºè”ç³»ï¼Œè¯·ä½ è®¾è®¡ä¸€ç§æ–¹æ¡ˆä½¿å¾—ä¸¤ä¸ªå¿«é€’å‘˜ä¹‹é—´çš„æœ€é•¿è·ç¦»æœ€çŸ­ã€‚ å…ˆè¾“å…¥ n,s1,s2n,s_1,s_2n,s1â€‹,s2â€‹ï¼Œåœ¨ä¸€è¡Œnnn ä¸ªæ•´æ•°xix_ixiâ€‹ã€‚ é¢˜è§£ CF å¦‚æ­¤å¤šçš„äºŒåˆ† + è´ªå¿ƒï¼Œä½†æˆ‘å°±æ˜¯æƒ³ä¸å‡ºæ¥â€¦â€¦ é¦–å…ˆäºŒåˆ†ç­”æ¡ˆã€‚ éš¾ç‚¹æ˜¯åœ¨å¦‚ä½•åˆ¤æ–­ç­”æ¡ˆåˆæ³•ã€‚ æ˜¾ç„¶æ­£ç€åšæ˜¯ä¸è¡Œçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è€ƒè™‘å€’ç€åšã€‚ æˆ‘ä»¬è€ƒè™‘ç°åœ¨äºŒåˆ†çš„è·ç¦»ä¸º LLLï¼Œæšä¸¾åˆ°ç¬¬iii æ­¥ï¼Œå¦‚æœä¸¤ä¸ªå¿«é€’å‘˜ä¸­è‡³å°‘æœ‰ä¸€ä¸ªçš„èµ·ç‚¹å‡ºç°åœ¨ [li,ri][l_i,r_i][liâ€‹,riâ€‹] çš„èŒƒå›´å†…ï¼Œä¸”ä¸¤ä¸ªå¿«é€’å‘˜ç›¸è·ä¸è¶…è¿‡LLLï¼Œé‚£ä¹ˆæ˜¯åˆæ³•çš„ã€‚ ç°åœ¨è€ƒè™‘ä» [li+1,ri+1][l_{i+1},r_{i+1}][li+1â€‹,ri+1â€‹] å‘[li,ri][l_{i},r_{i}][liâ€‹,riâ€‹]è½¬ç§»ã€‚ æ˜¾ç„¶ï¼Œä¸¤ä¸ªå¿«é€’å‘˜ä¸­åªæœ‰ä¸€ä¸ªå¿«é€’å‘˜åŠ¨ï¼Œè€Œä¸åŠ¨çš„é‚£ä¸ªå¿«é€’å‘˜å¿…é¡»å·²ç»åœ¨[xiâˆ’L,xi+L][x_i-L,x_i+L][xiâ€‹âˆ’L,xiâ€‹+L]ã€‚ æˆ‘ä»¬è€ƒè™‘ä¸‹é¢ä¸¤ç§æƒ…å†µï¼š å¦‚æœ xiâˆˆ[li,ri]x_i\\in[l_i,r_i]xiâ€‹âˆˆ[liâ€‹,riâ€‹]ï¼Œé‚£ä¹ˆåªè¦æœ‰ä¸€ä¸ªå¿«é€’å‘˜å·²ç»åœ¨[xiâˆ’L,xi+L][x_i-L,x_i+L][xiâ€‹âˆ’L,xiâ€‹+L] é‡Œå³å¯ï¼Œæˆ‘ä»¬è®©å¦ä¸€ä¸ªå¿«é€’å‘˜èµ°åˆ° xix_ixiâ€‹ï¼Œè€Œå› ä¸ºxiâˆˆ[li,ri]x_i\\in[l_i,r_i]xiâ€‹âˆˆ[liâ€‹,riâ€‹]ï¼Œæ‰€ä»¥è¿™ä½å¿«é€’å‘˜åœ¨[li,ri][l_i,r_i][liâ€‹,riâ€‹] é‡Œäº†ï¼Œä¸”ä¸¤ä¸ªå¿«é€’å‘˜ç›¸è·ä¸è¶…è¿‡LLLã€‚æ‰€ä»¥li=xiâˆ’L,ri=xi+Ll_i=x_i-L, r_i=x_i+Lliâ€‹=xiâ€‹âˆ’L,riâ€‹=xiâ€‹+Lã€‚ å¦‚æœ xiâˆ‰[li,ri]x_i\\notin [l_i,r_i]xiâ€‹âˆˆ/[liâ€‹,riâ€‹]ï¼Œè€ƒè™‘ä¸åŠ¨çš„å¿«é€’å‘˜ï¼Œé¦–å…ˆå¿…é¡»åœ¨[xiâˆ’L,xi+L][x_i-L,x_i+L][xiâ€‹âˆ’L,xiâ€‹+L] é‡Œï¼Œåˆç”±äº xiâˆ‰[li,ri]x_i\\notin[l_i,r_i]xiâ€‹âˆˆ/[liâ€‹,riâ€‹]ï¼Œæ•…ä»–ä¹Ÿå¿…é¡»åœ¨[li,ri][l_i,r_i][liâ€‹,riâ€‹] é‡Œï¼Œè€Œåˆ° xix_ixiâ€‹ çš„é‚£ä¸ªå¿«é€’å‘˜æ²¡æœ‰ä»€ä¹ˆç‰¹æ®Šçš„è¦æ±‚äº†ã€‚æ‰€ä»¥li=maxâ¡(li+1,xiâˆ’L),ri=minâ¡(ri+1,xi+L)l_i=\\max(l_{i+1},x_i-L),r_i=\\min(r_{i+1},x_i+L)liâ€‹=max(li+1â€‹,xiâ€‹âˆ’L),riâ€‹=min(ri+1â€‹,xiâ€‹+L)ã€‚ ä»£ç  1234567891011121314151617181920212223242526272829303132333435363738394041#include &lt;cstdio&gt;#include &lt;algorithm&gt;using namespace std;const int maxn = 100005;const int inf = 0x3f3f3f3f;int n, s1, s2;int aa[maxn];inline bool check(int x)&#123; int l = -inf, r = inf; for(int i = n; i; --i) &#123; if(l &lt;= aa[i] &amp;&amp; aa[i] &lt;= r) l = aa[i] - x, r = aa[i] + x; else l = max(l, aa[i] - x), r = min(r, aa[i] + x); &#125; return (l &lt;= s1 &amp;&amp; s1 &lt;= r) || (l &lt;= s2 &amp;&amp; s2 &lt;= r);&#125;int main()&#123; scanf(&quot;%d%d%d&quot;, &amp;n, &amp;s1, &amp;s2); for(int i = 1; i &lt;= n; ++i) scanf(&quot;%d&quot;, &amp;aa[i]); int l = abs(s1 - s2), r = inf; while(l &lt; r) &#123; int mid = (l + r) &gt;&gt; 1; if(check(mid)) r = mid; else l = mid + 1; &#125; printf(&quot;%d\\n&quot;, l); return 0;&#125;","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"CodeForces","slug":"CodeForces","permalink":"https://pufanyi.github.io/oi-blog/tags/CodeForces/"},{"name":"è´ªå¿ƒ","slug":"è´ªå¿ƒ","permalink":"https://pufanyi.github.io/oi-blog/tags/%E8%B4%AA%E5%BF%83/"},{"name":"äºŒåˆ†","slug":"äºŒåˆ†","permalink":"https://pufanyi.github.io/oi-blog/tags/%E4%BA%8C%E5%88%86/"}]},{"title":"CodeForces 77C Beavermuncher-0xFF","slug":"CF77C","date":"2019-01-11T16:00:00.000Z","updated":"2023-12-25T16:08:27.882Z","comments":true,"path":"CF77C/","link":"","permalink":"https://pufanyi.github.io/oi-blog/CF77C/","excerpt":"åŸé¢˜é“¾æ¥ æœ‰ä¸€æ£µæ ‘ï¼Œç¬¬iiiä¸ªèŠ‚ç‚¹ä¸Šæœ‰kik_ikiâ€‹åªæµ·ç‹¸ã€‚ç°åœ¨ï¼Œæœ‰ä¸€åªåƒæµ·ç‹¸çš„æœºå™¨&quot;Beavermuncher-0xFF&quot;ä»æ ¹èŠ‚ç‚¹ssså‡ºå‘ï¼Œæ¯åƒä¸€åªæµ·ç‹¸ï¼Œå®ƒå°±èƒ½å¤Ÿä¸”å¿…é¡»èµ°åˆ°ä¸è¯¥èŠ‚ç‚¹ä¸¤è¾¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹å¹¶åƒæ‰é‚£ä¸ªèŠ‚ç‚¹ä¸Šçš„ä¸€åªæµ·ç‹¸ã€‚è¯¥æœºå™¨æ¯åˆ°ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¸€æ¬¡éƒ½åªèƒ½åƒä¸€åªæµ·ç‹¸ã€‚è¦æ±‚æœ€ç»ˆæœºå™¨å›åˆ°æ ¹èŠ‚ç‚¹ã€‚é—®è¯¥æœºå™¨æœ€å¤šèƒ½åƒå¤šå°‘åªæµ·ç‹¸ã€‚","text":"åŸé¢˜é“¾æ¥ æœ‰ä¸€æ£µæ ‘ï¼Œç¬¬ iii ä¸ªèŠ‚ç‚¹ä¸Šæœ‰ kik_ikiâ€‹ åªæµ·ç‹¸ã€‚ç°åœ¨ï¼Œæœ‰ä¸€åªåƒæµ·ç‹¸çš„æœºå™¨ &quot;Beavermuncher-0xFF&quot; ä»æ ¹èŠ‚ç‚¹ sss å‡ºå‘ï¼Œæ¯åƒä¸€åªæµ·ç‹¸ï¼Œå®ƒå°±èƒ½å¤Ÿä¸”å¿…é¡»èµ°åˆ°ä¸è¯¥èŠ‚ç‚¹ä¸¤è¾¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹å¹¶åƒæ‰é‚£ä¸ªèŠ‚ç‚¹ä¸Šçš„ä¸€åªæµ·ç‹¸ã€‚è¯¥æœºå™¨æ¯åˆ°ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¸€æ¬¡éƒ½åªèƒ½åƒä¸€åªæµ·ç‹¸ã€‚è¦æ±‚æœ€ç»ˆæœºå™¨å›åˆ°æ ¹èŠ‚ç‚¹ã€‚é—®è¯¥æœºå™¨æœ€å¤šèƒ½åƒå¤šå°‘åªæµ·ç‹¸ã€‚ å…ˆè¾“å…¥èŠ‚ç‚¹ä¸ªæ•° n(nâ‰¤105)n(n\\le 10^5)n(nâ‰¤105)ï¼Œç„¶åæ˜¯nnn ä¸ªæ•´æ•° kik_ikiâ€‹ï¼Œåé¢nâˆ’1nâˆ’1nâˆ’1 è¡Œæè¿°ä¸€æ£µæ ‘ï¼Œæœ€åä¸€ä¸ªæ•´æ•°è¡¨ç¤ºæ ¹èŠ‚ç‚¹sssã€‚ æ ·ä¾‹ä¸€å¤§æ¦‚æ˜¯è¿™æ ·ä¸€å¹…å›¾ï¼š é¢˜è§£ ä¸éš¾å‘ç°ä»ä¸€ä¸ªèŠ‚ç‚¹å‡ºå‘ï¼Œæ²¡å‰å¾€å®ƒçš„ä¸€æ£µå­æ ‘ï¼Œéƒ½è¦èŠ±è´¹ 111 çš„ä»£ä»·ï¼ˆåºŸè¯ï¼‰ã€‚ å›åˆ°çˆ¶äº²åˆè¦èŠ±è´¹ 111 çš„ä»£ä»·ã€‚ æ‰€ä»¥ä¸€ä¸ªæ˜¾ç„¶çš„è´ªå¿ƒç­–ç•¥å°±æ˜¯å…ˆèŠ±è´¹ kiâˆ’1k_{i-1}kiâˆ’1â€‹ çš„ä»£ä»·â€œæ¸¸å†â€å„ä¸ªå„¿å­ï¼Œç„¶åå†è¿”å›çˆ¶äº²ã€‚ ä»¤ dp[i]dp[i]dp[i] è¡¨ç¤ºä» iii èŠ‚ç‚¹â€œæ¸¸å†â€å„¿å­åå›åˆ°çˆ¶äº²æœ€å¤§æ‰€èƒ½åƒæ‰çš„æµ·ç‹¸æ•°ã€‚ä½†æœ‰äº›èŠ‚ç‚¹èµ°å®Œæ‰€æœ‰å„¿å­åæµ·ç‹¸æ•°é‡è¿˜æ˜¯å¤§äº 111ã€‚æˆ‘ä»¬è®°å½•ä¸‹æ¯ä¸ªå„¿å­è¿”å›çˆ¶äº²åä»ç•™ä¸‹çš„æµ·ç‹¸æ•°kx[i]kx[i]kx[i]ï¼Œå½“çˆ¶äº²â€œæ¸¸å†â€å®Œæ‰€æœ‰å„¿å­åï¼Œè€ƒè™‘åœ¨çˆ¶äº²ä¸å„¿å­ä¹‹é—´å¾€è¿”è·‘ï¼Œå³iâ†’fa[i]â†’iâ†’â‹¯i\\to fa[i]\\to i\\to \\cdotsiâ†’fa[i]â†’iâ†’â‹¯ã€‚ä½†æœ‰äº›èŠ‚ç‚¹æ— æ³•â€œæ¸¸å†â€æ‰€æœ‰å„¿å­ï¼Œé‚£ä¹ˆå°±æŠŠå„¿å­çš„dpdpdp å€¼ä»å¤§åˆ°å°æ’åºå³å¯ã€‚ ä»£ç  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115#include &lt;cctype&gt;#include &lt;cstdio&gt;namespace IO&#123; const int maxl = 23333; char buf[maxl], *sss = buf, *ttt = buf; inline char gc() &#123; if(sss == ttt) &#123; ttt = (sss = buf) + fread(buf, 1, maxl, stdin); if(sss == ttt) return EOF; &#125; return *sss++; &#125; #define dd c = gc() template &lt;class T&gt; inline bool read(T&amp; x) &#123; x = 0; bool f = false; char dd; for(; !isdigit(c); dd) &#123; if(c == &#x27;-&#x27;) f = true; else if(c == EOF) return false; &#125; for(; isdigit(c); dd) x = (x &lt;&lt; 1) + (x &lt;&lt; 3) + (c ^ 48); if(f) x = -x; return true; &#125; #undef dd&#125;using IO::read;#include &lt;set&gt;#include &lt;utility&gt;#include &lt;algorithm&gt;using namespace std;typedef long long LL;typedef pair&lt;LL, int&gt; pii;const int maxn = 100005;int n, k[maxn], kx[maxn], rt;LL dp[maxn];struct Edge&#123; int to, nxt;&#125; e[maxn &lt;&lt; 1];int first[maxn];inline void add_edge(int from, int to)&#123; static int cnt = 0; e[++cnt].nxt = first[from]; first[from] = cnt; e[cnt].to = to; e[++cnt].nxt = first[to]; first[to] = cnt; e[cnt].to = from;&#125;inline void dfs(int now, int fa)&#123; set&lt;pii&gt; st; st.clear(); dp[now] = (now != rt); k[now] -= (now != rt); // ç›´æ¥æŠŠå»çˆ¶äº²çš„ä»£ä»·å‡æ‰ for(int i = first[now]; i; i = e[i].nxt) &#123; int to = e[i].to; if(fa != to) &#123; dfs(to, now); st.insert(make_pair(dp[to], to)); &#125; &#125; int tmp = 0; // å„¿å­èŠ‚ç‚¹ kx çš„ sum int tmpk = k[now]; set&lt;pii&gt;::reverse_iterator it; // å€’åºéå† set for(it = st.rbegin(); tmpk &amp;&amp; it != st.rend(); tmpk--, ++it) &#123; dp[now] += it-&gt;first + 1; tmp += kx[it-&gt;second]; &#125; dp[now] += min(tmpk, tmp) &lt;&lt; 1; kx[now] = max(tmpk - tmp, 0);&#125;int main()&#123; read(n); for(int i = 1; i &lt;= n; ++i) read(k[i]); for(int i = 1, f, t; i &lt; n; ++i) read(f), read(t), add_edge(f, t); read(rt); dfs(rt, 0); printf(&quot;%lld\\n&quot;, dp[rt]); return 0;&#125;","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"CodeForces","slug":"CodeForces","permalink":"https://pufanyi.github.io/oi-blog/tags/CodeForces/"},{"name":"DP","slug":"DP","permalink":"https://pufanyi.github.io/oi-blog/tags/DP/"},{"name":"è´ªå¿ƒ","slug":"è´ªå¿ƒ","permalink":"https://pufanyi.github.io/oi-blog/tags/%E8%B4%AA%E5%BF%83/"}]},{"title":"FFT å°å°ç»“","slug":"FFTå°å°ç»“","date":"2019-01-11T16:00:00.000Z","updated":"2023-12-25T16:08:27.892Z","comments":true,"path":"FFTå°å°ç»“/","link":"","permalink":"https://pufanyi.github.io/oi-blog/FFT%E5%B0%8F%E5%B0%8F%E7%BB%93/","excerpt":"æœªå®Œå¾…ç»­â€¦â€¦ upd: è™½ç„¶æœªå®Œï¼Œä½†æ˜¯ä¸æƒ³ç»­äº†ã€‚ å¬è¯´ç°åœ¨å…¨äººç±»éƒ½ä¼šFFTäº†ï¼Ÿ è¿™é‡Œåšä¸ªå°å°ç»“ã€‚","text":"æœªå®Œå¾…ç»­â€¦â€¦ upd: è™½ç„¶æœªå®Œï¼Œä½†æ˜¯ä¸æƒ³ç»­äº†ã€‚ å¬è¯´ç°åœ¨å…¨äººç±»éƒ½ä¼š FFT äº†ï¼Ÿ è¿™é‡Œåšä¸ªå°å°ç»“ã€‚ å¤šé¡¹å¼ å¤§æ¦‚å°±æ˜¯è¿™æ ·çš„ä¸€ä¸ªä¸œè¥¿ï¼š A(x)=âˆ‘i=0nâˆ’1aixiA(x) = \\sum_{i=0}^{n-1}a_ix^i A(x)=i=0âˆ‘nâˆ’1â€‹aiâ€‹xi ç³»æ•°ï¼ša0,a1,a2,â‹¯ ,anâˆ’1a_0, a_1, a_2,\\cdots, a_{n-1}a0â€‹,a1â€‹,a2â€‹,â‹¯,anâˆ’1â€‹ã€‚ æ¬¡æ•° ï¼šå¦‚æœæœ€é«˜ä½é000 ç³»æ•°æ˜¯ aka_kakâ€‹ï¼Œé‚£å°±ç§°A(x)A(x)A(x) çš„æ¬¡æ•°ä¸ºkkkã€‚ å¤šé¡¹å¼è¿ç®— å¤šé¡¹å¼åŠ æ³•ï¼šè‹¥A(x)=âˆ‘i=0nâˆ’1aixi,B(x)=âˆ‘i=0nâˆ’1bixi,C(x)=âˆ‘i=0nâˆ’1cixiA(x) = \\sum_{i=0}^{n-1}a_ix^i, B(x) = \\sum_{i=0}^{n-1}b_ix^i, C(x) = \\sum_{i=0}^{n-1}c_ix^iA(x)=âˆ‘i=0nâˆ’1â€‹aiâ€‹xi,B(x)=âˆ‘i=0nâˆ’1â€‹biâ€‹xi,C(x)=âˆ‘i=0nâˆ’1â€‹ciâ€‹xiï¼ŒA(x)+B(x)=C(x)A(x) + B(x) = C(x)A(x)+B(x)=C(x)ï¼Œé‚£ä¹ˆci=ai+bic_i=a_i+b_iciâ€‹=aiâ€‹+biâ€‹ã€‚ å¤šé¡¹å¼ä¹˜æ³•ï¼šç”¨ä¹˜æ³•ç»“åˆç‡ç®—ä¸€ä¸‹å³å¯ã€‚å¦‚A(x)=âˆ’10x+9,B(x)=4xâˆ’5A(x) =-10x+9,B(x) = 4x-5A(x)=âˆ’10x+9,B(x)=4xâˆ’5ï¼Œåˆ™ A(x)â‹…B(x)=(âˆ’10x+9)â‹…(4xâˆ’5)=âˆ’40x2+86xâˆ’45A(x)\\cdot B(x)=(-10x+9)\\cdot(4x-5)=-40x^2+86x-45 A(x)â‹…B(x)=(âˆ’10x+9)â‹…(4xâˆ’5)=âˆ’40x2+86xâˆ’45 ç¦»æ•£å·ç§¯ ï¼šæˆ‘ä»¬å¸¸è¯´â€œA(x)A(x)A(x) ä¸B(x)B(x)B(x)çš„å·ç§¯â€å…¶å®å¯ä»¥ ç®€å•ç†è§£ä¸º A(x)A(x)A(x) å’ŒB(x)B(x)B(x)çš„ä¹˜ç§¯ï¼Œè®°ä½œaâŠ—ba\\otimes baâŠ—bã€‚[1] ç³»æ•°è¡¨è¾¾ å°±æ˜¯æŠŠ A(x)=âˆ‘i=0nâˆ’1aixiA(x) = \\sum_{i=0}^{n-1}a_ix^iA(x)=âˆ‘i=0nâˆ’1â€‹aiâ€‹xi è®°å½•ä¸º (a1,a2,â‹¯ ,anâˆ’1)(a_1,a_2,\\cdots,a_{n-1})(a1â€‹,a2â€‹,â‹¯,anâˆ’1â€‹)ã€‚æœ´ç´ ç®—æ³•éœ€è¦O(n2)\\mathcal{O}(n^2)O(n2) è¿›è¡Œä¹˜æ³•ã€‚ ç‚¹å€¼è¡¨è¾¾ éšä¾¿ä»£ nnn ä¸ªä¸åŒçš„å€¼è¿›å»ï¼Œå¯ä»¥å¾—åˆ°{(x0,y0),(x1,y1),â‹¯ ,(xnâˆ’1,ynâˆ’1)}\\{(x_0,y_0),(x_1,y_1),\\cdots,(x_{n-1},y_{n-1})\\}{(x0â€‹,y0â€‹),(x1â€‹,y1â€‹),â‹¯,(xnâˆ’1â€‹,ynâˆ’1â€‹)}ã€‚è¿™å°±æ˜¯ç‚¹å€¼è¡¨è¾¾ã€‚ å¦‚æœä¸¤ä¸ªå¤šé¡¹å¼æœ‰ 2n2n2n ä¸ªä¸åŒå€¼çš„ç­”æ¡ˆä¸€ç›´ï¼Œé‚£ä¹ˆæŠŠå®ƒä»¬çš„ yyy ä¹˜èµ·æ¥ï¼Œå°±å¯ä»¥çš„åˆ°è¿™ä¸¤ä¸ªå¤šé¡¹å¼ç›¸ä¹˜åçš„å¤šé¡¹å¼ç‚¹å€¼è¡¨è¾¾ï¼Œå¤æ‚åº¦O(n)\\mathcal{O}(n)O(n)ã€‚ ä¸¤ç§è¡¨è¾¾æ–¹å¼çš„è½¬åŒ– ä»ç³»æ•°è¡¨è¾¾åˆ°ç‚¹å€¼è¡¨è¾¾ï¼Œæˆ‘ä»¬å¸¸ä½¿ç”¨ ç§¦ä¹éŸ¶ç®—æ³• ï¼ˆæˆ–ç§°ä¸º éœçº³æ³•åˆ™ï¼‰ A(x0)=a0+x0(a1+x0(a2+â‹¯+(x0(anâˆ’2+x0anâˆ’1))â‹¯ ))A(x_0)=a_0+x_0(a_1+x_0(a_2+\\cdots+(x_0(a_{n-2}+x_0a_{n-1}))\\cdots)) A(x0â€‹)=a0â€‹+x0â€‹(a1â€‹+x0â€‹(a2â€‹+â‹¯+(x0â€‹(anâˆ’2â€‹+x0â€‹anâˆ’1â€‹))â‹¯)) ä»ç‚¹å€¼è¡¨è¾¾åˆ°ç³»æ•°è¡¨è¾¾ï¼Œæˆ‘ä»¬å«åš æ’å€¼ ï¼Œå¸¸ä½¿ç”¨ æ‹‰æ ¼æœ—æ—¥å…¬å¼ï¼š A(x)=âˆ‘k=0nâˆ’1ykâˆjâ‰ k(xâˆ’xj)(xkâˆ’xj)A(x)=\\sum_{k=0}^{n-1}y_k\\prod_{j\\neq k}\\frac{(x-x_j)}{(x_k-x_j)} A(x)=k=0âˆ‘nâˆ’1â€‹ykâ€‹jî€ =kâˆâ€‹(xkâ€‹âˆ’xjâ€‹)(xâˆ’xjâ€‹)â€‹ å¦‚æœä½ æŠŠ xix_ixiâ€‹ ä»£è¿›å»ï¼Œå°±ä¼šå‘ç°ä»…æœ‰å½“ kkk æšä¸¾åˆ° iii æ—¶âˆjâ‰ k(xâˆ’xj)(xkâˆ’xj)=1\\prod_{j\\neq k}\\frac{(x-x_j)}{(x_k-x_j)}=1âˆjî€ =kâ€‹(xkâ€‹âˆ’xjâ€‹)(xâˆ’xjâ€‹)â€‹=1ï¼Œå…¶ä½™æƒ…å†µéƒ½ä¸ºâˆjâ‰ k(xâˆ’xj)(xkâˆ’xj)=0\\prod_{j\\neq k}\\frac{(x-x_j)}{(x_k-x_j)}=0âˆjî€ =kâ€‹(xkâ€‹âˆ’xjâ€‹)(xâˆ’xjâ€‹)â€‹=0ï¼ˆå› ä¸ºåˆ†å­çš„xjâˆ’xj=0x_j-x_j=0xjâ€‹âˆ’xjâ€‹=0ï¼‰ã€‚[2] é‚£å°±å‡è£…å®ƒæ˜¯å¯¹çš„å§ã€‚[3]ã€‚ å‡ é“æœ‰è¶£çš„é¢˜ Codeforces 933B A Determined Cleanup ç»™å®šä¸¤ä¸ªæ•´æ•° p,k(1â‰¤pâ‰¤1018,2â‰¤kâ‰¤2000)p, k (1\\le p\\le 10^{18},2\\le k\\le 2000)p,k(1â‰¤pâ‰¤1018,2â‰¤kâ‰¤2000)ï¼Œæ±‚æ„é€ å¤šé¡¹å¼f(x)=âˆ‘i=0dâˆ’1aixif(x)=\\sum_{i=0}^{d-1}a_ix^if(x)=âˆ‘i=0dâˆ’1â€‹aiâ€‹xiï¼Œä½¿å¾—å­˜åœ¨å¤šé¡¹å¼p(x)p(x)p(x) æ»¡è¶³f(x)=q(x)â‹…(x+k)+pf(x)=q(x)\\cdot(x+k)+pf(x)=q(x)â‹…(x+k)+pï¼Œä¸”aiâˆˆ[0,k),iâˆˆ[0,d)a_i\\in[0,k),i\\in[0,d)aiâ€‹âˆˆ[0,k),iâˆˆ[0,d)ã€‚[4] é¢˜è§£ å‡è®¾q(x)=âˆ‘i=0dâˆ’2bixiq(x)=\\sum_{i=0}^{d-2}b_ix^iq(x)=âˆ‘i=0dâˆ’2â€‹biâ€‹xiï¼Œé‚£ä¹ˆæœ‰ï¼š ai={p+kbii=0biâˆ’1+kbiiâ‰¥1a_i = \\begin{cases} p + kb_i &amp;&amp; i=0\\\\ b_{i-1} + kb_i &amp;&amp; i \\ge 1 \\end{cases} aiâ€‹={p+kbiâ€‹biâˆ’1â€‹+kbiâ€‹â€‹â€‹i=0iâ‰¥1â€‹ æˆ‘ä»¬æŠŠä¸Šå¼åè¿‡æ¥ï¼š {p=a0âˆ’kb0biâˆ’1=aiâˆ’kbi\\begin{cases} p=a_0-kb_0\\\\ b_{i-1}=a_i-kb_i \\end{cases} {p=a0â€‹âˆ’kb0â€‹biâˆ’1â€‹=aiâ€‹âˆ’kbiâ€‹â€‹ å¾€ä¸Šè¿­ä»£ä¸Šå»ï¼Œæˆ‘ä»¬å°±å‘ç°è¿™ä¸ªå¼å­å¾ˆåƒä¸Šé¢ç§¦ä¹éŸ¶ç®—æ³•çš„é‚£ä¸ªå¼å­ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾—åˆ°ï¼šp=ananâˆ’1â‹¯a1â€¾(âˆ’k)p=\\overline{a_na_{n-1}\\cdots a_{1}}_{(-k)}p=anâ€‹anâˆ’1â€‹â‹¯a1â€‹â€‹(âˆ’k)â€‹ã€‚ æ‰€ä»¥æˆ‘ä»¬åªè¦å¯¹ ppp è¿›è¡Œ âˆ’k-kâˆ’k è¿›åˆ¶åˆ†è§£å³å¯ã€‚ ä»£ç  12345678910111213141516171819202122232425#include &lt;cstdio&gt;typedef long long LL;const int maxn = 2333;LL ans[maxn];LL p, k;int main()&#123; scanf(&quot;%lld%lld&quot;, &amp;p, &amp;k); int top = 0; while(p) &#123; ans[++top] = p % (-k); p /= -k; if(ans[top] &lt; 0) p++, ans[top] += k; &#125; printf(&quot;%d\\n&quot;, top); for(int i = 1; i &lt;= top; ++i) printf(&quot;%d &quot;, ans[i]); return 0;&#125; å¤æ•° ä¸ºè§£å†³å¤æ•°å¼€æ–¹é—®é¢˜ï¼Œæˆ‘ä»¬å¼•å…¥æ–°æ•° iiiï¼Œå«åš è™šæ•°å•ä½ ï¼Œå®šä¹‰i2+1=0i^2+1=0i2+1=0ã€‚åˆæŠŠå½¢å¦‚a+bi(a,bâˆˆR)a+bi(a, b\\in \\mathbb{R})a+bi(a,bâˆˆR) çš„æ•°å«åš å¤æ•° ï¼Œå¤æ•°é›†ç”¨C\\mathbb{C}C è¡¨ç¤ºã€‚ å¤å¹³é¢ å…ˆæŠŠåæ ‡è½´ç”»å‡ºæ¥ï¼Œæ¨ªçš„å«å®è½´ï¼Œç«–çš„å«è™šè½´ï¼Œç„¶åç¡®å®š 000 çš„ä½ç½®ï¼Œz=a+biz=a+biz=a+biå¯ä»¥ç”¨äºŒç»´ç©ºé—´æ¥è¡¨ç¤ºå‡ºæ¥ã€‚ å¤§æ¦‚å°±æ˜¯è¿™æ ·[5]ï¼š æ¨¡é•¿ï¼šä¸Šå›¾ä¸­çš„rrrã€‚ è¾è§’ï¼šä¸Šå›¾ä¸­çš„Ï†\\varphiÏ†ã€‚ å¤æ•°è¿ç®— åŠ å‡æ³•ï¼š(a+bi)+(c+di)=(a+c)+(b+d)i(a+bi)+(c+di)=(a+c)+(b+d)i(a+bi)+(c+di)=(a+c)+(b+d)iã€‚ä¸å‘é‡ä¸€æ ·ï¼Œå¯ä»¥ä½¿ç”¨ä¸‰è§’å½¢å®šåˆ™ã€‚ ä¹˜æ³•ï¼š(a+bi)(c+di)=ac+bci+adi+bdi2=(acâˆ’bd)+(bc+ad)i(a+bi)(c+di)=ac+bci+adi+bdi^{2}=(ac-bd)+(bc+ad)i(a+bi)(c+di)=ac+bci+adi+bdi2=(acâˆ’bd)+(bc+ad)iã€‚å¤æ•°ç›¸ä¹˜ï¼Œæ¨¡é•¿ç›¸ä¹˜ï¼Œå¹…è§’ç›¸åŠ ã€‚ è€ƒè™‘æ¨¡é•¿ä¸º 111 çš„å¤æ•° Ï‰\\omegaÏ‰ã€‚ä¸€ä¸ªå¤æ•°xxx ä¸å®ƒç›¸ä¹˜ï¼Œå¾—åˆ°çš„ç­”æ¡ˆ yyy ä¸xxxæ¨¡é•¿ç›¸ç­‰ï¼Œè¾è§’æ˜¯ xxx åŠ ä¸Šäº† Ï‰\\omegaÏ‰ çš„è¾è§’ã€‚æƒ³åˆ°ä»€ä¹ˆï¼Ÿæ—‹è½¬ï¼Ÿ æ¬§æ‹‰å…¬å¼ eiu=cosâ¡u+isinâ¡ue^{iu}=\\cos u+i\\sin u eiu=cosu+isinu æˆ‘æ‰ä¸ä¼šå‘Šè¯‰ä½ æˆ‘ä¸ä¼šè¯ã€‚[6] å•ä½æ ¹ è€ƒè™‘æ–¹ç¨‹ xnâˆ’1=0 (nâˆˆN+)x^n-1=0\\,(n\\in \\mathbb{N_+})xnâˆ’1=0(nâˆˆN+â€‹)ï¼Œè€ƒè™‘åˆ°å¤æ•°æ—‹è½¬çš„æ€§è´¨ï¼Œæˆ‘ä»¬å‘ç°å°±æ˜¯å°†å•ä½åœ†åˆ’åˆ†æˆnnn ç­‰åˆ†ã€‚æ‰€å¾—çš„è§£å°±å« å•ä½æ ¹ï¼Œè®°ä¸ºÏ‰n\\omega_nÏ‰nâ€‹ã€‚ ç”»æˆå›¾å¤§æ¦‚å°±æ˜¯è¿™æ ·çš„[7]ï¼š æ˜¾ç„¶ï¼Œl=1,Î¸=2Ï€nl=1, \\theta=\\frac{2\\pi}{n}l=1,Î¸=n2Ï€â€‹ã€‚ æ‰€ä»¥Ï‰n=cosâ¡Î¸+isinâ¡Î¸=cosâ¡2Ï€n+isinâ¡2Ï€n=e2Ï€n\\omega_n=\\cos \\theta+i\\sin\\theta=\\cos\\frac{2\\pi}{n}+i\\sin\\frac{2\\pi}{n}=e^{\\frac{2\\pi}{n}}Ï‰nâ€‹=cosÎ¸+isinÎ¸=cosn2Ï€â€‹+isinn2Ï€â€‹=en2Ï€â€‹ã€‚ æ¶ˆå»å¼•ç† Ï‰dndk=(e2Ï€dn)dk=(e2Ï€n)k=Ï‰nk\\omega_{dn}^{dk}={(e^{\\frac{2\\pi}{dn}})}^{dk}=(e^{\\frac{2\\pi}{n}})^k=\\omega_n^k Ï‰dndkâ€‹=(edn2Ï€â€‹)dk=(en2Ï€â€‹)k=Ï‰nkâ€‹ æŠ˜åŠå¼•ç† Ï‰nk+n2=Ï‰nkâ‹…Ï‰nn2=âˆ’Ï‰nk\\omega_n^{k+\\frac{n}{2}}=\\omega_n^k\\cdot\\omega_n^\\frac{n}{2}=-\\omega_n^k Ï‰nk+2nâ€‹â€‹=Ï‰nkâ€‹â‹…Ï‰n2nâ€‹â€‹=âˆ’Ï‰nkâ€‹ æ‰€ä»¥ï¼š (Ï‰nk+n2)2=(Ï‰nk)2(\\omega_n^{k+\\frac{n}{2}})^2=(\\omega_n^k)^2 (Ï‰nk+2nâ€‹â€‹)2=(Ï‰nkâ€‹)2 ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæˆ‘ä»¬è¦ç®— f(Ï‰nk)f(\\omega^k_n)f(Ï‰nkâ€‹) çš„å€¼ï¼ˆkâˆˆZ,kâˆˆ[0,n)k\\in\\mathbb{Z},k\\in[0, n)kâˆˆZ,kâˆˆ[0,n)ï¼‰ï¼Œæˆ‘ä»¬åªéœ€è¦è®¡ç®— kâˆˆ[0,n2)k\\in[0,\\frac{n}{2})kâˆˆ[0,2nâ€‹) æ—¶çš„å€¼å³å¯ã€‚ æ±‚å’Œå¼•ç† ç”±ï¼š xâ‹…âˆ‘i=0nâˆ’1xi=âˆ‘i=1nxix\\cdot\\sum_{i=0}^{n-1}x^i=\\sum_{i=1}^{n}x^i xâ‹…i=0âˆ‘nâˆ’1â€‹xi=i=1âˆ‘nâ€‹xi ä¸¤è¾¹åŒå‡å» âˆ‘i=0nâˆ’1xi\\sum_{i=0}^{n-1}x^iâˆ‘i=0nâˆ’1â€‹xi å¾—ï¼š (xâˆ’1)âˆ‘i=0nâˆ’1xi=xnâˆ’x0=xnâˆ’1(x-1)\\sum_{i=0}^{n-1}x^i=x^n-x^0=x^n-1 (xâˆ’1)i=0âˆ‘nâˆ’1â€‹xi=xnâˆ’x0=xnâˆ’1 æ•…å½“ xâ‰ 1x\\neq 1xî€ =1 æ—¶ï¼š âˆ‘i=0nâˆ’1xi=xnâˆ’1xâˆ’1\\sum_{i=0}^{n-1}x^i=\\frac{x^n-1}{x-1} i=0âˆ‘nâˆ’1â€‹xi=xâˆ’1xnâˆ’1â€‹ æ‰€ä»¥å½“ Ï‰nkâ‰ 1\\omega_n^k\\neq 1Ï‰nkâ€‹î€ =1ï¼Œå³nâˆ¤kn\\nmid knâˆ¤k æ—¶ï¼š âˆ‘i=0nâˆ’1(Ï‰nk)i=(Ï‰nk)nâˆ’1Ï‰nkâˆ’1=0\\sum_{i=0}^{n-1}(\\omega_n^k)^i=\\frac{(\\omega_n^k)^n-1}{\\omega_n^k-1}=0 i=0âˆ‘nâˆ’1â€‹(Ï‰nkâ€‹)i=Ï‰nkâ€‹âˆ’1(Ï‰nkâ€‹)nâˆ’1â€‹=0 è€Œå½“ Ï‰nk=1\\omega_n^k=1Ï‰nkâ€‹=1ï¼Œå³nâˆ£kn\\mid knâˆ£k æ—¶ï¼š âˆ‘i=0nâˆ’1(Ï‰nk)i=n\\sum_{i=0}^{n-1}(\\omega_n^k)^i=n i=0âˆ‘nâˆ’1â€‹(Ï‰nkâ€‹)i=n ç»¼ä¸Šï¼š âˆ‘i=0nâˆ’1(Ï‰nk)i={0nâˆ¤knnâˆ£k\\sum_{i=0}^{n-1}(\\omega_n^k)^i = \\begin{cases} 0&amp; n\\nmid k\\\\ n&amp; n\\mid k \\end{cases} i=0âˆ‘nâˆ’1â€‹(Ï‰nkâ€‹)i={0nâ€‹nâˆ¤knâˆ£kâ€‹ æˆ–è€…æˆ‘ä»¬å¯ä»¥å†™æˆï¼š âˆ‘i=0nâˆ’1(Ï‰nk)i=[nâˆ£k]Ã—n\\sum_{i=0}^{n-1}(\\omega_n^k)^i = [n\\mid k]\\times n i=0âˆ‘nâˆ’1â€‹(Ï‰nkâ€‹)i=[nâˆ£k]Ã—n å…¶ä¸­ [ å‘½é¢˜ a][\\text{å‘½é¢˜ a}][å‘½é¢˜ a] è¡¨ç¤ºå¦‚æœå‘½é¢˜ a æˆç«‹ï¼Œé‚£ä¹ˆè¯¥å€¼ä¸º111ï¼Œå¦åˆ™ä¸º000ã€‚ æ¿å­ 1234567891011struct Complex&#123; double x, y; Complex(double x = 0, double y = 0) &#123; this-&gt;x = x, this-&gt;y = y; &#125; friend Complex operator + (Complex a, Complex b) &#123; return Complex(a.x + b.x, a.y + b.y); &#125; friend Complex operator - (Complex a, Complex b) &#123; return Complex(a.x - b.x, a.y - b.y); &#125; friend Complex operator * (Complex a, Complex b) &#123; return Complex(a.x * b.x - a.y * b.y, a.x * b.y + a.y * b.x); &#125;&#125;; å¤šé¡¹å¼ä¹˜æ³•çš„åŸºæœ¬åŸç† é¦–å…ˆï¼Œæˆ‘ä»¬æ‰€è¯´çš„å¤šé¡¹å¼ä¹˜æ³•æ˜¾ç„¶æ˜¯ä¸¤ä¸ªç”¨ç³»æ•°è¡¨è¾¾çš„å¤šé¡¹å¼ä¹‹é—´çš„ç®—æ³•ã€‚ æˆ‘ä»¬å‘ç°æœ´ç´ ç®—æ³•çš„å¤æ‚åº¦æ˜¯O(n2)\\mathcal{O}(n^2)O(n2)ã€‚ ç„¶åæˆ‘ä»¬å‘ç°ç”¨ç³»æ•°è¡¨è¾¾å¥½åƒå¾ˆéš¾ä¼˜åŒ–ï¼Œä½†å¤šé¡¹å¼ä¹˜æ³•æœ‰ä¸€ä¸ªå¤©ç„¶çš„ä¼˜åŒ–æ–¹æ¡ˆï¼Œä¹Ÿå°±æ˜¯å¦‚æœå¤šé¡¹å¼æ˜¯ç”¨ç‚¹å€¼è¡¨ç¤ºçš„ï¼Œé‚£ä¹ˆä¹˜èµ·æ¥æ˜¯ O(n)\\mathcal{O}(n)O(n) çš„ã€‚ æ‰€ä»¥èƒ½ä¸èƒ½å…ˆæŠŠå®ƒä»¬è½¬åŒ–ä¸ºç‚¹å€¼è¡¨è¾¾ï¼Œç„¶åä¹˜èµ·æ¥ä¹‹åæŠŠå®ƒä»¬æ’å€¼å›å»å‘¢ï¼Ÿ å¾ˆé«˜å…´çš„æ˜¯æˆ‘ä»¬æœ‰ FFTã€‚ æ‰€ä»¥ï¼Œå¤šé¡¹å¼ä¹˜æ³•å°±æ˜¯è¿™æ ·å®Œæˆçš„ã€‚[8] DFT ä¸ FFT å¯¹äºå¤šé¡¹å¼ A(x)=âˆ‘i=0naixiA(x)=\\sum_{i=0}^na_ix^iA(x)=âˆ‘i=0nâ€‹aiâ€‹xiï¼Œæˆ‘ä»¬è®°a=(a0,a1,â‹¯ ,anâˆ’1)a=(a_0, a_1, \\cdots, a_{n-1})a=(a0â€‹,a1â€‹,â‹¯,anâˆ’1â€‹)ï¼Œy=(A(Ï‰n0),A(Ï‰n1),â‹¯ ,A(Ï‰nnâˆ’1))y=(A(\\omega_n^0), A(\\omega_n^1), \\cdots, A(\\omega_n^{n-1}))y=(A(Ï‰n0â€‹),A(Ï‰n1â€‹),â‹¯,A(Ï‰nnâˆ’1â€‹))ã€‚åˆ™ç§°yyy æ˜¯aaaçš„ ç¦»æ•£å‚…é‡Œå¶å˜æ¢ ï¼ˆDFTï¼‰ï¼Œè®°ä½œy=DFTâ¡n(a)y=\\operatorname{DFT}_n(a)y=DFTnâ€‹(a)ã€‚æ±‚ä¸€ä¸ªå¤šé¡¹å¼çš„DFTâ¡\\operatorname{DFT}DFTï¼Œæœ´ç´ ç®—æ³•çš„å¤æ‚åº¦ä¸ºO(n2)\\mathcal{O}(n^2)O(n2)ï¼Œè€Œå¦‚æœç”¨ä¸€ç§ç§°ä¸º å¿«é€Ÿå‚…é‡Œå¶å˜æ¢ï¼ˆFFTï¼‰çš„æ–¹æ³•ï¼Œåˆ©ç”¨ä¸Šé¢æ‰€ä»‹ç»çš„å‡ ä¸ªå•ä½æ ¹çš„æ€§è´¨ï¼Œå¯ä»¥å°†è¯¥è¿‡ç¨‹ä¼˜åŒ–åˆ°O(nlogâ¡n)\\mathcal{O}(n\\log n)O(nlogn)ã€‚ï¼ˆæ„Ÿè§‰ç»ˆäºè¿›å…¥æ­£é¢˜äº†ï¼‰ åˆ†æ²»ï¼ æŠ˜åŠå¼•ç†ä½¿å•ä½æœ‰äº†å…¶ä»–æ•°æ²¡æœ‰çš„ä¼˜åŠ¿â€”â€”å®ƒå¯ä»¥åˆ†æ²»ã€‚ ä¸ºäº†è®©åˆ†æ²»èƒ½é¡ºåˆ©è¿›è¡Œï¼Œä¸‹é¢æ‰€æ¶‰åŠåˆ°çš„å¤šé¡¹å¼çš„é•¿åº¦éƒ½å¯ä»¥è¡¨ç¤ºä¸º 2k(kâˆˆZ)2^k(k\\in \\mathbb{Z})2k(kâˆˆZ)ã€‚å¦‚æœå¤šé¡¹å¼é•¿åº¦ä¸è¶³2k2^k2kï¼Œæˆ‘ä»¬å°±ç”¨000 å°†å®ƒè¡¥é½ã€‚ æˆ‘ä»¬æŠŠéœ€è¦è®¡ç®—çš„å¤šé¡¹å¼ A(x)=âˆ‘i=0naixiA(x)=\\sum_{i=0}^na_ix^iA(x)=âˆ‘i=0nâ€‹aiâ€‹xi æŒ‰ç³»æ•°ç¼–å·çš„å¥‡å¶åˆ†æˆä¸¤éƒ¨åˆ†ï¼Œå³ A0(x)=âˆ‘i=0n/2a2ixiA_0(x)=\\sum_{i=0}^{n/2}a_{2i}x^iA0â€‹(x)=âˆ‘i=0n/2â€‹a2iâ€‹xi å’ŒA1(x)=âˆ‘i=0n/2a2i+1xiA_1(x)=\\sum_{i=0}^{n/2}a_{2i+1}x^iA1â€‹(x)=âˆ‘i=0n/2â€‹a2i+1â€‹xiã€‚æˆ‘ä»¬ä¸éš¾å‘ç°ï¼š A(x)=A0(x2)+xA1(x2)A(x) = A_0(x^2) + xA_1(x^2) A(x)=A0â€‹(x2)+xA1â€‹(x2) å¹³æ–¹å‡ºç°äº†ï¼ æˆ‘ä»¬ä»…éœ€è®¡ç®—x=Ï‰nk(k=0âˆ¼n2)x=\\omega_n^k(k=0\\sim \\frac{n}{2})x=Ï‰nkâ€‹(k=0âˆ¼2nâ€‹)ï¼Œç„¶åæˆ‘ä»¬å°±ä¼šå‘ç°ï¼š A(Ï‰nk)={A0((Ï‰nk)2)+Ï‰nkA1((Ï‰nk)2)k&lt;n2A0((Ï‰nkâˆ’n/2)2)âˆ’Ï‰nk/2A1((Ï‰nk/2)2)kâ‰¥n2A(\\omega_n^k) = \\begin{cases} A_0((\\omega_n^k)^2) + \\omega_n^kA_1((\\omega_n^k)^2) &amp;&amp; k&lt;\\frac{n}{2}\\\\ A_0((\\omega_n^{k-n/2})^2) - \\omega_n^{k/2}A_1((\\omega_n^{k/2})^2) &amp;&amp; k \\ge \\frac{n}{2} \\end{cases} A(Ï‰nkâ€‹)={A0â€‹((Ï‰nkâ€‹)2)+Ï‰nkâ€‹A1â€‹((Ï‰nkâ€‹)2)A0â€‹((Ï‰nkâˆ’n/2â€‹)2)âˆ’Ï‰nk/2â€‹A1â€‹((Ï‰nk/2â€‹)2)â€‹â€‹k&lt;2nâ€‹kâ‰¥2nâ€‹â€‹ åˆx2=(Ï‰nk)2=Ï‰n/2kx^2=(\\omega_n^k)^2=\\omega_{n/2}^kx2=(Ï‰nkâ€‹)2=Ï‰n/2kâ€‹ï¼Œæ‰€ä»¥é€’å½’ä¸‹å»æ˜¯æˆ‘ä»¬ä½¿ç”¨çš„å•ä½æ ¹å…¶å®æ˜¯Ï‰n/2\\omega_{n/2}Ï‰n/2â€‹ã€‚ å…·ä½“å¯ä»¥çœ‹ä»£ç ã€‚ ä»£ç å®ç° 123456789101112131415161718192021inline void FFT(Complex* a, int n)&#123; if(n == 1) return; Complex *a0 = new Complex[n &gt;&gt; 1]; Complex *a1 = new Complex[n &gt;&gt; 1]; for(int i = 0; i &lt; n; i += 2) // å¥‡å¶åˆ†ç±» &#123; a0[i &gt;&gt; 1] = a[i]; a1[i &gt;&gt; 1] = a[i ^ 1]; &#125; FFT(a0, n &gt;&gt; 1); FFT(a1, n &gt;&gt; 1); // åˆ†æ²» Complex w(1., 0.), w1(cos(pi2 / n), sin(pi2 / n)); // w1 æ˜¯ 1 æ¬¡å•ä½æ ¹ï¼Œw æ˜¯ k æ¬¡å•ä½æ ¹ for(int i = 0; (i &lt;&lt; 1) &lt; n; ++i) &#123; a[i] = a0[i] + a1[i] * w; a[i + (n &gt;&gt; 1)] = a0[i] - a1[i] * w; w = w * w1; &#125;&#125; IDFTï¼Ÿ è¿™æ ·å°±å®Œäº†å—ï¼Ÿä¸æ˜¯çš„ã€‚ ç°åœ¨æˆ‘ä»¬æ‰€çš„åˆ°çš„æ˜¯ç‚¹å€¼è¡¨ç¤ºï¼Œè€Œæˆ‘ä»¬æ‰€éœ€è¦çš„æ˜¯æŠŠç³»æ•°è¡¨è¾¾ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦æŠŠå®ƒæ’å€¼å›å»ã€‚ æˆ‘ä»¬æŠŠè¿™ä¸ªæ“ä½œå«åš ç¦»æ•£å‚…é‡Œå¶å˜æ¢çš„é€†å˜æ¢ï¼ˆIDFTï¼‰ã€‚ æ‹‰æ ¼æœ—æ—¥å…¬å¼ï¼ŸO(n2)\\mathcal{O}(n^2)O(n2) æˆ‘ä»¬å‡è®¾å¾—åˆ°y=DFTâ¡(a)y=\\operatorname{DFT}(a)y=DFT(a)ï¼Œæˆ‘ä»¬æ„é€ å‘é‡cccï¼š ck=âˆ‘i=0nâˆ’1yi(Ï‰nâˆ’k)i=âˆ‘i=0nâˆ’1âˆ‘j=0nâˆ’1Ï‰nâˆ’kiajÏ‰nij=âˆ‘i=0nâˆ’1âˆ‘j=0nâˆ’1Ï‰ni(jâˆ’k)aj=âˆ‘j=0nâˆ’1âˆ‘i=0nâˆ’1Ï‰ni(jâˆ’k)aj=âˆ‘j=0nâˆ’1ajâˆ‘i=0nâˆ’1(Ï‰n(jâˆ’k))i\\begin{aligned} c_k&amp;=\\sum_{i=0}^{n-1}y_i(\\omega_n^{-k})^i\\\\ &amp;=\\sum_{i=0}^{n-1}\\sum_{j=0}^{n-1}\\omega_n^{-ki}a_j\\omega_n^{ij}\\\\ &amp;=\\sum_{i=0}^{n-1}\\sum_{j=0}^{n-1}\\omega_n^{i(j-k)}a_j\\\\ &amp;=\\sum_{j=0}^{n-1}\\sum_{i=0}^{n-1}\\omega_n^{i(j-k)}a_j\\\\ &amp;=\\sum_{j=0}^{n-1}a_j\\sum_{i=0}^{n-1}(\\omega_n^{(j-k)})^i \\end{aligned} ckâ€‹â€‹=i=0âˆ‘nâˆ’1â€‹yiâ€‹(Ï‰nâˆ’kâ€‹)i=i=0âˆ‘nâˆ’1â€‹j=0âˆ‘nâˆ’1â€‹Ï‰nâˆ’kiâ€‹ajâ€‹Ï‰nijâ€‹=i=0âˆ‘nâˆ’1â€‹j=0âˆ‘nâˆ’1â€‹Ï‰ni(jâˆ’k)â€‹ajâ€‹=j=0âˆ‘nâˆ’1â€‹i=0âˆ‘nâˆ’1â€‹Ï‰ni(jâˆ’k)â€‹ajâ€‹=j=0âˆ‘nâˆ’1â€‹ajâ€‹i=0âˆ‘nâˆ’1â€‹(Ï‰n(jâˆ’k)â€‹)iâ€‹ ç„¶åæ ¹æ®æ±‚å’Œå¼•ç†æˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°ï¼š ck=âˆ‘j=0nâˆ’1ajâˆ‘i=0nâˆ’1(Ï‰n(jâˆ’k))i=âˆ‘j=0nâˆ’1[jâˆ’kâˆ£n]naj\\begin{aligned} c_k&amp;=\\sum_{j=0}^{n-1}a_j\\sum_{i=0}^{n-1}(\\omega_n^{(j-k)})^i\\\\ &amp;=\\sum_{j=0}^{n-1}[j-k\\mid n]na_j \\end{aligned} ckâ€‹â€‹=j=0âˆ‘nâˆ’1â€‹ajâ€‹i=0âˆ‘nâˆ’1â€‹(Ï‰n(jâˆ’k)â€‹)i=j=0âˆ‘nâˆ’1â€‹[jâˆ’kâˆ£n]najâ€‹â€‹ ç”±äº 0â‰¤j,k&lt;n0\\le j,k&lt;n0â‰¤j,k&lt;nï¼Œæ‰€ä»¥jâˆ’kâˆ£nj-k\\mid njâˆ’kâˆ£n å½“ä¸”ä»…å½“ jâˆ’k=0j-k=0jâˆ’k=0 å³j=kj=kj=kã€‚ æ•…æˆ‘ä»¬å¯ä»¥æŠŠç­‰å¼å†™æˆ ck=âˆ‘j=0nâˆ’1[j=k]naj=nakc_k=\\sum_{j=0}^{n-1}[j=k]na_j=na_k ckâ€‹=j=0âˆ‘nâˆ’1â€‹[j=k]najâ€‹=nakâ€‹ æ‰€ä»¥ï¼š ak=1ncka_k=\\frac{1}{n}c_k akâ€‹=n1â€‹ckâ€‹ æ‰€ä»¥æˆ‘ä»¬åªéœ€è®¡ç®— ckc_kckâ€‹ å³å¯ã€‚[9] æˆ‘ä»¬å‘ç°æˆ‘ä»¬å°±æ˜¯æŠŠæ™®é€šçš„ FFT å•ä½æ ¹ Ï‰n\\omega_nÏ‰nâ€‹ æ”¹æˆäº†Ï‰nâˆ’1\\omega_n^{-1}Ï‰nâˆ’1â€‹ã€‚ å›é¡¾ä¸Šé¢é‚£å¹…å›¾ï¼š æˆ‘ä»¬å‘ç°è®© Î¸\\thetaÎ¸ åˆ°è¿™è½¬ï¼Œä¹Ÿå°±æ˜¯æŠŠå›¾ä¸Šä¸‹ç¿»è½¬ä¸€ä¸‹å°±å¯ä»¥äº†ã€‚ å…¶ä¸­çš„å•ä½æ ¹Ï‰nâˆ’1=cosâ¡2Ï€nâˆ’isinâ¡2Ï€n\\omega_n^{-1}=\\cos\\frac{2\\pi}{n}-i\\sin\\frac{2\\pi}{n}Ï‰nâˆ’1â€‹=cosn2Ï€â€‹âˆ’isinn2Ï€â€‹ã€‚ å…·ä½“å¯ä»¥çœ‹ä»£ç å®ç°ã€‚ ä»£ç å®ç° 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566#include &lt;cmath&gt;#include &lt;cstdio&gt;#include &lt;cstring&gt;#include &lt;iostream&gt;using namespace std;const double pi = acos(-1.);const double pi2 = 2. * pi;struct Complex&#123; double x, y; Complex(double x = 0, double y = 0) &#123; this-&gt;x = x, this-&gt;y = y; &#125; friend Complex operator + (Complex a, Complex b) &#123; return Complex(a.x + b.x, a.y + b.y); &#125; friend Complex operator - (Complex a, Complex b) &#123; return Complex(a.x - b.x, a.y - b.y); &#125; friend Complex operator * (Complex a, Complex b) &#123; return Complex(a.x * b.x - a.y * b.y, a.x * b.y + a.y * b.x); &#125;&#125;;inline void FFT(Complex* a, int n, int tp) // åŠ äº†ä¸ª tpï¼Œè¡¨ç¤ºå•ä½æ ¹çš„å¹‚æ¬¡æ˜¯å¦ä¸ºæ­£&#123; if(n == 1) return; Complex *a0 = new Complex[n &gt;&gt; 1]; Complex *a1 = new Complex[n &gt;&gt; 1]; for(int i = 0; i &lt; n; i += 2) &#123; a0[i &gt;&gt; 1] = a[i]; a1[i &gt;&gt; 1] = a[i ^ 1]; &#125; FFT(a0, n &gt;&gt; 1, tp); FFT(a1, n &gt;&gt; 1, tp); Complex w(1., 0.), w1(cos(pi2 / n), tp * sin(pi2 / n)); // å¦‚æœå•ä½æ ¹çš„å¹‚æ¬¡ä¸ºè´Ÿé‚£ä¹ˆ sin çš„å€¼åº”å–è´Ÿ for(int i = 0; (i &lt;&lt; 1) &lt; n; ++i) &#123; a[i] = a0[i] + a1[i] * w; a[i + (n &gt;&gt; 1)] = a0[i] - a1[i] * w; w = w * w1; &#125;&#125;const int maxn = 1000005;Complex aa[maxn &lt;&lt; 2], bb[maxn &lt;&lt; 2];int main()&#123; int n, m, k; scanf(&quot;%d%d&quot;, &amp;n, &amp;m); for(k = 1; k &lt;= n + m; k &lt;&lt;= 1); for(int i = 0; i &lt;= n; ++i) scanf(&quot;%lf&quot;, &amp;aa[i].x); for(int i = 0; i &lt;= m; ++i) scanf(&quot;%lf&quot;, &amp;bb[i].x); FFT(aa, k, 1); FFT(bb, k, 1); for(int i = 0; i &lt; k; ++i) aa[i] = aa[i] * bb[i]; FFT(aa, k, -1); for(int i = 0; i &lt;= n + m; ++i) printf(&quot;%d &quot;, (int) (aa[i].x / k + .5)); return 0;&#125; å¡å¸¸å¤§æ³•å¥½ è´è¶æ“ä½œ æˆ‘ä»¬æ¥çœ‹è¿™æ®µä»£ç ï¼š 123456for(int i = 0; (i &lt;&lt; 1) &lt; n; ++i)&#123; a[i] = a0[i] + a1[i] * w; a[i + (n &gt;&gt; 1)] = a0[i] - a1[i] * w; w = w * w1;&#125; ç”±äºå¤æ‚åº¦ä¸»è¦é›†ä¸­åœ¨å¤æ•°è¿ç®—ä¸Šï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŠŠå®ƒä¼˜åŒ–ï¼š 1234567for(int i = 0; (i &lt;&lt; 1) &lt; n; ++i)&#123; t = a1[i] * w; a[i] = a0[i] + t; a[i + (n &gt;&gt; 1)] = a0[i] - t; w = w * w1;&#125; è™½ç„¶ä¹Ÿä¸çŸ¥é“è¿™æœ‰ä»€ä¹ˆç”¨ã€‚ æˆ‘ä»¬æŠŠä¸Šé¢è¿™æ®µä»£ç å«åš è´è¶æ“ä½œã€‚ ä»é€’å½’åˆ°è¿­ä»£ æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ FFT é€’å½’çš„å…¨è¿‡ç¨‹[10]ï¼š ç¬¬ä¸€æ¬¡é€’å½’æ—¶ï¼Œæˆ‘ä»¬æŠŠä¸‹æ ‡äºŒè¿›åˆ¶æœ€åä¸€ä½ä¸º 000 çš„æ”¾åœ¨å·¦è¾¹ï¼Œæœ€åä¸€ä½ä¸º 111 çš„æ”¾åœ¨å³è¾¹ã€‚æ¥ç€ï¼Œæˆ‘ä»¬æŠŠä¸‹æ ‡å€’æ•°ç¬¬äºŒä½ä¸º 000 çš„æ”¾åœ¨åæ ‡ï¼Œå€’æ•°ç¬¬äºŒä½ä¸º 111 çš„æ”¾åœ¨å³è¾¹â€¦â€¦ æˆ‘ä»¬æŠŠä¸‹æ ‡äºŒè¿›åˆ¶åˆ†è§£æ¥çœ‹çœ‹ï¼š ä¸çŸ¥é“å¤§å®¶æœ‰æ²¡æœ‰å‘ç°ä¸€ä¸ªç‰¹ç‚¹ï¼šè¿™æ£µæ ‘ä»ä¸‹å¾€ä¸Šå¥½åƒåšäº†ä¸€ä¸ªäºŒè¿›åˆ¶ä¸‹çš„åŸºæ•°æ’åºï¼šå…ˆæ¯”è¾ƒæœ€åä¸€ä½ï¼Œåœ¨æ¯”è¾ƒå€’æ•°ç¬¬äºŒä½â€¦â€¦ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæˆ‘ä»¬æŠŠè¿™äº›æ•°çš„äºŒè¿›åˆ¶ä¸²å€’è¿‡æ¥ï¼Œæ¯”å¦‚ 110 å°±å˜æˆäº† 011ï¼Œ001 å°±å˜æˆäº†100ï¼Œæˆ‘ä»¬å…¶å®æ˜¯å¯¹å®ƒè¿›è¡Œäº†ä¸€éæ’åºã€‚ äºæ˜¯æˆ‘ä»¬æŠŠä¸€ä¸ªæ•°çš„ä¸‹æ ‡å€’è¿‡æ¥å°±æ˜¯é€’å½’æ ‘åº•å±‚çš„ä½ç½®äº†ã€‚ O(nlogâ¡n)\\mathcal{O}(n\\log n)O(nlogn)æš´åŠ›ï¼Ÿ å½“ç„¶æˆ‘ä»¬è¿˜å¯ä»¥ O(n)\\mathcal{O}(n)O(n) è§£å†³ï¼Œæœ‰ä¸€ä¸ªå¾ˆæ˜¾ç„¶çš„ dpï¼šrev[i] = (rev[i &gt;&gt; 1] &gt;&gt; 1) | ((i &amp; 1) &lt;&lt; cs)ï¼Œrev[i]è¡¨ç¤º iii ç¿»è½¬åçš„æ•°å­—ï¼Œcsè¡¨ç¤ºè¿™ä¸ªäºŒè¿›åˆ¶æ•°å­—çš„é•¿åº¦ï¼ˆå«å‰å¯¼ 000ï¼‰ã€‚(i &amp; 1) &lt;&lt; cs è¡¨ç¤º i æœ€åä¸€ä½ç¿»è½¬åçš„æ•°å­—ï¼Œrev[i &gt;&gt; 1] &gt;&gt; 1æ˜¯ i å‡ºæœ€åä¸€ä½å¤–ç¿»è½¬å¾—åˆ°çš„æ•°å­—ã€‚æ¯”å¦‚ 0101101ï¼Œ(i &amp; 1) &lt;&lt; cs æ˜¯1000000ï¼Œè€Œ i &gt;&gt; 1 æ˜¯0010110ï¼Œç¿»è½¬ä¹‹åå¾—åˆ° 0110100ï¼Œå³ç§»1 ä¹‹åæ˜¯0011010ï¼Œåœ¨æˆ–ä¸Šå‰é¢çš„1000000ï¼Œå¾—åˆ°çš„æ˜¯1011010ã€‚ ä»£ç å®ç° 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071#include &lt;cmath&gt;#include &lt;cstdio&gt;#include &lt;iostream&gt;#include &lt;algorithm&gt;using namespace std;const int maxn = 1000005;const double pi2 = 2. * acos(-1.);struct Complex&#123; double x, y; Complex(double x = 0, double y = 0) &#123; this-&gt;x = x, this-&gt;y = y; &#125; friend Complex operator + (Complex a, Complex b) &#123; return Complex(a.x + b.x, a.y + b.y); &#125; friend Complex operator - (Complex a, Complex b) &#123; return Complex(a.x - b.x, a.y - b.y); &#125; friend Complex operator * (Complex a, Complex b) &#123; return Complex(a.x * b.x - a.y * b.y, a.x * b.y + a.y * b.x); &#125;&#125;;int rev[maxn &lt;&lt; 2];Complex aa[maxn &lt;&lt; 2], bb[maxn &lt;&lt; 2];inline void FFT(Complex* a, int n, int tp)&#123; for(int i = 0; i &lt; n; ++i) if(i &lt; rev[i]) swap(a[i], a[rev[i]]); for(int s = 2; s &lt;= n; s &lt;&lt;= 1) &#123; Complex w1(cos(pi2 / s), tp * sin(pi2 / s)), w, tmp; for(int i = 0; i &lt; n; i += s) &#123; w = Complex(1., 0.); for(int j = 0; (j &lt;&lt; 1) &lt; s; ++j, w = w * w1) &#123; tmp = w * a[i + j + (s &gt;&gt; 1)]; a[i + j + (s &gt;&gt; 1)] = a[i + j] - tmp; a[i + j] = a[i + j] + tmp; &#125; &#125; &#125;&#125;int main()&#123; int n, m; scanf(&quot;%d%d&quot;, &amp;n, &amp;m); for(int i = 0; i &lt;= n; ++i) scanf(&quot;%lf&quot;, &amp;aa[i].x); for(int i = 0; i &lt;= m; ++i) scanf(&quot;%lf&quot;, &amp;bb[i].x); int l = 1, cs = 0; while(l &lt;= n + m) &#123; l &lt;&lt;= 1; cs++; &#125; for(int i = 0; i &lt; l; ++i) rev[i] = (rev[i &gt;&gt; 1] &gt;&gt; 1) | ((i &amp; 1) &lt;&lt; (cs - 1)); FFT(aa, l, 1); FFT(bb, l, 1); for(int i = 0; i &lt; l; ++i) aa[i] = aa[i] * bb[i]; FFT(aa, l, -1); for(int i = 0; i &lt;= n + m; ++i) printf(&quot;%d &quot;, (int) (aa[i].x / l + .5)); return 0;&#125; ä»£ç é•¿åº¦å·®ä¸å¤šï¼ˆä¸Šé¢çš„æ˜¯è¿­ä»£å®ç°ï¼‰ï¼Œä½†é€Ÿåº¦å’Œå†…å­˜ä¸Šçš„å·®è·æ˜¯å¾ˆå¤§çš„ã€‚ FFT ä¼˜åŒ–é«˜ç²¾ä¹˜æ³• é«˜ç²¾ä¹˜æ³•å°±æ˜¯æŠŠä¸¤ä¸ªå¤§æ•°å½“æˆå¤šé¡¹å¼ä¹˜èµ·æ¥ï¼Œå…¶å®å°±æ˜¯æ™®é€š FFTï¼Œå°±ç›´æ¥ä¸Šä»£ç äº†ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687#include &lt;cmath&gt;#include &lt;cstdio&gt;#include &lt;cstring&gt;#include &lt;iostream&gt;#include &lt;algorithm&gt;using namespace std;typedef long long LL;const int maxn = 60005;const double pi2 = 2. * acos(-1);struct Complex&#123; double x, y; Complex(double x = 0, double y = 0) &#123; this-&gt;x = x, this-&gt;y = y; &#125; friend Complex operator + (Complex a, Complex b) &#123; return Complex(a.x + b.x, a.y + b.y); &#125; friend Complex operator - (Complex a, Complex b) &#123; return Complex(a.x - b.x, a.y - b.y); &#125; friend Complex operator * (Complex a, Complex b) &#123; return Complex(a.x * b.x - a.y * b.y, a.x * b.y + a.y * b.x); &#125;&#125;;int rev[maxn &lt;&lt; 2];inline void FFT(Complex* a, int n, int tp)&#123; for(int i = 0; i &lt; n; ++i) if(i &lt; rev[i]) swap(a[i], a[rev[i]]); for(int s = 2; s &lt;= n; s &lt;&lt;= 1) &#123; Complex w1(cos(pi2 / s), tp * sin(pi2 / s)), w, t; for(int i = 0; i &lt; n; i += s) &#123; w = Complex(1., 0.); for(int j = 0; (j &lt;&lt; 1) &lt; s; ++j, w = w1 * w) &#123; t = a[i + j + (s &gt;&gt; 1)] * w; a[i + j + (s &gt;&gt; 1)] = a[i + j] - t; a[i + j] = a[i + j] + t; &#125; &#125; &#125;&#125;Complex aa[maxn &lt;&lt; 2], bb[maxn &lt;&lt; 2];LL ans[maxn &lt;&lt; 2];char s[maxn];int main()&#123; int n; scanf(&quot;%d&quot;, &amp;n); scanf(&quot;%s&quot;, s); for(int i = 0; i &lt; n; ++i) aa[i].x = s[n - i - 1] ^ 48; scanf(&quot;%s&quot;, s); for(int i = 0; i &lt; n; ++i) bb[i].x = s[n - i - 1] ^ 48; int l = 1, cs = 0; while(l &lt; (n &lt;&lt; 1)) &#123; l &lt;&lt;= 1; cs++; &#125; for(int i = 0; i &lt; l; ++i) rev[i] = (rev[i &gt;&gt; 1] &gt;&gt; 1) | ((i &amp; 1) &lt;&lt; (cs - 1)); FFT(aa, l, 1); FFT(bb, l, 1); for(int i = 0; i &lt; l; ++i) aa[i] = aa[i] * bb[i]; FFT(aa, l, -1); for(int i = 0; i &lt; l; ++i) &#123; ans[i] += (LL) (aa[i].x / l + .5); ans[i + 1] += ans[i] / 10; ans[i] %= 10; &#125; while(!ans[l] &amp;&amp; l) --l; while(~l) printf(&quot;%lld&quot;, ans[l--]); return 0;&#125; ä¸€äº›ç®€å•çš„é¢˜ UVa 12298 Super Poker II æŒ‰ç…§å›½é™…æƒ¯ä¾‹ï¼Œuva çš„é¢˜æ˜¯ä¸€å®šè¦æ”¾ pdf çš„ï¼š é¢˜ç›®å¤§æ„ æœ‰ä¸€å‰¯æ‰‘å…‹ï¼Œå¯¹äºæ¯ä¸ªæ­£åˆæ•° pppï¼Œæ°å¥½æœ‰444 å¼ ä¸åŒèŠ±è‰²çš„ç‰Œã€‚å…¶ä¸­æœ‰ä¸€äº›ç‰Œä¸¢å¤±ï¼ˆé¢˜ç›®ä¼šæä¾›å·²ç»ä¸¢å¤±ç‰Œçš„åˆ—è¡¨ï¼Œå››ç§èŠ±è‰²åˆ†åˆ«ç”¨ S,H,C,D\\text{S,H,C,D}S,H,C,D è¡¨ç¤ºï¼‰ã€‚ä»å››ç§ä¸åŒèŠ±è‰²ç‰Œä¸­åˆ†åˆ«å–å‡ºä¸€å¼ ç‰Œï¼Œæ±‚è¿™å››å¼ ç‰Œæ„æˆç‚¹æ•°ä¸º nnn çš„æ–¹æ¡ˆæ•°ã€‚ å¤šç»„æ•°æ®ï¼Œæ¯ç»„æ•°æ®è¾“å…¥ a,b,ca, b, ca,b,cï¼Œccc ä¸ºä¸¢å¤±ç‰Œçš„æ•°é‡ï¼Œåˆ†åˆ«è¾“å‡º n=a,n=a+1,â‹¯ ,n=bn=a,n=a+1,\\cdots,n=bn=a,n=a+1,â‹¯,n=b æ—¶çš„ç­”æ¡ˆã€‚[8:1] é¢˜è§£ æˆ‘ä»¬ä»¤ f[i]f[i]f[i] è¡¨ç¤ºç”¨ç°æœ‰çš„ç‰Œç»„æˆ iii çš„æ–¹æ¡ˆæ•°ã€‚æ­£å¸¸çš„ dpdpdp åŠ å…¥æ¯ç§èŠ±è‰²çš„å¤æ‚åº¦éƒ½æ˜¯ O(n2)\\mathcal{O}(n^2)O(n2)ï¼Œä½†æ˜¯æˆ‘ä»¬å‘ç°å¯¹ä¸¤ç§èŠ±è‰²çš„åˆå¹¶ï¼Œå¦‚æœæˆ‘ä»¬æœ‰f1[i],f2[i]f_1[i],f_2[i]f1â€‹[i],f2â€‹[i] ä¸¤ç§èŠ±è‰²ï¼Œé‚£ä¹ˆå¾—åˆ°çš„ f[i]f[i]f[i] å…¶å®å°±æ˜¯ f1f_1f1â€‹ ä¸f2f_2f2â€‹çš„å·ç§¯ï¼Œå› ä¸ºæ ¹æ®ä¹˜æ³•åŸç†ä¸åŠ æ³•åŸç†ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°f[i]=âˆ‘j+k=if1[j]+f2[k]f[i] = \\sum_{j+k=i} f_1[j]+f_2[k]f[i]=âˆ‘j+k=iâ€‹f1â€‹[j]+f2â€‹[k]ã€‚ ç„¶åå¤§åŠ› FFTã€‚ å¯¹äº†è¿™é¢˜è¦å¼€long doubleã€‚ ä»£ç  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148#include &lt;cmath&gt;#include &lt;cctype&gt;#include &lt;cstdio&gt;#include &lt;cstring&gt;#include &lt;bitset&gt;#include &lt;iostream&gt;#include &lt;algorithm&gt;using namespace std;typedef long double LD;typedef long long LL;inline char gc()&#123; static const int L = 23333; static char sxd[L], *sss = sxd, *ttt = sxd; if(sss == ttt) &#123; ttt = (sss = sxd) + fread(sxd, 1, L, stdin); if(sss == ttt) return EOF; &#125; return *sss++;&#125;#define dd c = gc()inline char read(int&amp; x)&#123; x = 0; char dd; for(; !isdigit(c); dd) if(c == EOF) return EOF; for(; isdigit(c); dd) x = (x &lt;&lt; 1) + (x &lt;&lt; 3) + (c ^ 48); return c;&#125;#undef ddconst int maxn = 50005 &lt;&lt; 2;const LD pi2 = acos(-1.) * (LD) 2.;int pp[maxn &lt;&lt; 2];inline void pre()&#123; int n = 50000; for(int i = 2; i &lt;= n; ++i) &#123; if(!pp[i]) &#123; for(int j = i &lt;&lt; 1; j &lt;= n; j += i) pp[j] = 1; &#125; &#125;&#125;struct Complex&#123; LD x, y; Complex(LD a = 0., LD b = 0.) &#123; x = a, y = b; &#125; friend Complex operator + (Complex a, Complex b) &#123; return Complex(a.x + b.x, a.y + b.y); &#125; friend Complex operator - (Complex a, Complex b) &#123; return Complex(a.x - b.x, a.y - b.y); &#125; friend Complex operator * (Complex a, Complex b) &#123; return Complex(a.x * b.x - a.y * b.y, a.x * b.y + b.x * a.y); &#125;&#125;;int rev[maxn &lt;&lt; 2];inline void FFT(Complex* a, int n, int tp)&#123; for(int i = 0; i &lt; n; ++i) if(i &lt; rev[i]) swap(a[i], a[rev[i]]); for(int s = 2; s &lt;= n; s &lt;&lt;= 1) &#123; Complex w, w1 = Complex(cos(pi2 / s), tp * sin(pi2 / s)), tmp; for(int i = 0; i &lt; n; i += s) &#123; w = Complex(1., 0.); for(int l = 0; (l &lt;&lt; 1) &lt; s; ++l, w = w * w1) &#123; tmp = a[i + l + (s &gt;&gt; 1)] * w; a[i + l + (s &gt;&gt; 1)] = a[i + l] - tmp; a[i + l] = a[i + l] + tmp; &#125; &#125; &#125;&#125;Complex aa[maxn &lt;&lt; 2], bb[maxn &lt;&lt; 2], cc[maxn &lt;&lt; 2], dd[maxn &lt;&lt; 2];inline void solve(int n, int l, int r)&#123; int L = r + 1; int len = 1, cs = -1; while(len &lt;= (L &lt;&lt; 2)) // 4 ä¸ªå¤šé¡¹å¼ç›¸ä¹˜ï¼Œé•¿åº¦å½“ç„¶è¦ä¹˜ 4 äº† &#123; len &lt;&lt;= 1; cs++; &#125; memset(aa, 0, sizeof(aa)); memset(bb, 0, sizeof(bb)); memset(cc, 0, sizeof(cc)); memset(dd, 0, sizeof(dd)); for(int i = 0; i &lt; len; ++i) rev[i] = (rev[i &gt;&gt; 1] &gt;&gt; 1) | ((i &amp; 1) &lt;&lt; cs); for(int i = 1; i &lt; r; ++i) aa[i] = bb[i] = cc[i] = dd[i] = Complex((LD) pp[i], 0.); for(int i = 1, t; i &lt;= n; ++i) &#123; char c = read(t); switch(c) &#123; case &#x27;S&#x27;: aa[t].x = 0.; break; case &#x27;H&#x27;: bb[t].x = 0.; break; case &#x27;C&#x27;: cc[t].x = 0.; break; case &#x27;D&#x27;: dd[t].x = 0.; break; &#125; &#125; FFT(aa, len, 1), FFT(bb, len, 1), FFT(cc, len, 1), FFT(dd, len, 1); for(int i = 0; i &lt; len; ++i) aa[i] = aa[i] * bb[i] * cc[i] * dd[i]; FFT(aa, len, -1); for(int i = l; i &lt;= r; ++i) printf(&quot;%lld\\n&quot;, (LL) ((aa[i].x / len) + .5)); puts(&quot;&quot;);&#125;signed main()&#123; pre(); int x, y, z; while(read(x) != EOF &amp;&amp; read(y) != EOF &amp;&amp; read(z) != EOF &amp;&amp; (x || y || z)) solve(z, x, y); return 0;&#125; NTT æˆ‘ä»¬å‘ç° FFT çš„å¤æ‚åº¦å¾ˆä¼˜ç§€ï¼Œç„¶è€Œä¸èƒ½å–æ¨¡ã€‚ é‚£æˆ‘ä»¬æœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•è®©å®ƒèƒ½å–æ¨¡å‘¢ï¼Ÿ æˆ‘ä»¬è€ƒè™‘ä»å•ä½æ ¹ä¸‹æ‰‹ã€‚ æˆ‘ä»¬çœ‹å•ä½æ ¹çš„å®šä¹‰ï¼š Ï‰nn=1\\omega_n^n=1 Ï‰nnâ€‹=1 æœ‰æ²¡æœ‰å…³äºå–æ¨¡ç­‰äº 111 çš„å¼å­ï¼Ÿ ç›¸ä¿¡å¤§å®¶éƒ½æƒ³åˆ°äº†è´¹é©¬å°å®šç†ï¼š apâˆ’1â‰¡1(modp)a^{p-1}\\equiv 1\\pmod p apâˆ’1â‰¡1(modp) å½“ç„¶ ppp å¾—æ˜¯ç´ æ•°ã€‚ äºæ˜¯æˆ‘ä»¬å¯ä»¥è”ç«‹æ–¹ç¨‹ï¼š apâˆ’1â‰¡Ï‰nn(modp)a^{p-1}\\equiv\\omega^n_n\\pmod p apâˆ’1â‰¡Ï‰nnâ€‹(modp) ä¸¤è¾¹åŒå¼€ nnn æ¬¡æ ¹å·ï¼š apâˆ’1nâ‰¡Ï‰n(modp)a^{\\frac{p-1}{n}}\\equiv \\omega_n\\pmod p anpâˆ’1â€‹â‰¡Ï‰nâ€‹(modp) å¦‚æœ nâˆ£pâˆ’1n\\mid p-1nâˆ£pâˆ’1 çš„è¯ï¼Œé‚£è¿™å¼å­å°±æœ‰è¶£äº†ï¼šæˆ‘ä»¬å¯ä»¥æŠŠ Ï‰n\\omega_nÏ‰nâ€‹ æ¢æˆapâˆ’1na^{\\frac{p-1}{n}}anpâˆ’1â€‹ï¼Œå°±å¯ä»¥å®Œæˆå–æ¨¡æ“ä½œäº†ã€‚ æˆ‘ä»¬å‘ç°åœ¨åš FFT æ—¶ï¼Œnnnä¸€å®šæ˜¯ 222 çš„å¹‚æ¬¡ï¼Œæ‰€ä»¥ ppp åªè¦è¡¨ç¤ºæˆ 2kÃ—tâˆ’1(k,tâˆˆN)2^k\\times t-1(k,t\\in \\mathbb{N})2kÃ—tâˆ’1(k,tâˆˆN)ï¼Œä¸”2kâ‰¥n2^k\\ge n2kâ‰¥n å°±å¯ä»¥äº†ã€‚ ä¸»è¦ç”¨çš„æ˜¯998244353=119Ã—223+1998244353=119\\times2^{23}+1998244353=119Ã—223+1ã€‚[11] è¿™ æ‰æ˜¯çœŸçš„å®šä¹‰ã€‚ â†©ï¸ æ„Ÿè°¢ majun å¤§ä½¬ çš„å£èƒ¡è¯æ˜ã€‚ â†©ï¸ æˆ³ è¿™é‡Œ çœ‹çœŸçš„è¯æ˜ã€‚ â†©ï¸ ç¿»è¯‘æ¥è‡ª NaVi_Awson å¤§ä½¬çš„blogï¼Œç•¥æœ‰æ”¹åŠ¨ã€‚ â†©ï¸ å›¾ç‰‡æ¥è‡ªWikipediaã€‚ â†©ï¸ å…·ä½“å¯ä»¥å»çœ‹çœ‹luojinyao å¤§ä½¬çš„ blogã€‚ â†©ï¸ å›¾ç‰‡æ¥è‡ªã€Šç®—æ³•å¯¼è®ºã€‹ï¼Œæœ‰æ”¹åŠ¨ã€‚ â†©ï¸ ç¿»è¯‘æ‘˜è‡ªã€Šç®—æ³•ç«èµ›å…¥é—¨ç»å…¸ è®­ç»ƒæŒ‡å—ã€‹ï¼Œæœ‰æ”¹åŠ¨ã€‚ â†©ï¸ â†©ï¸ æ„Ÿè°¢ sxd666 å·¨ä½¬ çš„å£èƒ¡ã€‚ â†©ï¸ å›¾ç‰‡æ¥è‡ªã€Šç®—æ³•å¯¼è®ºã€‹ã€‚ â†©ï¸ å…¶å®ƒçš„æ•°å¯ä»¥å‚è€ƒ è¿™é‡Œã€‚ â†©ï¸","categories":[{"name":"å°å°ç»“","slug":"å°å°ç»“","permalink":"https://pufanyi.github.io/oi-blog/categories/%E5%B0%8F%E5%B0%8F%E7%BB%93/"}],"tags":[{"name":"æ•°å­¦","slug":"æ•°å­¦","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%95%B0%E5%AD%A6/"},{"name":"FFT","slug":"FFT","permalink":"https://pufanyi.github.io/oi-blog/tags/FFT/"}]},{"title":"åšé¢˜è®°å½•","slug":"åšé¢˜è®°å½•","date":"2019-01-11T16:00:00.000Z","updated":"2023-12-25T16:08:28.074Z","comments":true,"path":"åšé¢˜è®°å½•/","link":"","permalink":"https://pufanyi.github.io/oi-blog/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/","excerpt":"æœ¬æƒ³æ²¡åšä¸€é“é¢˜å†™ä¸€ç¯‡é¢˜è§£ã€‚åˆšç«‹ä¸‹è¿™ä¸ªflagæˆ‘å°±åæ‚”äº†ã€‚äºæ˜¯å°±å†™ä¸€å¥è¯é¢˜è§£å§ã€‚äº‹å®è¯æ˜æ——å­ä¸èƒ½éšä¾¿æ’å•Šã€‚","text":"æœ¬æƒ³æ²¡åšä¸€é“é¢˜å†™ä¸€ç¯‡é¢˜è§£ã€‚åˆšç«‹ä¸‹è¿™ä¸ª flag æˆ‘å°±åæ‚”äº†ã€‚äºæ˜¯å°±å†™ä¸€å¥è¯é¢˜è§£å§ã€‚äº‹å®è¯æ˜æ——å­ä¸èƒ½éšä¾¿æ’å•Šã€‚ å¦‚æœæœ‰é¢˜ç›®æˆ‘ä¸“é—¨å¼€ä¸€ç¯‡æ–‡ç« æˆ‘ä¼šåŠ ä¸Šé“¾æ¥ã€‚ ä»¥å‰åšè¿‡çš„è§‰å¾—æœ‰è¶£çš„é¢˜ç›®ä¹Ÿä¼šä¸€ç‚¹ç‚¹åœ°åŠ ä¸Šæ¥ã€‚ å¦‚æœæœ‰ CE çš„ï¼Œå¯ä»¥è¯•è¯•-std=c++11ã€‚ Codeforces ã€CF3Dã€‘å°†æ¯ä¸ªé—®å·å˜æˆå·¦æ‹¬å·å’Œæœ‰æ‹¬å·éƒ½æœ‰ä¸€ä¸ªä»£ä»·ï¼Œæ±‚æ˜¯æœ€ç»ˆä¸²åŒ¹é…çš„æœ€å°ä»£ä»·ã€‚ç”¨å †è´ªå¿ƒï¼Œæ‹¬å·åŒ¹é…é—®é¢˜ã€‚code ã€CF6Eã€‘å•è°ƒé˜Ÿåˆ—ã€‚code ã€CF7Dã€‘å­—ç¬¦ä¸²å“ˆå¸Œã€‚code ã€CF7Eã€‘dpï¼Œå¤§ç»†èŠ‚é¢˜ã€‚code ã€CF9Dã€‘dp é¢˜ï¼Œè¯¢é—® nnn ä¸ªç‚¹ç»„æˆäºŒå‰æ ‘ï¼Œé«˜åº¦å¤§äºç­‰äº hhh çš„æœ‰å¤šå°‘ä¸ªã€‚ä»¤ f[i][j]f[i][j]f[i][j] è¡¨ç¤º iii ä¸ªèŠ‚ç‚¹é«˜åº¦å°äºç­‰äº jjj çš„äºŒå‰æ ‘æœ‰å‡ ä¸ªã€‚code ã€CF10Dã€‘ç»å…¸çš„ dp é¢˜ã€‚code ã€CF13Cã€‘O(n2)\\mathcal{O}(n^2)O(n2)dp å¯è¿‡ï¼Œä½†æœ‰ O(nlogâ¡n)\\mathcal{O}(n\\log n)O(nlogn) çš„è´ªå¿ƒã€‚dp code greedy code ã€CF14Dã€‘æ ‘ä¸Šé—®é¢˜ï¼Œæ ‘å½¢ dp+ åˆ†ç±»è®¨è®ºã€‚code ã€CF22Eã€‘æ±‚è®©è¯¥å›¾å˜æˆå¼ºè”é€šå›¾è‡³å°‘å¢åŠ å¤šå°‘è¾¹å¹¶è¾“å‡ºè¾¹ã€‚å›¾æ„é€ ã€‚code ã€CF57Eã€‘æ‰“è¡¨æ‰¾è§„å¾‹å¥½é¢˜ã€‚code ã€CF77Cã€‘æ ‘å½¢ dp+ è´ªå¿ƒã€‚code ã€CF351Dã€‘æ ‘çŠ¶æ•°ç»„ï¼ŒHH çš„é¡¹é“¾çš„å‡çº§ç‰ˆã€‚code ã€CF434Dã€‘ç½‘ç»œæµï¼Œå»ºå›¾ã€‚code ã€CF449Cã€‘æ•°è®º + æ„é€ ã€‚code ã€CF505Eã€‘äºŒåˆ†ç­”æ¡ˆ + è´ªå¿ƒã€‚code ã€CF551Cã€‘äºŒåˆ†ç­”æ¡ˆ + è´ªå¿ƒã€‚code ã€CF675Eã€‘æ ‘çŠ¶æ•°ç»„ / çº¿æ®µæ ‘ä¼˜åŒ–åŸºäºè´ªå¿ƒçš„ dpã€‚code ã€CF875Eã€‘äºŒåˆ†ç­”æ¡ˆ + è´ªå¿ƒã€‚code ã€CF933Bã€‘æœ‰å…³å¤šé¡¹å¼çš„æ„é€ é¢˜ã€‚code ã€CF986Bã€‘è´ªå¿ƒ + æ•°å­¦ã€‚code ã€CF1037Dã€‘å¤§åŠ›æ¨¡æ‹Ÿ BFSã€‚ code ã€CF1045Bã€‘ä¸€é“æœ‰è¶£çš„æ•°å­¦ + å­—ç¬¦ä¸²é¢˜ã€‚code ã€CF1096Dã€‘æ‰“å®Œæ‰å‘ç°å¼€é”™é¢˜ç›®äº†â€¦â€¦dpï¼Œæ¯ä¸ªçŠ¶æ€æ˜¯ä¸€ä¸ªç±»ä¼¼çŸ©é˜µçš„äºŒç»´æ•°ç»„ã€‚å…ˆå®šä¹‰ 0,1,2,30, 1, 2, 30,1,2,3 å››ä¸ªçŠ¶æ€ï¼Œç„¶åæ¯ä¸ªäºŒç»´æ•°ç»„è®°å½•çš„æ˜¯åƒé‚»æ¥è¡¨ä¸€æ ·çš„ï¼šä» 111 çŠ¶æ€å‘ 222 çŠ¶æ€éœ€è¦èŠ±è´¹å¤šå°‘ï¼Œç„¶åå¤§åŠ›è½¬ç§»ã€‚å…¶å®å¯ä»¥åŠ å¼ºä¸€ä¸‹æ”¯æŒåŒºé—´æŸ¥è¯¢ï¼ˆå¥—ä¸€åªçº¿æ®µæ ‘å³å¯ï¼‰ï¼Œå•ç‚¹ä¿®æ”¹ã€‚code ã€CF1103Bã€‘äº¤äº’é¢˜ã€‚éœ€è¦å‘ç°ç»“è®ºï¼šå½“ x&lt;ax&lt;ax&lt;a æ—¶ï¼Œxâ‰¤2x(moda)â‡”xâ‰¤aâ‰¤2xx \\le 2x\\pmod a\\Leftrightarrow x\\le a\\le 2xxâ‰¤2x(moda)â‡”xâ‰¤aâ‰¤2xï¼Œç„¶åå…ˆå€å¢æšä¸¾ xxx å†å®šèŒƒå›´ï¼Œæœ€åäºŒåˆ†ã€‚è¿˜æœ‰ 111 éœ€è¦ç‰¹åˆ¤ã€‚è¯è¯´è¿™è¯¢é—®æ¬¡æ•°å¡å¾—å¥½ç´§å•Šâ€¦â€¦code UVa ã€UVa11292ã€‘è´ªå¿ƒã€‚code ã€UVa11729ã€‘è´ªå¿ƒã€‚code ã€Uva11300ã€‘è´ªå¿ƒï¼Œéœ€è¦ä¸€ç‚¹æ•°å­¦åˆ†æã€‚code ã€UVa1388ã€‘è´ªå¿ƒï¼Œæ„Ÿè§‰æ˜¯å‡é¢˜ï¼Œç»“è®ºéœ€è¦æš´æœéªŒè¯ã€‚code ã€UVa10881ã€‘æŒºæœ‰è¶£çš„é¢˜ï¼Œéœ€è¦å‘ç°ä¸€äº›ç»“è®ºã€‚code ã€UVa1030ã€‘ç•™å‘ï¼Œè¿˜æ²¡æ‰“ã€‚ ã€UVa11464ã€‘çŠ¶å‹ã€‚code ã€UVa1352ã€‘æš´æœã€‚ä¹¦ä¸Šè¯´è¦æ‰“è¡¨ï¼Œä½†ä¼¼ä¹æœ‰ç‚¹å¤šæ­¤ä¸€ä¸¾â€¦â€¦code ã€UVa11210ã€‘ç•™å‘å§ï¼Œçœ‹ä¸æ‡‚é¢˜æ„å•Šâ€¦â€¦ ã€UVa11384ã€‘äºŒè¿›åˆ¶åˆ†è§£ã€‚code ã€UVa10795ã€‘udebug ä¸Šæ ‡ç¨‹å¥½åƒæ˜¯å‡çš„â€¦â€¦è¢« è¿™ç»„æ•°æ® å¡äº†ã€‚ç†æ‰€å½“ç„¶é”™è¯¯çš„ç¨‹åºä¹Ÿè¿‡äº†ï¼Œäºæ˜¯æˆ‘çš„ä»£ç ä¹Ÿè¿‡äº†â€¦â€¦code(wrong)","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"CodeForces","slug":"CodeForces","permalink":"https://pufanyi.github.io/oi-blog/tags/CodeForces/"},{"name":"UVa","slug":"UVa","permalink":"https://pufanyi.github.io/oi-blog/tags/UVa/"}]},{"title":"CodeForces 449C Jzzhu and Apples","slug":"CF449C","date":"2019-01-04T16:00:00.000Z","updated":"2023-12-25T16:08:27.880Z","comments":true,"path":"CF449C/","link":"","permalink":"https://pufanyi.github.io/oi-blog/CF449C/","excerpt":"åŸé¢˜é“¾æ¥ ç»™å‡ºæ­£æ•´æ•°nnnï¼Œä½ è¦æŠŠ1âˆ¼n1\\sim n1âˆ¼nä¹‹é—´çš„æ­£æ•´æ•°ä¸¤ä¸¤åˆ†ç»„ï¼Œä½¿å¾—æ¯ä¸€ç»„ä¸¤ä¸ªæ•°çš„æœ€å¤§å…¬çº¦æ•°å¤§äº111ã€‚è¾“å‡ºèƒ½åˆ†æˆæœ€å¤šä¸ªç»„ï¼Œå¹¶æŒ‰ä»»æ„é¡ºåºè¾“å‡ºæ¯ç»„çš„ä¸¤ä¸ªæ•°ã€‚","text":"åŸé¢˜é“¾æ¥ ç»™å‡ºæ­£æ•´æ•° nnnï¼Œä½ è¦æŠŠ1âˆ¼n1\\sim n1âˆ¼n ä¹‹é—´çš„æ­£æ•´æ•°ä¸¤ä¸¤åˆ†ç»„ï¼Œä½¿å¾—æ¯ä¸€ç»„ä¸¤ä¸ªæ•°çš„æœ€å¤§å…¬çº¦æ•°å¤§äº111ã€‚è¾“å‡ºèƒ½åˆ†æˆæœ€å¤šä¸ªç»„ï¼Œå¹¶æŒ‰ä»»æ„é¡ºåºè¾“å‡ºæ¯ç»„çš„ä¸¤ä¸ªæ•°ã€‚ é¢˜è§£ å®˜æ–¹é¢˜è§£ è¯´å¾—å¾ˆç®€å•ã€‚å°±æ˜¯æšä¸¾ä»å¤§åˆ°å°è´¨å› æ•° xxxï¼ˆå¦‚æœ2xâ‰¥n2x\\ge n2xâ‰¥n æ˜¾ç„¶å°±ä¸ç”¨ç®¡äº†ï¼‰ï¼Œæ‰¾å‡ºæ‰€æœ‰ä¹‹å‰æ²¡æœ‰åŒ¹é…è¿‡å¾— xxx çš„å€æ•°ï¼Œå¦‚æœæ˜¯å¶æ•°ä¸ªå°±ä¸¤ä¸¤åŒ¹é…ï¼Œå¦åˆ™æŠŠ 2x2x2x é™¤å»å³å¯ã€‚ é‚£ä¸ºä»€ä¹ˆè¿™æ ·æ˜¯å¯¹çš„å‘¢ï¼Ÿ æˆ‘ä»¬æ¥çœ‹æœ€åæšä¸¾åˆ° x=2x=2x=2 çš„æƒ…å†µã€‚å¦‚æœæœ‰å¶æ•°ä¸ªï¼Œé‚£æ­£å¥½å¯ä»¥ä¸¤ä¸¤åŒ¹é…ï¼Œæ˜¾ç„¶æœ€ä¼˜ã€‚å¦‚æœæ˜¯å¥‡æ•°ä¸ªï¼Œé‚£æˆ‘ä»¬å‘ç°æ‰€æœ‰ å¯èƒ½è¢«åŒ¹é…çš„æ•° ï¼ˆå³æ‰€æœ‰æšä¸¾åˆ°çš„æ•°ï¼‰æœ‰å¥‡æ•°ä¸ªï¼Œå³æˆ‘ä»¬è‡³å°‘éœ€è¦æ‰”æ‰ä¸€ä¸ªã€‚ç°åœ¨æˆ‘ä»¬åªæ‰”æ‰äº†ä¸€ä¸ªï¼ˆå› ä¸ºä¹‹å‰é™¤å»çš„2x2x2x éƒ½åœ¨æ­¤æ—¶è¢«åŒ¹é…äº†ï¼‰ï¼Œæ‰€ä»¥è¿™ç§æƒ…å†µæ˜¯æœ€ä¼˜çš„ã€‚ ä»£ç  12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455#include &lt;cstdio&gt;#include &lt;algorithm&gt;using namespace std;const int maxn = 100005;int n, prime[maxn &gt;&gt; 1], p[maxn], cnt;inline void oula(int n)&#123; cnt = 0; for(int i = 2; i &lt;= n; ++i) &#123; if(!p[i]) prime[++cnt] = i; for(int j = 1; j &lt;= cnt &amp;&amp; prime[j] * i &lt;= n; ++j) &#123; p[prime[j] * i] = 1; if(!(i % prime[j])) break; &#125; &#125;&#125;int aa[maxn], cntt, hv[maxn];int ans[maxn][2], anss;int main()&#123; scanf(&quot;%d&quot;, &amp;n); oula(n &gt;&gt; 1); for(int i = cnt; i; --i) &#123; cntt = 0; for(int j = prime[i]; j &lt;= n; j += prime[i]) if(!hv[j]) aa[++cntt] = j; if(cntt &amp; 1) &#123; swap(aa[cntt], aa[2]); cntt--; &#125; for(int j = 1; j &lt;= cntt; j += 2) &#123; hv[aa[j]] = hv[aa[j + 1]] = 1; ans[++anss][0] = aa[j]; ans[anss][1] = aa[j + 1]; &#125; &#125; printf(&quot;%d\\n&quot;, anss); for(int i = 1; i &lt;= anss; ++i) printf(&quot;%d %d\\n&quot;, ans[i][0], ans[i][1]); return 0;&#125;","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"CodeForces","slug":"CodeForces","permalink":"https://pufanyi.github.io/oi-blog/tags/CodeForces/"},{"name":"æ•°è®º","slug":"æ•°è®º","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%95%B0%E8%AE%BA/"},{"name":"æ„é€ ","slug":"æ„é€ ","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%9E%84%E9%80%A0/"}]},{"title":"ZJOI2014 ç’€ç¿å…‰å","slug":"ç’€ç¿å…‰å","date":"2019-01-04T16:00:00.000Z","updated":"2023-12-25T16:08:28.082Z","comments":true,"path":"ç’€ç¿å…‰å/","link":"","permalink":"https://pufanyi.github.io/oi-blog/%E7%92%80%E7%81%BF%E5%85%89%E5%8D%8E/","excerpt":"é¢˜é¢ é‡‘å…ˆç”Ÿæœ‰ä¸€ä¸ªå¥³æœ‹å‹æ²¡åå­—ã€‚å¥¹å‹¤åŠ³å‹‡æ•¢ã€æ™ºæ…§å–„è‰¯ã€‚é‡‘å…ˆç”Ÿå¾ˆå–œæ¬¢å¥¹ã€‚ä¸ºæ­¤ï¼Œé‡‘å…ˆç”Ÿç”¨a3a^3a3å—1Ã—1Ã—11 \\times 1 \\times 11Ã—1Ã—1çš„ç‹¬ç‰¹çš„æ°´æ™¶åˆ¶ä½œäº†ä¸€ä¸ªè¾¹é•¿ä¸ºaaaçš„æ°´æ™¶ç«‹æ–¹ä½“ï¼Œä»–è¦å°†è¿™ä¸ªæ°´æ™¶ç«‹æ–¹ä½“é€ç»™ä»–è§è¿‡æœ€å•çº¯å–„è‰¯çš„å¥¹ã€‚ ç”±äºæ°´æ™¶ç«‹æ–¹ä½“å¤ªå¤ªï¼Œä¸å¥½è¿é€ï¼Œé‡‘å…ˆç”Ÿè¿˜æ˜¯å°†å®ƒæ‹†å¼€æ¥é€å‡ºã€‚ä»–ç›¸ä¿¡æ‹¼å¥½è¿™ä¸ªæ°´æ™¶ç«‹æ–¹éš¾ä¸å€’èªæ˜çš„å¥¹ã€‚ æ²¡åå­—æ”¶åˆ°äº†ç¤¼ç‰©åæœç„¶ä¸ä¸€ä¼šå„¿å°±æ ¹æ®è¯´æ˜å°†æ°´æ™¶ç«‹æ–¹ä½“æ‹¼å¥½äº†ã€‚æ²¡åå­—å‘ç°ï¼Œæœ‰nnnå—æ°´æ™¶åœ¨æ¼†é»‘å®‰é™çš„å¤œæ™šä¼šéšæœºä»¥ç­‰æ¦‚ç‡å‘ä¸Šä¸‹å·¦å³å‰åå…­ä¸ªæ–¹å‘çš„ä¸€ä¸ªå‘å‡ºå…‰ã€‚è¢«å…‰ç…§åˆ°çš„æ°´æ™¶æ˜¾å¾—æ ¼å¤–å¥½çœ‹ã€‚æ²¡åå­—ç»™æ¯ä¸€å—ä¸ä¼šå‘å…‰çš„æ°´æ™¶å®šä¹‰äº†ä¸€ä¸ªå¥½çœ‹ç¨‹åº¦ã€‚æ°´æ™¶ç«‹æ–¹ä½“åœ¨å¤œæ™šä¸­çš„å¥½çœ‹ç¨‹åº¦å°±æ˜¯æ¯å—è¢«å…‰ç…§åˆ°çš„æ°´æ™¶çš„å¥½çœ‹ç¨‹åº¦ä¹‹å’Œã€‚æ²¡åå­—æƒ³çŸ¥é“ï¼Œæ°´æ™¶ç«‹æ–¹ä½“åœ¨å¤œæ™šä¸­çš„å¥½çœ‹ç¨‹åº¦çš„æœ€å°å€¼å’Œæœ€å¤§å€¼ã€‚","text":"é¢˜é¢ é‡‘å…ˆç”Ÿæœ‰ä¸€ä¸ªå¥³æœ‹å‹æ²¡åå­—ã€‚å¥¹å‹¤åŠ³å‹‡æ•¢ã€æ™ºæ…§å–„è‰¯ã€‚é‡‘å…ˆç”Ÿå¾ˆå–œæ¬¢å¥¹ã€‚ä¸ºæ­¤ï¼Œé‡‘å…ˆç”Ÿç”¨ a3a^3a3 å—1Ã—1Ã—11 \\times 1 \\times 11Ã—1Ã—1çš„ç‹¬ç‰¹çš„æ°´æ™¶åˆ¶ä½œäº†ä¸€ä¸ªè¾¹é•¿ä¸º aaa çš„æ°´æ™¶ç«‹æ–¹ä½“ï¼Œä»–è¦å°†è¿™ä¸ªæ°´æ™¶ç«‹æ–¹ä½“é€ç»™ä»–è§è¿‡æœ€å•çº¯å–„è‰¯çš„å¥¹ã€‚ ç”±äºæ°´æ™¶ç«‹æ–¹ä½“å¤ªå¤ªï¼Œä¸å¥½è¿é€ï¼Œé‡‘å…ˆç”Ÿè¿˜æ˜¯å°†å®ƒæ‹†å¼€æ¥é€å‡ºã€‚ä»–ç›¸ä¿¡æ‹¼å¥½è¿™ä¸ªæ°´æ™¶ç«‹æ–¹éš¾ä¸å€’èªæ˜çš„å¥¹ã€‚ æ²¡åå­—æ”¶åˆ°äº†ç¤¼ç‰©åæœç„¶ä¸ä¸€ä¼šå„¿å°±æ ¹æ®è¯´æ˜å°†æ°´æ™¶ç«‹æ–¹ä½“æ‹¼å¥½äº†ã€‚æ²¡åå­—å‘ç°ï¼Œæœ‰ nnn å—æ°´æ™¶åœ¨æ¼†é»‘å®‰é™çš„å¤œæ™šä¼šéšæœºä»¥ç­‰æ¦‚ç‡å‘ä¸Šä¸‹å·¦å³å‰åå…­ä¸ªæ–¹å‘çš„ä¸€ä¸ªå‘å‡ºå…‰ã€‚è¢«å…‰ç…§åˆ°çš„æ°´æ™¶æ˜¾å¾—æ ¼å¤–å¥½çœ‹ã€‚æ²¡åå­—ç»™æ¯ä¸€å—ä¸ä¼šå‘å…‰çš„æ°´æ™¶å®šä¹‰äº†ä¸€ä¸ªå¥½çœ‹ç¨‹åº¦ã€‚æ°´æ™¶ç«‹æ–¹ä½“åœ¨å¤œæ™šä¸­çš„å¥½çœ‹ç¨‹åº¦å°±æ˜¯æ¯å—è¢«å…‰ç…§åˆ°çš„æ°´æ™¶çš„å¥½çœ‹ç¨‹åº¦ä¹‹å’Œã€‚æ²¡åå­—æƒ³çŸ¥é“ï¼Œæ°´æ™¶ç«‹æ–¹ä½“åœ¨å¤œæ™šä¸­çš„å¥½çœ‹ç¨‹åº¦çš„æœ€å°å€¼å’Œæœ€å¤§å€¼ã€‚ è¾“å…¥æ ¼å¼ ç¬¬ä¸€è¡Œæ˜¯ aaaï¼Œè¡¨ç¤ºæ°´æ™¶ç«‹æ–¹ä½“çš„è¾¹é•¿ã€‚ æ¥ä¸‹æ¥ a3a^3a3 è¡Œï¼Œæ¯è¡Œè‹¥å¹²æ•´æ•°ã€‚ ç¬¬ä¸€ä¸ªæ•° gig_igiâ€‹ è¡¨ç¤ºç¬¬ iii å—æ°´æ™¶çš„å¥½çœ‹ç¨‹åº¦ã€‚å¦‚æœ gi=0g_i=0giâ€‹=0ï¼Œä»£è¡¨è¿™å—æ°´æ™¶ä¼šå‘å…‰ã€‚æ¥ä¸‹æ¥ 3âˆ¼63\\sim 63âˆ¼6ä¸ªæ•´æ•°ï¼Œä»£è¡¨ä¸è¿™å—æ°´æ™¶æœ‰å…±åŒé¢çš„æ°´æ™¶ç¼–å·ã€‚ è¾“å‡ºæ ¼å¼ ä¸¤ä¸ªæ•´æ•°ï¼Œä»£è¡¨æ°´æ™¶ç«‹æ–¹ä½“åœ¨å¤œæ™šå¥½çœ‹ç¨‹åº¦çš„æœ€å°å€¼ä¸æœ€å¤§å€¼ã€‚ æ ·ä¾‹ æ ·ä¾‹è¾“å…¥ 12345678920 7 2 30 8 1 44 5 4 18 6 3 216 3 6 732 4 5 81 1 8 52 2 7 6 æ ·ä¾‹è¾“å‡º 10 12 æ•°æ®èŒƒå›´ä¸æç¤º å¯¹äºæ‰€æœ‰æ•°æ®ï¼Œ1&lt;aâ‰¤70,gi&lt;1000000,nâ‰¤81&lt;a\\le 70, g_i&lt;1000000, n\\le 81&lt;aâ‰¤70,giâ€‹&lt;1000000,nâ‰¤8ã€‚ é¢˜è§£ é¦–å…ˆï¼Œä»‹ç»ä¸€ä¸‹ c++ stl é‡Œçš„ç¥ç‰©â€”â€”stringstreamã€‚ è¿™ä¸œè¥¿èƒ½åƒ cin é‚£æ ·è¯»å…¥ï¼Œä½†æ˜¯æ˜¯ä»å­—ç¬¦ä¸²ä¸­è¯»å…¥ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±ä¸ç”¨æ‰“å¿«è¯»äº†ï¼ˆè™½ç„¶æ…¢äº†ä¸€ç‚¹ï¼Œä½†å¼€æ°§æ°”ä¹‹åæµ·æ˜Ÿï¼‰ã€‚ å¤´æ–‡ä»¶&lt;sstream&gt; å¤§æ¦‚å°±æ˜¯è¿™æ ·è¯»ï¼š 123456789for(int i = 1; i &lt;= n; ++i)&#123; getline(cin, tmp); stringstream ss(tmp); ss &gt;&gt; dep[i]; int aa; while(ss &gt;&gt; aa) add_edge(i, aa);&#125; é¢˜ç›®ä¸­çš„ç…§å°„ä¸ä»…åªç…§åˆ°äº†ä¸è¯¥æ°´æ™¶ç›¸é‚»çš„æ°´æ™¶ï¼Œå®ƒæŠŠæ•´æ¡å°„çº¿ä¸Šçš„æ°´æ™¶å…¨ç…§åˆ°äº†ã€‚ æ‰€ä»¥æˆ‘ä»¬åªèƒ½è€ƒè™‘å»ºå‡ºè¿™ä¸ªç«‹æ–¹ä½“åé‡æ–°å»ºå›¾ã€‚ æˆ‘çš„æ€è·¯æ˜¯è¿™æ ·çš„ï¼š å…ˆæ‰¾åˆ°ä¸€ä¸ªåº¦ä¸º 3 çš„ç‚¹ä½œä¸ºä¸€ä¸ªè§’çš„ç‚¹ï¼Œç”¨ bfs æ±‚å‡ºå…¶é“ä¸ªç‚¹çš„æœ€çŸ­è·¯ã€‚è®°ä»¥è¯¥ç‚¹ä¸ºåŸç‚¹çš„ç¬¬ iii ä¸ªç‚¹åæ ‡ä¸º(x1,i,y1,i,z1,i)(x_{1, i}, y_{1, i}, z_{1, i})(x1,iâ€‹,y1,iâ€‹,z1,iâ€‹)ï¼Œæœ€çŸ­è·¯ä¸ºdist[0][i]dist[0][i]dist[0][i]ï¼Œæ˜¾ç„¶æœ‰dist[0][i]=x1,iâˆ’1+y1,iâˆ’1+z1,iâˆ’1dist[0][i] = x_{1, i} - 1+ y_{1, i} - 1 + z_{1, i} - 1dist[0][i]=x1,iâ€‹âˆ’1+y1,iâ€‹âˆ’1+z1,iâ€‹âˆ’1ã€‚ æˆ‘ä»¬ä»»é€‰ä¸€ä¸ªå¹³é¢ï¼Œè¦æ±‚åŒ…å«åˆšæ‰é‚£ä¸ªç‚¹ã€‚æˆ‘ä»¬æ‰¾åˆ°åœ¨è¯¥å¹³é¢ä¸Šè¯¥ç‚¹å¯¹è§’çº¿ä¸Šçš„ç‚¹ï¼Œå…¶å®å°±æ˜¯éšä¾¿æ‰¾ä¸€ä¸ªåº¦ä¸º 3ï¼ˆåœ¨è§’ä¸Šï¼‰ä¸”ä¸åŸç‚¹è·ç¦»2(nâˆ’1)2(n-1)2(nâˆ’1)ï¼ˆåœ¨è¯¥å¹³é¢ä¸Šæœ€è¿œï¼‰çš„ç‚¹ã€‚ä»¥è¯¥ç‚¹ä¸ºåŸç‚¹è·‘ä¸€éæœ€çŸ­è·¯ï¼Œè®°dist[1][i]dist[1][i]dist[1][i]ã€‚ ç”±äºæˆ‘ä»¬è®¾è®¡æœ€çŸ­è·¯æ—¶ï¼Œå¯ä»¥å…ˆèµ°åˆ°è¯¥ç‚¹æ­£ä¸‹æ–¹ï¼Œå†å¾€ä¸Šçˆ¬ï¼ŒåŒæ ·ï¼Œæˆ‘ä»¬å¯ä»¥è®¾è®¡æˆå…ˆèµ°yyyï¼Œå†èµ°xxxï¼Œæœ€åèµ°zzzã€‚ æˆ‘ä»¬å‘ç° dist[0][i]+dist[1][i]=2(nâˆ’1)dist[0][i] +dist[1][i]=2(n-1)dist[0][i]+dist[1][i]=2(nâˆ’1)ï¼Œæˆ‘ä»¬æŠŠå®ƒå‡å»ï¼Œå°±åªå‰©ä¸‹2z2z2z äº†ï¼Œäºæ˜¯ zzz å°±æ±‚å‡ºæ¥äº†ï¼š 123456789101112131415161718192021/** ddn æ˜¯åº¦æ•° di æ˜¯åŸç‚¹ poi è®°å½•ç‚¹çš„ x, y, z è¿™é‡Œçš„ n å·²ç»æ˜¯ç‚¹çš„ä¸ªæ•°äº† tn æ‰æ˜¯è¾¹é•¿ ç”±äºä» 1 å¼€å§‹ï¼Œæ‰€ä»¥æœ‰äº›åœ°æ–¹å¾®è°ƒäº†ä¸€ä¸‹ */for(di[0] = 1; ddn[di[0]] &gt; 3; ++di[0]);bfs(0);for(int i = 1; i &lt;= n; ++i)&#123; if(ddn[i] == 3 &amp;&amp; dist[0][i] == ((tn-1)&lt;&lt;1)) &#123; di[1] = i; break; &#125;&#125;bfs(1);for(int i = 1; i &lt;= n; ++i) poi[i].z = (dist[0][i] + dist[1][i] - ((tn-2)&lt;&lt;1)) &gt;&gt; 1; æˆ‘ä»¬å¯ä»¥ç”¨åŒæ ·çš„æ–¹æ³•æŠŠ xxx è§£å‡ºæ¥ï¼Œæœ€åçš„ yyy åªè¦å‡ä¸€ä¸‹å°±å¯ä»¥äº†ã€‚å› ä¸ºæˆ‘çš„åæ ‡æ˜¯ä» 1 å¼€å§‹çš„ï¼Œæ‰€ä»¥æˆ‘å¯¹åæ ‡åšäº†ä¸€äº›å¾®è°ƒï¼Œä» 0 å¼€å§‹å°±æ²¡æœ‰è¿™ä¸ªé—®é¢˜ã€‚ ç”±äºä¹‹å‰ bfs çš„æ•°æ®æˆ‘ä»¬è¿˜èƒ½ç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€å†ä¸€é bfs å³å¯ 123456789101112for(int i = 1; i &lt;= n; ++i) if(poi[i].z == tn &amp;&amp; dist[0][i] == dist[1][i] &amp;&amp; ddn[i] == 3) di[2] = i;bfs(2);for(int i = 1; i &lt;= n; ++i)&#123; poi[i].x = (dist[0][i] + dist[2][i] - ((tn-1)&lt;&lt;1)) &gt;&gt; 1; poi[i].y = (dist[0][i] - poi[i].x - poi[i].z) + 1; poi[i].x++; poi[i].y++; mmap[poi[i].x][poi[i].y][poi[i].z] = i;&#125; äºæ˜¯æˆ‘ä»¬å°±å»ºå¥½å›¾äº†ã€‚ åé¢çš„å¤§åŠ› dfs ä¹Ÿæ²¡ä»€ä¹ˆå¥½è¯´çš„ã€‚ ä¸‹é¢æŠŠ ac ä»£ç è´´ä¸€ä¸‹ï¼Œç”±äº stringstream åœ¨æ²¡æœ‰æ°§æ°”çš„æƒ…å†µä¸‹ææ…¢ï¼Œæ‰€ä»¥å¿…é¡»å¼€æ°§æ°”ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168#include &lt;cstring&gt;#include &lt;iostream&gt;#include &lt;fstream&gt;#include &lt;sstream&gt;//stringstream #include &lt;queue&gt;using namespace std;const int maxm = 2058000;// è¿™é‡Œçš„æœ€å¤§è¾¹æ•°æˆ‘æ˜¯æŠŠç‚¹æ•°åŠ èµ·æ¥ä¹˜äº† 6 const int maxn = 75*75*75;const int inf = 0x3f3f3f3f;int n;// æ€»ä¸ªæ•° int tn;// è¾¹é•¿ struct Edge&#123; int to, nxt;&#125; e[maxm&lt;&lt;1];int first[maxn];int cnt;inline void add_edge(int f, int t)&#123; e[++cnt].nxt = first[f]; first[f] = cnt; e[cnt].to = t;&#125;int dirx[] = &#123;1, -1, 0, 0, 0, 0&#125;;int diry[] = &#123;0, 0, 1, -1, 0, 0&#125;;int dirz[] = &#123;0, 0, 0, 0, 1, -1&#125;;int dep[maxn];//&quot; å¥½çœ‹ç¨‹åº¦ &quot; int vis[maxn];int minn = inf;int maxx = -inf;int ll[10];// ä¼šå‘å…‰çš„æ°´æ™¶çš„ç¼–å· int ddn[maxn];// åº¦æ•° int zl;// è¿™æ˜¯ä¸ª ddn çš„ cnt int mmap[73][73][73]; struct zb&#123; int x, y, z;&#125; poi[maxn];#define pan (x &gt; 0 &amp;&amp; x &lt;= tn &amp;&amp; y &gt; 0 &amp;&amp; y &lt;= tn &amp;&amp; z &gt; 0 &amp;&amp; z &lt;= tn)#define nxxt x += dirx[i], y += diry[i], z += dirz[i]inline int getans(int i, zb a)// èƒ½åŠ å¤šå°‘ &quot; å¥½çœ‹ç¨‹åº¦ &quot;&#123; int ans = 0; int x = a.x, y = a.y, z = a.z; for(; pan; nxxt) if(!vis[mmap[x][y][z]]++)// ç”±äºå¾…ä¼šå„¿å›æº¯æ—¶è¦åˆ é™¤ï¼Œæ‰€ä»¥æ‡’åˆ°å®¶çš„æˆ‘å°±ç›´æ¥ç”¨ ++,-- ä»£æ›¿è®°å½•äº† ans += dep[mmap[x][y][z]]; return ans;&#125;inline void delvis(int i, zb a)// å›æº¯æ—¶æŠŠ dfs å‰åŠ çš„ vis åˆ é™¤ &#123; int x = a.x, y = a.y, z = a.z; for(; pan; nxxt) vis[mmap[x][y][z]]--;&#125;inline void dfs(int now, int ans)// å¤§åŠ›æšä¸¾æ‰€æœ‰æƒ…å†µ &#123; if(now &gt; zl) &#123; minn = min(minn, ans); maxx = max(maxx, ans); return; &#125; for(int i = 0; i &lt; 6; ++i) &#123; dfs(now+1, ans + getans(i, poi[ll[now]])); delvis(i, poi[ll[now]]); &#125;&#125;int dist[4][maxn];int di[4];bool viss[maxn];inline void bfs(int id)// æ±‚æœ€çŸ­è·¯ &#123; memset(viss, 0, sizeof(viss)); queue&lt;int&gt; q; int from = di[id]; viss[from] = true; q.push(from); while(!q.empty()) &#123; int now = q.front(); q.pop(); for(int i = first[now]; i; i = e[i].nxt) &#123; int to = e[i].to; if(!viss[to]) &#123; viss[to] = true; dist[id][to] = dist[id][now] + 1; q.push(to); &#125; &#125; &#125;&#125;int main() &#123; ios:: sync_with_stdio(false); cin &gt;&gt; n; tn = n; string tmp; getline(cin, tmp); n *= n * n; for(int i = 1; i &lt;= n; ++i) &#123; getline(cin, tmp); stringstream ss(tmp); ss &gt;&gt; dep[i]; int aa; if(!dep[i]) &#123; vis[i] = true; ll[++zl] = i; &#125; while(ss &gt;&gt; aa) &#123; add_edge(i, aa); ddn[i]++; &#125; &#125; for(di[0] = 1; ddn[di[0]] &gt; 3; ++di[0]); bfs(0); for(int i = 1; i &lt;= n; ++i) &#123; if(ddn[i] == 3 &amp;&amp; dist[0][i] == ((tn-1)&lt;&lt;1)) &#123; di[1] = i; break; &#125; &#125; bfs(1); for(int i = 1; i &lt;= n; ++i)// å¾—åˆ° z &#123; poi[i].z = (dist[0][i] + dist[1][i] - ((tn-2)&lt;&lt;1)) &gt;&gt; 1; if(poi[i].z == tn &amp;&amp; dist[0][i] == dist[1][i] &amp;&amp; ddn[i] == 3) di[2] = i; &#125; bfs(2); for(int i = 1; i &lt;= n; ++i)// å¾—åˆ° x, y &#123; poi[i].x = (dist[0][i] + dist[2][i] - ((tn-1)&lt;&lt;1)) &gt;&gt; 1; poi[i].y = (dist[0][i] - poi[i].x - poi[i].z) + 1; poi[i].x++; poi[i].y++; mmap[poi[i].x][poi[i].y][poi[i].z] = i; &#125; dfs(1, 0); cout &lt;&lt; minn &lt;&lt; &#x27; &#x27; &lt;&lt; maxx &lt;&lt; endl; fclose(stdin); fclose(stdout); return 0;&#125;","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"æ¨¡æ‹Ÿ","slug":"æ¨¡æ‹Ÿ","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%A8%A1%E6%8B%9F/"},{"name":"ZJOI","slug":"ZJOI","permalink":"https://pufanyi.github.io/oi-blog/tags/ZJOI/"},{"name":"æœç´¢","slug":"æœç´¢","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%90%9C%E7%B4%A2/"}]},{"title":"CodeForces 1045B Space Isaac","slug":"CF1045B","date":"2018-12-30T16:00:00.000Z","updated":"2023-12-25T16:08:27.871Z","comments":true,"path":"CF1045B/","link":"","permalink":"https://pufanyi.github.io/oi-blog/CF1045B/","excerpt":"åŸé¢˜é“¾æ¥ 0âˆ¼mâˆ’10\\sim m-10âˆ¼mâˆ’1çš„æ•°è¢«åˆ†æˆä¸¤ä¸ªé›†åˆï¼Œä½ å¯ä»¥åˆ†åˆ«ä»ä¸¤ä¸ªé›†åˆä¸­å–ä¸€ä¸ªæ•°ç›¸åŠ å¹¶å¯¹mmmå–æ¨¡ï¼Œæ±‚0âˆ¼mâˆ’10\\sim m-10âˆ¼mâˆ’1ä¸­ä¸èƒ½æ„é€ å‡ºçš„æ•°ã€‚","text":"åŸé¢˜é“¾æ¥ 0âˆ¼mâˆ’10\\sim m-10âˆ¼mâˆ’1çš„æ•°è¢«åˆ†æˆä¸¤ä¸ªé›†åˆï¼Œä½ å¯ä»¥åˆ†åˆ«ä»ä¸¤ä¸ªé›†åˆä¸­å–ä¸€ä¸ªæ•°ç›¸åŠ å¹¶å¯¹ mmm å–æ¨¡ï¼Œæ±‚ 0âˆ¼mâˆ’10\\sim m-10âˆ¼mâˆ’1 ä¸­ä¸èƒ½æ„é€ å‡ºçš„æ•°ã€‚ é¢˜è§£ æ„Ÿè§‰å¦‚æœ sxd666 æ¥åšè¿™é¢˜è‚¯å®šèƒ½ä¸€çœ¼ç§’ï¼Œç„¶è€Œä»–æ­£å¿™ç€åˆ‡å…¶ä»–é¢˜ã€‚ é¦–å…ˆæˆ‘ä»¬å‘ç°å¦‚æœè¦è®© a+bâ‰¡x(modm)â€‹a + b \\equiv x \\pmod mâ€‹a+bâ‰¡x(modm)â€‹ï¼Œå¦‚æœå·²çŸ¥a,xâ€‹a, xâ€‹a,xâ€‹ï¼Œé‚£bâ€‹bâ€‹bâ€‹ ä¸€å®šæ˜¯å”¯ä¸€çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå‡è®¾ç»™å®šé›†åˆæ˜¯ Aâ€‹Aâ€‹Aâ€‹ï¼Œä¸ä¹‹å¯¹åº”çš„é›†åˆä¸ºBâ€‹Bâ€‹Bâ€‹ï¼Œå¦‚æœæœ‰aâˆˆAâ€‹a\\in Aâ€‹aâˆˆAâ€‹ ä½†æ‰¾ä¸åˆ° bâˆˆAâ€‹b\\in Aâ€‹bâˆˆAâ€‹ ä½¿å¾— a+bâ‰¡x(modm)â€‹a + b \\equiv x\\pmod mâ€‹a+bâ‰¡x(modm)â€‹ã€‚é‚£ä¹ˆxâˆˆA+Bâ€‹x\\in A + Bâ€‹xâˆˆA+Bâ€‹ï¼ˆå®šä¹‰A+B={a+b:aâˆˆA,bâˆˆB}â€‹A + B = \\{a + b : a\\in A, b\\in B\\}â€‹A+B={a+b:aâˆˆA,bâˆˆB}â€‹ï¼‰ã€‚åè¿‡æ¥è®²ï¼Œå¦‚æœxâˆ‰A+Bâ€‹x\\notin A + Bâ€‹xâˆˆ/A+Bâ€‹ï¼Œé‚£ä¹ˆä¸€å®šèƒ½æŠŠAâ€‹Aâ€‹Aâ€‹ ä¸­æ‰€æœ‰å…ƒç´ é…å¯¹ï¼ˆå¯èƒ½ä¸¤ä¸ªæ•°ç›¸åŒï¼‰ï¼Œä¹Ÿå³xâˆ‰A+B âŸº A=xâˆ’Aâ€‹x\\notin A + B \\iff A = x - Aâ€‹xâˆˆ/A+BâŸºA=xâˆ’Aâ€‹ï¼ˆå®šä¹‰xâˆ’A={xâˆ’a:aâˆˆA}â€‹x - A= \\{x - a : a\\in A\\}â€‹xâˆ’A={xâˆ’a:aâˆˆA}â€‹ï¼‰ã€‚ ç„¶åæˆ‘ä»¬å¦‚æœæŠŠå°äº mmm çš„æ•´æ•°çœ‹æˆä¸€ä¸ªç¯ï¼Œå¦‚æœæœ‰ä¸¤ä¸ªæ•° a,ba, ba,b ä½¿a+bâ‰¡x(modm)a + b \\equiv x \\pmod ma+bâ‰¡x(modm)ï¼Œaaaé¡ºæ—¶é’ˆæ—¶é’ˆç§»åŠ¨ï¼Œbbbè‚¯å®šé€†æ—¶é’ˆç§»åŠ¨ï¼ˆå³è¿åŠ¨æ–¹å‘ç›¸åï¼Œä¸”ç§»åŠ¨çš„é•¿åº¦åº”è¯¥æ˜¯ç›¸ç­‰çš„ï¼ˆ(a+k) mod m+(bâˆ’k) mod mâ‰¡a+b(modm)(a + k)\\bmod m + (b - k)\\bmod m \\equiv a + b \\pmod m(a+k)modm+(bâˆ’k)modmâ‰¡a+b(modm)å˜›ï¼‰ã€‚ äºæ˜¯æˆ‘ä»¬ç”»ä¸¤ä¸ªåœ†ï¼Œéƒ½è¡¨ç¤ºé›†åˆ {ai}\\{a_i\\}{aiâ€‹}ï¼ˆå‡è®¾aia_iaiâ€‹ å·²ç»æ’å¥½åºï¼‰ï¼Œæˆ‘ä»¬è¦æŠŠç¬¬ä¸€ä¸ªåœ†çš„ç‚¹ä¸ç¬¬äºŒä¸ªåœ†çš„ç‚¹åŒ¹é…ã€‚ å‡è®¾ aia_iaiâ€‹ ä¸aja_jajâ€‹åŒ¹é…ã€‚æˆ‘ä»¬æŠŠ iii ç§»åŠ¨è‡³ i+1i+1i+1ï¼Œé‚£ä¹ˆæ ¹æ®ä¸Šé¢æ¨å‡ºçš„å•è°ƒæ€§ï¼Œjjj å¿…é¡»ç§»è‡³ jâˆ’1j-1jâˆ’1ï¼ˆå› ä¸ºaiâˆ¼ai+1a_i\\sim a_{i+1}aiâ€‹âˆ¼ai+1â€‹ ä¹‹é—´æ²¡æœ‰æ•°äº†ï¼Œæ‰€ä»¥ jjj ä¹Ÿåªèƒ½ç§»åŠ¨ä¸€æ ¼ï¼‰ï¼Œåˆå› ä¸ºç§»åŠ¨è·ç¦»å¿…é¡»ç›¸ç­‰ï¼Œå³ai+1âˆ’ai=ajâˆ’ajâˆ’1a_{i+1} - a_i = a_j - a_{j-1}ai+1â€‹âˆ’aiâ€‹=ajâ€‹âˆ’ajâˆ’1â€‹ã€‚ æ‰€ä»¥æˆ‘ä»¬ä»¤ bi=aiâˆ’aiâˆ’1b_i = a_{i} - a_{i-1}biâ€‹=aiâ€‹âˆ’aiâˆ’1â€‹ï¼ˆb1=(a1âˆ’an) mod mb_1 = (a_1 - a_n)\\bmod mb1â€‹=(a1â€‹âˆ’anâ€‹)modmï¼‰ï¼Œè®¾ä¸²s1=bnbnâˆ’1bnâˆ’2â‹¯b1,s2=b1b2b3â‹¯bns_1 = b_nb_{n-1}b_{n-2}\\cdots b_1, s_2 = b_1b_2b_3\\cdots b_ns1â€‹=bnâ€‹bnâˆ’1â€‹bnâˆ’2â€‹â‹¯b1â€‹,s2â€‹=b1â€‹b2â€‹b3â€‹â‹¯bnâ€‹ï¼Œæˆ‘ä»¬è¦æ‰¾çš„æ˜¯s1s_1s1â€‹ ä¸s2s_2s2â€‹æˆç¯åç›¸ç­‰ï¼Œå¹¶æ‰¾åˆ°ä¸€å¯¹åŒ¹é…çš„æ•°ï¼Œä»–ä»¬åŠ èµ·æ¥æ¨¡ mmm å³ä¸ºä¸€ç»„è§£ã€‚æˆ‘ä»¬ä»¤ s3=s2+s2s_3 = s_2 + s_2s3â€‹=s2â€‹+s2â€‹ï¼Œæ‰¾åˆ°s3s_3s3â€‹ ä¸­æ‰€æœ‰ç­‰äº s1s_1s1â€‹ çš„å­ä¸²ï¼Œå°±å¾—åˆ°äº†æ‰€æœ‰è§£ï¼Œè¿™ä¸ªé—®é¢˜ç”¨ KMP æˆ–æ˜¯ Z éƒ½èƒ½è§£å†³ã€‚ ä»£ç  12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667#include &lt;cstdio&gt;#include &lt;set&gt;#include &lt;vector&gt;#include &lt;iostream&gt;#include &lt;algorithm&gt;using namespace std;typedef long long LL;const int maxn = 200005;LL aa[maxn]; // è¯»å…¥çš„ aLL bb[maxn]; // å³ä¸Šé¢è¯´çš„ bvector&lt;LL&gt; gou;int in[maxn &lt;&lt; 2];LL Z[maxn &lt;&lt; 2];set&lt;LL&gt; ans;int main()&#123; int n; LL m; scanf(&quot;%d%lld&quot;, &amp;n, &amp;m); for(int i = 1; i &lt;= n; ++i) scanf(&quot;%lld&quot;, &amp;aa[i]); bb[1] = ((aa[1] - aa[n]) + m) % m; for(int i = 2; i &lt;= n; ++i) bb[i] = ((aa[i] - aa[i-1]) % m + m) % m; for(int i = n; i; --i) // è¿™é‡Œç”¨çš„æ˜¯ Z ç®—æ³•ï¼Œæ‰€ä»¥åˆå¹¶æˆäº†ä¸€ä¸ªä¸² &#123; gou.push_back(bb[i]); in[gou.size() - 1] = i; &#125; gou.push_back(-1LL); for(int i = 1; i &lt;= n; ++i) &#123; gou.push_back(bb[i]); in[gou.size() - 1] = i; &#125; for(int i = 1; i &lt;= n; ++i) &#123; gou.push_back(bb[i]); in[gou.size() - 1] = i; &#125; Z[0] = gou.size(); for(int i = 1, j = 1, k; i &lt; (int) gou.size(); i = k) // Z ç®—æ³• &#123; j = max(j, i); while(gou[j] == gou[j - i]) ++j; Z[i] = j - i; k = i + 1; while(k + Z[k - i] &lt; j) &#123; Z[k] = Z[k - i]; ++k; &#125; &#125; for(int i = 1; i &lt; (int) gou.size(); ++i) if(Z[i] &gt;= n) // å¤§åŠ›è®°å½•ç­”æ¡ˆ ans.insert((aa[in[i] - 1 ? in[i] - 1 : n] + aa[n]) % m); printf(&quot;%d\\n&quot;, (int) ans.size()); for(auto it = ans.begin(); it != ans.end(); ++it) printf(&quot;%lld &quot;, *it); return 0;&#125;","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"æ•°å­¦","slug":"æ•°å­¦","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%95%B0%E5%AD%A6/"},{"name":"CodeForces","slug":"CodeForces","permalink":"https://pufanyi.github.io/oi-blog/tags/CodeForces/"},{"name":"å­—ç¬¦ä¸²","slug":"å­—ç¬¦ä¸²","permalink":"https://pufanyi.github.io/oi-blog/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2/"},{"name":"æ•°è®º","slug":"æ•°è®º","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%95%B0%E8%AE%BA/"}]},{"title":"CodeForces 351D Jeff and Removing Periods","slug":"CF351D","date":"2018-12-30T16:00:00.000Z","updated":"2023-12-25T16:08:27.874Z","comments":true,"path":"CF351D/","link":"","permalink":"https://pufanyi.github.io/oi-blog/CF351D/","excerpt":"åŸé¢˜é“¾æ¥ æœ‰ä¸€ä¸ªé•¿åº¦ä¸ºn(nâ‰¤105)n(n\\le 10^5)n(nâ‰¤105)çš„åºåˆ—{a}(aiâ‰¤105)\\{a\\}(a_i\\le 10^5){a}(aiâ€‹â‰¤105)ï¼Œä½ å¯ä»¥å¯¹å®ƒè¿›è¡Œæ“ä½œï¼Œæ“ä½œå¦‚ä¸‹ï¼šé¦–å…ˆé€‰æ‹©ä¸‰ä¸ªæ•°v,t,kv, t, kv,t,kï¼Œæ»¡è¶³av=av+t=av+2t=â‹¯=av+kta_v = a_{v+t} = a_{v + 2t} = \\cdots = a_{v + kt}avâ€‹=av+tâ€‹=av+2tâ€‹=â‹¯=av+ktâ€‹ï¼Œç„¶åå°†å…¶åˆ é™¤ï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„åºåˆ—ã€‚æ¯æ¬¡æ“ä½œç»“æŸåä½ éƒ½èƒ½å°†æ–°æ•°åˆ—é‡æ’ã€‚ ç°æœ‰Q(Qâ‰¤105)Q(Q\\le 10^5)Q(Qâ‰¤105)ä¸ªè¯¢é—®ï¼Œæ¯æ¬¡è¯¢é—®[l,r][l, r][l,r]è¡¨ç¤ºé—®è¦æŠŠ[l,r][l, r][l,r]åˆ é™¤æ‰€éœ€çš„æœ€å°æ­¥æ•°ã€‚","text":"åŸé¢˜é“¾æ¥ æœ‰ä¸€ä¸ªé•¿åº¦ä¸º n(nâ‰¤105)n(n\\le 10^5)n(nâ‰¤105) çš„åºåˆ—{a}(aiâ‰¤105)\\{a\\}(a_i\\le 10^5){a}(aiâ€‹â‰¤105)ï¼Œä½ å¯ä»¥å¯¹å®ƒè¿›è¡Œæ“ä½œï¼Œæ“ä½œå¦‚ä¸‹ï¼šé¦–å…ˆé€‰æ‹©ä¸‰ä¸ªæ•°v,t,kv, t, kv,t,kï¼Œæ»¡è¶³av=av+t=av+2t=â‹¯=av+kta_v = a_{v+t} = a_{v + 2t} = \\cdots = a_{v + kt}avâ€‹=av+tâ€‹=av+2tâ€‹=â‹¯=av+ktâ€‹ï¼Œç„¶åå°†å…¶åˆ é™¤ï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„åºåˆ—ã€‚æ¯æ¬¡æ“ä½œç»“æŸåä½ éƒ½èƒ½å°†æ–°æ•°åˆ—é‡æ’ã€‚ ç°æœ‰ Q(Qâ‰¤105)Q(Q\\le 10^5)Q(Qâ‰¤105) ä¸ªè¯¢é—®ï¼Œæ¯æ¬¡è¯¢é—® [l,r][l, r][l,r] è¡¨ç¤ºé—®è¦æŠŠ [l,r][l, r][l,r] åˆ é™¤æ‰€éœ€çš„æœ€å°æ­¥æ•°ã€‚ ï¼ˆä»¥ä¸Šç¿»è¯‘æ”¹å†™è‡ª æ´›è°·ï¼‰ é¢˜è§£ æ„Ÿè§‰åƒæ˜¯ HH çš„é¡¹é“¾ çš„å‡çº§ç‰ˆã€‚ ä¸éš¾å‘ç°ç­”æ¡ˆå°±æ˜¯ [l,r][l, r][l,r] ä¸åŒæ•°çš„ä¸ªæ•° +++ ç¬¬ä¸€æ¬¡åœ¨ [l,r][l,r][l,r] ä¸­æ˜¯å¦æœ‰ä¸€ç§æ•°è¢«åˆ æ‰ã€‚ è®°ä¸¤ä¸ªæ•°ç»„ fa[i]fa[i]fa[i] ä¸ffa[i]ffa[i]ffa[i]ï¼Œfa[i]fa[i]fa[i]è¡¨ç¤ºä¸Šä¸€æ¬¡ç¬¬ iii ä¸ªæ•°å‡ºç°åœ¨äº†é‚£é‡Œï¼Œffa[i]ffa[i]ffa[i]è¡¨ç¤ºå¦‚æœè¯¢é—®çš„ lâ‰¤ffa[i]l\\le ffa[i]lâ‰¤ffa[i]ï¼Œé‚£ä¹ˆåœ¨[l,r][l, r][l,r] åŒºé—´å†…ä¸ç¬¬ iii ä¸ªæ•°ç›¸åŒçš„ä¸å¯èƒ½è¢«ä¸€æ¬¡æ€§åˆ é™¤ã€‚ å¤§è‡´å°±æ˜¯è¿™æ ·ä¸€å¹…å›¾ï¼š é»‘è‰²è¡¨ç¤º fa[i]fa[i]fa[i]ï¼Œçº¢è‰²è¡¨ç¤ºffa[i]ffa[i]ffa[i]ï¼ˆå¦‚æœfa[i]fa[i]fa[i] æˆ–ffa[i]ffa[i]ffa[i]è¿åˆ°äº† 000 å°±æ²¡ç”»ï¼‰ã€‚ ä¸éš¾å¾—å‡ºå¦‚æœiâˆ’fa[i]=fa[i]âˆ’fa[fa[i]]i - fa[i] = fa[i] - fa[fa[i]]iâˆ’fa[i]=fa[i]âˆ’fa[fa[i]]ï¼Œé‚£ä¹ˆffa[i]=ffa[fa[i]]ffa[i] = ffa[fa[i]]ffa[i]=ffa[fa[i]]ï¼Œå¦åˆ™ffa[i]=fa[fa[i]]ffa[i] = fa[fa[i]]ffa[i]=fa[fa[i]]ã€‚ 1234567for(int i = 1, aa; i &lt;= n; ++i)&#123; scanf(&quot;%d&quot;, &amp;aa); fa[i] = lst[aa]; lst[aa] = i; ffa[i] = (fa[i] - fa[fa[i]] == i - fa[i]) ? ffa[fa[i]] : fa[fa[i]];&#125; æˆ‘ä»¬è€ƒè™‘ç¦»çº¿ï¼Œè®©è¯¢é—®æŒ‰ rrr ä¸ºå…³é”®å­—æ’åºã€‚ è€ƒè™‘æŸ¥è¯¢ [l,r][l, r][l,r]ï¼Œå¦‚æœæ˜¯è¿™æ ·ä¸€æ®µåºåˆ—ï¼š1,2,2,2,31, 2, 2, 2, 31,2,2,2,3ï¼Œæˆ‘ä»¬å‘ç°222 å‡ºç°äº† 333 æ¬¡ï¼Œæˆ‘ä»¬é’¦å®šæœ€åä¸€ä¸ª 222 å¯¹ç­”æ¡ˆæœ‰è´¡çŒ®ã€‚è¿™æ ·æˆ‘ä»¬å¯¹æ‰€æœ‰ç›¸åŒçš„æ•°ï¼Œéƒ½é’¦å®šæœ€åä¸€ä¸ªå¯¹ç­”æ¡ˆæœ‰è´¡çŒ®ï¼Œå…¶ä½™å¯¹ç­”æ¡ˆå³å¯ã€‚è¿™æ ·æ²¡åŠ å…¥ä¸€ä¸ªæ•°ï¼Œå°±åœ¨çº¿æ®µæ ‘ / æ ‘çŠ¶æ•°ç»„å¯¹ iii ä½ç½®åŠ  111ï¼Œåœ¨fa[i]fa[i]fa[i] ä½ç½®å‡ 111 å³å¯ï¼ˆæŠŠå‰ä¸€ä¸ªæ•°çš„è´¡çŒ®åˆ å»ï¼‰ã€‚ å¯¹äºè¯¢é—®ç¬¬ä¸€æ¬¡èƒ½å¦å®Œå…¨åˆ é™¤ä¸€ä¸ªæ•°ï¼Œæˆ‘ä»¬åªéœ€æŸ¥è¯¢æœ‰å¤šå°‘ä¸ªæ•°åœ¨ [l,r][l, r][l,r] ä¸Šä¸æ˜¯å‡åŒ€åˆ†å¸ƒå³å¯ã€‚åŒç†ï¼Œæˆ‘ä»¬é’¦å®šæœ€åä¸€ä¸ªå¯¹ç­”æ¡ˆæœ‰è´¡çŒ®ï¼Œæ²¡åŠ å…¥ä¸€ä¸ª iii æ—¶ï¼Œåœ¨ ffa[fa[i]]ffa[fa[i]]ffa[fa[i]] ä¸Šâˆ’1-1âˆ’1ï¼Œåœ¨ ffa[i]ffa[i]ffa[i] ä¸Š+1+1+1å³å¯ã€‚ ä»£ç  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293#include &lt;cstdio&gt;#include &lt;iostream&gt;#include &lt;algorithm&gt;using namespace std;const int maxn = 100005;int n;struct Tree&#123; int no[maxn &lt;&lt; 2]; int K; inline void build_tree() &#123; for(K = 1; K &lt;= n; K &lt;&lt;= 1); &#125; inline void add(int k, int x) &#123; if(!k) return; for(k += K; k; k &gt;&gt;= 1) no[k] += x; &#125; inline int query(int l, int r) &#123; int ans = 0; for(l += K - 1, r += K + 1; l ^ r ^ 1; l &gt;&gt;= 1, r &gt;&gt;= 1) &#123; if(~l &amp; 1) ans += no[l ^ 1]; if(r &amp; 1) ans += no[r ^ 1]; &#125; return ans; &#125;&#125; tr1, tr2;int fa[maxn], ffa[maxn], lst[maxn];struct ask&#123; int l, r, id; friend bool operator &lt; (ask a, ask b) &#123; return a.r &lt; b.r; &#125;&#125; q[maxn];int ans[maxn];int main()&#123; scanf(&quot;%d&quot;, &amp;n); tr1.build_tree(), tr2.build_tree(); for(int i = 1, aa; i &lt;= n; ++i) &#123; scanf(&quot;%d&quot;, &amp;aa); fa[i] = lst[aa]; lst[aa] = i; ffa[i] = (fa[i] - fa[fa[i]] == i - fa[i]) ? ffa[fa[i]] : fa[fa[i]]; &#125; int Q; scanf(&quot;%d&quot;, &amp;Q); for(int i = 1; i &lt;= Q; ++i) &#123; scanf(&quot;%d%d&quot;, &amp;q[i].l, &amp;q[i].r); q[i].id = i; &#125; sort(q + 1, q + Q + 1); for(int i = 1, now = 0; i &lt;= Q; ++i) &#123; register int l = q[i].l, r = q[i].r; while(now &lt; r) &#123; now++; tr1.add(fa[now], -1); tr1.add(now, 1); tr2.add(ffa[fa[now]], -1); tr2.add(ffa[now], 1); &#125; int tt1 = tr1.query(l, r), tt2 = tr2.query(l, r); ans[q[i].id] = tt1 + (tt1 == tt2); &#125; for(int i = 1; i &lt;= Q; ++i) printf(&quot;%d\\n&quot;, ans[i]); return 0;&#125;","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"CodeForces","slug":"CodeForces","permalink":"https://pufanyi.github.io/oi-blog/tags/CodeForces/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"},{"name":"æ ‘çŠ¶æ•°ç»„/çº¿æ®µæ ‘","slug":"æ ‘çŠ¶æ•°ç»„-çº¿æ®µæ ‘","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84-%E7%BA%BF%E6%AE%B5%E6%A0%91/"}]},{"title":"CodeForces 986B Petr and Permutations","slug":"CF986B","date":"2018-12-30T16:00:00.000Z","updated":"2023-12-25T16:08:27.883Z","comments":true,"path":"CF986B/","link":"","permalink":"https://pufanyi.github.io/oi-blog/CF986B/","excerpt":"åŸé¢˜é“¾æ¥ Petrè¦æ‰“ä¹±æ’åˆ—ã€‚ä»–é¦–å…ˆæœ‰ä¸€ä¸ªä»111åˆ°nnnçš„é¡ºåºæ’åˆ—ï¼Œç„¶åè¿›è¡Œ3n3n3næ¬¡æ“ä½œï¼Œæ¯æ¬¡é€‰ä¸¤ä¸ªæ•°å¹¶äº¤æ¢å®ƒä»¬ã€‚ Alexä¹Ÿè¦æ‰“ä¹±æ’åˆ—ã€‚ä»–ä¸Petrå”¯ä¸€çš„ä¸åŒæ˜¯ä»–è¿›è¡Œ7n+17n+17n+1æ¬¡æ“ä½œã€‚ ç»™å®šä¸€ä¸ª111åˆ°nnnçš„æ’åˆ—ã€‚é—®æ˜¯ç”±è°æ‰“ä¹±çš„ã€‚å¦‚æœæ˜¯Petrï¼Œè¾“å‡º&quot;Petr&quot;ï¼Œå¦åˆ™è¾“å‡º&quot;Um_nik&quot;ï¼ˆä¸æ˜¯Alexï¼‰ã€‚","text":"åŸé¢˜é“¾æ¥ Petr è¦æ‰“ä¹±æ’åˆ—ã€‚ä»–é¦–å…ˆæœ‰ä¸€ä¸ªä» 111 åˆ°nnnçš„é¡ºåºæ’åˆ—ï¼Œç„¶åè¿›è¡Œ 3n3n3n æ¬¡æ“ä½œï¼Œæ¯æ¬¡é€‰ä¸¤ä¸ªæ•°å¹¶äº¤æ¢å®ƒä»¬ã€‚ Alex ä¹Ÿè¦æ‰“ä¹±æ’åˆ—ã€‚ä»–ä¸ Petr å”¯ä¸€çš„ä¸åŒæ˜¯ä»–è¿›è¡Œ 7n+17n+17n+1 æ¬¡æ“ä½œã€‚ ç»™å®šä¸€ä¸ª 111 åˆ°nnnçš„æ’åˆ—ã€‚é—®æ˜¯ç”±è°æ‰“ä¹±çš„ã€‚å¦‚æœæ˜¯ Petrï¼Œè¾“å‡º &quot;Petr&quot;ï¼Œå¦åˆ™ è¾“å‡º &quot;Um_nik&quot;ï¼ˆä¸æ˜¯ Alexï¼‰ã€‚ ï¼ˆby AKEEï¼‰ é¢˜è§£ é¦–å…ˆæˆ‘ä»¬è€ƒè™‘æ€ä¹ˆå¿«é€Ÿè¿˜åŸè¿™ä¸ªåºåˆ—ã€‚ å¾ˆæ˜¾ç„¶çš„ä¸€ä¸ªè´ªå¿ƒç­–ç•¥å°±æ˜¯å‡è®¾åºåˆ—ä¸º {ai}\\{a_i\\}{aiâ€‹}ï¼Œä¸æ–­æŠŠaaia_{a_i}aaiâ€‹â€‹ ä¸aia_iaiâ€‹äº¤æ¢ç›´åˆ°ai=ia_i=iaiâ€‹=iã€‚ è¿™æ ·åšæˆ‘ä»¬å‘ç°äº¤æ¢æ¬¡æ•°æ˜¯ O(n)\\mathcal{O}(n)O(n) çº§åˆ«çš„ï¼Œå› ä¸º aaia_{a_i}aaiâ€‹â€‹ æœ€å¤šè¢«é€‰ nnn æ¬¡ã€‚ ç„¶åæˆ‘ä»¬å‘ç°è¦ä¸€ä¸ªåºåˆ—äº¤æ¢åå½¢æˆäº¤æ¢å‰çš„åºåˆ—äº¤æ¢æ¬¡æ•°åªèƒ½æ˜¯å¶æ•°ã€‚æ‰€ä»¥è¯¥äº¤æ¢æ¬¡æ•°ä¸ Petr æˆ–Alexçš„å¥‡å¶æ€§ç›¸åŒã€‚ äºæ˜¯åªè¦åˆ¤ä¸€ä¸‹å¥‡å¶å³å¯ã€‚ ä»£ç  12345678910111213141516171819202122232425262728293031#include &lt;cstdio&gt;#include &lt;iostream&gt;#include &lt;algorithm&gt;using namespace std;const int maxn = 1000005;int aa[maxn];int main()&#123; int n; scanf(&quot;%d&quot;, &amp;n); for(int i = 1; i &lt;= n; ++i) scanf(&quot;%d&quot;, &amp;aa[i]); int ans = 0; for(int i = 1; i &lt;= n; ++i) &#123; while(aa[i] != i) &#123; swap(aa[aa[i]], aa[i]); ans++; &#125; &#125; if((n &amp; 1) == (ans &amp; 1)) // åˆ¤æ–­å¥‡å¶æ€§ç›¸åŒ puts(&quot;Petr&quot;); else puts(&quot;Um_nik&quot;); return 0;&#125;","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"CodeForces","slug":"CodeForces","permalink":"https://pufanyi.github.io/oi-blog/tags/CodeForces/"},{"name":"è´ªå¿ƒ","slug":"è´ªå¿ƒ","permalink":"https://pufanyi.github.io/oi-blog/tags/%E8%B4%AA%E5%BF%83/"}]},{"title":"ä¸‰é“å¤§æ°´é¢˜","slug":"ä¸‰é“å¤§æ°´é¢˜","date":"2018-12-30T16:00:00.000Z","updated":"2023-12-25T16:08:27.956Z","comments":true,"path":"ä¸‰é“å¤§æ°´é¢˜/","link":"","permalink":"https://pufanyi.github.io/oi-blog/%E4%B8%89%E9%81%93%E5%A4%A7%E6%B0%B4%E9%A2%98/","excerpt":"å’Œsxdå‡ºçš„å¤§æ°´é¢˜ï¼ŒT1T2å¤§æ ·ä¾‹è¿ç»­å‡ºé”…å¿«è¢«è¡¨æ­»äº†ã€‚","text":"å’Œ sxd å‡ºçš„å¤§æ°´é¢˜ï¼ŒT1T2 å¤§æ ·ä¾‹è¿ç»­å‡ºé”…å¿«è¢«è¡¨æ­»äº†ã€‚ é¢˜é¢ å®Œæ•´çš„é€‰æ‰‹æ–‡ä»¶å¤¹ æˆ³è¿™é‡Œä¸‹è½½ é¢˜è§£ æ•°æ® è¿™é‡Œæ˜¯æ•°æ® ä¸€ç‚¹å°é—®é¢˜ T1 å…¶å®ä¸èƒ½ç”¨ Lucasã€‚ å› ä¸ºæ¨¡æ•°å¤ªå°äº†ï¼Œæ±‚é€†å…ƒæ—¶æœ‰é”…ã€‚ æ‰€ä»¥åº”å°†åŸé¢˜æ¨¡æ•°æ”¹å¤§ï¼Œæ•°æ®èŒƒå›´æ”¹å°ã€‚ ç„¶è€Œæ¯”èµ›æ—¶ä¸¤é¢˜å¤§æ ·ä¾‹çš„å‡ºé”…å·²ç»è®©æˆ‘æ— æ‰€ç•æƒ§äº†â€¦â€¦","categories":[{"name":"å‡ºé¢˜","slug":"å‡ºé¢˜","permalink":"https://pufanyi.github.io/oi-blog/categories/%E5%87%BA%E9%A2%98/"}],"tags":[{"name":"æ•°å­¦","slug":"æ•°å­¦","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%95%B0%E5%AD%A6/"},{"name":"æ¨¡æ‹Ÿèµ›","slug":"æ¨¡æ‹Ÿèµ›","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%A8%A1%E6%8B%9F%E8%B5%9B/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"},{"name":"æ ‘çŠ¶æ•°ç»„/çº¿æ®µæ ‘","slug":"æ ‘çŠ¶æ•°ç»„-çº¿æ®µæ ‘","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84-%E7%BA%BF%E6%AE%B5%E6%A0%91/"},{"name":"å‡ºé¢˜","slug":"å‡ºé¢˜","permalink":"https://pufanyi.github.io/oi-blog/tags/%E5%87%BA%E9%A2%98/"},{"name":"æ ‘çš„é‡å¿ƒ","slug":"æ ‘çš„é‡å¿ƒ","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%A0%91%E7%9A%84%E9%87%8D%E5%BF%83/"}]},{"title":"CodeForces 551C GukiZ hates Boxes","slug":"CF551C","date":"2018-12-29T11:33:33.000Z","updated":"2023-12-25T16:08:27.880Z","comments":true,"path":"CF551C/","link":"","permalink":"https://pufanyi.github.io/oi-blog/CF551C/","excerpt":"åŸé¢˜é“¾æ¥ æœ‰nnnä¸ªä½ç½®(1âˆ¼n)(1\\sim n)(1âˆ¼n)ï¼Œç¬¬iiiä¸ªä½ç½®ä¸Šæœ‰aia_iaiâ€‹ä¸ªç®±å­ã€‚æœ‰mmmä¸ªäººï¼Œå¼€å§‹åœ¨000ä½ç½®ï¼ˆå³åœ¨111å·ä½ç½®å·¦è¾¹ï¼‰ï¼Œæ¯ä¸€ç§’é’Ÿæ¯ä¸ªäººéƒ½å¯ä»¥é€‰æ‹©æ¬èµ°è‡ªå·±ä½ç½®ä¸Šçš„ä¸€ä¸ªç®±å­æˆ–å‘å‰èµ°ä¸€æ­¥ï¼ˆå³ä»ä½ç½®iiièµ°åˆ°ä½ç½®i+1i+1i+1ï¼‰ã€‚é—®æœ€å°‘éœ€è¦å¤šå°‘æ—¶é—´æ‰å¯ä»¥å°†ç®±å­å…¨éƒ¨æ¬å®Œã€‚","text":"åŸé¢˜é“¾æ¥ æœ‰ nnn ä¸ªä½ç½® (1âˆ¼n)(1\\sim n)(1âˆ¼n)ï¼Œç¬¬iii ä¸ªä½ç½®ä¸Šæœ‰ aia_iaiâ€‹ ä¸ªç®±å­ã€‚æœ‰ mmm ä¸ªäººï¼Œå¼€å§‹åœ¨ 000 ä½ç½®ï¼ˆå³åœ¨ 111 å·ä½ç½®å·¦è¾¹ï¼‰ï¼Œæ¯ä¸€ç§’é’Ÿæ¯ä¸ªäººéƒ½å¯ä»¥é€‰æ‹©æ¬èµ°è‡ªå·±ä½ç½®ä¸Šçš„ä¸€ä¸ªç®±å­æˆ–å‘å‰èµ°ä¸€æ­¥ï¼ˆå³ä»ä½ç½® iii èµ°åˆ°ä½ç½®i+1i+1i+1ï¼‰ã€‚é—®æœ€å°‘éœ€è¦å¤šå°‘æ—¶é—´æ‰å¯ä»¥å°†ç®±å­å…¨éƒ¨æ¬å®Œã€‚ è¾“å…¥ç¬¬ä¸€è¡Œä¸¤ä¸ªæ­£æ•´æ•° n,m(n,mâ‰¤105)n, m(n, m\\le 10^5)n,m(n,mâ‰¤105)ï¼Œç¬¬äºŒè¡Œnnn ä¸ªæ•´æ•°ai(0â‰¤aiâ‰¤109)a_i(0\\le a_i\\le 10^9)aiâ€‹(0â‰¤aiâ€‹â‰¤109)ã€‚ é¢˜è§£ å‘ç°æ­£ç€åšæ¯”è¾ƒéº»çƒ¦ï¼Œäºæ˜¯è€ƒè™‘äºŒåˆ†ç­”æ¡ˆã€‚ å¦‚æœéœ€è¦éªŒè¯çš„ç­”æ¡ˆä¸º xxxï¼Œé‚£æˆ‘ä»¬å°±è®©æ¯ä¸ªäººéƒ½æœ‰xxx ç§’ã€‚ æˆ‘ä»¬è€ƒè™‘è®©äººä¸€ä¸ªä¸€ä¸ªæ¥ï¼Œä¸€ä¸ªæ˜¾ç„¶çš„è´ªå¿ƒå°±æ˜¯è®©æ¯ä¸ªäººéƒ½æ‹¿å°½é‡è¿œçš„ç®±å­ã€‚ ç„¶åå¤§åŠ›æ¨¡æ‹Ÿå³å¯ã€‚ ä»£ç  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869#include &lt;cstdio&gt;#include &lt;iostream&gt;#include &lt;algorithm&gt;using namespace std;typedef long long LL;const int maxn = 100005, maxm = 100005;int aa[maxn];int now[maxn];int n, m;inline bool pan(LL x)&#123; for(int i = 1; i &lt;= n; ++i) now[i] = aa[i]; int noww = n; for(int i = 1; i &lt;= m; ++i) &#123; LL tx = x; while(!now[noww] &amp;&amp; noww) noww--; if(!noww) return true; tx -= noww; if(tx &lt; 0) return false; while(tx &gt;= 0) &#123; if(now[noww] &gt; tx) &#123; now[noww] -= tx; break; &#125; else &#123; tx-= now[noww]; now[noww] = 0; while(!now[noww] &amp;&amp; noww) noww--; if(!noww) return true; &#125; &#125; &#125; while(!now[noww] &amp;&amp; noww) noww--; return !noww;&#125;int main()&#123; scanf(&quot;%d%d&quot;, &amp;n, &amp;m); for(int i = 1; i &lt;= n; ++i) scanf(&quot;%d&quot;, &amp;aa[i]); LL l = 0, r = 0x3f3f3f3f3f3f3f3f; while(l &lt; r) &#123; LL mid = (l + r) &gt;&gt; 1; if(pan(mid)) r = mid; else l = mid + 1; &#125; printf(&quot;%I64d\\n&quot;, l); return 0;&#125;","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"CodeForces","slug":"CodeForces","permalink":"https://pufanyi.github.io/oi-blog/tags/CodeForces/"},{"name":"è´ªå¿ƒ","slug":"è´ªå¿ƒ","permalink":"https://pufanyi.github.io/oi-blog/tags/%E8%B4%AA%E5%BF%83/"},{"name":"äºŒåˆ†","slug":"äºŒåˆ†","permalink":"https://pufanyi.github.io/oi-blog/tags/%E4%BA%8C%E5%88%86/"}]},{"title":"zkw çº¿æ®µæ ‘ä¼˜åŒ– dijkstra","slug":"zkwçº¿æ®µæ ‘ä¼˜åŒ–dijkstra","date":"2018-12-22T16:00:00.000Z","updated":"2023-12-25T16:08:27.954Z","comments":true,"path":"zkwçº¿æ®µæ ‘ä¼˜åŒ–dijkstra/","link":"","permalink":"https://pufanyi.github.io/oi-blog/zkw%E7%BA%BF%E6%AE%B5%E6%A0%91%E4%BC%98%E5%8C%96dijkstra/","excerpt":"å¬è¯´zkwçº¿æ®µæ ‘ä¼˜åŒ–dijkstraè·‘å¾—å¾ˆå¿«å‘¢ï¼Œæ´›è°·æœ€ä¼˜è§£éƒ½æ˜¯ç”¨è¿™ä¸ªçš„ã€‚ ç„¶åæˆ‘å°±è‡ªå·±æ‰“äº†ä¸€å‘ã€‚ ç¡®å®å¿«äº†è®¸å¤šï¼Œä½†è¿˜æ˜¯è¢«æœ€ä¼˜è§£åŠç€æ‰“â€¦â€¦ ä½†è‡³å°‘èƒ½è¿‡bzoj3040ã€‚","text":"å¬è¯´ zkw çº¿æ®µæ ‘ä¼˜åŒ– dijkstra è·‘å¾—å¾ˆå¿«å‘¢ï¼Œæ´›è°·æœ€ä¼˜è§£éƒ½æ˜¯ç”¨è¿™ä¸ªçš„ã€‚ ç„¶åæˆ‘å°±è‡ªå·±æ‰“äº†ä¸€å‘ã€‚ ç¡®å®å¿«äº†è®¸å¤šï¼Œä½†è¿˜æ˜¯è¢«æœ€ä¼˜è§£åŠç€æ‰“â€¦â€¦ ä½†è‡³å°‘èƒ½è¿‡bzoj3040ã€‚ æŠŠæ™®é€šå †ä¼˜ dij çš„å †æ”¹æˆçº¿æ®µæ ‘å°±å¯ä»¥äº†ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273struct Edge&#123; int to, dist, nxt;&#125; e[maxm &lt;&lt; 1];int first[maxn];inline void add_edge(int from, int to, int dist)&#123; static int cnt = 0; e[++cnt].nxt = first[from]; first[from] = cnt; e[cnt].dist = dist; e[cnt].to = to;&#125;int dist[maxn];struct DIJKSTRA&#123;#define ls(x) (x &lt;&lt; 1)#define rs(x) (x &lt;&lt; 1 | 1) struct Tree &#123; int no[maxn &lt;&lt; 2]; int t; inline void build_tree() &#123; for(t = 1; t &lt;= n; t &lt;&lt;= 1); for(register int i = 1; i &lt;= n; ++i) no[i + t] = i; &#125; inline void change(int k) &#123; for(k += t, k &gt;&gt;= 1; k; k &gt;&gt;= 1) no[k] = dist[no[ls(k)]] &lt; dist[no[rs(k)]] ? no[ls(k)] : no[rs(k)]; &#125; inline void del(int k) &#123; for(no[k += t] = 0, k &gt;&gt;= 1; k; k &gt;&gt;= 1) no[k] = dist[no[ls(k)]] &lt; dist[no[rs(k)]] ? no[ls(k)] : no[rs(k)]; &#125; &#125; tr; inline void dijkstra(int s) &#123; memset(dist, 0x3f, sizeof(dist)); dist[s] = 0; tr.build_tree(); tr.change(s); for(int i = 1; i &lt;= n; ++i) &#123; register int now = tr.no[1]; if(!now || dist[now] &gt;= inf) break; tr.del(now); for(int j = first[now]; j; j = e[j].nxt) &#123; register int to = e[j].to; if(dist[to] &gt; dist[now] + e[j].dist) &#123; dist[to] = dist[now] + e[j].dist; tr.change(to); &#125; &#125; &#125; &#125;&#125;","categories":[{"name":"æ¨¡æ¿","slug":"æ¨¡æ¿","permalink":"https://pufanyi.github.io/oi-blog/categories/%E6%A8%A1%E6%9D%BF/"}],"tags":[{"name":"å›¾è®º","slug":"å›¾è®º","permalink":"https://pufanyi.github.io/oi-blog/tags/%E5%9B%BE%E8%AE%BA/"},{"name":"æœ€çŸ­è·¯","slug":"æœ€çŸ­è·¯","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%9C%80%E7%9F%AD%E8%B7%AF/"}]},{"title":"20180524 æ¨¡æ‹Ÿèµ› T3 Word","slug":"20180524æ¨¡æ‹Ÿèµ›-word","date":"2018-12-21T16:00:00.000Z","updated":"2023-12-25T16:08:27.856Z","comments":true,"path":"20180524æ¨¡æ‹Ÿèµ›-word/","link":"","permalink":"https://pufanyi.github.io/oi-blog/20180524%E6%A8%A1%E6%8B%9F%E8%B5%9B-word/","excerpt":"ä¸€é“æœ‰è¶£çš„çŸ©ä¹˜é¢˜ã€‚","text":"ä¸€é“æœ‰è¶£çš„çŸ©ä¹˜é¢˜ã€‚ é¢˜è§£ æ˜¾ç„¶å…ƒè¾…éŸ³å¯ä»¥åˆ†å¼€æ¥çœ‹ï¼Œé‚£æˆ‘ä»¬å°±åªçœ‹å…ƒéŸ³ã€‚ äºæ˜¯æˆ‘ä»¬å°±å¯ä»¥å¾ˆè‡ªç„¶åœ°æ¨å‡ºans=âˆ‘i=1n(i+1)pians=\\sum_{i=1}^n(i+1)p^ians=âˆ‘i=1nâ€‹(i+1)piã€‚ç”±äºæœ‰ä¸€ä¸ªå«é‡éŸ³çš„ä¸œè¥¿ï¼Œæ‰€ä»¥ç³»æ•°æ˜¯i+1i+1i+1ã€‚ç›´æ¥ç®—ä¼š Tï¼ˆ70 åˆ†ï¼‰ï¼Œäºæ˜¯æˆ‘ä»¬å°±æƒ³åˆ°äº†çŸ©é˜µå¿«é€Ÿå¹‚ã€‚ é¦–å…ˆæˆ‘ä»¬å½“ç„¶æƒ³åˆ°æ˜¯æ¨ 2Ã—22\\times 22Ã—2 çš„ï¼Œäºæ˜¯å†™å‡ºåˆå§‹çŸ©é˜µ[02p]\\begin{bmatrix}0 &amp; 2p \\end{bmatrix}[0â€‹2pâ€‹]ï¼Œè¦è½¬ç§»åˆ°[2p3p2+2p]\\begin{bmatrix}2p &amp; 3p^2+2p\\end{bmatrix}[2pâ€‹3p2+2pâ€‹]ã€‚å‘ç°çŸ©é˜µçš„ç³»æ•°æœ‰å˜åŒ–ï¼Œæ— æ³•è½¬ç§»ã€‚äºæ˜¯æˆ‘ä»¬å°±éœ€è¦æ·»åŠ ä¸€æ ¼æ¥è¾…åŠ©è½¬ç§»ã€‚è§‚å¯Ÿä¸¤çŸ©é˜µçš„ç³»æ•°å˜åŒ–ï¼Œæˆ‘ä»¬å°±ä¸éš¾æ¨å‡ºè¾…åŠ©çš„é‚£ä¸ªåº”è¯¥å¡«ä»€ä¹ˆï¼š[0p2p]â†’[2pp23p2+2p]\\begin{bmatrix}0&amp;p&amp;2p\\end{bmatrix}\\to \\begin{bmatrix}2p&amp;p^2&amp;3p^2+2p\\end{bmatrix}[0â€‹pâ€‹2pâ€‹]â†’[2pâ€‹p2â€‹3p2+2pâ€‹]ã€‚äºæ˜¯å¾—å‡ºä¸­é—´çŸ©é˜µæ˜¯[1000pp10p]\\begin{bmatrix}1&amp;0&amp;0\\\\0&amp;p&amp;p\\\\1&amp;0&amp;p\\end{bmatrix}â£â¢â¡â€‹101â€‹0p0â€‹0ppâ€‹â¦â¥â¤â€‹ã€‚ ç„¶åå°±ç”¨åŒæ ·çš„æ–¹æ³•ç®—è¾…éŸ³å³å¯ã€‚ ä»£ç  1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162#include &lt;cstring&gt;#include &lt;cmath&gt;#include &lt;fstream&gt;using namespace std;typedef long long LL;ifstream fin(&quot;word.in&quot;);ofstream fout(&quot;word.out&quot;);LL chen[4][4], q, p, n, mod, jg[2][4], tt[4][4];inline void pow(int aa)&#123; while(aa) &#123; if(aa &amp; 1) &#123; for(int j = 1; j &lt;= 3; ++j) &#123; tt[1][j] = 0; for(int k = 1; k &lt;= 3; ++k) tt[1][j] = (tt[1][j] + jg[1][k] * chen[k][j] % mod) %mod; &#125; memcpy(jg, tt, sizeof(jg)); &#125; aa &gt;&gt;= 1; for(int i = 1; i &lt;= 3; ++i) &#123; for(int j = 1; j &lt;= 3; ++j) &#123; tt[i][j] = 0; for(int k = 1; k &lt;= 3; ++k) tt[i][j] = (tt[i][j]+chen[i][k]*chen[k][j]%mod)%mod; &#125; &#125; memcpy(chen, tt, sizeof(chen)); &#125;&#125;int main()&#123; fin &gt;&gt; q &gt;&gt; p &gt;&gt; n &gt;&gt; mod; jg[1][1] = (q&lt;&lt;1) % mod; jg[1][2] = q % mod; chen[1][1] = chen[2][1] = chen[2][2] = q % mod; chen[1][3] = chen[3][3] = 1; pow(n); LL sumy = jg[1][3]; memset(jg, 0, sizeof(jg)); memset(chen, 0, sizeof(chen)); jg[1][1] = (p&lt;&lt;1) % mod; jg[1][2] = p%mod; chen[1][1] = chen[2][1] = chen[2][2] = p % mod; chen[1][3] = chen[3][3] = 1; pow(n); LL sumf = jg[1][3]; LL ans = (sumy * sumf % mod + sumy + sumf) % mod; fout &lt;&lt; ans; return 0;&#125;","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"æ•°å­¦","slug":"æ•°å­¦","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%95%B0%E5%AD%A6/"},{"name":"æ¨¡æ‹Ÿèµ›","slug":"æ¨¡æ‹Ÿèµ›","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%A8%A1%E6%8B%9F%E8%B5%9B/"}]},{"title":"SPOJ1026 Favorite Dice & èµ åˆ¸æ”¶é›†é—®é¢˜","slug":"SP1026","date":"2018-12-21T16:00:00.000Z","updated":"2023-12-25T16:08:27.908Z","comments":true,"path":"SP1026/","link":"","permalink":"https://pufanyi.github.io/oi-blog/SP1026/","excerpt":"åŸé¢˜é“¾æ¥ å‡è®¾æœ‰nnnä¸ªæ•°ï¼Œæ¯ç§æ¯ä¸ªæ•°è·å–æœºç‡ç›¸åŒï¼Œè€Œä¸”æ¯ä¸ªæ•°äº¦æ— é™ä¾›åº”ã€‚è‹¥å–tttä¸ªï¼Œèƒ½é›†é½è¿™nnnä¸ªæ•°çš„æ¦‚ç‡æ˜¯å¤šå°‘ï¼Ÿ","text":"åŸé¢˜é“¾æ¥ å‡è®¾æœ‰ nnn ä¸ªæ•°ï¼Œæ¯ç§æ¯ä¸ªæ•°è·å–æœºç‡ç›¸åŒï¼Œè€Œä¸”æ¯ä¸ªæ•°äº¦æ— é™ä¾›åº”ã€‚è‹¥å– ttt ä¸ªï¼Œèƒ½é›†é½è¿™ nnn ä¸ªæ•°çš„æ¦‚ç‡æ˜¯å¤šå°‘ï¼Ÿ é¢˜è§£ æˆ‘ä»¬è€ƒè™‘å½“ä½ æ‰‹ä¸Šå·²æœ‰ iii ç§ä¸åŒçš„æ•°ï¼Œä»é›†åˆä¸­ä»»é€‰ä¸€ä¸ªæ•°å¾—åˆ°æ–°æ•°çš„æ¦‚ç‡ï¼Œä¸ºnâˆ’i+1n\\frac{n-i+1}{n}nnâˆ’i+1â€‹ï¼Œé‚£æœŸæœ›å³ä¸º1p=nnâˆ’i+1\\frac{1}{p} = \\frac{n}{n-i+1}p1â€‹=nâˆ’i+1nâ€‹ã€‚æ‰€ä»¥æ€»æœŸæœ›ä¸ºâˆ‘i=1nnnâˆ’i+1=âˆ‘i=1nni\\sum_{i = 1}^{n}\\frac{n}{n-i+1} = \\sum_{i=1}^{n}\\frac{n}{i}âˆ‘i=1nâ€‹nâˆ’i+1nâ€‹=âˆ‘i=1nâ€‹inâ€‹ã€‚ å½“ç„¶ä¹Ÿå¯ä»¥ç”¨æ¦‚ç‡ dp æ¥æ¨ï¼š æˆ‘ä»¬è®¾ f[i]f[i]f[i] è¡¨ç¤ºå–äº† iii ç§æ•°æ—¶è¿˜é¡»å–çš„æ•°çš„æœŸæœ›ã€‚ æ˜¾ç„¶f[n]=0f[n] = 0f[n]=0ï¼Œç­”æ¡ˆä¸ºf[0]f[0]f[0]ï¼Œæ‰€ä»¥ä¸ºé€†æ¨ã€‚ åˆç”±äºé€‰ç¬¬ iii ä¸ªæ•°åå†é€‰ä¸€ä¸ªæ•°ä¸å·²ç»é€‰è¿‡çš„æ•°ä¸åŒçš„æ¦‚ç‡ä¸ºnâˆ’in\\frac{n-i}{n}nnâˆ’iâ€‹ï¼Œç›¸åŒä¸ºin\\frac{i}{n}niâ€‹ã€‚ äºæ˜¯å¯å¾—f[i]=nâˆ’inf[i+1]+inf[i]+1f[i] = \\frac{n-i}{n}f[i+1]+\\frac{i}{n}f[i] + 1f[i]=nnâˆ’iâ€‹f[i+1]+niâ€‹f[i]+1ã€‚ è§£å¾—f[i]=f[i+1]+nnâˆ’if[i] = f[i+1] + \\frac{n}{n-i}f[i]=f[i+1]+nâˆ’inâ€‹ã€‚ äºæ˜¯æ•´ç†ä¸€ä¸‹å°±å˜æˆäº†f[0]=âˆ‘i=1nnif[0] = \\sum_{i=1}^{n}\\frac{n}{i}f[0]=âˆ‘i=1nâ€‹inâ€‹ã€‚","categories":[{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"}],"tags":[{"name":"æ•°å­¦","slug":"æ•°å­¦","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%95%B0%E5%AD%A6/"},{"name":"DP","slug":"DP","permalink":"https://pufanyi.github.io/oi-blog/tags/DP/"},{"name":"SPOJ","slug":"SPOJ","permalink":"https://pufanyi.github.io/oi-blog/tags/SPOJ/"}]},{"title":"Hello World!","slug":"hello-world","date":"2018-11-11T04:44:00.000Z","updated":"2023-12-25T16:08:27.954Z","comments":true,"path":"hello-world/","link":"","permalink":"https://pufanyi.github.io/oi-blog/hello-world/","excerpt":"ä½œä¸ºæ–°åšå®¢çš„å¼€å¤´ã€‚","text":"ä½œä¸ºæ–°åšå®¢çš„å¼€å¤´ã€‚ 123456#include &lt;iostream&gt;int main() &#123; std::cout &lt;&lt; &quot;Hello World!&quot; &lt;&lt; std::endl; return 0;&#125;","categories":[],"tags":[]}],"categories":[{"name":"notes","slug":"notes","permalink":"https://pufanyi.github.io/oi-blog/categories/notes/"},{"name":"å…¬å‘Š","slug":"å…¬å‘Š","permalink":"https://pufanyi.github.io/oi-blog/categories/%E5%85%AC%E5%91%8A/"},{"name":"Project","slug":"Project","permalink":"https://pufanyi.github.io/oi-blog/categories/Project/"},{"name":"éšç¬”","slug":"éšç¬”","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%9A%8F%E7%AC%94/"},{"name":"æ–‡åŒ–è¯¾","slug":"æ–‡åŒ–è¯¾","permalink":"https://pufanyi.github.io/oi-blog/categories/%E6%96%87%E5%8C%96%E8%AF%BE/"},{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pufanyi.github.io/oi-blog/categories/%E9%A2%98%E8%A7%A3/"},{"name":"å°å°ç»“","slug":"å°å°ç»“","permalink":"https://pufanyi.github.io/oi-blog/categories/%E5%B0%8F%E5%B0%8F%E7%BB%93/"},{"name":"æ¸¸è®°","slug":"æ¸¸è®°","permalink":"https://pufanyi.github.io/oi-blog/categories/%E6%B8%B8%E8%AE%B0/"},{"name":"æ¯’ç˜¤","slug":"æ¯’ç˜¤","permalink":"https://pufanyi.github.io/oi-blog/categories/%E6%AF%92%E7%98%A4/"},{"name":"å‡ºé¢˜","slug":"å‡ºé¢˜","permalink":"https://pufanyi.github.io/oi-blog/categories/%E5%87%BA%E9%A2%98/"},{"name":"æ¨¡æ¿","slug":"æ¨¡æ¿","permalink":"https://pufanyi.github.io/oi-blog/categories/%E6%A8%A1%E6%9D%BF/"}],"tags":[{"name":"æ•°å­¦","slug":"æ•°å­¦","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%95%B0%E5%AD%A6/"},{"name":"Linear Algebra","slug":"Linear-Algebra","permalink":"https://pufanyi.github.io/oi-blog/tags/Linear-Algebra/"},{"name":"NTU","slug":"NTU","permalink":"https://pufanyi.github.io/oi-blog/tags/NTU/"},{"name":"OOP","slug":"OOP","permalink":"https://pufanyi.github.io/oi-blog/tags/OOP/"},{"name":"notes","slug":"notes","permalink":"https://pufanyi.github.io/oi-blog/tags/notes/"},{"name":"Software Engineering","slug":"Software-Engineering","permalink":"https://pufanyi.github.io/oi-blog/tags/Software-Engineering/"},{"name":"Project","slug":"Project","permalink":"https://pufanyi.github.io/oi-blog/tags/Project/"},{"name":"Data Science","slug":"Data-Science","permalink":"https://pufanyi.github.io/oi-blog/tags/Data-Science/"},{"name":"Artificial Intelligence","slug":"Artificial-Intelligence","permalink":"https://pufanyi.github.io/oi-blog/tags/Artificial-Intelligence/"},{"name":"åˆ†æ²»","slug":"åˆ†æ²»","permalink":"https://pufanyi.github.io/oi-blog/tags/%E5%88%86%E6%B2%BB/"},{"name":"Discrete Mathematics","slug":"Discrete-Mathematics","permalink":"https://pufanyi.github.io/oi-blog/tags/Discrete-Mathematics/"},{"name":"æ¦‚ç‡","slug":"æ¦‚ç‡","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%A6%82%E7%8E%87/"},{"name":"CodeForces","slug":"CodeForces","permalink":"https://pufanyi.github.io/oi-blog/tags/CodeForces/"},{"name":"æ„é€ ","slug":"æ„é€ ","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%9E%84%E9%80%A0/"},{"name":"å›¾è®º","slug":"å›¾è®º","permalink":"https://pufanyi.github.io/oi-blog/tags/%E5%9B%BE%E8%AE%BA/"},{"name":"æ•°è®º","slug":"æ•°è®º","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%95%B0%E8%AE%BA/"},{"name":"äº¤äº’é¢˜","slug":"äº¤äº’é¢˜","permalink":"https://pufanyi.github.io/oi-blog/tags/%E4%BA%A4%E4%BA%92%E9%A2%98/"},{"name":"DP","slug":"DP","permalink":"https://pufanyi.github.io/oi-blog/tags/DP/"},{"name":"æ–‡åŒ–è¯¾","slug":"æ–‡åŒ–è¯¾","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%96%87%E5%8C%96%E8%AF%BE/"},{"name":"AtCoder","slug":"AtCoder","permalink":"https://pufanyi.github.io/oi-blog/tags/AtCoder/"},{"name":"åšå¼ˆ","slug":"åšå¼ˆ","permalink":"https://pufanyi.github.io/oi-blog/tags/%E5%8D%9A%E5%BC%88/"},{"name":"hash","slug":"hash","permalink":"https://pufanyi.github.io/oi-blog/tags/hash/"},{"name":"ç½‘ç»œæµ","slug":"ç½‘ç»œæµ","permalink":"https://pufanyi.github.io/oi-blog/tags/%E7%BD%91%E7%BB%9C%E6%B5%81/"},{"name":"è´ªå¿ƒ","slug":"è´ªå¿ƒ","permalink":"https://pufanyi.github.io/oi-blog/tags/%E8%B4%AA%E5%BF%83/"},{"name":"æœ€çŸ­è·¯","slug":"æœ€çŸ­è·¯","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%9C%80%E7%9F%AD%E8%B7%AF/"},{"name":"å¹¶æŸ¥é›†","slug":"å¹¶æŸ¥é›†","permalink":"https://pufanyi.github.io/oi-blog/tags/%E5%B9%B6%E6%9F%A5%E9%9B%86/"},{"name":"two points","slug":"two-points","permalink":"https://pufanyi.github.io/oi-blog/tags/two-points/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"},{"name":"æ ‘çŠ¶æ•°ç»„/çº¿æ®µæ ‘","slug":"æ ‘çŠ¶æ•°ç»„-çº¿æ®µæ ‘","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84-%E7%BA%BF%E6%AE%B5%E6%A0%91/"},{"name":"äºŒåˆ†","slug":"äºŒåˆ†","permalink":"https://pufanyi.github.io/oi-blog/tags/%E4%BA%8C%E5%88%86/"},{"name":"è®°å¿†åŒ–æœç´¢","slug":"è®°å¿†åŒ–æœç´¢","permalink":"https://pufanyi.github.io/oi-blog/tags/%E8%AE%B0%E5%BF%86%E5%8C%96%E6%90%9C%E7%B4%A2/"},{"name":"ç”Ÿæˆæ ‘","slug":"ç”Ÿæˆæ ‘","permalink":"https://pufanyi.github.io/oi-blog/tags/%E7%94%9F%E6%88%90%E6%A0%91/"},{"name":"USACO","slug":"USACO","permalink":"https://pufanyi.github.io/oi-blog/tags/USACO/"},{"name":"æ¸¸è®°","slug":"æ¸¸è®°","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%B8%B8%E8%AE%B0/"},{"name":"å‡ºé¢˜","slug":"å‡ºé¢˜","permalink":"https://pufanyi.github.io/oi-blog/tags/%E5%87%BA%E9%A2%98/"},{"name":"UVa","slug":"UVa","permalink":"https://pufanyi.github.io/oi-blog/tags/UVa/"},{"name":"æ¨¡æ‹Ÿèµ›","slug":"æ¨¡æ‹Ÿèµ›","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%A8%A1%E6%8B%9F%E8%B5%9B/"},{"name":"Lucas","slug":"Lucas","permalink":"https://pufanyi.github.io/oi-blog/tags/Lucas/"},{"name":"LCT","slug":"LCT","permalink":"https://pufanyi.github.io/oi-blog/tags/LCT/"},{"name":"SPOJ","slug":"SPOJ","permalink":"https://pufanyi.github.io/oi-blog/tags/SPOJ/"},{"name":"åˆ†å—","slug":"åˆ†å—","permalink":"https://pufanyi.github.io/oi-blog/tags/%E5%88%86%E5%9D%97/"},{"name":"å¡å¸¸","slug":"å¡å¸¸","permalink":"https://pufanyi.github.io/oi-blog/tags/%E5%8D%A1%E5%B8%B8/"},{"name":"æ¨¡æ‹Ÿ","slug":"æ¨¡æ‹Ÿ","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%A8%A1%E6%8B%9F/"},{"name":"FFT","slug":"FFT","permalink":"https://pufanyi.github.io/oi-blog/tags/FFT/"},{"name":"ZJOI","slug":"ZJOI","permalink":"https://pufanyi.github.io/oi-blog/tags/ZJOI/"},{"name":"æœç´¢","slug":"æœç´¢","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%90%9C%E7%B4%A2/"},{"name":"å­—ç¬¦ä¸²","slug":"å­—ç¬¦ä¸²","permalink":"https://pufanyi.github.io/oi-blog/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2/"},{"name":"æ ‘çš„é‡å¿ƒ","slug":"æ ‘çš„é‡å¿ƒ","permalink":"https://pufanyi.github.io/oi-blog/tags/%E6%A0%91%E7%9A%84%E9%87%8D%E5%BF%83/"}]}